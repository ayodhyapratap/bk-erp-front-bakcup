(this["webpackJsonpbk-erp-front"]=this["webpackJsonpbk-erp-front"]||[]).push([[18],{1098:function(t,e,a){},1099:function(t,e,a){"use strict";var n={enabled:!0,visible:!0,styles:{},keys:{}};"FORCE_COLOR"in Object({NODE_ENV:"production",PUBLIC_URL:"https://bk-erp.plutonic.co.in",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0})&&(n.enabled="0"!==Object({NODE_ENV:"production",PUBLIC_URL:"https://bk-erp.plutonic.co.in",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).FORCE_COLOR);var i=function(t,e,a){var n=t.open,i=t.close,s=t.regex;return e=n+(e.includes(i)?e.replace(s,i+n):e)+i,a?e.replace(/\r?\n/g,"".concat(i,"$&").concat(n)):e},s=function(t,e,a){n.styles[t]=function(t){return t.open="\x1b[".concat(t.codes[0],"m"),t.close="\x1b[".concat(t.codes[1],"m"),t.regex=new RegExp("\\u001b\\[".concat(t.codes[1],"m"),"g"),t}({name:t,codes:e}),(n.keys[a]||(n.keys[a]=[])).push(t),Reflect.defineProperty(n,t,{get:function(){var e=function t(e){return function(t,e){if(""===t||null==t)return"";if(!1===n.enabled)return t;if(!1===n.visible)return"";for(var a=""+t,s=a.includes("\n"),o=e.length;o-- >0;)a=i(n.styles[e[o]],a,s);return a}(e,t.stack)};return Reflect.setPrototypeOf(e,n),e.stack=this.stack?this.stack.concat(t):[t],e}})};s("reset",[0,0],"modifier"),s("bold",[1,22],"modifier"),s("dim",[2,22],"modifier"),s("italic",[3,23],"modifier"),s("underline",[4,24],"modifier"),s("inverse",[7,27],"modifier"),s("hidden",[8,28],"modifier"),s("strikethrough",[9,29],"modifier"),s("black",[30,39],"color"),s("red",[31,39],"color"),s("green",[32,39],"color"),s("yellow",[33,39],"color"),s("blue",[34,39],"color"),s("magenta",[35,39],"color"),s("cyan",[36,39],"color"),s("white",[37,39],"color"),s("gray",[90,39],"color"),s("grey",[90,39],"color"),s("bgBlack",[40,49],"bg"),s("bgRed",[41,49],"bg"),s("bgGreen",[42,49],"bg"),s("bgYellow",[43,49],"bg"),s("bgBlue",[44,49],"bg"),s("bgMagenta",[45,49],"bg"),s("bgCyan",[46,49],"bg"),s("bgWhite",[47,49],"bg"),s("blackBright",[90,39],"bright"),s("redBright",[91,39],"bright"),s("greenBright",[92,39],"bright"),s("yellowBright",[93,39],"bright"),s("blueBright",[94,39],"bright"),s("magentaBright",[95,39],"bright"),s("cyanBright",[96,39],"bright"),s("whiteBright",[97,39],"bright"),s("bgBlackBright",[100,49],"bgBright"),s("bgRedBright",[101,49],"bgBright"),s("bgGreenBright",[102,49],"bgBright"),s("bgYellowBright",[103,49],"bgBright"),s("bgBlueBright",[104,49],"bgBright"),s("bgMagentaBright",[105,49],"bgBright"),s("bgCyanBright",[106,49],"bgBright"),s("bgWhiteBright",[107,49],"bgBright");var o=n.ansiRegex=/[\u001b\u009b][[\]#;?()]*(?:(?:(?:[^\W_]*;?[^\W_]*)\u0007)|(?:(?:[0-9]{1,4}(;[0-9]{0,4})*)?[~0-9=<>cf-nqrtyA-PRZ]))/g;n.hasColor=n.hasAnsi=function(t){return o.lastIndex=0,!!t&&"string"===typeof t&&o.test(t)},n.unstyle=function(t){return o.lastIndex=0,"string"===typeof t?t.replace(o,""):t},n.none=n.clear=n.noop=function(t){return t},n.stripColor=n.unstyle,n.symbols=a(1100),n.define=s,t.exports=n},1100:function(t,e,a){"use strict";(function(e){var a="win32"===e.platform,n="linux"===e.platform,i={bullet:"\u2022",check:"\u221a",cross:"\xd7",ellipsis:"...",heart:"\u2764",info:"i",line:"\u2500",middot:"\xb7",minus:"\uff0d",plus:"\uff0b",question:"?",questionSmall:"\ufe56",pointer:">",pointerSmall:"\xbb",warning:"\u203c"},s={ballotCross:"\u2718",bullet:"\u2022",check:"\u2714",cross:"\u2716",ellipsis:"\u2026",heart:"\u2764",info:"\u2139",line:"\u2500",middot:"\xb7",minus:"\uff0d",plus:"\uff0b",question:"?",questionFull:"\uff1f",questionSmall:"\ufe56",pointer:n?"\u25b8":"\u276f",pointerSmall:n?"\u2023":"\u203a",warning:"\u26a0"};t.exports=a?i:s,Reflect.defineProperty(t.exports,"windows",{enumerable:!1,value:i}),Reflect.defineProperty(t.exports,"other",{enumerable:!1,value:s})}).call(this,a(69))},1259:function(t,e,a){"use strict";a.r(e);a(226);var n=a(227),i=(a(236),a(237)),s=(a(244),a(245)),o=(a(238),a(239)),r=(a(275),a(272)),c=(a(270),a(268)),l=(a(285),a(284)),m=(a(282),a(280)),d=(a(229),a(228)),p=(a(242),a(19)),u=(a(278),a(279)),h=a(250),f=a(47),g=a(31),b=a(95),y=a(94),E=a(97),v=a(96),O=a(24),T=a(98),_=(a(259),a(260)),C=(a(135),a(99)),A=a(0),k=a.n(A),H=a(230),j=a.n(H),S=(a(654),a(655),a(656)),D=a.n(S),L=a(663),w=a.n(L),x=a(710),B=(a(1098),a(25)),I=a(64),P=a(417),F=a(2),R=a(23),N=a(34),M=(a(319),a(326)),Y=a(478),V=function(t){function e(t){return Object(b.a)(this,e),Object(E.a)(this,Object(v.a)(e).call(this,t))}return Object(T.a)(e,t),Object(y.a)(e,[{key:"render",value:function(){return k.a.createElement(M.a,{placement:"right",content:k.a.createElement(Y.a,Object.assign({appointmentId:this.props.event.appointment.id,key:this.props.event.appointment.id},this.props)),trigger:"hover"},k.a.createElement("div",{style:{color:"white",height:"100%"}},k.a.createElement("h1",{style:{color:"white"}},k.a.createElement(p.a,{type:"user"}),this.props.title)))}}]),e}(k.a.Component),z=a(3),G=a(235),W=k.a.createElement(m.a,null,k.a.createElement(m.a.Item,{key:"1"},k.a.createElement(I.b,{to:"/settings/calendarsettings#timings"},"Modify Calendar Timings")),k.a.createElement(m.a.Item,{key:"2"},k.a.createElement(I.b,{to:"/settings/clinics-staff#staff"},"Add/Edit Doctor or Staff")),k.a.createElement(m.a.Item,{key:"3"},k.a.createElement(I.b,{to:"/settings/clinics-staff#notification"},"Modify SMS/Email for Doctor/Staff")),k.a.createElement(m.a.Item,{key:"4"},k.a.createElement(I.b,{to:"/settings/communication-settings"},"Modify SMS/Email for Patients")),k.a.createElement(m.a.Item,{key:"5"},k.a.createElement(I.b,{to:"/settings/calendarsettings#categories"},"Add/Edit Categroies"))),q=function(t,e){var a=z.get(F.v);a||(a={}),a=Object(g.a)({},a,Object(f.a)({},t,e)),z.set(F.v,a)},K=function(t){var e=!0,a=j()(t.value).isValid()?j()(t.value).format("dddd").toLowerCase():null;if("DOCTOR"!=t.filterType||"ALL"==t.selectedDoctor)if(t.calendarTimings&&a&&t.calendarTimings[a]){var n=t.calendarTimings[a];n.lunch?(j()(t.value,"HH:mm:ss").format("HH:mm:ss")<=n.startTime.format("HH:mm:ss")||j()(t.value,"HH:mm:ss").format("HH:mm:ss")>n.endTime.format("HH:mm:ss")||j()(t.value,"HH:mm:ss").format("HH:mm:ss")<n.lunchEndTime.format("HH:mm:ss")&&j()(t.value,"HH:mm:ss").format("HH:mm:ss")>=n.lunchStartTime.format("HH:mm:ss"))&&(e=!1):(j()(t.value,"HH:mm:ss").format("HH:mm:ss")<=n.startTime.format("HH:mm:ss")||j()(t.value,"HH:mm:ss").format("HH:mm:ss")>n.endTime.format("HH:mm:ss"))&&(e=!1)}else a&&!t.calendarTimings[a]&&(e=!1);else if(t.doctorTimings&&a&&t.doctorTimings[a]){var i=t.doctorTimings[a];i.lunch?(j()(t.value,"HH:mm:ss").format("HH:mm:ss")<=i.startTime.format("HH:mm:ss")||j()(t.value,"HH:mm:ss").format("HH:mm:ss")>i.endTime.format("HH:mm:ss")||j()(t.value,"HH:mm:ss").format("HH:mm:ss")<i.lunchEndTime.format("HH:mm:ss")&&j()(t.value,"HH:mm:ss").format("HH:mm:ss")>=i.lunchStartTime.format("HH:mm:ss"))&&(e=!1):(j()(t.value,"HH:mm:ss").format("HH:mm:ss")<=i.startTime.format("HH:mm:ss")||j()(t.value,"HH:mm:ss").format("HH:mm:ss")>i.endTime.format("HH:mm:ss"))&&(e=!1)}else t.doctorTimings&&a&&!t.doctorTimings[a]&&(e=!1);if(t.showCalendarEvents&&e)for(var s=0;s<t.blockedCalendar.length;s++)if(t.blockedCalendar[s].doctor&&"DOCTOR"==t.filterType){if(t.blockedCalendar[s].doctor==t.selectedDoctor&&j()(t.value).isBetween(j()(t.blockedCalendar[s].block_from),j()(t.blockedCalendar[s].block_to))){e=!1;break}}else if(j()(t.value).isBetween(j()(t.blockedCalendar[s].block_from),j()(t.blockedCalendar[s].block_to))){e=!1;break}if(e)return t.children;var o=k.a.Children.only(t.children);return k.a.cloneElement(o,{className:"".concat(o.props.className," rbc-off-range-bg")})},U=(a(266),a(269)),J=a(249),Q=function(t){function e(t){var a;return Object(b.a)(this,e),(a=Object(E.a)(this,Object(v.a)(e).call(this,t))).changeDate=function(t){var e=Object(O.a)(a);a.setState((function(e){return t?{selectedDate:e.selectedDate.add(1,"days")}:{selectedDate:e.selectedDate.subtract(1,"days")}}),(function(){e.todaysAppointments()}))},a.todaysAppointments=function(){var t=Object(O.a)(a);t.setState({loading:!0});Object(R.c)(Object(R.f)(N.q,[a.props.active_practiceId]),(function(e){t.setState((function(t){var a={},n=[];return e.forEach((function(e){if(e.status==J.m)return!0;a[e.status]?a[e.status]+=1:a[e.status]=1,"ALL"==t.todaysAppointmentFilter?n.push(e):t.todaysAppointmentFilter==e.status&&n.push(e)})),{todaysAppointments:e,todaysAppointmentOverview:a,todaysFilteredAppointments:n,loading:!1}}))}),(function(){t.setState({loading:!1})}),{start:t.state.selectedDate.format("YYYY-MM-DD"),end:t.state.selectedDate.format("YYYY-MM-DD")})},a.filterTodaysAppointment=function(t){a.setState((function(e){var a=[];return e.todaysAppointments.forEach((function(e){"ALL"==t?a.push(e):t==e.status&&a.push(e)})),{todaysFilteredAppointments:a,todaysAppointmentFilter:t}}))},a.changeAppointmentStatus=function(t,e,n){var i=Object(O.a)(a);Object(R.c)(Object(R.f)(N.o,[t]),(function(a){a.status==e?i.updateAppointmentStatus(t,e,n):(Object(R.a)(F.Q,"Appointment status has already changed. Updating Appointments..."),i.todaysAppointments())}),(function(){}))},a.updateAppointmentStatus=function(t,e,n){var i=Object(O.a)(a),s={status:n};n==J.Ib?s.waiting=j()().format():n==J.F?s.engaged=j()().format():n==J.n&&(s.checkout=j()().format());Object(R.l)(Object(R.f)(N.o,[t]),s,(function(t){Object(R.a)(F.Sb,"Appointment Status Changed Successfully!!"),i.todaysAppointments()}),(function(){}))},a.state={todaysAppointments:[],todaysFilteredAppointments:[],todaysAppointmentOverview:{},todaysAppointmentFilter:"ALL",selectedDate:a.props.selectedDate},a.todaysAppointments=a.todaysAppointments.bind(Object(O.a)(a)),a}return Object(T.a)(e,t),Object(y.a)(e,[{key:"componentDidMount",value:function(){this.todaysAppointments()}},{key:"render",value:function(){var t=this,e=this;return k.a.createElement("div",null,k.a.createElement(l.a,{trigger:"click",overlay:W},k.a.createElement(d.a,{block:!0,style:{margin:5}},k.a.createElement(p.a,{type:"setting"})," Settings ",k.a.createElement(p.a,{type:"down"}))),e.props.activePracticePermissions.AddWalkinAppointment||e.props.allowAllPermissions?k.a.createElement(I.b,{to:"/calendar/create-appointment"},k.a.createElement(d.a,{block:!0,type:"primary",style:{margin:5}}," Walkin Appointment")):null,k.a.createElement(n.a,{gutter:8},k.a.createElement(i.a,{span:6,onClick:function(){return t.filterTodaysAppointment(t.state.todaysAppointmentFilter==J.Db?"ALL":J.Db)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==J.Db?"#FF6600":null,color:this.state.todaysAppointmentFilter==J.Db?"white":"#FF6600",boxShadow:"0 2px 4px #111 inset"}},k.a.createElement("small",null,J.Db),k.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==J.Db?"white":"#FF6600"}},this.state.todaysAppointmentOverview[J.Db]?this.state.todaysAppointmentOverview[J.Db]:0)),k.a.createElement(i.a,{span:6,onClick:function(){return t.filterTodaysAppointment(t.state.todaysAppointmentFilter==J.Ib?"ALL":J.Ib)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==J.Ib?"#FC0000":null,color:this.state.todaysAppointmentFilter==J.Ib?"white":"#FC0000",boxShadow:"0 2px 4px #111 inset"}},k.a.createElement("small",null,J.Ib),k.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==J.Ib?"white":"#FC0000"}},this.state.todaysAppointmentOverview[J.Ib]?this.state.todaysAppointmentOverview[J.Ib]:0)),k.a.createElement(i.a,{span:6,onClick:function(){return t.filterTodaysAppointment(t.state.todaysAppointmentFilter==J.F?"ALL":J.F)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==J.F?"#598C01":null,color:this.state.todaysAppointmentFilter==J.F?"white":"#598C01",boxShadow:"0 2px 4px #111 inset"}},k.a.createElement("small",null,J.F),k.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==J.F?"white":"#598C01"}},this.state.todaysAppointmentOverview[J.F]?this.state.todaysAppointmentOverview[J.F]:0)),k.a.createElement(i.a,{span:6,onClick:function(){return t.filterTodaysAppointment(t.state.todaysAppointmentFilter==J.n?"ALL":J.n)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==J.n?"#0094DE":null,color:this.state.todaysAppointmentFilter==J.n?"white":"#0094DE",boxShadow:"0 2px 4px #111 inset"}},k.a.createElement("small",null,J.n),k.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==J.n?"white":"#0094DE"}},this.state.todaysAppointmentOverview[J.n]?this.state.todaysAppointmentOverview[J.n]:0))),k.a.createElement(o.a,null,k.a.createElement("a",{type:"primary",onClick:function(){return t.changeDate(!1)}},k.a.createElement(p.a,{type:"left"})),this.state.selectedDate.format("MMM Do")==j()().format("MMM Do")?"Today":this.state.selectedDate.format("MMM Do"),"'s Schedule (",this.state.todaysFilteredAppointments.length,") \xa0",k.a.createElement("a",{type:"primary",onClick:function(){return t.changeDate(!0)}},k.a.createElement(p.a,{type:"right"}))),k.a.createElement(s.a,{spinning:this.state.loading},k.a.createElement(U.a,{size:"small",dataSource:this.state.todaysFilteredAppointments,renderItem:function(a){return a.status==J.m?k.a.createElement("div",null):k.a.createElement(U.a.Item,{color:"transparent",style:{padding:0}},k.a.createElement("div",{style:{border:"1px solid #ddd",borderRadius:"5px",textDecoration:a.status==J.m?"line-through":"inherit",backgroundColor:a.status==J.m?"#aaa":"#eee",width:"100%",marginTop:"2px",borderLeft:"5px solid".concat(a.doctor&&e.props.doctors_object&&e.props.doctors_object[a.doctor]?e.props.doctors_object[a.doctor].calendar_colour:"transparent")}},k.a.createElement(X,Object.assign({},a,{changeAppointmentStatus:t.changeAppointmentStatus},t.props))))}})))}}]),e}(k.a.Component);function X(t){return k.a.createElement("div",{style:{width:"100%"}},k.a.createElement("p",{style:{marginBottom:0}},k.a.createElement(M.a,{placement:"right",content:k.a.createElement(Y.a,Object.assign({appointmentId:t.id,key:t.id},t))},k.a.createElement("span",{style:{width:"calc(100% - 60px)"}},k.a.createElement("b",null,j()(t.schedule_at).format("LT")),"\xa0",t.patient.user.first_name)),t.status==J.Db?k.a.createElement("span",{style:{width:"70px",float:"right"}},k.a.createElement("a",{onClick:function(){return t.changeAppointmentStatus(t.id,J.Db,J.Ib)},disabled:!t.activePracticePermissions.ChangeAppointmentStatus}," Check In")):null,t.status==J.Ib?k.a.createElement("span",{style:{width:"70px",float:"right"}},k.a.createElement("a",{onClick:function(){return t.changeAppointmentStatus(t.id,J.Ib,J.F)},disabled:!t.activePracticePermissions.ChangeAppointmentStatus}," Engage")):null,t.status==J.F?k.a.createElement("span",{style:{width:"70px",float:"right"}},k.a.createElement("a",{onClick:function(){return t.changeAppointmentStatus(t.id,J.F,J.n)},disabled:!t.activePracticePermissions.ChangeAppointmentStatus}," Check Out")):null,t.status==J.n?k.a.createElement("span",{style:{width:"70px",float:"right"}},k.a.createElement("small",null,"Checked Out")):null))}a(240);var Z=a(241),$=(a(246),a(234),a(233)),tt=(a(349),a(359)),et=(a(289),a(290)),at=(a(281),a(283)),nt=(a(139),a(101)),it=(a(231),a(232)),st=(a(251),a(254)),ot=(a(1099),a(26)),rt=a(294),ct=(st.a.TextArea,Z.a.Item),lt=(c.a.Group,r.a.Group,it.a.Meta),mt=function(t){function e(t){var a;return Object(b.a)(this,e),(a=Object(E.a)(this,Object(v.a)(e).call(this,t))).loadPracticeTiming=function(){var t=Object(O.a)(a);Object(R.c)(Object(R.f)(N.J,[a.props.active_practiceId]),(function(e){var a={};e.length&&(a=e[0]);var n={};J.s.forEach((function(t){n[t]={},a.visting_hour_same_week?(n[t].startTime=j()(a.first_start_time,"HH:mm:ss"),n[t].endTime=j()(a.second_end_time,"HH:mm:ss"),a.is_two_sessions?(n[t].lunch=!0,n[t].lunchStartTime=j()(a.first_end_time,"HH:mm:ss"),n[t].lunchEndTime=j()(a.second_start_time,"HH:mm:ss")):n[t].lunch=!1):a[t]?(n[t].startTime=j()(a["first_start_time_".concat(t)],"HH:mm:ss"),n[t].endTime=j()(a["second_end_time_".concat(t)],"HH:mm:ss"),a["is_two_sessions_".concat(t)]?(n[t].lunch=!0,n[t].lunchStartTime=j()(a["first_end_time_".concat(t)],"HH:mm:ss"),n[t].lunchEndTime=j()(a["second_start_time_".concat(t)],"HH:mm:ss")):n[t].lunch=!1):n[t]=null})),t.setState({calendarTimings:Object(g.a)({},n)},(function(){t.findOutsidePracticeTiming()}))}),(function(){t.setState({calendarTimings:{}})}))},a.loadDoctorsTiming=function(){var t=Object(O.a)(a);t.state.timeToCheckBlock.doctor&&Object(R.c)(Object(R.f)(N.Y,[a.props.active_practiceId]),(function(e){var a={};e.length&&(a=e[0]);var n={};J.s.forEach((function(t){n[t]={},a.visting_hour_same_week?(n[t].startTime=j()(a.first_start_time,"HH:mm:ss"),n[t].endTime=j()(a.second_end_time,"HH:mm:ss"),a.is_two_sessions?(n[t].lunch=!0,n[t].lunchStartTime=j()(a.first_end_time,"HH:mm:ss"),n[t].lunchEndTime=j()(a.second_start_time,"HH:mm:ss")):n[t].lunch=!1):a[t]?(n[t].startTime=j()(a["first_start_time_".concat(t)],"HH:mm:ss"),n[t].endTime=j()(a["second_end_time_".concat(t)],"HH:mm:ss"),a["is_two_sessions_".concat(t)]?(n[t].lunch=!0,n[t].lunchStartTime=j()(a["first_end_time_".concat(t)],"HH:mm:ss"),n[t].lunchEndTime=j()(a["second_start_time_".concat(t)],"HH:mm:ss")):n[t].lunch=!1):n[t]=null})),t.setState({doctorTimings:Object(g.a)({},n)},(function(){t.findOutsideDoctorTiming()}))}),(function(){}),{doctor:t.state.timeToCheckBlock.doctor})},a.setBlockedTiming=function(t,e){var n=Object(O.a)(a);t&&a.setState((function(a){return{timeToCheckBlock:Object(g.a)({},a.timeToCheckBlock,Object(f.a)({},t,e))}}),(function(){n.loadAppointmentList(),n.findBlockedTiming(),n.findOutsidePracticeTiming(),"doctor"==t?n.loadDoctorsTiming():n.findOutsideDoctorTiming()}))},a.findBlockedTiming=function(){var t=Object(O.a)(a);Object(R.c)(N.x,(function(e){e.forEach((function(e){null==e.doctor?t.setState({practiceBlock:!0}):e.doctor==t.props.timeToCheckBlock.doctor&&t.setState({doctorBlock:!0})}))}),(function(){}),{practice:a.props.active_practiceId,cal_fdate:j()(t.state.timeToCheckBlock.schedule_at).format(),cal_tdate:j()(t.state.timeToCheckBlock.schedule_at).add(t.state.timeToCheckBlock.slot,"minutes").format()})},a.findOutsidePracticeTiming=function(){var t=Object(O.a)(a),e=!0;if(t.state.timeToCheckBlock.schedule_at&&t.state.timeToCheckBlock.slot){var n=t.state.timeToCheckBlock.schedule_at,i=t.state.calendarTimings,s=j()(n).isValid()?j()(n).format("dddd").toLowerCase():null;if(i&&s&&i[s]){var o=i[s];o.lunch?(j()(n,"HH:mm:ss").format("HH:mm:ss")<=o.startTime.format("HH:mm:ss")||j()(n,"HH:mm:ss").format("HH:mm:ss")>o.endTime.format("HH:mm:ss")||j()(n,"HH:mm:ss").format("HH:mm:ss")<o.lunchEndTime.format("HH:mm:ss")&&j()(n,"HH:mm:ss").format("HH:mm:ss")>=o.lunchStartTime.format("HH:mm:ss"))&&(e=!1):(j()(n,"HH:mm:ss").format("HH:mm:ss")<=o.startTime.format("HH:mm:ss")||j()(n,"HH:mm:ss").format("HH:mm:ss")>o.endTime.format("HH:mm:ss"))&&(e=!1)}else s&&!i[s]&&(e=!1)}t.setState({practiceOutsideAvailableTiming:!e})},a.findOutsideDoctorTiming=function(){var t=Object(O.a)(a),e=!0;if(t.state.timeToCheckBlock.schedule_at&&t.state.timeToCheckBlock.slot){var n=t.state.timeToCheckBlock.schedule_at,i=t.state.doctorTimings,s=j()(n).isValid()?j()(n).format("dddd").toLowerCase():null;if(i&&s&&i[s]){var o=i[s];o.lunch?(j()(n,"HH:mm:ss").format("HH:mm:ss")<=o.startTime.format("HH:mm:ss")||j()(n,"HH:mm:ss").format("HH:mm:ss")>o.endTime.format("HH:mm:ss")||j()(n,"HH:mm:ss").format("HH:mm:ss")<o.lunchEndTime.format("HH:mm:ss")&&j()(n,"HH:mm:ss").format("HH:mm:ss")>=o.lunchStartTime.format("HH:mm:ss"))&&(e=!1):(j()(n,"HH:mm:ss").format("HH:mm:ss")<=o.startTime.format("HH:mm:ss")||j()(n,"HH:mm:ss").format("HH:mm:ss")>o.endTime.format("HH:mm:ss"))&&(e=!1)}else s&&i&&!i[s]&&(e=!1)}t.setState({doctorOutsideAvailableTiming:!e})},a.handleSubmit=function(t){var e=Object(O.a)(a);t.preventDefault(),a.props.form.validateFields((function(t,n){if(!t){e.setState({saving:!0});var i=Object(g.a)({},n);i.patient={user:{}},a.state.patientDetails?i.patient=a.state.patientDetails:(i.patient.user.first_name=i.patient_name,i.patient.user.email=i.patient_email,i.patient.user.mobile=i.patient_mobile,i.patient_email=void 0,i.patient_name=void 0,i.patient_mobile=void 0),i.practice=e.props.active_practiceId;var s=function(t){e.setState({saving:!1}),e.props.history&&(e.props.history.goBack(),e.props.history.replace("/patients/appointments")),e.props.loadData&&e.props.loadData(),t&&Object(R.a)(F.Sb,"Appointment Created Successfully")},o=function(){e.setState({saving:!1})};a.state.appointment?Object(R.l)(Object(R.f)(N.o,[a.state.appointment.id]),i,s,o):Object(R.j)(N.h,i,s,o)}}))},a.handlePatientSelect=function(t){if(t){var e=Object(O.a)(a);Object(R.c)(Object(R.f)(N.xc,[t]),(function(t){e.setState({patientDetails:t})}),(function(){}))}},a.handleClick=function(t){a.setState({patientDetails:null})},a.state={redirect:!1,practice_doctors:[],appointmentCategories:null,procedure_category:null,treatmentNotes:null,practice_staff:[],appointment:null,loading:!1,patientListData:[],appointmentDetail:null,saving:!1,doctorBlock:!1,doctorOutsideAvailableTiming:!1,practiceBlock:!1,practiceOutsideAvailableTiming:!1,timeToCheckBlock:{schedule_at:j()(),slot:10},procedureObjectsById:{},startTime:a.props.startTime},a.changeRedirect=a.changeRedirect.bind(Object(O.a)(a)),a.loadDoctors=a.loadDoctors.bind(Object(O.a)(a)),a.loadProcedureCategory=a.loadProcedureCategory.bind(Object(O.a)(a)),a.loadTreatmentNotes=a.loadTreatmentNotes.bind(Object(O.a)(a)),a.searchPatient=a.searchPatient.bind(Object(O.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(O.a)(a)),a.loadAppointment=a.loadAppointment.bind(Object(O.a)(a)),a.loadAppointmentList=a.loadAppointmentList.bind(Object(O.a)(a)),a}return Object(T.a)(e,t),Object(y.a)(e,[{key:"componentDidMount",value:function(){var t=this;if(this.loadDoctors(),this.loadProcedureCategory(),this.loadTreatmentNotes(),this.loadAppointmentCategories(),this.loadPracticeTiming(),this.loadAppointmentList(),this.props.match.params.appointmentid)t.loadAppointment();else if(this.props.history&&this.props.history.location.search){var e=this.props.history.location.search.substr(1).split("&");e.length&&e.forEach((function(e){var a=e.split("=");a&&2==a.length&&"patient"==a[0]&&a[1]&&t.handlePatientSelect(a[1])}))}}},{key:"loadAppointment",value:function(){var t=this;this.setState({loading:!0});Object(R.c)(Object(R.f)(N.o,[this.props.match.params.appointmentid]),(function(e){t.setState({appointment:e,patientDetails:e.patient,timeToCheckBlock:e,loading:!1},(function(){t.findBlockedTiming(),t.findOutsideDoctorTiming(),t.loadDoctorsTiming(),t.loadAppointmentList()}))}),(function(){t.setState({loading:!1})}))}},{key:"loadDoctors",value:function(){var t=this;Object(R.c)(Object(R.f)(N.Ec,[this.props.active_practiceId]),(function(e){var a=[],n={};e.staff.forEach((function(e){e.role==F.N&&(a.push(e),t.props.user.id==e.user.id&&(n=e))})),t.setState((function(t){return{selectedDoctor:a.length&&!n.id?a[0].user.id:n.user.id,practice_doctors:a,timeToCheckBlock:Object(g.a)({},t.timeToCheckBlock,{doctor:a.length&&!n.id?a[0].user.id:n.user.id})}}),(function(){t.findBlockedTiming(),t.loadDoctorsTiming()}))}),(function(){}))}},{key:"loadProcedureCategory",value:function(){var t=this;Object(R.c)(Object(R.f)(N.Lc,[this.props.active_practiceId]),(function(e){var a={};e.forEach((function(t){a[t.id]=t})),t.setState({procedure_category:e,procedureObjectsById:Object(g.a)({},a)})}),(function(){}),{pagination:!1})}},{key:"loadTreatmentNotes",value:function(){var t=this;Object(R.c)(Object(R.f)(N.kb,[this.props.active_practiceId]),(function(e){t.setState({treatmentNotes:e})}),(function(){}))}},{key:"loadAppointmentCategories",value:function(){var t=this;Object(R.c)(Object(R.f)(N.p,[this.props.active_practiceId]),(function(e){t.setState({appointmentCategories:e})}),(function(){}))}},{key:"changeRedirect",value:function(){var t=this.state.redirect;this.setState({redirect:!t})}},{key:"searchPatient",value:function(t){var e=this;this.setState({searchPatientString:t});t&&Object(R.c)(Object(R.f)(N.Wc,[t]),(function(a){e.setState((function(e){if(e.searchPatientString==t)return a.current>1?{patientListData:[].concat(Object(h.a)(e.patientListData),Object(h.a)(a.results))}:{patientListData:Object(h.a)(a.results)}}))}),(function(t){e.setState({searchPatientString:null})}))}},{key:"loadAppointmentList",value:function(){var t=this,e={start_time:j()(this.state.timeToCheckBlock.schedule_at).format(),end_time:j()(this.state.timeToCheckBlock.schedule_at).add(this.state.timeToCheckBlock.slot,"minutes").format(),doctor:this.state.timeToCheckBlock.doctor};Object(R.c)(Object(R.f)(N.s,[this.props.active_practiceId]),(function(e){t.setState({appointmentList:e})}),(function(t){}),e)}},{key:"render",value:function(){var t=this,e=this,a=this.props.formLayout?this.props.formLayout:{labelCol:{span:6},wrapperCol:{span:14}},o=this.props.formLayout?this.props.formLayout:{wrapperCol:{offset:6,span:14}},r=this.props.form.getFieldDecorator,c=[];this.state.treatmentNotes&&this.state.treatmentNotes.forEach((function(t){c.push({label:t.name,value:t.id})}));var l=[];this.state.appointmentCategories&&this.state.appointmentCategories.forEach((function(t){l.push({label:t.name,value:t.id})}));var m=this.state.appointment?this.state.appointment.schedule_at:this.props.startTime;m||(m=new j.a(new Date).format());return k.a.createElement(it.a,null,k.a.createElement(s.a,{spinning:this.state.saving},k.a.createElement(Z.a,{onSubmit:this.handleSubmit},this.props.title?k.a.createElement("h2",null,this.props.title):null,k.a.createElement(ct,Object.assign({key:"schedule_at",label:"Appointment Schedule"},a),r("schedule_at",{initialValue:m?j()(m):j()(this.props.startTime),rules:[{required:!0,message:ot.j}]})(k.a.createElement(u.a,{showTime:{use12Hours:!0},format:"YYYY/MM/DD hh:mm a",allowClear:!1,onChange:function(e){return t.setBlockedTiming("schedule_at",e)}})),this.state.practiceOutsideAvailableTiming?k.a.createElement(nt.a,{message:"Selected time is outside available clinic time!!",type:"warning",showIcon:!0}):null,this.state.practiceBlock?k.a.createElement(nt.a,{message:"Selected time is blocked in this clinic !!",type:"warning",showIcon:!0}):null),k.a.createElement(ct,Object.assign({key:"slot"},a,{label:"Time Slot"}),r("slot",{initialValue:this.state.appointment?this.state.appointment.slot:10,rules:[{required:!0,message:ot.j}]})(k.a.createElement(at.a,{min:1,onChange:function(e){return t.setBlockedTiming("slot",e)}})),k.a.createElement("span",{className:"ant-form-text"},"mins",k.a.createElement(n.a,{style:{float:"right"}},k.a.createElement(i.a,{span:24},this.state.appointmentList&&this.state.appointmentList.length>0?k.a.createElement("div",{span:5,style:{float:"right"}},k.a.createElement("ul",{style:{listStyle:"none",display:"inline-flex",paddingLeft:"15px",paddingRight:"10px"}},e.state.appointmentList.map((function(t){return k.a.createElement("li",{style:{border:"1px solid #bbb",marginLeft:"13px",padding:" 0.01em 14px"}},k.a.createElement("span",{style:{width:"calc(100% - 60px)"}},k.a.createElement("b",null,j()(t.schedule_at).format("LT")),"\xa0",t.patient.user.first_name),"\xa0",k.a.createElement("b",null,"with")," \xa0",t.doctor_data.user.first_name)})))):null))),this.state.appointmentList&&this.state.appointmentList.length>0?k.a.createElement(k.a.Fragment,null,k.a.createElement(nt.a,{message:"Selected time slot have assigned someone else !! please select another slot.",type:"warning",showIcon:!0})):null),e.state.patientDetails?k.a.createElement(ct,Object.assign({key:"id",value:this.state.patientDetails.id},o),k.a.createElement(it.a,{bordered:!1,style:{background:"#ECECEC"}},k.a.createElement(lt,{avatar:this.state.patientDetails.image?k.a.createElement(et.a,{src:Object(R.g)(this.state.patientDetails.image)}):k.a.createElement(et.a,{style:{backgroundColor:"#87d068"}},this.state.patientDetails.user.first_name?this.state.patientDetails.user.first_name.charAt(0):k.a.createElement(p.a,{type:"user"})),title:this.state.patientDetails.user.first_name,description:k.a.createElement("span",null,e.props.activePracticePermissions.PatientPhoneNumber?this.state.patientDetails.user.mobile:Object(rt.b)(this.state.patientDetails.user.mobile),k.a.createElement("br",null),k.a.createElement(d.a,{type:"primary",style:{float:"right"},onClick:this.handleClick},"Add New Patient"))}))):k.a.createElement("div",null,k.a.createElement(ct,Object.assign({key:"patient_name",label:"Patient Name"},a),r("patient_name",{initialValue:this.state.appointment?this.state.appointment.patient.user.first_name:null,rules:[{required:!0,message:ot.j}]})(k.a.createElement(tt.a,{placeholder:"Patient Name",showSearch:!0,onSearch:this.searchPatient,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onSelect:this.handlePatientSelect},this.state.patientListData.map((function(t){return k.a.createElement(tt.a.Option,{value:t.id.toString()},k.a.createElement(U.a.Item,{style:{padding:0}},k.a.createElement(U.a.Item.Meta,{avatar:t.image?k.a.createElement(et.a,{src:Object(R.g)(t.image)}):k.a.createElement(et.a,{style:{backgroundColor:"#87d068"}},t.user.first_name?t.user.first_name.charAt(0):k.a.createElement(p.a,{type:"user"})),title:"".concat(t.user.first_name," (ID:").concat(t.custom_id?t.custom_id:t.user.id,")"),description:e.props.activePracticePermissions.PatientPhoneNumber?t.user.mobile:Object(rt.b)(t.user.mobile)})))}))))),k.a.createElement(ct,Object.assign({key:"patient_mobile",label:"Mobile Number"},a),r("patient_mobile",{initialValue:this.state.appointment?this.state.appointment.patient.user.mobile:null,rules:[{required:!0,message:ot.j}]})(k.a.createElement(st.a,{placeholder:"Mobile Number"}))),k.a.createElement(ct,Object.assign({key:"patient_email",label:"Email Address"},a),r("patient_email",{initialValue:this.state.appointment?this.state.appointment.patient.user.email:null,rules:[{type:"email",message:"The input is not valid E-mail!"}]})(k.a.createElement(st.a,{placeholder:"Email Address"})))),k.a.createElement(ct,Object.assign({key:"doctor"},a,{label:"Doctor"}),r("doctor",{initialValue:this.state.appointment?this.state.appointment.doctor:this.state.selectedDoctor},{rules:[{required:!0,message:ot.j}]})(k.a.createElement($.a,{placeholder:"Doctor",onChange:function(e){return t.setBlockedTiming("doctor",e)}},this.state.practice_doctors.map((function(t){return k.a.createElement($.a.Option,{value:t.id},"".concat(t.user.first_name,"(").concat(t.user.email,")"))})))),this.state.doctorBlock?k.a.createElement(nt.a,{message:"Selected time is blocked for selected doctor in this clinic!!",type:"warning",showIcon:!0}):null,this.state.doctorOutsideAvailableTiming?k.a.createElement(nt.a,{message:"Selected time is out of doctor's visit time in this clinic!!",type:"warning",showIcon:!0}):null,this.state.appointmentList&&this.state.appointmentList.length>0?k.a.createElement(k.a.Fragment,null,k.a.createElement(nt.a,{message:"Selected time doctor's busy on other patients in  this clinic!!",type:"warning",showIcon:!0})):null),k.a.createElement(ct,Object.assign({key:"category"},a,{label:"Category"}),r("category",{initialValue:this.state.appointment?this.state.appointment.category:null},{rules:[{required:!0,message:ot.j}]})(k.a.createElement($.a,{placeholder:"Category"},l.map((function(t){return k.a.createElement($.a.Option,{value:t.value},t.label)}))))),this.state.appointment?k.a.createElement(ct,Object.assign({key:"status"},a,{label:"Status"}),r("status",{initialValue:this.state.appointment.status})(k.a.createElement($.a,{placeholder:"Status"},J.f.map((function(t){return k.a.createElement($.a.Option,{value:t.value},t.label)}))))):null,k.a.createElement(ct,Object.assign({key:"notes"},a,{label:"Notes"}),r("notes",{initialValue:this.state.appointment?this.state.appointment.notes:null},{rules:[{required:!0,message:ot.j}]})(k.a.createElement(st.a,{placeholder:"Notes"}))),k.a.createElement(ct,a,k.a.createElement(d.a,{loading:e.state.saving,type:"primary",htmlType:"submit",style:{margin:5}},"Submit"),e.props.history?k.a.createElement(d.a,{style:{margin:5},onClick:function(){return e.props.history.goBack()}},"Cancel"):null))))}}]),e}(k.a.Component),dt=function(t){function e(t){var a;return Object(b.a)(this,e),(a=Object(E.a)(this,Object(v.a)(e).call(this,t))).state={},a}return Object(T.a)(e,t),Object(y.a)(e,[{key:"render",value:function(){var t=this,e=(N.h,[{key:"practice",value:this.props.active_practiceId}]),a=Z.a.create()(mt);return k.a.createElement(n.a,null,k.a.createElement(B.b,{exact:!0,path:"/calendar/:appointmentid/edit-appointment",render:function(n){return t.props.match.params.appointmentid?k.a.createElement(a,Object.assign({},n,t.props,{defaultValues:e,title:"Edit Appointment",changeRedirect:t.changeRedirect})):k.a.createElement(B.a,{to:"/patients/appointments/"})}}),k.a.createElement(B.b,{exact:!0,path:"/calendar/create-appointment",render:function(n){return k.a.createElement(a,Object.assign({},t.props,{defaultValues:e,changeRedirect:t.changeRedirect},n,{title:"ADD Appointment "}))}}))}}]),e}(k.a.Component),pt=a(295),ut=Object(x.c)(j.a),ht=D()(x.a),ft=C.a.Content,gt=_.a.confirm,bt=function(t){function e(t){var a;return Object(b.a)(this,e),(a=Object(E.a)(this,Object(v.a)(e).call(this,t))).changeCalendarType=function(t){var e=Object(O.a)(a);a.setState({calendarType:t,selectedDoctor:"ALL",selectedCategory:"ALL",filterType:"DOCTOR"},(function(){"APPOINTMENTS"==t?e.changeFilter("selectedDoctor","ALL"):"AVAILABILITY"==t&&e.state.practice_doctors.length&&e.changeFilter("selectedDoctor",e.state.practice_doctors[0].id)}))},a.resizeEvent=function(t){var e=t.event,n=t.start,i=t.end;if(e.appointment.status!=J.Db)return Object(R.a)(F.bc,"Action Not Allowed"),!0;var s=a.state.events,o={},r=Object(O.a)(a),c=[];s.forEach((function(t){t.id==e.id&&(o={schedule_at:j()(n).format(),slot:parseInt((i-n)/6e4)})}));var l=function(t){Object(R.a)(F.Sb,"time changed"),s.forEach((function(t){c.push(t.id==e.id?Object(g.a)({},t,{start:n,end:i}):t)})),r.setState({events:c},(function(){r.refreshFilterList()}))},m=function(){};gt({title:"Are you sure to change the time of this appointment?",onOk:function(){Object(R.l)(Object(R.f)(N.o,[e.id]),o,l,m)},onCancel:function(){}})},a.blockedCalendarTiming=function(t,e){var n=Object(O.a)(a);Object(R.c)(N.x,(function(t){n.setState({blockedCalendar:t})}),(function(){}),{practice:a.props.active_practiceId,cal_fdate:t.format(),cal_tdate:e.format()})},a.onRangeChange=function(t){if(t.start&&t.end)if(a.appointmentList(j()(t.start),j()(t.end)),1==j()(t.start).date())a.setState({selectedDate:j()(t.start)});else{var e=j()(t.start);a.setState({selectedDate:e.month(e.month()+1).date(1)})}else t.length&&(7==t.length?a.appointmentList(j()(t[0]).subtract(1,"day"),j()(t[t.length-1]).subtract(1,"day")):a.appointmentList(j()(t[0]),j()(t[t.length-1])),a.setState({selectedDate:j()(t[0])}))},a.onSelectedDateChange=function(t){var e=Object(O.a)(a);a.setState({selectedDate:j()(t)},(function(){e.appointmentList(j()(t).startOf("day"),j()(t).endOf("day"))}))},a.setFilterType=function(t){var e=Object(O.a)(a);a.setState({filterType:t.key,selectedDoctor:"ALL",selectedCategory:"ALL"},(function(){"DOCTOR"==t.key?e.changeFilter("selectedDoctor","ALL"):"CATEGORY"==t.key&&e.changeFilter("selectedCategory","ALL")}))},a.setFilter=function(t,e){var n=Object(O.a)(a);a.setState(Object(f.a)({},t,e),(function(){q(t,e),n.changeFilter("tempKey","ALL")}))},a.refreshFilterList=function(){var t=a.state;"DOCTOR"==t.filterType?a.changeFilter("selectedDoctor",t.selectedDoctor):"CATEGORY"==t.filterType&&a.changeFilter("selectedCategory",t.selectedCategory)},a.changeFilter=function(t,e){"selectedDoctor"==t&&"ALL"!=e&&a.loadDoctorTiming(e),a.setState((function(a){var n,i=[];return a.events.forEach((function(n){if(!a.filterCancelledAppointment&&n.appointment.status==J.m)return!0;"ALL"==e?i.push(n):"selectedDoctor"==t&&n.doctor==e?i.push(n):"selectedCategory"==t&&n.appointment.category==e&&i.push(n)})),n={},Object(f.a)(n,t,e),Object(f.a)(n,"filteredEvent",i),n}))},a.changeState=function(t,e){a.setState(Object(f.a)({},t,e),(function(){q(t,e)}))},a.loadDoctorTiming=function(t){var e=Object(O.a)(a);Object(R.c)(Object(R.f)(N.Y,[a.props.active_practiceId]),(function(a){var n={};a.length&&(n=a[0]);var i={};J.s.forEach((function(t){i[t]={},n.visting_hour_same_week?(i[t].startTime=j()(n.first_start_time,"HH:mm:ss"),i[t].endTime=j()(n.second_end_time,"HH:mm:ss"),n.is_two_sessions?(i[t].lunch=!0,i[t].lunchStartTime=j()(n.first_end_time,"HH:mm:ss"),i[t].lunchEndTime=j()(n.second_start_time,"HH:mm:ss")):i[t].lunch=!1):n[t]?(i[t].startTime=j()(n["first_start_time_".concat(t)],"HH:mm:ss"),i[t].endTime=j()(n["second_end_time_".concat(t)],"HH:mm:ss"),n["is_two_sessions_".concat(t)]?(i[t].lunch=!0,i[t].lunchStartTime=j()(n["first_end_time_".concat(t)],"HH:mm:ss"),i[t].lunchEndTime=j()(n["second_start_time_".concat(t)],"HH:mm:ss")):i[t].lunch=!1):i[t]=null})),e.setState((function(e){return{doctorTiming:Object(g.a)({},e.doctorTiming,Object(f.a)({},t,Object(g.a)({},i)))}}))}),(function(){}),{doctor:t})},a.state=Object(g.a)({startTime:null,visiblePopover:!1,events:[],filteredEvent:[],appointments:[],practice_doctors:[],practice_categories:[],practice_staff:[],doctors_object:null,categories_object:null,calendarTimings:null,timing:{},loading:!0,selectedDoctor:"ALL",selectedCategory:"ALL",selectedDate:j()(),filterType:"DOCTOR",calendarType:"APPOINTMENTS",doctorsAppointmentCount:{},categoriesAppointmentCount:{},blockedCalendar:[],showCalendarEvents:!0,showAppointments:!0,doctorTiming:{}},function(){var t=z.get(F.v);return t||(t={}),t}()),a.onSelectSlot=a.onSelectSlot.bind(Object(O.a)(a)),a.onSelectEvent=a.onSelectEvent.bind(Object(O.a)(a)),a.moveEvent=a.moveEvent.bind(Object(O.a)(a)),a.resizeEvent=a.resizeEvent.bind(Object(O.a)(a)),a.loadDoctors=a.loadDoctors.bind(Object(O.a)(a)),a.eventStyleGetter=a.eventStyleGetter.bind(Object(O.a)(a)),a.loadCalendarTimings=a.loadCalendarTimings.bind(Object(O.a)(a)),a.loadCalendarTimings(),a}return Object(T.a)(e,t),Object(y.a)(e,[{key:"componentDidMount",value:function(){var t;this.appointmentList(j()().startOf("day"),j()().endOf("day")),this.loadDoctors(),t=this,Object(R.c)(Object(R.f)(N.p,[t.props.active_practiceId]),(function(e){var a={},n=e.map((function(t){return a[t.id]=Object(g.a)({},t,{calendar_colour:Object(G.b)(Object(G.a)(t.name))}),a[t.id]}));t.setState({categories_object:a,practice_categories:n})}),(function(){}))}},{key:"loadDoctors",value:function(){var t=this;t.setState({doctorLoading:!0});Object(R.c)(Object(R.f)(N.Ec,[this.props.active_practiceId]),(function(e){var a=[],n=[],i={};e.staff.forEach((function(t){t.role==F.N?(a.push(t),i[t.id]=t):n.push(t)})),t.setState({practice_staff:n,practice_doctors:a,doctors_object:i,doctorLoading:!1})}),(function(){t.setState({doctorLoading:!1})}))}},{key:"loadCalendarTimings",value:function(){var t=this;Object(R.c)(Object(R.f)(N.J,[this.props.active_practiceId]),(function(e){var a={};e.length&&(a=e[0]);var n={};J.s.forEach((function(t){n[t]={},a.visting_hour_same_week?(n[t].startTime=j()(a.first_start_time,"HH:mm:ss"),n[t].endTime=j()(a.second_end_time,"HH:mm:ss"),a.is_two_sessions?(n[t].lunch=!0,n[t].lunchStartTime=j()(a.first_end_time,"HH:mm:ss"),n[t].lunchEndTime=j()(a.second_start_time,"HH:mm:ss")):n[t].lunch=!1):a[t]?(n[t].startTime=j()(a["first_start_time_".concat(t)],"HH:mm:ss"),n[t].endTime=j()(a["second_end_time_".concat(t)],"HH:mm:ss"),a["is_two_sessions_".concat(t)]?(n[t].lunch=!0,n[t].lunchStartTime=j()(a["first_end_time_".concat(t)],"HH:mm:ss"),n[t].lunchEndTime=j()(a["second_start_time_".concat(t)],"HH:mm:ss")):n[t].lunch=!1):n[t]=null})),t.setState({calendarTimings:Object(g.a)({},a),timing:Object(g.a)({},n),loading:!1})}),(function(){t.setState({loading:!1})}))}},{key:"moveEvent",value:function(t){var e=t.event,a=t.start,n=t.end,i=t.isAllDay;if(e.appointment.status!=J.Db)return Object(R.a)(F.bc,"Action Not Allowed"),!0;var s=this.state.events,o=s.indexOf(e),r=e.allDay,c=this;!e.allDay&&i?r=!0:e.allDay&&!i&&(r=!1);var l=Object(g.a)({},e,{start:a,end:n,allDay:r}),m=Object(h.a)(s),d={schedule_at:j()(a).format(),slot:parseInt((n-a)/6e4)},p=function(t){Object(R.a)(F.Sb,"time changed"),m.splice(o,1,l),c.setState({events:m},(function(){c.refreshFilterList()}))},u=function(){};gt({title:"Are you sure to change the time of this appointment?",onOk:function(){Object(R.l)(Object(R.f)(N.o,[e.id]),d,p,u)},onCancel:function(){}})}},{key:"onSelectSlot",value:function(t){var e=j()(t.start).format();"doubleClick"==t.action&&(this.setState({startTime:e,redirect:!0}),this.props.history.push("/calendar/create-appointment"))}},{key:"onSelectEvent",value:function(t,e){this.setState({visiblePopover:!0}),this.props.history.push("/patients/appointments/".concat(t.id))}},{key:"appointmentList",value:function(t,e){var a=this;a.setState({loading:!0});Object(R.c)(Object(R.f)(N.q,[this.props.active_practiceId]),(function(t){a.setState((function(e){e.events;var a=[],n=[],i={},s={};return t.forEach((function(t){var o=new j.a(t.schedule_at).add(t.slot,"minutes"),r={appointment:t,start:new Date(j()(t.schedule_at)),end:new Date(o),title:t.patient.user.first_name,id:t.id,doctor:t.doctor,loading:!1};if(i.ALL?(i.ALL.ALL+=1,t.status==J.m&&(i.ALL.CANCELLED+=1)):(i.ALL={},i.ALL.ALL=1,t.status==J.m?i.ALL.CANCELLED=1:i.ALL.CANCELLED=0),t.doctor&&i[t.doctor]?(i[t.doctor].ALL+=1,t.status==J.m&&(i[t.doctor].CANCELLED+=1)):(i[t.doctor]={},i[t.doctor].ALL=1,t.status==J.m?i[t.doctor].CANCELLED=1:i[t.doctor].CANCELLED=0),t.category&&i[t.category]?s[t.category]+=1:s[t.category]=1,a.push(r),!e.filterCancelledAppointment&&r.appointment.status==J.m)return!0;"DOCTOR"==e.filterType&&"ALL"==e.selectedDoctor||"CATEGORY"==e.filterType&&"ALL"==e.selectedCategory?n.push(r):"DOCTOR"==e.filterType&&r.doctor==e.selectedDoctor?n.push(r):"CATEGORY"==e.filterType&&r.appointment.category==e.selectedCategory&&n.push(r)})),{events:a,filteredEvent:n,doctorsAppointmentCount:Object(g.a)({},i),categoriesAppointmentCount:Object(g.a)({},s,{ALL:t.length}),appointments:t,loading:!1}}))}),(function(){a.setState({loading:!1})}),{start:t.format("YYYY-MM-DD"),end:e.format("YYYY-MM-DD")}),this.blockedCalendarTiming(t,e)}},{key:"eventStyleGetter",value:function(t,e,a,n){var i=t.doctor,s=t.appointment.category,o=null,r={borderRadius:"0px",opacity:.8,border:"5px",color:"white",display:"block"};return t.appointment.status==J.m?(r.backgroundColor="#aaa",r.textDecoration="line-through"):("DOCTOR"==this.state.filterType?o=i&&this.state.doctors_object&&this.state.doctors_object[i]?this.state.doctors_object[i].calendar_colour:"black":"CATEGORY"==this.state.filterType&&(o=s&&this.state.categories_object&&this.state.categories_object[s]?"#".concat(this.state.categories_object[s].calendar_colour):"black"),r.backgroundColor=o),{style:r}}},{key:"render",value:function(){var t=this,e=this;this.state.startTime;this.state.calendarTimings&&(new Date(new j.a(this.state.calendarTimings.start_time,"HH:mm:ss")),new Date(new j.a(this.state.calendarTimings.end_time,"HH:mm:ss")));return k.a.createElement(ft,{className:"main-container"},k.a.createElement("div",{style:{padding:"5px"}},k.a.createElement(B.d,null,k.a.createElement(B.b,{exact:!0,path:"/calendar/create-appointment",render:function(e){return t.props.activePracticePermissions.AddAppointment||t.props.allowAllPermissions?k.a.createElement(dt,Object.assign({},t.state,t.props,e,{startTime:t.state.startTime})):k.a.createElement(pt.a,null)}}),k.a.createElement(B.b,{exact:!0,path:"/calendar/:appointmentid/edit-appointment",render:function(e){return t.props.activePracticePermissions.EditAppointment||t.props.allowAllPermissions?k.a.createElement(dt,Object.assign({},t.state,t.props,e,{startTime:t.state.startTime})):k.a.createElement(pt.a,null)}}),k.a.createElement(B.b,null,k.a.createElement("div",{style:{backgroundColor:"#fff",padding:"5px 10px"}},k.a.createElement(n.a,{gutter:16},k.a.createElement(i.a,{span:3},k.a.createElement(u.a,{onChange:this.onSelectedDateChange,value:this.state.selectedDate,format:"DD-MM-YYYY",style:{margin:5},allowClear:!1}),"APPOINTMENTS"==this.state.calendarType?k.a.createElement("div",null,e.props.activePracticePermissions.BlockCalendar||e.props.allowAllPermissions?k.a.createElement(d.a,{block:!0,style:{margin:5}},k.a.createElement(I.b,{to:"/calendar/blockcalendar"},k.a.createElement(p.a,{type:"stop"})," Block Calendar")):null,k.a.createElement(l.a,{trigger:"click",overlay:k.a.createElement(m.a,{onClick:this.setFilterType},k.a.createElement(m.a.Item,{key:"DOCTOR"},"DOCTOR"),k.a.createElement(m.a.Item,{key:"CATEGORY"},"CATEGORY"))},k.a.createElement(d.a,{block:!0,style:{margin:5}},this.state.filterType," ",k.a.createElement(p.a,{type:"caret-down"})))):null,k.a.createElement(s.a,{spinning:this.state.doctorLoading},"DOCTOR"==this.state.filterType?k.a.createElement(m.a,{selectedKeys:[this.state.selectedDoctor],size:"small",onClick:function(e){return t.changeFilter("selectedDoctor",e.key)}},"APPOINTMENTS"==this.state.calendarType?k.a.createElement(m.a.Item,{key:"ALL",style:{marginBottom:2,textOverflow:"ellipsis",borderLeft:"5px solid black",borderRight:"none"}},k.a.createElement("span",null,"(",this.state.doctorsAppointmentCount.ALL?this.state.filterCancelledAppointment?this.state.doctorsAppointmentCount.ALL.ALL:this.state.doctorsAppointmentCount.ALL.ALL-this.state.doctorsAppointmentCount.ALL.CANCELLED:0,") All Doctors")):null,this.state.practice_doctors.map((function(e){return k.a.createElement(m.a.Item,{key:e.id,style:{textOverflow:"ellipsis",borderRight:"none",borderLeft:"5px solid ".concat(e.calendar_colour),backgroundColor:t.state.selectedDoctor==e.id?e.calendar_colour:"inherit",color:t.state.selectedDoctor==e.id?"white":"inherit",fontWeight:t.state.selectedDoctor==e.id?"bold":"inherit"}},k.a.createElement("span",null,"(",t.state.doctorsAppointmentCount[e.id]?t.state.filterCancelledAppointment?t.state.doctorsAppointmentCount[e.id].ALL:t.state.doctorsAppointmentCount[e.id].ALL-t.state.doctorsAppointmentCount[e.id].CANCELLED:0,") ",e.user.first_name))}))):k.a.createElement(m.a,{selectedKeys:[this.state.selectedCategory],size:"small",onClick:function(e){return t.changeFilter("selectedCategory",e.key)}},k.a.createElement(m.a.Item,{key:"ALL",style:{marginBottom:2,textOverflow:"ellipsis",borderLeft:"5px solid black",borderRight:"none"}},k.a.createElement("span",null,"(",this.state.categoriesAppointmentCount.ALL?this.state.categoriesAppointmentCount.ALL:0,") All Categories")),this.state.practice_categories.map((function(e){return k.a.createElement(m.a.Item,{key:e.id,style:{textOverflow:"ellipsis",borderRight:"none",borderLeft:"5px solid #".concat(e.calendar_colour),backgroundColor:t.state.selectedCategory==e.id?"#".concat(e.calendar_colour):"inherit",color:t.state.selectedCategory==e.id?"white":"inherit",fontWeight:t.state.selectedCategory==e.id?"bold":"inherit"}},k.a.createElement("span",null,"(",t.state.categoriesAppointmentCount[e.id]?t.state.categoriesAppointmentCount[e.id]:0,") ",e.name))}))),k.a.createElement("div",{style:{marginTop:16}},k.a.createElement(c.a.Group,{size:"small",checked:this.state.calendarType,defaultValue:this.state.calendarType,buttonStyle:"solid",onChange:function(e){return t.changeCalendarType(e.target.value)}},k.a.createElement(c.a.Button,{value:"APPOINTMENTS"},k.a.createElement("small",null,"Appointments")),k.a.createElement(c.a.Button,{value:"AVAILABILITY"},k.a.createElement("small",null,"Availability")))),k.a.createElement("div",{style:{position:"fixed",bottom:10,zIndex:9}},this.state.openMorePanel?k.a.createElement("div",{style:{boxShadow:"0 2px 4px #111",border:"1px solid #bbb",borderRadius:2,padding:5,backgroundColor:"white"}},k.a.createElement("ul",{style:{listStyle:"none",paddingInlineStart:0}},k.a.createElement("li",null,k.a.createElement(r.a,{checked:this.state.showCalendarEvents,onChange:function(t){return e.changeState("showCalendarEvents",t.target.checked)}},k.a.createElement("small",null,"Events"))),k.a.createElement("li",null,k.a.createElement(r.a,{checked:this.state.showAppointments,onChange:function(t){return e.changeState("showAppointments",t.target.checked)}},k.a.createElement("small",null,"Appointments"))),k.a.createElement("li",null,k.a.createElement(r.a,{checked:this.state.show24HourCalendar,onChange:function(t){return e.changeState("show24HourCalendar",t.target.checked)}},k.a.createElement("small",null,"24 Hours"))),k.a.createElement("li",null,k.a.createElement(r.a,{checked:this.state.filterCancelledAppointment,onChange:function(t){return e.setFilter("filterCancelledAppointment",t.target.checked)}},k.a.createElement("small",null,"Cancellled Appointment"))),k.a.createElement("li",null,k.a.createElement(o.a,null)),k.a.createElement("li",null,k.a.createElement(I.b,{to:"/settings/clinics-staff#staff"},k.a.createElement("small",null,"Add Doctor"))),k.a.createElement("li",null,k.a.createElement(I.b,{to:"/settings/calendarsettings#timings"},k.a.createElement("small",null," Customize Calendar"))),k.a.createElement("li",null,k.a.createElement("a",null,k.a.createElement("small",null,"Resync")),k.a.createElement(d.a,{onClick:function(){return t.changeState("openMorePanel",!1)},shape:"circle",size:"small",type:"danger",icon:"close",style:{float:"right"}})))):k.a.createElement("a",{onClick:function(){return t.changeState("openMorePanel",!0)}},"More ",k.a.createElement(p.a,{type:"caret-down"}))))),"APPOINTMENTS"==this.state.calendarType?k.a.createElement("div",null,k.a.createElement(i.a,{span:16},k.a.createElement(s.a,{size:"large",spinning:this.state.loading},k.a.createElement(ht,{key:"APPOINTMENTS",defaultDate:new Date,localizer:ut,defaultView:"day",step:10,timeslots:1,truncateEvents:!1,events:this.state.showAppointments?this.state.filteredEvent:[],onEventDrop:this.moveEvent,onEventResize:this.resizeEvent,resizable:!0,selectable:!0,popup:this.onSelectEvent,onSelectSlot:this.onSelectSlot,views:{month:!0,week:yt,day:!0,agenda:!0},style:{height:"calc(100vh - 85px)"},eventPropGetter:this.eventStyleGetter,date:new Date(this.state.selectedDate.format()),onRangeChange:this.onRangeChange,components:{event:function(t){return k.a.createElement(V,Object.assign({},t,e.props))},timeSlotWrapper:function(t){return k.a.createElement(K,Object.assign({},t,{key:t.value.toString(),blockedCalendar:e.state.blockedCalendar,calendarTimings:e.state.timing,doctorTimings:e.state.doctorTiming[e.state.selectedDoctor],filterType:e.state.filterType,selectedDoctor:e.state.selectedDoctor,showCalendarEvents:e.state.showCalendarEvents}))}}}))),k.a.createElement(i.a,{span:5},k.a.createElement(Q,Object.assign({},this.props,this.state,{selectedDate:this.state.selectedDate,key:j()(this.state.selectedDate).format("l")})))):k.a.createElement(i.a,{span:21},k.a.createElement(ht,{key:"AVAILABILITY",defaultDate:new Date,localizer:ut,defaultView:"day",step:10,timeslots:1,truncateEvents:!1,events:this.state.showAppointments?this.state.filteredEvent:[],onEventDrop:this.moveEvent,onEventResize:this.resizeEvent,resizable:!0,selectable:!0,popup:this.onSelectEvent,onSelectSlot:this.onSelectSlot,views:{week:!0,day:!0},style:{height:"calc(100vh - 85px)"},eventPropGetter:this.eventStyleGetter,date:new Date(this.state.selectedDate.format()),onRangeChange:this.onRangeChange,components:{event:function(t){return k.a.createElement(V,Object.assign({},t,e.props))},timeSlotWrapper:function(t){return k.a.createElement(K,Object.assign({},t,{key:t.value.toString(),blockedCalendar:e.state.blockedCalendar,calendarTimings:e.state.timing,doctorTimings:e.state.doctorTiming[e.state.selectedDoctor],filterType:e.state.filterType,selectedDoctor:e.state.selectedDoctor,showCalendarEvents:e.state.showCalendarEvents}))}}}))))))))}}]),e}(A.Component),yt=(e.default=bt,function(t){function e(){return Object(b.a)(this,e),Object(E.a)(this,Object(v.a)(e).apply(this,arguments))}return Object(T.a)(e,t),Object(y.a)(e,[{key:"render",value:function(){var t=this.props.date,a=e.range(t);return k.a.createElement(w.a,Object.assign({},this.props,{range:a,eventOffset:15}))}}]),e}(k.a.Component));yt.range=function(t){for(var e=P.add(t,-1,"day"),a=P.add(e,6,"day"),n=e,i=[];P.lte(n,a,"day");)i.push(n),n=P.add(n,1,"day");return i},yt.navigate=function(t,e){switch(e){case x.b.PREVIOUS:return P.add(t,-3,"day");case x.b.NEXT:return P.add(t,3,"day");default:return t}},yt.title=function(t){return" ".concat(t.toLocaleDateString())}}}]);
//# sourceMappingURL=18.4fa501ee.chunk.js.map