(window["webpackJsonpbk-erp-front"]=window["webpackJsonpbk-erp-front"]||[]).push([[16],{1597:function(e,t,a){},1598:function(e,t,a){},1620:function(e,t,a){},1749:function(e,t,a){"use strict";a.r(t);a(223);var n=a(224),s=(a(232),a(233)),o=(a(241),a(242)),r=(a(234),a(235)),i=(a(279),a(276)),c=(a(273),a(270)),l=(a(290),a(289)),m=(a(287),a(283)),d=(a(228),a(227)),p=(a(236),a(18)),u=(a(281),a(282)),h=a(248),f=a(33),g=a(96),b=a(97),y=a(100),E=a(98),v=a(44),A=a(99),C=(a(259),a(260)),O=(a(138),a(101)),T=a(0),L=a.n(T),D=a(64),k=a.n(D),H=(a(1597),a(1598),a(857)),j=a.n(H),S=a(864),w=a.n(S),_=a(902),F=a(2),x=(a(1620),a(24)),P=a(65),I=a(475),R=a(23),M=a(32),Y=(a(343),a(357)),N=a(581),z=function(e){function t(e){return Object(g.a)(this,t),Object(y.a)(this,Object(E.a)(t).call(this,e))}return Object(A.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return L.a.createElement(Y.a,{placement:"right",content:L.a.createElement(N.a,Object.assign({appointmentId:this.props.event.appointment.id,key:this.props.event.appointment.id},this.props)),trigger:"hover"},L.a.createElement("div",{style:{color:"white",height:"100%"}},L.a.createElement("h1",{style:{color:"white"}},L.a.createElement(p.a,{type:"user"}),this.props.title)))}}]),t}(L.a.Component),G=a(231),B=a(3);function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var J=L.a.createElement(m.a,null,L.a.createElement(m.a.Item,{key:"1"},L.a.createElement(P.b,{to:"/settings/calendarsettings#timings"},"Modify Calendar Timings")),L.a.createElement(m.a.Item,{key:"2"},L.a.createElement(P.b,{to:"/settings/clinics-staff#staff"},"Add/Edit Doctor or Staff")),L.a.createElement(m.a.Item,{key:"3"},L.a.createElement(P.b,{to:"/settings/clinics-staff#notification"},"Modify SMS/Email for Doctor/Staff")),L.a.createElement(m.a.Item,{key:"4"},L.a.createElement(P.b,{to:"/settings/communication-settings"},"Modify SMS/Email for Patients")),L.a.createElement(m.a.Item,{key:"5"},L.a.createElement(P.b,{to:"/settings/calendarsettings#categories"},"Add/Edit Categroies"))),K=function(e,t){var a=B.get(F.v);a||(a={}),a=W({},a,Object(f.a)({},e,t)),B.set(F.v,a)},q=function(){var e=B.get(F.v);return e||(e={}),e},U=function(e){var t=!0,a=k()(e.value).isValid()?k()(e.value).format("dddd").toLowerCase():null;if("DOCTOR"!=e.filterType||"ALL"==e.selectedDoctor)if(e.calendarTimings&&a&&e.calendarTimings[a]){var n=e.calendarTimings[a];n.lunch?(k()(e.value,"HH:mm:ss").format("HH:mm:ss")<=n.startTime.format("HH:mm:ss")||k()(e.value,"HH:mm:ss").format("HH:mm:ss")>n.endTime.format("HH:mm:ss")||k()(e.value,"HH:mm:ss").format("HH:mm:ss")<n.lunchEndTime.format("HH:mm:ss")&&k()(e.value,"HH:mm:ss").format("HH:mm:ss")>=n.lunchStartTime.format("HH:mm:ss"))&&(t=!1):(k()(e.value,"HH:mm:ss").format("HH:mm:ss")<=n.startTime.format("HH:mm:ss")||k()(e.value,"HH:mm:ss").format("HH:mm:ss")>n.endTime.format("HH:mm:ss"))&&(t=!1)}else a&&!e.calendarTimings[a]&&(t=!1);else if(e.doctorTimings&&a&&e.doctorTimings[a]){var s=e.doctorTimings[a];s.lunch?(k()(e.value,"HH:mm:ss").format("HH:mm:ss")<=s.startTime.format("HH:mm:ss")||k()(e.value,"HH:mm:ss").format("HH:mm:ss")>s.endTime.format("HH:mm:ss")||k()(e.value,"HH:mm:ss").format("HH:mm:ss")<s.lunchEndTime.format("HH:mm:ss")&&k()(e.value,"HH:mm:ss").format("HH:mm:ss")>=s.lunchStartTime.format("HH:mm:ss"))&&(t=!1):(k()(e.value,"HH:mm:ss").format("HH:mm:ss")<=s.startTime.format("HH:mm:ss")||k()(e.value,"HH:mm:ss").format("HH:mm:ss")>s.endTime.format("HH:mm:ss"))&&(t=!1)}else e.doctorTimings&&a&&!e.doctorTimings[a]&&(t=!1);if(e.showCalendarEvents&&t)for(var o=0;o<e.blockedCalendar.length;o++)if(e.blockedCalendar[o].doctor&&"DOCTOR"==e.filterType){if(e.blockedCalendar[o].doctor==e.selectedDoctor&&k()(e.value).isBetween(k()(e.blockedCalendar[o].block_from),k()(e.blockedCalendar[o].block_to))){t=!1;break}}else if(k()(e.value).isBetween(k()(e.blockedCalendar[o].block_from),k()(e.blockedCalendar[o].block_to))){t=!1;break}if(t)return e.children;var r=L.a.Children.only(e.children);return L.a.cloneElement(r,{className:r.props.className+" rbc-off-range-bg"})},Q=(a(268),a(271)),X=a(247),Z=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(y.a)(this,Object(E.a)(t).call(this,e))).changeDate=function(e){var t=Object(v.a)(a);a.setState((function(t){return e?{selectedDate:t.selectedDate.add(1,"days")}:{selectedDate:t.selectedDate.subtract(1,"days")}}),(function(){t.todaysAppointments()}))},a.todaysAppointments=function(){var e=Object(v.a)(a);e.setState({loading:!0});Object(R.c)(Object(R.f)(M.q,[a.props.active_practiceId]),(function(t){e.setState((function(e){var a={},n=[];return t.forEach((function(t){if(t.status==X.m)return!0;a[t.status]?a[t.status]+=1:a[t.status]=1,"ALL"==e.todaysAppointmentFilter?n.push(t):e.todaysAppointmentFilter==t.status&&n.push(t)})),{todaysAppointments:t,todaysAppointmentOverview:a,todaysFilteredAppointments:n,loading:!1}}))}),(function(){e.setState({loading:!1})}),{start:e.state.selectedDate.format("YYYY-MM-DD"),end:e.state.selectedDate.format("YYYY-MM-DD")})},a.filterTodaysAppointment=function(e){a.setState((function(t){var a=[];return t.todaysAppointments.forEach((function(t){"ALL"==e?a.push(t):e==t.status&&a.push(t)})),{todaysFilteredAppointments:a,todaysAppointmentFilter:e}}))},a.changeAppointmentStatus=function(e,t,n){var s=Object(v.a)(a);Object(R.c)(Object(R.f)(M.o,[e]),(function(a){a.status==t?s.updateAppointmentStatus(e,t,n):(Object(R.a)(F.Q,"Appointment status has already changed. Updating Appointments..."),s.todaysAppointments())}),(function(){}))},a.updateAppointmentStatus=function(e,t,n){var s=Object(v.a)(a),o={status:n};n==X.Hb?o.waiting=k()().format():n==X.F?o.engaged=k()().format():n==X.n&&(o.checkout=k()().format());Object(R.l)(Object(R.f)(M.o,[e]),o,(function(e){Object(R.a)(F.Sb,"Appointment Status Changed Successfully!!"),s.todaysAppointments()}),(function(){}))},a.state={todaysAppointments:[],todaysFilteredAppointments:[],todaysAppointmentOverview:{},todaysAppointmentFilter:"ALL",selectedDate:a.props.selectedDate},a.todaysAppointments=a.todaysAppointments.bind(Object(v.a)(a)),a}return Object(A.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.todaysAppointments()}},{key:"render",value:function(){var e=this,t=this;return L.a.createElement("div",null,L.a.createElement(l.a,{trigger:"click",overlay:J},L.a.createElement(d.a,{block:!0,style:{margin:5}},L.a.createElement(p.a,{type:"setting"})," Settings ",L.a.createElement(p.a,{type:"down"}))),t.props.activePracticePermissions.AddWalkinAppointment||t.props.allowAllPermissions?L.a.createElement(P.b,{to:"/calendar/create-appointment"},L.a.createElement(d.a,{block:!0,type:"primary",style:{margin:5}}," Walkin Appointment")):null,L.a.createElement(n.a,{gutter:8},L.a.createElement(s.a,{span:6,onClick:function(){return e.filterTodaysAppointment(e.state.todaysAppointmentFilter==X.Cb?"ALL":X.Cb)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==X.Cb?"#FF6600":null,color:this.state.todaysAppointmentFilter==X.Cb?"white":"#FF6600",boxShadow:"0 2px 4px #111 inset"}},L.a.createElement("small",null,X.Cb),L.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==X.Cb?"white":"#FF6600"}},this.state.todaysAppointmentOverview[X.Cb]?this.state.todaysAppointmentOverview[X.Cb]:0)),L.a.createElement(s.a,{span:6,onClick:function(){return e.filterTodaysAppointment(e.state.todaysAppointmentFilter==X.Hb?"ALL":X.Hb)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==X.Hb?"#FC0000":null,color:this.state.todaysAppointmentFilter==X.Hb?"white":"#FC0000",boxShadow:"0 2px 4px #111 inset"}},L.a.createElement("small",null,X.Hb),L.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==X.Hb?"white":"#FC0000"}},this.state.todaysAppointmentOverview[X.Hb]?this.state.todaysAppointmentOverview[X.Hb]:0)),L.a.createElement(s.a,{span:6,onClick:function(){return e.filterTodaysAppointment(e.state.todaysAppointmentFilter==X.F?"ALL":X.F)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==X.F?"#598C01":null,color:this.state.todaysAppointmentFilter==X.F?"white":"#598C01",boxShadow:"0 2px 4px #111 inset"}},L.a.createElement("small",null,X.F),L.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==X.F?"white":"#598C01"}},this.state.todaysAppointmentOverview[X.F]?this.state.todaysAppointmentOverview[X.F]:0)),L.a.createElement(s.a,{span:6,onClick:function(){return e.filterTodaysAppointment(e.state.todaysAppointmentFilter==X.n?"ALL":X.n)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==X.n?"#0094DE":null,color:this.state.todaysAppointmentFilter==X.n?"white":"#0094DE",boxShadow:"0 2px 4px #111 inset"}},L.a.createElement("small",null,X.n),L.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==X.n?"white":"#0094DE"}},this.state.todaysAppointmentOverview[X.n]?this.state.todaysAppointmentOverview[X.n]:0))),L.a.createElement(r.a,null,L.a.createElement("a",{type:"primary",onClick:function(){return e.changeDate(!1)}},L.a.createElement(p.a,{type:"left"})),this.state.selectedDate.format("MMM Do")==k()().format("MMM Do")?"Today":this.state.selectedDate.format("MMM Do"),"'s Schedule (",this.state.todaysFilteredAppointments.length,") \xa0",L.a.createElement("a",{type:"primary",onClick:function(){return e.changeDate(!0)}},L.a.createElement(p.a,{type:"right"}))),L.a.createElement(o.a,{spinning:this.state.loading},L.a.createElement(Q.a,{size:"small",dataSource:this.state.todaysFilteredAppointments,renderItem:function(a){return a.status==X.m?L.a.createElement("div",null):L.a.createElement(Q.a.Item,{color:"transparent",style:{padding:0}},L.a.createElement("div",{style:{border:"1px solid #ddd",borderRadius:"5px",textDecoration:a.status==X.m?"line-through":"inherit",backgroundColor:a.status==X.m?"#aaa":"#eee",width:"100%",marginTop:"2px",borderLeft:"5px solid"+(a.doctor&&t.props.doctors_object&&t.props.doctors_object[a.doctor]?t.props.doctors_object[a.doctor].calendar_colour:"transparent")}},L.a.createElement($,Object.assign({},a,{changeAppointmentStatus:e.changeAppointmentStatus},e.props))))}})))}}]),t}(L.a.Component);function $(e){return L.a.createElement("div",{style:{width:"100%"}},L.a.createElement("p",{style:{marginBottom:0}},L.a.createElement(Y.a,{placement:"right",content:L.a.createElement(N.a,Object.assign({appointmentId:e.id,key:e.id},e))},L.a.createElement("span",{style:{width:"calc(100% - 60px)"}},L.a.createElement("b",null,k()(e.schedule_at).format("LT")),"\xa0",e.patient.user.first_name)),e.status==X.Cb?L.a.createElement("span",{style:{width:"70px",float:"right"}},L.a.createElement("a",{onClick:function(){return e.changeAppointmentStatus(e.id,X.Cb,X.Hb)},disabled:!e.activePracticePermissions.ChangeAppointmentStatus}," Check In")):null,e.status==X.Hb?L.a.createElement("span",{style:{width:"70px",float:"right"}},L.a.createElement("a",{onClick:function(){return e.changeAppointmentStatus(e.id,X.Hb,X.F)},disabled:!e.activePracticePermissions.ChangeAppointmentStatus}," Engage")):null,e.status==X.F?L.a.createElement("span",{style:{width:"70px",float:"right"}},L.a.createElement("a",{onClick:function(){return e.changeAppointmentStatus(e.id,X.F,X.n)},disabled:!e.activePracticePermissions.ChangeAppointmentStatus}," Check Out")):null,e.status==X.n?L.a.createElement("span",{style:{width:"70px",float:"right"}},L.a.createElement("small",null,"Checked Out")):null))}var ee=a(921),te=a(302);function ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ne(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ae(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ae(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var se=Object(_.c)(k.a),oe=j()(_.a),re=O.a.Content,ie=C.a.confirm,ce=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(y.a)(this,Object(E.a)(t).call(this,e))).changeCalendarType=function(e){var t=Object(v.a)(a);a.setState({calendarType:e,selectedDoctor:"ALL",selectedCategory:"ALL",filterType:"DOCTOR"},(function(){"APPOINTMENTS"==e?t.changeFilter("selectedDoctor","ALL"):"AVAILABILITY"==e&&t.state.practice_doctors.length&&t.changeFilter("selectedDoctor",t.state.practice_doctors[0].id)}))},a.resizeEvent=function(e){var t=e.event,n=e.start,s=e.end;if(t.appointment.status!=X.Cb)return Object(R.a)(F.bc,"Action Not Allowed"),!0;var o=a.state.events,r={},i=Object(v.a)(a),c=[];o.forEach((function(e){e.id==t.id&&(r={schedule_at:k()(n).format(),slot:parseInt((s-n)/6e4)})}));var l=function(e){Object(R.a)(F.Sb,"time changed"),o.forEach((function(e){c.push(e.id==t.id?ne({},e,{start:n,end:s}):e)})),i.setState({events:c},(function(){i.refreshFilterList()}))},m=function(){};ie({title:"Are you sure to change the time of this appointment?",onOk:function(){Object(R.l)(Object(R.f)(M.o,[t.id]),r,l,m)},onCancel:function(){}})},a.blockedCalendarTiming=function(e,t){var n=Object(v.a)(a);Object(R.c)(M.x,(function(e){n.setState({blockedCalendar:e})}),(function(){}),{practice:a.props.active_practiceId,cal_fdate:e.format(),cal_tdate:t.format()})},a.onRangeChange=function(e){if(e.start&&e.end)if(a.appointmentList(k()(e.start),k()(e.end)),1==k()(e.start).date())a.setState({selectedDate:k()(e.start)});else{var t=k()(e.start);a.setState({selectedDate:t.month(t.month()+1).date(1)})}else e.length&&(7==e.length?a.appointmentList(k()(e[0]).subtract(1,"day"),k()(e[e.length-1]).subtract(1,"day")):a.appointmentList(k()(e[0]),k()(e[e.length-1])),a.setState({selectedDate:k()(e[0])}))},a.onSelectedDateChange=function(e){var t=Object(v.a)(a);a.setState({selectedDate:k()(e)},(function(){t.appointmentList(k()(e).startOf("day"),k()(e).endOf("day"))}))},a.setFilterType=function(e){var t=Object(v.a)(a);a.setState({filterType:e.key,selectedDoctor:"ALL",selectedCategory:"ALL"},(function(){"DOCTOR"==e.key?t.changeFilter("selectedDoctor","ALL"):"CATEGORY"==e.key&&t.changeFilter("selectedCategory","ALL")}))},a.setFilter=function(e,t){var n=Object(v.a)(a);a.setState(Object(f.a)({},e,t),(function(){K(e,t),n.changeFilter("tempKey","ALL")}))},a.refreshFilterList=function(){var e=a.state;"DOCTOR"==e.filterType?a.changeFilter("selectedDoctor",e.selectedDoctor):"CATEGORY"==e.filterType&&a.changeFilter("selectedCategory",e.selectedCategory)},a.changeFilter=function(e,t){"selectedDoctor"==e&&"ALL"!=t&&a.loadDoctorTiming(t),a.setState((function(a){var n,s=[];return a.events.forEach((function(n){if(!a.filterCancelledAppointment&&n.appointment.status==X.m)return!0;"ALL"==t?s.push(n):"selectedDoctor"==e&&n.doctor==t?s.push(n):"selectedCategory"==e&&n.appointment.category==t&&s.push(n)})),n={},Object(f.a)(n,e,t),Object(f.a)(n,"filteredEvent",s),n}))},a.changeState=function(e,t){a.setState(Object(f.a)({},e,t),(function(){K(e,t)}))},a.loadDoctorTiming=function(e){var t=Object(v.a)(a);Object(R.c)(Object(R.f)(M.Y,[a.props.active_practiceId]),(function(a){var n={};a.length&&(n=a[0]);var s={};X.s.forEach((function(e){s[e]={},n.visting_hour_same_week?(s[e].startTime=k()(n.first_start_time,"HH:mm:ss"),s[e].endTime=k()(n.second_end_time,"HH:mm:ss"),n.is_two_sessions?(s[e].lunch=!0,s[e].lunchStartTime=k()(n.first_end_time,"HH:mm:ss"),s[e].lunchEndTime=k()(n.second_start_time,"HH:mm:ss")):s[e].lunch=!1):n[e]?(s[e].startTime=k()(n["first_start_time_".concat(e)],"HH:mm:ss"),s[e].endTime=k()(n["second_end_time_".concat(e)],"HH:mm:ss"),n["is_two_sessions_".concat(e)]?(s[e].lunch=!0,s[e].lunchStartTime=k()(n["first_end_time_".concat(e)],"HH:mm:ss"),s[e].lunchEndTime=k()(n["second_start_time_".concat(e)],"HH:mm:ss")):s[e].lunch=!1):s[e]=null})),t.setState((function(t){return{doctorTiming:ne({},t.doctorTiming,Object(f.a)({},e,ne({},s)))}}))}),(function(){}),{doctor:e})},a.state=ne({startTime:null,visiblePopover:!1,events:[],filteredEvent:[],appointments:[],practice_doctors:[],practice_categories:[],practice_staff:[],doctors_object:null,categories_object:null,calendarTimings:null,timing:{},loading:!0,selectedDoctor:"ALL",selectedCategory:"ALL",selectedDate:k()(),filterType:"DOCTOR",calendarType:"APPOINTMENTS",doctorsAppointmentCount:{},categoriesAppointmentCount:{},blockedCalendar:[],showCalendarEvents:!0,showAppointments:!0,doctorTiming:{}},q()),a.onSelectSlot=a.onSelectSlot.bind(Object(v.a)(a)),a.onSelectEvent=a.onSelectEvent.bind(Object(v.a)(a)),a.moveEvent=a.moveEvent.bind(Object(v.a)(a)),a.resizeEvent=a.resizeEvent.bind(Object(v.a)(a)),a.loadDoctors=a.loadDoctors.bind(Object(v.a)(a)),a.eventStyleGetter=a.eventStyleGetter.bind(Object(v.a)(a)),a.loadCalendarTimings=a.loadCalendarTimings.bind(Object(v.a)(a)),a.loadCalendarTimings(),a}return Object(A.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){var e;this.appointmentList(k()().startOf("day"),k()().endOf("day")),this.loadDoctors(),e=this,Object(R.c)(Object(R.f)(M.p,[e.props.active_practiceId]),(function(t){var a={},n=t.map((function(e){return a[e.id]=W({},e,{calendar_colour:Object(G.b)(Object(G.a)(e.name))}),a[e.id]}));e.setState({categories_object:a,practice_categories:n})}),(function(){}))}},{key:"loadDoctors",value:function(){var e=this;e.setState({doctorLoading:!0});Object(R.c)(Object(R.f)(M.Dc,[this.props.active_practiceId]),(function(t){var a=[],n=[],s={};t.staff.forEach((function(e){e.role==F.N?(a.push(e),s[e.id]=e):n.push(e)})),e.setState({practice_staff:n,practice_doctors:a,doctors_object:s,doctorLoading:!1})}),(function(){e.setState({doctorLoading:!1})}))}},{key:"loadCalendarTimings",value:function(){var e=this;Object(R.c)(Object(R.f)(M.J,[this.props.active_practiceId]),(function(t){var a={};t.length&&(a=t[0]);var n={};X.s.forEach((function(e){n[e]={},a.visting_hour_same_week?(n[e].startTime=k()(a.first_start_time,"HH:mm:ss"),n[e].endTime=k()(a.second_end_time,"HH:mm:ss"),a.is_two_sessions?(n[e].lunch=!0,n[e].lunchStartTime=k()(a.first_end_time,"HH:mm:ss"),n[e].lunchEndTime=k()(a.second_start_time,"HH:mm:ss")):n[e].lunch=!1):a[e]?(n[e].startTime=k()(a["first_start_time_".concat(e)],"HH:mm:ss"),n[e].endTime=k()(a["second_end_time_".concat(e)],"HH:mm:ss"),a["is_two_sessions_".concat(e)]?(n[e].lunch=!0,n[e].lunchStartTime=k()(a["first_end_time_".concat(e)],"HH:mm:ss"),n[e].lunchEndTime=k()(a["second_start_time_".concat(e)],"HH:mm:ss")):n[e].lunch=!1):n[e]=null})),e.setState({calendarTimings:ne({},a),timing:ne({},n),loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"moveEvent",value:function(e){var t=e.event,a=e.start,n=e.end,s=e.isAllDay;if(t.appointment.status!=X.Cb)return Object(R.a)(F.bc,"Action Not Allowed"),!0;var o=this.state.events,r=o.indexOf(t),i=t.allDay,c=this;!t.allDay&&s?i=!0:t.allDay&&!s&&(i=!1);var l=ne({},t,{start:a,end:n,allDay:i}),m=Object(h.a)(o),d={schedule_at:k()(a).format(),slot:parseInt((n-a)/6e4)},p=function(e){Object(R.a)(F.Sb,"time changed"),m.splice(r,1,l),c.setState({events:m},(function(){c.refreshFilterList()}))},u=function(){};ie({title:"Are you sure to change the time of this appointment?",onOk:function(){Object(R.l)(Object(R.f)(M.o,[t.id]),d,p,u)},onCancel:function(){}})}},{key:"onSelectSlot",value:function(e){var t=k()(e.start).format();"doubleClick"==e.action&&(this.setState({startTime:t,redirect:!0}),this.props.history.push("/calendar/create-appointment"))}},{key:"onSelectEvent",value:function(e,t){this.setState({visiblePopover:!0}),this.props.history.push("/patients/appointments/"+e.id)}},{key:"appointmentList",value:function(e,t){var a=this;a.setState({loading:!0});Object(R.c)(Object(R.f)(M.q,[this.props.active_practiceId]),(function(e){a.setState((function(t){t.events;var a=[],n=[],s={},o={};return e.forEach((function(e){var r=new k.a(e.schedule_at).add(e.slot,"minutes"),i={appointment:e,start:new Date(k()(e.schedule_at)),end:new Date(r),title:e.patient.user.first_name,id:e.id,doctor:e.doctor,loading:!1};if(s.ALL?(s.ALL.ALL+=1,e.status==X.m&&(s.ALL.CANCELLED+=1)):(s.ALL={},s.ALL.ALL=1,e.status==X.m?s.ALL.CANCELLED=1:s.ALL.CANCELLED=0),e.doctor&&s[e.doctor]?(s[e.doctor].ALL+=1,e.status==X.m&&(s[e.doctor].CANCELLED+=1)):(s[e.doctor]={},s[e.doctor].ALL=1,e.status==X.m?s[e.doctor].CANCELLED=1:s[e.doctor].CANCELLED=0),e.category&&s[e.category]?o[e.category]+=1:o[e.category]=1,a.push(i),!t.filterCancelledAppointment&&i.appointment.status==X.m)return!0;"DOCTOR"==t.filterType&&"ALL"==t.selectedDoctor||"CATEGORY"==t.filterType&&"ALL"==t.selectedCategory?n.push(i):"DOCTOR"==t.filterType&&i.doctor==t.selectedDoctor?n.push(i):"CATEGORY"==t.filterType&&i.appointment.category==t.selectedCategory&&n.push(i)})),{events:a,filteredEvent:n,doctorsAppointmentCount:ne({},s),categoriesAppointmentCount:ne({},o,{ALL:e.length}),appointments:e,loading:!1}}))}),(function(){a.setState({loading:!1})}),{start:e.format("YYYY-MM-DD"),end:t.format("YYYY-MM-DD")}),this.blockedCalendarTiming(e,t)}},{key:"eventStyleGetter",value:function(e,t,a,n){var s=e.doctor,o=e.appointment.category,r=null,i={borderRadius:"0px",opacity:.8,border:"5px",color:"white",display:"block"};return e.appointment.status==X.m?(i.backgroundColor="#aaa",i.textDecoration="line-through"):("DOCTOR"==this.state.filterType?r=s&&this.state.doctors_object&&this.state.doctors_object[s]?this.state.doctors_object[s].calendar_colour:"black":"CATEGORY"==this.state.filterType&&(r=o&&this.state.categories_object&&this.state.categories_object[o]?"#"+this.state.categories_object[o].calendar_colour:"black"),i.backgroundColor=r),{style:i}}},{key:"render",value:function(){var e=this,t=this;this.state.startTime;this.state.calendarTimings&&(new Date(new k.a(this.state.calendarTimings.start_time,"HH:mm:ss")),new Date(new k.a(this.state.calendarTimings.end_time,"HH:mm:ss")));return L.a.createElement(re,{className:"main-container"},L.a.createElement("div",{style:{padding:"5px"}},L.a.createElement(x.d,null,L.a.createElement(x.b,{exact:!0,path:"/calendar/create-appointment",render:function(t){return e.props.activePracticePermissions.AddAppointment||e.props.allowAllPermissions?L.a.createElement(ee.a,Object.assign({},e.state,e.props,t,{startTime:e.state.startTime})):L.a.createElement(te.a,null)}}),L.a.createElement(x.b,{exact:!0,path:"/calendar/:appointmentid/edit-appointment",render:function(t){return e.props.activePracticePermissions.EditAppointment||e.props.allowAllPermissions?L.a.createElement(ee.a,Object.assign({},e.state,e.props,t,{startTime:e.state.startTime})):L.a.createElement(te.a,null)}}),L.a.createElement(x.b,null,L.a.createElement("div",{style:{backgroundColor:"#fff",padding:"5px 10px"}},L.a.createElement(n.a,{gutter:16},L.a.createElement(s.a,{span:3},L.a.createElement(u.a,{onChange:this.onSelectedDateChange,value:this.state.selectedDate,format:"DD-MM-YYYY",style:{margin:5},allowClear:!1}),"APPOINTMENTS"==this.state.calendarType?L.a.createElement("div",null,t.props.activePracticePermissions.BlockCalendar||t.props.allowAllPermissions?L.a.createElement(d.a,{block:!0,style:{margin:5}},L.a.createElement(P.b,{to:"/calendar/blockcalendar"},L.a.createElement(p.a,{type:"stop"})," Block Calendar")):null,L.a.createElement(l.a,{trigger:"click",overlay:L.a.createElement(m.a,{onClick:this.setFilterType},L.a.createElement(m.a.Item,{key:"DOCTOR"},"DOCTOR"),L.a.createElement(m.a.Item,{key:"CATEGORY"},"CATEGORY"))},L.a.createElement(d.a,{block:!0,style:{margin:5}},this.state.filterType," ",L.a.createElement(p.a,{type:"caret-down"})))):null,L.a.createElement(o.a,{spinning:this.state.doctorLoading},"DOCTOR"==this.state.filterType?L.a.createElement(m.a,{selectedKeys:[this.state.selectedDoctor],size:"small",onClick:function(t){return e.changeFilter("selectedDoctor",t.key)}},"APPOINTMENTS"==this.state.calendarType?L.a.createElement(m.a.Item,{key:"ALL",style:{marginBottom:2,textOverflow:"ellipsis",borderLeft:"5px solid black",borderRight:"none"}},L.a.createElement("span",null,"(",this.state.doctorsAppointmentCount.ALL?this.state.filterCancelledAppointment?this.state.doctorsAppointmentCount.ALL.ALL:this.state.doctorsAppointmentCount.ALL.ALL-this.state.doctorsAppointmentCount.ALL.CANCELLED:0,") All Doctors")):null,this.state.practice_doctors.map((function(t){return L.a.createElement(m.a.Item,{key:t.id,style:{textOverflow:"ellipsis",borderRight:"none",borderLeft:"5px solid "+t.calendar_colour,backgroundColor:e.state.selectedDoctor==t.id?t.calendar_colour:"inherit",color:e.state.selectedDoctor==t.id?"white":"inherit",fontWeight:e.state.selectedDoctor==t.id?"bold":"inherit"}},L.a.createElement("span",null,"(",e.state.doctorsAppointmentCount[t.id]?e.state.filterCancelledAppointment?e.state.doctorsAppointmentCount[t.id].ALL:e.state.doctorsAppointmentCount[t.id].ALL-e.state.doctorsAppointmentCount[t.id].CANCELLED:0,") ",t.user.first_name))}))):L.a.createElement(m.a,{selectedKeys:[this.state.selectedCategory],size:"small",onClick:function(t){return e.changeFilter("selectedCategory",t.key)}},L.a.createElement(m.a.Item,{key:"ALL",style:{marginBottom:2,textOverflow:"ellipsis",borderLeft:"5px solid black",borderRight:"none"}},L.a.createElement("span",null,"(",this.state.categoriesAppointmentCount.ALL?this.state.categoriesAppointmentCount.ALL:0,") All Categories")),this.state.practice_categories.map((function(t){return L.a.createElement(m.a.Item,{key:t.id,style:{textOverflow:"ellipsis",borderRight:"none",borderLeft:"5px solid #"+t.calendar_colour,backgroundColor:e.state.selectedCategory==t.id?"#"+t.calendar_colour:"inherit",color:e.state.selectedCategory==t.id?"white":"inherit",fontWeight:e.state.selectedCategory==t.id?"bold":"inherit"}},L.a.createElement("span",null,"(",e.state.categoriesAppointmentCount[t.id]?e.state.categoriesAppointmentCount[t.id]:0,") ",t.name))}))),L.a.createElement("div",{style:{marginTop:16}},L.a.createElement(c.a.Group,{size:"small",checked:this.state.calendarType,defaultValue:this.state.calendarType,buttonStyle:"solid",onChange:function(t){return e.changeCalendarType(t.target.value)}},L.a.createElement(c.a.Button,{value:"APPOINTMENTS"},L.a.createElement("small",null,"Appointments")),L.a.createElement(c.a.Button,{value:"AVAILABILITY"},L.a.createElement("small",null,"Availability")))),L.a.createElement("div",{style:{position:"fixed",bottom:10,zIndex:9}},this.state.openMorePanel?L.a.createElement("div",{style:{boxShadow:"0 2px 4px #111",border:"1px solid #bbb",borderRadius:2,padding:5,backgroundColor:"white"}},L.a.createElement("ul",{style:{listStyle:"none",paddingInlineStart:0}},L.a.createElement("li",null,L.a.createElement(i.a,{checked:this.state.showCalendarEvents,onChange:function(e){return t.changeState("showCalendarEvents",e.target.checked)}},L.a.createElement("small",null,"Events"))),L.a.createElement("li",null,L.a.createElement(i.a,{checked:this.state.showAppointments,onChange:function(e){return t.changeState("showAppointments",e.target.checked)}},L.a.createElement("small",null,"Appointments"))),L.a.createElement("li",null,L.a.createElement(i.a,{checked:this.state.show24HourCalendar,onChange:function(e){return t.changeState("show24HourCalendar",e.target.checked)}},L.a.createElement("small",null,"24 Hours"))),L.a.createElement("li",null,L.a.createElement(i.a,{checked:this.state.filterCancelledAppointment,onChange:function(e){return t.setFilter("filterCancelledAppointment",e.target.checked)}},L.a.createElement("small",null,"Cancellled Appointment"))),L.a.createElement("li",null,L.a.createElement(r.a,null)),L.a.createElement("li",null,L.a.createElement(P.b,{to:"/settings/clinics-staff#staff"},L.a.createElement("small",null,"Add Doctor"))),L.a.createElement("li",null,L.a.createElement(P.b,{to:"/settings/calendarsettings#timings"},L.a.createElement("small",null," Customize Calendar"))),L.a.createElement("li",null,L.a.createElement("a",null,L.a.createElement("small",null,"Resync")),L.a.createElement(d.a,{onClick:function(){return e.changeState("openMorePanel",!1)},shape:"circle",size:"small",type:"danger",icon:"close",style:{float:"right"}})))):L.a.createElement("a",{onClick:function(){return e.changeState("openMorePanel",!0)}},"More ",L.a.createElement(p.a,{type:"caret-down"}))))),"APPOINTMENTS"==this.state.calendarType?L.a.createElement("div",null,L.a.createElement(s.a,{span:16},L.a.createElement(o.a,{size:"large",spinning:this.state.loading},L.a.createElement(oe,{key:"APPOINTMENTS",defaultDate:new Date,localizer:se,defaultView:"day",step:10,timeslots:1,truncateEvents:!1,events:this.state.showAppointments?this.state.filteredEvent:[],onEventDrop:this.moveEvent,onEventResize:this.resizeEvent,resizable:!0,selectable:!0,popup:this.onSelectEvent,onSelectSlot:this.onSelectSlot,views:{month:!0,week:le,day:!0,agenda:!0},style:{height:"calc(100vh - 85px)"},eventPropGetter:this.eventStyleGetter,date:new Date(this.state.selectedDate.format()),onRangeChange:this.onRangeChange,components:{event:function(e){return L.a.createElement(z,Object.assign({},e,t.props))},timeSlotWrapper:function(e){return L.a.createElement(U,Object.assign({},e,{key:e.value.toString(),blockedCalendar:t.state.blockedCalendar,calendarTimings:t.state.timing,doctorTimings:t.state.doctorTiming[t.state.selectedDoctor],filterType:t.state.filterType,selectedDoctor:t.state.selectedDoctor,showCalendarEvents:t.state.showCalendarEvents}))}}}))),L.a.createElement(s.a,{span:5},L.a.createElement(Z,Object.assign({},this.props,this.state,{selectedDate:this.state.selectedDate,key:k()(this.state.selectedDate).format("l")})))):L.a.createElement(s.a,{span:21},L.a.createElement(oe,{key:"AVAILABILITY",defaultDate:new Date,localizer:se,defaultView:"day",step:10,timeslots:1,truncateEvents:!1,events:this.state.showAppointments?this.state.filteredEvent:[],onEventDrop:this.moveEvent,onEventResize:this.resizeEvent,resizable:!0,selectable:!0,popup:this.onSelectEvent,onSelectSlot:this.onSelectSlot,views:{week:!0,day:!0},style:{height:"calc(100vh - 85px)"},eventPropGetter:this.eventStyleGetter,date:new Date(this.state.selectedDate.format()),onRangeChange:this.onRangeChange,components:{event:function(e){return L.a.createElement(z,Object.assign({},e,t.props))},timeSlotWrapper:function(e){return L.a.createElement(U,Object.assign({},e,{key:e.value.toString(),blockedCalendar:t.state.blockedCalendar,calendarTimings:t.state.timing,doctorTimings:t.state.doctorTiming[t.state.selectedDoctor],filterType:t.state.filterType,selectedDoctor:t.state.selectedDoctor,showCalendarEvents:t.state.showCalendarEvents}))}}}))))))))}}]),t}(T.Component),le=(t.default=ce,function(e){function t(){return Object(g.a)(this,t),Object(y.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.date,a=t.range(e);return L.a.createElement(w.a,Object.assign({},this.props,{range:a,eventOffset:15}))}}]),t}(L.a.Component));le.range=function(e){for(var t=I.add(e,-1,"day"),a=I.add(t,6,"day"),n=t,s=[];I.lte(n,a,"day");)s.push(n),n=I.add(n,1,"day");return s},le.navigate=function(e,t){switch(t){case _.b.PREVIOUS:return I.add(e,-3,"day");case _.b.NEXT:return I.add(e,3,"day");default:return e}},le.title=function(e){return" ".concat(e.toLocaleDateString())}}}]);
//# sourceMappingURL=16.2eadb972.chunk.js.map