(this["webpackJsonpbk-erp-front"]=this["webpackJsonpbk-erp-front"]||[]).push([[11],{1245:function(e,t,a){var n=a(362),i=a(388),r=a(304);e.exports=function(e,t){var a={};return t=r(t,3),i(e,(function(e,i,r){n(a,t(e,i,r),e)})),a}},1246:function(e,t,a){},1247:function(e,t,a){},1248:function(e,t,a){"use strict";function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!==typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=i?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}a.default=e,t&&t.set(e,a);return a}(a(0)),l=(i=a(5))&&i.__esModule?i:{default:i},c=a(328);function o(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var u=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},d=function(e){return r.createElement(c.ConfigConsumer,null,(function(t){var a=t.getPrefixCls,n=e.prefixCls,i=e.className,c=e.avatar,o=e.title,d=e.description,m=u(e,["prefixCls","className","avatar","title","description"]),p=a("card",n),f=(0,l.default)("".concat(p,"-meta"),i),h=c?r.createElement("div",{className:"".concat(p,"-meta-avatar")},c):null,b=o?r.createElement("div",{className:"".concat(p,"-meta-title")},o):null,y=d?r.createElement("div",{className:"".concat(p,"-meta-description")},d):null,g=b||y?r.createElement("div",{className:"".concat(p,"-meta-detail")},b,y):null;return r.createElement("div",s({},m,{className:f}),h,g)}))};t.default=d},1254:function(e,t,a){"use strict";a.r(t);a(244);var n=a(245),i=a(95),r=a(94),l=a(97),c=a(96),o=a(24),s=a(98),u=(a(135),a(99)),d=a(0),m=a.n(d),p=a(25),f=(a(226),a(227)),h=(a(259),a(260)),b=(a(266),a(269)),y=(a(262),a(263)),g=(a(236),a(237)),E=(a(256),a(257)),v=(a(238),a(239)),_=(a(229),a(228)),O=(a(252),a(253)),P=(a(289),a(290)),k=(a(242),a(19)),j=(a(231),a(232)),C=a(64),S=a(230),x=a.n(S),I=(a(281),a(283)),D=(a(270),a(268)),M=(a(240),a(241)),w=(a(234),a(233)),T=a(250),F=a(47),A=a(31),L=(a(278),a(279)),V=(a(251),a(254)),N=a(694),R=a.n(N),B=a(1245),z=a.n(B),Y=a(23),q=a(34),W=a(261),G=a(243),H=a(2),U=a(246),K=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).getPatientGroup=function(){var e=Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.rc,[a.props.active_practiceId]),(function(t){e.setState({patientGroup:t,loading:!1})}),(function(){e.setState({loading:!1})}))},a.state={patientGroup:[],loading:!0},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.getPatientGroup()}},{key:"deleteObject",value:function(e){var t=this,a=e;a.is_active=!1;Object(Y.j)(Object(Y.f)(q.rc,[this.props.active_practiceId]),a,(function(e){t.getPatientGroup()}),(function(){}))}},{key:"render",value:function(){var e=this,t=[{title:"Group Name",dataIndex:"name",key:"name"},{title:"Patient Count",dataIndex:"patient_count",key:"patient_count"},{title:"Action",key:"action",render:function(t,a){return m.a.createElement(E.a,{title:"Are you sure delete this prescription?",onConfirm:function(){return e.deleteObject(a)},okText:"Yes",cancelText:"No"},m.a.createElement("a",null,"Delete"))}}],a=[{label:"Group Name",key:"name",required:!0,type:H.W}],n={successFn:function(t){console.log(t),Object(Y.a)(H.Sb,"success"),e.getPatientGroup()},errorFn:function(){},action:Object(Y.f)(q.rc,[this.props.active_practiceId]),method:"post",beforeSubmit:function(e){console.log(e)}},i=M.a.create()(U.a);return m.a.createElement(f.a,null,m.a.createElement(i,Object.assign({formProp:n,title:"Patient Groups",fields:a},this.props)),m.a.createElement(v.a,null),m.a.createElement(G.a,{dataSource:this.state.patientGroup,loading:this.state.loading,columns:t}))}}]),t}(m.a.Component),X=a(294),Q=a(249),Z=a(295),J=j.a.Meta,$=V.a.Search,ee=L.a.MonthPicker,te=1,ae=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).togglePatientGroupEditing=function(e){a.setState({showPatientGroupModal:!!e}),e||a.getPatientGroup()},a.changeSelectedPatientGroup=function(e){var t=Object(o.a)(a);a.setState({selectedPatientGroup:e.target.value,currentPage:null},(function(){t.getMorePatient()}))},a.addNewOptionField=function(){var e=a.props.form,t=e.getFieldValue("keys").concat(te++);e.setFieldsValue({keys:t})},a.removeNewOptionField=function(e){var t=a.props.form,n=t.getFieldValue("keys");1!==n.length&&t.setFieldsValue({keys:n.filter((function(t){return t!==e}))})},a.handleChangeOption=function(e,t,n){Object(o.a)(a).setState((function(t){return{selectedOption:Object(A.a)({},t.selectedOption,Object(F.a)({},e,n)),custm_col:n?12:8}}))},a.AdvanceSearchPatient=function(e){var t=Object(o.a)(a);e.preventDefault();var n={};a.props.form.validateFields((function(e,t){e||(n=Object(A.a)({},t,{dob:t.dob?x()(t.dob).format("YYYY-MM-DD"):null,dob_gte:t.dob_gte?x()(t.dob_gte).format("YYYY-MM-DD"):null,dob_lte:t.dob_lte?x()(t.dob_lte).format("YYYY-MM-DD"):null,dob_month:t.dob_month?x()(t.dob_month).format("MM"):null}))})),delete n.keys,t.setState({patientData:n},(function(){t.loadAdvanceSearchPatient()}))},a.loadAdvanceSearchPatient=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(o.a)(a),n=t.state.patientData;t.setState({advancedSearch:!0,advanceLoading:!0});var i=function(e){t.setState((function(t){return e.current>1?{patientListData:[].concat(Object(T.a)(t.patientListData),Object(T.a)(e.results)),morePatientList:e.next,currentPage:e.current,advanceLoading:!1}:{patientListData:Object(T.a)(e.results),morePatientList:e.next,currentPage:e.current,advanceLoading:!1}}))},r=function(){t.setState({advanceLoading:!1})};n.page=e,Object(Y.c)(q.d,i,r,n)},a.state={patientListData:[],patientGroup:[],morePatients:null,loading:!0,selectedPatientGroup:"all",advanced_option:Q.b,selectedOption:{},sourceList:[],custm_col:8,advanceLoading:!1},a.getPatientListData=a.getPatientListData.bind(Object(o.a)(a)),a.searchPatient=a.searchPatient.bind(Object(o.a)(a)),a.getMorePatient=a.getMorePatient.bind(Object(o.a)(a)),a.getSources=a.getSources.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.getPatientListData(),this.getPatientGroup(),this.getSources()}},{key:"getSources",value:function(){var e=this;Object(Y.c)(q.zd,(function(t){e.setState({sourceList:t})}),(function(){}))}},{key:"getPatientGroup",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.rc,[this.props.active_practiceId]),(function(t){var a=t.sort((function(e,t){return t.patient_count-e.patient_count}));e.setState({patientGroup:a})}),(function(){e.setState({})}))}},{key:"getPatientListData",value:function(){var e=this;Object(Y.c)(q.jc,(function(t){e.setState({patientListData:t.results,morePatients:t.next,currentPage:t.current,totalPatients:t.count,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"searchPatient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=this;a.setState({searchvalue:!0,searchString:e});var n=function(t){a.setState((function(a){if(a.searchString==e)return t.current>1?{patientListData:[].concat(Object(T.a)(a.patientListData),Object(T.a)(t.results)),morePatients:t.next,currentPage:t.current}:{patientListData:Object(T.a)(t.results),morePatients:t.next,currentPage:t.current,loading:!1}}))},i=function(){},r={page:t,page_size:20};e?Object(Y.c)(Object(Y.f)(q.Wc,[e]),n,i,r):this.getPatientListData()}},{key:"getMorePatient",value:function(){var e=this,t=this.state.currentPage,a={};t?a.page=parseInt(t)+1:this.setState({loading:!0});var n=this.state.selectedPatientGroup;if("all"!=n)if("smart_a"==n||"smart_b"==n||"smart_c"==n||"smart_d"==n||"smart_e"==n||"smart_f"==n)switch(n){case"smart_a":a.gender="male";break;case"smart_b":a.gender="female";break;case"smart_c":a.gender="female",a.age=30,a.type="gt";break;case"smart_d":a.gender="female",a.age=30,a.type="lt";break;case"smart_e":a.gender="male",a.age=30,a.type="gt";break;case"smart_f":a.gender="male",a.age=30,a.type="lt"}else a.group=this.state.selectedPatientGroup;Object(Y.c)(q.jc,(function(a){a.current==t+1&&e.setState((function(e){return a.current>1?{patientListData:[].concat(Object(T.a)(e.patientListData),Object(T.a)(a.results)),morePatients:a.next,currentPage:a.current}:{patientListData:Object(T.a)(a.results),morePatients:a.next,currentPage:a.current,loading:!1}}))}),(function(){}),Object(A.a)({},a))}},{key:"advancedOption",value:function(e){this.getPatientListData(),this.setState({advancedOptionShow:!e,selectedOption:""}),e&&this.props.form.setFieldsValue({keys:[0]})}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,i=a.getFieldDecorator,r=a.getFieldValue;i("keys",{initialValue:[0]});var l=r("keys"),c=Object(A.a)({},z()(this.state.selectedOption,(function(e){return e}))),o=l.map((function(a,n){return m.a.createElement(f.a,{gutter:12,key:a},m.a.createElement(g.a,{span:10},m.a.createElement(w.a,{style:{width:"200px"},defaultValue:H.y,key:a,size:"small",onChange:function(t){return e.handleChangeOption(a,"type",t)}},m.a.createElement(w.a.Option,{value:""},H.y),R()(e.state.advanced_option,(function(e){return t.state.selectedOption[a]==e.value||!c[e.value]})).map((function(e){return m.a.createElement(w.a.Option,{value:e.value,key:a},e.label)})))),e.state.selectedOption?m.a.createElement(m.a.Fragment,null,m.a.createElement(g.a,{span:8},m.a.createElement(re,{k:a,selectedOption:e.state.selectedOption,form:e.props.form,sourceList:e.state.sourceList})),m.a.createElement(g.a,{span:4},n?m.a.createElement(_.a,{onClick:function(){return e.removeNewOptionField(a)},size:"small",style:{margin:5}},m.a.createElement(k.a,{className:"dynamic-delete-button",type:"minus-circle-o",style:{color:"red"}})):null,n==l.length-1&&t.state.selectedOption[a]?m.a.createElement(_.a,{onClick:e.addNewOptionField,size:"small",style:{margin:5}},m.a.createElement(k.a,{className:"dynamic-delete-button",type:"plus-circle-o"})):null)):null)}));return t.props.activePracticePermissions.ViewPatient?m.a.createElement("div",null,m.a.createElement(f.a,{gutter:16},this.state.advancedOptionShow?m.a.createElement(M.a,{onSubmit:this.AdvanceSearchPatient,layout:"inline"},m.a.createElement(f.a,{gutter:16},m.a.createElement(g.a,{span:16},o),m.a.createElement(g.a,{span:4,style:{display:"flex"}},m.a.createElement(M.a.Item,null,m.a.createElement(_.a,{icon:"search",htmlType:"submit",onSubmit:this.AdvanceSearchPatient,type:"primary",style:{margin:5}},"Search")),m.a.createElement(M.a.Item,null,m.a.createElement(_.a,{style:{margin:5},onClick:function(t){return e.advancedOption(!0)},size:"small"},"Basic Search"))))):m.a.createElement(m.a.Fragment,null,m.a.createElement(g.a,{span:12},m.a.createElement($,{style:{margin:5},placeholder:"Search Patient By Name / ID / Mobile No / Aadhar No",size:"small",onChange:function(t){return e.searchPatient(t.target.value)},enterButton:!0})),m.a.createElement(g.a,{span:12,style:{textAlign:"center"}},m.a.createElement(_.a,{style:{margin:5},onClick:function(t){return e.advancedOption(!1)},size:"small"},"Advance Search"))),m.a.createElement(v.a,{style:{margin:0}})),m.a.createElement(f.a,{gutter:16},m.a.createElement(g.a,{span:5,style:{height:"calc(100% - 55px)",overflow:"auto",padding:"10px"}},m.a.createElement(D.a.Group,{buttonStyle:"solid",defaultValue:this.state.selectedPatientGroup,onChange:this.changeSelectedPatientGroup},m.a.createElement("h2",null,"Patients"),m.a.createElement(D.a.Button,{key:"all",style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:"all"},"All Patients",m.a.createElement(y.a,{color:"#87d068",style:{float:"right",margin:4}},this.state.totalPatients?this.state.totalPatients:0)),m.a.createElement("p",null,m.a.createElement("br",null)),m.a.createElement("h2",null,"Groups"),m.a.createElement("p",null,m.a.createElement("b",null,"My Groups"),m.a.createElement("a",{style:{float:"right"},onClick:function(){return e.togglePatientGroupEditing(!0)}},"Manage")),this.state.patientGroup.map((function(e){return m.a.createElement(D.a.Button,{key:e.id,style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:e.id},e.name,m.a.createElement(y.a,{color:"#87d068",style:{float:"right",margin:4}},e.patient_count))})),m.a.createElement("p",null,m.a.createElement("br",null)),m.a.createElement("p",null,m.a.createElement("b",null,"Smart Groups")),m.a.createElement(D.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_a",value:"smart_a"},"All Male"),m.a.createElement(D.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_b",value:"smart_b"},"All Female"),m.a.createElement(D.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_e",value:"smart_e"},"Male Over 30"),m.a.createElement(D.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_c",value:"smart_c"},"Female Over 30"),m.a.createElement(D.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_f",value:"smart_f"},"Male Under 30"),m.a.createElement(D.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_d",value:"smart_d"},"Female Under 30"),m.a.createElement("p",null,m.a.createElement("br",null)))),m.a.createElement(g.a,{span:19,style:{overflow:"scroll",borderLeft:"1px solid #ccc"}},m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null,this.state.patientListData.length?this.state.patientListData.map((function(e){return m.a.createElement(ie,Object.assign({},e,{key:e.id,showMobile:t.props.activePracticePermissions.PatientPhoneNumber,showEmail:t.props.activePracticePermissions.PatientEmailId,setCurrentPatient:t.props.setCurrentPatient}))})):m.a.createElement("p",{style:{textAlign:"center"}},"No Data Found"))),this.state.searchvalue?m.a.createElement(W.a,{loaderFunction:this.searchPatient,loading:this.state.loading,hidden:!this.state.morePatients}):this.state.advancedSearch?m.a.createElement(W.a,{loading:this.state.advanceLoading,loaderFunction:function(){return e.loadAdvanceSearchPatient(t.state.morePatientList)},hidden:!this.state.morePatientList}):m.a.createElement(W.a,{loaderFunction:this.getMorePatient,loading:this.state.loading,hidden:!this.state.morePatients})),m.a.createElement(h.a,{visible:this.state.showPatientGroupModal,footer:null,onCancel:function(){return e.togglePatientGroupEditing(!1)}},m.a.createElement(K,this.props)))):m.a.createElement(Z.a,null)}}]),t}(m.a.Component),ne=M.a.create()(ae);function ie(e){return m.a.createElement(g.a,{xs:24,sm:24,md:12,lg:8,xl:8,xxl:6},m.a.createElement(j.a,{onClick:function(){return e.setCurrentPatient(e)},style:{margin:"3px",paddingBottom:"8px"}},m.a.createElement(J,{avatar:e.image?m.a.createElement(P.a,{src:Object(Y.g)(e.image),size:50}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"},size:50},e.user.first_name?e.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),title:e.user.first_name,description:m.a.createElement("span",null,e.showMobile?e.user.mobile:Object(X.b)(e.user.mobile),m.a.createElement("br",null),e.showEmail?e.user.email:Object(X.a)(e.user.email),m.a.createElement("br",null),m.a.createElement("span",{className:"patientIdHighlight"},"#",e.custom_id?e.custom_id:e.id,e.gender?",".concat(e.gender.charAt(0).toUpperCase()):null))})))}function re(e){return m.a.createElement(m.a.Fragment,null,"name"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("name")(m.a.createElement(V.a,{placeholder:"patient Name",size:"small"}))):null,"phone"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("phone")(m.a.createElement(V.a,{placeholder:"Contact Number",size:"small"}))):null,"age"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key},e.form.getFieldDecorator("age")(m.a.createElement(I.a,{placeholder:"Patient Age",size:"small"}))):null,"age_gte"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key},e.form.getFieldDecorator("age_gte")(m.a.createElement(I.a,{placeholder:"Age more than",size:"small"}))):null,"age_lte"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key},e.form.getFieldDecorator("age_lte")(m.a.createElement(I.a,{placeholder:"Age Less than",size:"small"}))):null,"has_age"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,null,e.form.getFieldDecorator("has_age")(m.a.createElement(w.a,{style:{width:100},size:"small"},Q.N.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label," ")}))))):null,"dob"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key,label:"is"},e.form.getFieldDecorator("dob")(m.a.createElement(L.a,{placeholder:"Date of Birth",size:"small"}))):null,"dob_gte"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key},e.form.getFieldDecorator("dob_gte")(m.a.createElement(L.a,{size:"small"}))):null,"dob_lte"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key},e.form.getFieldDecorator("dob_lte")(m.a.createElement(L.a,{size:"small"}))):null,"dob_month"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key},e.form.getFieldDecorator("dob_month")(m.a.createElement(ee,{size:"small"}))):null,"has_dob"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,null,e.form.getFieldDecorator("has_dob")(m.a.createElement(w.a,{style:{width:100},size:"small"},Q.O.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label," ")}))))):null,"patient_id"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("patient_id")(m.a.createElement(V.a,{placeholder:"Patient Id",size:"small"}))):null,"has_aadhar"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,null,e.form.getFieldDecorator("has_aadhar")(m.a.createElement(w.a,{style:{width:100},size:"small"},Q.M.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))):null,"aadhar"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("aadhar")(m.a.createElement(V.a,{placeholder:"Aadhar Id",size:"small"}))):null,"email"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("email")(m.a.createElement(V.a,{placeholder:"Email Id",size:"small"}))):null,"has_email"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,null,e.form.getFieldDecorator("has_email")(m.a.createElement(w.a,{style:{width:100},size:"small"},Q.P.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label," ")}))))):null,"gender"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key,label:"is"},e.form.getFieldDecorator("gender")(m.a.createElement(w.a,{style:{width:100},size:"small"},Q.L.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))):null,"has_gender"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,null,e.form.getFieldDecorator("has_gender")(m.a.createElement(w.a,{style:{width:100},size:"small"},Q.Q.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))):null,"pincode"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("pincode")(m.a.createElement(V.a,{placeholder:"PINCODE",size:"small"}))):null,"has_pincode"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,null,e.form.getFieldDecorator("has_pincode")(m.a.createElement(w.a,{style:{width:100},size:"small"},Q.R.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))):null,"has_street"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,null,e.form.getFieldDecorator("has_street")(m.a.createElement(w.a,{style:{width:100},size:"small"},Q.S.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))):null,"street"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("street")(m.a.createElement(V.a,{placeholder:"Street Address",size:"small"}))):null,"blood_group"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,{key:e.key,label:"is"},e.form.getFieldDecorator("blood_group")(m.a.createElement(w.a,{style:{width:100},size:"small"},Q.k.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.name)}))))):null,"source"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,null,e.form.getFieldDecorator("source")(m.a.createElement(w.a,{style:{width:100},size:"small"},e.sourceList.map((function(e){return m.a.createElement(w.a.Option,{value:e.id},e.name)}))))):null,"agent_referal"==e.selectedOption[e.k]?m.a.createElement(M.a.Item,null,e.form.getFieldDecorator("agent_referal")(m.a.createElement(w.a,{style:{width:100},size:"small"},Q.yb.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))):null)}var le=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPatientCallNotes=function(){var e=Object(o.a)(a);e.setState({callNotesLoading:!0});var t={patient:a.props.patientId};Object(Y.c)(q.nc,(function(t){e.setState({callNotes:t,callNotesLoading:!1})}),(function(t){e.setState({callNotesLoading:!1})}),t)},a.state={notes:[],callNotesLoading:!1,loading:!0},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadPatientNotes(),this.loadPatientCallNotes()}},{key:"loadPatientNotes",value:function(){var e=this;e.setState({loading:!0});Object(Y.c)(Object(Y.f)(q.uc,[this.props.patientId,this.props.active_practiceId]),(function(t){e.setState({notes:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this,t=[{key:"name",required:!0,type:H.W}],a={successFn:function(t){Object(Y.a)(H.Sb,"Patient Note Added"),e.loadPatientNotes()},errorFn:function(){},action:Object(Y.f)(q.uc,[this.props.patientId,this.props.active_practiceId]),method:"post",beforeSubmit:function(e){}},n=[{key:"patient",value:this.props.patientId},{key:"practice",value:this.props.active_practiceId}],i=M.a.create()(U.a);return m.a.createElement("div",null,m.a.createElement(v.a,null,"Patient Notes"),m.a.createElement(i,{formProp:a,defaultValues:n,fields:t}),m.a.createElement(b.a,{size:"small",loading:this.state.loading,dataSource:this.state.notes,renderItem:function(e){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:e.name,description:"by ".concat(e.staff?e.staff.user.first_name:"--"," on ").concat(x()(e.created_at).format("lll"))}))}}),m.a.createElement(v.a,null,"Voice Call Notes"),m.a.createElement(b.a,{size:"small",loading:this.state.callNotesLoading,dataSource:this.state.callNotes,renderItem:function(e){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:e.remarks?e.remarks:"--",description:"Created on ".concat(x()(e.timestamp).format("lll"))}))}}))}}]),t}(m.a.Component),ce=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={redirect:!1,currentPatient:a.props.currentPatient,Membership:[]},a.loadMembership=a.loadMembership.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadMembership()}},{key:"loadMembership",value:function(){var e=this;e.state.currentPatient&&Object(Y.c)(Object(Y.f)(q.bc,[e.props.active_practiceId]),(function(t){e.setState({Membership:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this;console.log("form state",this.state);var t=[{label:"Type",key:"medical_membership",type:H.Nb,options:this.state.Membership.map((function(e){return{label:e.name,value:e.id}}))},{label:"Start Date",key:"medical_from",initilValue:x()(),type:H.K,format:"YYYY-MM-DD"}],a={successFn:function(t){Object(Y.a)(H.Sb,"Medical Membership added"),e.props.loadProfile(),e.props.loadMedicalMembership(),e.props.formChange()},errorFn:function(){},action:Object(Y.f)(q.kc,[this.props.patientId]),method:"post"},n=M.a.create()(U.a),i=[{key:"patient",value:this.props.patientId},{key:"practice",value:this.props.active_practiceId}];return m.a.createElement(n,{formProp:a,defaultValues:i,fields:t})}}]),t}(m.a.Component),oe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={redirect:!1,currentPatient:a.props.currentPatient,agentRoles:[]},a.loadAgentRoles=a.loadAgentRoles.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadAgentRoles()}},{key:"loadAgentRoles",value:function(){var e=this;Object(Y.c)(q.e,(function(t){e.setState({agentRoles:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this,t=[{label:"Role Type",key:"role",type:H.Nb,options:this.state.agentRoles.map((function(e){return{label:e.name,value:e.id}}))},{label:"Document Upload",key:"aadhar_upload",type:H.Pb,required:!0}],a={successFn:function(t){Object(Y.a)(H.Sb,"Agent Role added"),e.props.loadProfile()},errorFn:function(){},action:Object(Y.f)(q.xc,[this.props.patientId]),method:"put"},n=M.a.create()(U.a);return m.a.createElement(n,{formProp:a,defaultValues:[{key:"is_agent",value:!0}],fields:t})}}]),t}(m.a.Component),se=a(235),ue=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).formChange=function(e){a.setState({add:e})},a.addAgent=function(){Object(o.a)(a).setState({agentModalVisible:!0})},a.addAgentModalClosed=function(){a.setState({agentModalVisible:!1})},a.state={patientProfile:null,currentPatient:a.props.currentPatient,medicalHistory:{},loading:!0,add:"",MedicalMembership:null,hide:!1,agentModalVisible:!1},a.loadProfile=a.loadProfile.bind(Object(o.a)(a)),a.loadMedicalMembership=a.loadMedicalMembership.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.state.currentPatient&&(this.loadProfile(!1),this.loadMedicalMembership())}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.currentPatient&&e.currentPatient!=this.state.currentPatient&&this.setState({currentPatient:e.currentPatient},(function(){t.loadProfile(!1)}))}},{key:"loadProfile",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this,a=function(a){t.setState({patientProfile:a,loading:!1}),t.props.refreshWallet&&e&&t.props.refreshWallet()},n=function(){t.setState({loading:!1})};t.state.currentPatient&&Object(Y.c)(Object(Y.f)(q.xc,[t.state.currentPatient.id]),a,n)}},{key:"loadMedicalMembership",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.kc,[e.props.currentPatient.id]),(function(t){e.setState({MedicalMembership:t[t.length-1],loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"onClickHandler",value:function(e){this.state.MedicalMembership?(Object(Y.a)(H.Q,"Membership !!"),this.setState({add:!1})):this.setState({add:e})}},{key:"deleteMembership",value:function(e){var t=this,a={id:e,is_active:!1};Object(Y.j)(Object(Y.f)(q.Wb,[t.props.currentPatient.id]),a,(function(e){t.loadProfile(),t.loadMedicalMembership(),t.props.refreshWallet&&t.props.refreshWallet()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this;if(this.props.currentPatient){var a=this.state.patientProfile;return a?m.a.createElement(j.a,{loading:this.state.loading,title:"Patient Profile"},m.a.createElement(f.a,{gutter:16},m.a.createElement(g.a,{span:6,style:{textAlign:"center"}},a.image?m.a.createElement("img",{src:Object(Y.g)(a.image),style:{width:"100%"}}):m.a.createElement(P.a,{size:200,shape:"square",style:{backgroundColor:"#87d068"}},a.user.first_name?a.user.first_name:m.a.createElement(k.a,{type:"user"})),a.is_agent&&a.is_approved?m.a.createElement(O.a,{title:"Referral Code",value:a.user.referer_code}):null,t.props.activePracticePermissions.EditPatient?m.a.createElement(C.b,{to:"/patient/".concat(this.state.currentPatient.id,"/profile/edit")},m.a.createElement(_.a,{type:"primary",style:{margin:10},block:!0},m.a.createElement(k.a,{type:"edit"}),"\xa0Edit Patient Profile")):null,m.a.createElement(g.a,null,m.a.createElement(v.a,null),this.state.add?m.a.createElement("div",null,m.a.createElement("h1",{style:{fontSize:"18px"}},"Medical Membership ",m.a.createElement("a",{href:"#",onClick:function(){return e.onClickHandler(!1)}},"Cancel")),m.a.createElement(ce,Object.assign({},this.props,this.state,{patientId:a.id,loadMedicalMembership:t.loadMedicalMembership,formChange:t.formChange,loadProfile:t.loadProfile}))):m.a.createElement("div",{style:{padding:"0px"}},m.a.createElement("h1",{style:{fontSize:"18px",textAlign:"center"}},"Medical Membership ",m.a.createElement("a",{href:"#",onClick:function(){return e.onClickHandler(!0)}},this.state.MedicalMembership?"Renew":"Add")),this.state.MedicalMembership?m.a.createElement(j.a,{size:"small",title:"Membership",extra:m.a.createElement(E.a,{title:"Are you sure delete this Membership?",onConfirm:function(){return t.deleteMembership(e.state.MedicalMembership.id)},okText:"Yes",cancelText:"No"},m.a.createElement(_.a,{icon:"close",type:"danger",shape:"circle",size:"small"})),style:{textAlign:"center"}},m.a.createElement("div",{style:{textAlign:"left"}},m.a.createElement("p",null,m.a.createElement("strong",null,"Membership Code : "),m.a.createElement("span",null,this.state.MedicalMembership.membership_code)),m.a.createElement("p",null,m.a.createElement("strong",null,"Start Date : "),m.a.createElement("span",null,this.state.MedicalMembership.medical_from)),m.a.createElement("p",null,m.a.createElement("strong",null,"Valid Till : "),m.a.createElement("span",null,this.state.MedicalMembership.medical_to)))):null))),m.a.createElement(g.a,{span:12},m.a.createElement(de,{label:"Patient Name",value:a.user.first_name}),m.a.createElement(de,{label:"Patient ID",value:a.custom_id?a.custom_id:a.id}),a&&a.role?m.a.createElement(de,{label:"Advisor Role",value:a.role_data.name}):null,m.a.createElement(de,{label:"Gender",value:a.gender}),a.is_age?m.a.createElement(de,{label:"Age",value:a.dob?x()().diff(this.props.currentPatient.dob,"years"):null}):m.a.createElement(de,{label:"Date of Birth",value:a.dob}),m.a.createElement(de,{label:"On Dialysis?",value:a.on_dialysis?"Yes":"No"}),m.a.createElement(de,{label:"Referer",value:a.user.referer_data.referer?m.a.createElement(C.b,{to:"/patient/".concat(a.user.referer_data.patient,"/profile")},a.user.referer_data.referer.first_name):"--"}),m.a.createElement(v.a,null,"Contact Details"),m.a.createElement(de,{label:"Email",value:t.props.activePracticePermissions.PatientEmailId?a.user.email:Object(X.a)(a.user.email)}),m.a.createElement(de,{label:"Primary Mobile",value:t.props.activePracticePermissions.PatientPhoneNumber?a.user.mobile:Object(X.b)(a.user.mobile)}),m.a.createElement(de,{label:"Secondary Mobile",value:t.props.activePracticePermissions.PatientPhoneNumber?a.secondary_mobile_no:Object(X.b)(a.secondary_mobile_no)}),m.a.createElement(de,{label:"Landline No",value:a.landline_no}),m.a.createElement(de,{label:"Address",value:a.address}),m.a.createElement(de,{label:"Locality",value:a.locality}),m.a.createElement(de,{label:"City",value:a.city_data?a.city_data.name:null}),m.a.createElement(de,{label:"State",value:a.state_data?a.state_data.name:null}),m.a.createElement(de,{label:"Country",value:a.country_data?a.country_data.name:null}),m.a.createElement(de,{label:"Pincode",value:a.pincode})),m.a.createElement(g.a,{span:6,style:{borderLeft:"1 px solid #ccc"}},m.a.createElement(le,Object.assign({},this.props,{patientId:a.id})),m.a.createElement(v.a,null,"Medical History"),a.medical_history_data?a.medical_history_data.map((function(e,t){return m.a.createElement(y.a,{color:"#".concat(Object(se.b)(Object(se.a)(e.name)))},e.name)})):null,m.a.createElement(v.a,null,"Groups"),m.a.createElement(b.a,{dataSource:a.patient_group_data,renderItem:function(e){return m.a.createElement(b.a.Item,null,e.name)}})),m.a.createElement(h.a,{title:"Add Agent",visible:this.state.agentModalVisible,onOk:null,footer:null,onCancel:this.addAgentModalClosed},m.a.createElement(oe,Object.assign({patientId:a.id},this.state))))):m.a.createElement(j.a,{loading:this.state.loading})}return m.a.createElement(ne,this.props)}}]),t}(m.a.Component);function de(e){return m.a.createElement(f.a,{gutter:16,style:{marginBottom:"5px"}},m.a.createElement(g.a,{span:8,style:{textAlign:"right"}},e.label,":"),m.a.createElement(g.a,{span:16},m.a.createElement("strong",null,e.value)))}a(275);var me=a(272),pe=(a(342),a(341)),fe=(a(319),a(326)),he=(a(137),a(15)),be=a(396),ye=h.a.confirm,ge=function(e){function t(e){var a,n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadMedicalHistory=function(){var e=Object(o.a)(n);Object(Y.c)(Object(Y.f)(q.Vb,[n.props.active_practiceId]),(function(t){e.setState({history:t})}),(function(){}))},n.setFormParams=function(e,t){n.setState(Object(F.a)({},e,t))},n.getPatientGroup=function(){var e=Object(o.a)(n);Object(Y.c)(Object(Y.f)(q.rc,[n.props.active_practiceId]),(function(t){e.setState({patientGroup:t,loading:!1})}),(function(){e.setState({loading:!1})}))},n.handleSubmit=function(e){var t=Object(o.a)(n);e.preventDefault(),n.props.form.validateFields((function(e,a){if(!e){var i=Object(A.a)({},a,{file_enable:!!a.file_enable,file_count:a.file_count?a.file_count:n.state.file_count,on_dialysis:!!t.state.on_dialysis,medical_history:a.medical_history,patient_group:a.patient_group,user:{first_name:a.first_name?a.first_name:"",mobile:a.mobile,email:a.email}});a.anniversary&&(i.anniversary=x()(a.anniversary).format("YYYY-MM-DD")),a.dob&&(i.dob=x()(a.dob).format("YYYY-MM-DD")),a.age&&(i.is_age=!0,i.dob=x()().subtract(a.age,"years").format("YYYY-MM-DD")),a.custom_id?i.custom_id=a.custom_id_pre+a.custom_id:i.custom_id=null;var r="image";i[r]&&i[r].file&&i[r].file.response&&(i[r]=i[r].file.response.image_path),delete i.first_name,delete i.email,delete i.referer_code,delete i.mobile,delete i.age,delete i.custom_id_pre,t.setState({loading:!0});var l=function(e){Object(Y.a)("Patient Saved Successfully!!"),t.setState({loading:!1}),t.props.history.replace("/patient/".concat(e.id,"/profile"))},c=function(){t.setState({loading:!1})};i=Object(Y.m)(i),t.props.currentPatient?Object(Y.l)(Object(Y.f)(q.xc,[t.props.currentPatient.id]),i,l,c):Object(Y.j)(Object(Y.f)(q.jc,[t.props.match.params.id]),i,l,c)}}))},n.toggleWebCam=function(e,t){n.setState((function(a){return{webCamState:Object(A.a)({},a.webCamState,Object(F.a)({},e,t))}}))},n.getImageandUpload=function(e,t){var a=Object(o.a)(n),i=new FormData;i.append("image",t),i.append("name","file");Object(Y.j)(q.tb,i,(function(t){a.props.form.setFieldsValue(Object(F.a)({},e,{file:{response:t}})),Object(Y.a)(H.Sb,"Image Captured and processed."),a.setState((function(t){return{webCamState:Object(A.a)({},t.webCamState,Object(F.a)({},e,!1))}}))}),(function(){}),{"content-type":"multipart/form-data"})},n.onChangeValue=function(e,t){var a=Object(o.a)(n);a.setState(Object(F.a)({},e,t),(function(){"country"==e&&a.getState(),"state"==e&&a.getCity()}))},n.setFormParams=function(e,t){n.setState(Object(F.a)({},e,t))},n.onChangeCheckbox=function(){n.setState({on_dialysis:!n.state.on_dialysis})},n.changeFormType=function(e){n.setState({selectedFormType:e.target.value})},n.handleRelation=function(e){e?n.setState({relation_text:!1}):n.setState({relation_text:!0})},n.handleNumberChange=function(e){n.setState({number:Object(A.a)({},ve(e),{value:e})})},n.state=(a={redirect:!1,history:[],patientGroup:[],membership:[],webCamState:{},countrylist:[],stateList:[],cityList:[],sourceList:[],country:n.props.currentPatient&&n.props.currentPatient.country_data?n.props.currentPatient.country:null,state:n.props.currentPatient&&n.props.currentPatient.state_data?n.props.currentPatient.state:null,selectedFormType:"DOB",file_count:10,file_enable:!0,relation_text:!0,loading:!1},Object(F.a)(a,Q.l,[]),Object(F.a)(a,Q.nb,[]),Object(F.a)(a,Q.Fb,[]),Object(F.a)(a,Q.J,[]),Object(F.a)(a,Q.K,[]),Object(F.a)(a,"number",{}),a),n.changeRedirect=n.changeRedirect.bind(Object(o.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(o.a)(n)),n.getCountry=n.getCountry.bind(Object(o.a)(n)),n.getState=n.getState.bind(Object(o.a)(n)),n.getCity=n.getCity.bind(Object(o.a)(n)),n.getSources=n.getSources.bind(Object(o.a)(n)),n.loadPatientData=n.loadPatientData.bind(Object(o.a)(n)),n}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadMedicalHistory(),this.getPatientGroup(),this.getPatientMembership(),this.getSources(),this.getCountry(),this.state.country&&this.getState(),this.state.state&&this.getCity(),this.props.currentPatient&&this.loadPatientData(this.props.currentPatient.id),Object(se.c)(this,[Q.l,Q.nb,Q.Fb,Q.J,Q.K])}},{key:"getCountry",value:function(){var e=this;Object(Y.c)(q.U,(function(t){e.setState({countrylist:t})}),(function(){}))}},{key:"getSources",value:function(){var e=this;Object(Y.c)(q.zd,(function(t){e.setState({sourceList:t})}),(function(){}))}},{key:"getState",value:function(){var e=this;Object(Y.c)(q.Bd,(function(t){e.setState({stateList:t})}),(function(){}),{country:this.state.country})}},{key:"getCity",value:function(){var e=this;Object(Y.c)(q.Q,(function(t){e.setState({cityList:t})}),(function(){}),{state:this.state.state})}},{key:"getPatientMembership",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.bc,[this.props.active_practiceId]),(function(t){e.setState({membership:t})}),(function(){}))}},{key:"loadPatientData",value:function(e){var t=this;Object(Y.c)(Object(Y.f)(q.xc,[e]),(function(e){t.setState({patientDetails:e,loading:!1})}),(function(){t.setState({loading:!1})}))}},{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"onDeletePatient",value:function(){var e=this;ye({title:"Are you sure delete this patient?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){e.patientDelete()}})}},{key:"patientDelete",value:function(){var e=this,t=e.state.patientDetails.id,a={id:t,is_active:!1};Object(Y.l)(Object(Y.f)(q.xc,[t]),a,(function(){e.setState({loading:!1}),Object(Y.a)("Patient Deleted!!"),e.props.history.push("/patients/profile")}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=this.props.form.getFieldDecorator,n={labelCol:{span:6},wrapperCol:{span:14}},i=[];this.state.history&&this.state.history.forEach((function(e){i.push({label:e.name,value:e.id})}));var r=[];this.state.patientGroup&&this.state.patientGroup.forEach((function(e){r.push({label:e.name,value:e.id})}));var l=[];this.state.membership&&this.state.membership.forEach((function(e){l.push({label:e.name,value:e.id})}));var c={name:"image",data:{name:"hello"},action:Object(Y.h)(q.sb),headers:{authorization:"authorization-text"},onChange:function(e){e.file.status,"done"===e.file.status?he.a.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&he.a.error("".concat(e.file.name," file upload failed."))}};return m.a.createElement(M.a,{onSubmit:t.handleSubmit},m.a.createElement(j.a,{title:m.a.createElement("span",null,t.props.currentPatient?"Edit Profile":"Add Patient","\xa0\xa0",m.a.createElement(C.b,{to:"/patients/patientprintform"},"Print Patient Form")),extra:m.a.createElement("div",null,m.a.createElement(_.a,{style:{margin:5},type:"primary",htmlType:"submit"},"Save"),t.props.history?m.a.createElement(_.a,{style:{margin:5},onClick:function(){return t.props.history.goBack()}},"Cancel"):null,t.props.currentPatient?m.a.createElement(m.a.Fragment,null,this.state.patientDetails&&this.state.patientDetails.is_approved?m.a.createElement(fe.a,{placement:"leftBottom",trigger:"hover",content:"An Agent is associated. Patient can not be deleted."},m.a.createElement(_.a,{style:{margin:5},type:"danger",disabled:!0},"Delete")):t.props.activePracticePermissions.DeletePatient||t.props.allowAllPermissions?m.a.createElement(_.a,{style:{margin:5},onClick:function(){return t.onDeletePatient()},type:"danger",disabled:!this.state.patientDetails},"Delete"):null):null)},m.a.createElement(M.a.Item,Object.assign({key:"image"},n,{label:"Patient Image"}),a("image",{valuePropName:"image"})(m.a.createElement(pe.a,c,m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"upload"})," Select File"),this.state.patientDetails&&this.state.patientDetails.image?m.a.createElement("img",{src:Object(Y.g)(this.state.patientDetails?this.state.patientDetails.image:null),style:{maxWidth:"100%"}}):null)),m.a.createElement("span",{className:"ant-form-text"},m.a.createElement("a",{onClick:function(){return t.toggleWebCam("image",Math.random())}},"Open Webcam")),m.a.createElement(h.a,{footer:null,onCancel:function(){return t.toggleWebCam("image",!1)},visible:!!t.state.webCamState.image,width:680,key:t.state.webCamState.image},m.a.createElement(be.a,{getScreenShot:function(e){return t.getImageandUpload("image",e)}}))),m.a.createElement(M.a.Item,Object.assign({label:"Patient Name"},n),a("first_name",{rules:[{required:!0,message:"Input Patient Name!"}],initialValue:this.state.patientDetails?this.state.patientDetails.user.first_name:""})(m.a.createElement(V.a,{placeholder:"Patient Name"}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:8},m.a.createElement(M.a.Item,{label:"Patient Id",labelCol:{span:18},wrapperCol:{span:6}},a("custom_id_pre",{initialValue:this.state.patientDetails&&this.state.patientDetails.is_agent?"AD":"BK"})(m.a.createElement(w.a,null,m.a.createElement(w.a.Option,{value:"BK"},"BK"),m.a.createElement(w.a.Option,{value:"AD"},"AD"))))),m.a.createElement(g.a,{span:16},m.a.createElement(M.a.Item,{labelCol:{span:0},wrapperCol:{span:18},validateStatus:this.state.number.validateStatus,help:this.state.number.errorMsg||"Only numbers are allowed."},a("custom_id",{initialValue:this.state.patientDetails?this.state.patientDetails.custom_id.replace(/\D/g,""):""})(m.a.createElement(I.a,{style:{width:"100%"},placeholder:"Patient Id",onChange:this.handleNumberChange}))))),this.state.source&&this.state.source==H.W?m.a.createElement(M.a.Item,Object.assign({key:"source_extra",label:"Source"},n),a("source_extra",{initialValue:""})(m.a.createElement(V.a,{placeholder:"Source"})),m.a.createElement("a",{onClick:function(){return t.setFormParams("source",H.Nb)}},"Choose Source")):m.a.createElement(M.a.Item,Object.assign({label:"Source"},n),a("source",{initialValue:this.state.patientDetails?this.state.patientDetails.source:null})(m.a.createElement(w.a,{placeholder:"Select Source",showSearch:!0,optionFilterProp:"children"},this.state.sourceList.map((function(e){return m.a.createElement(w.a.Option,{value:e.id},e.name)})))),this.props.user.is_superuser?m.a.createElement("a",{onClick:function(){return t.setFormParams("source",H.W)}},"Enter New Source"):null),m.a.createElement(M.a.Item,Object.assign({label:"Referral Code"},n),a("referal",{initialValue:t.state.patientDetails&&t.state.patientDetails.user.referer_data.referer?t.state.patientDetails.user.referer_data.referer.referer_code:""})(m.a.createElement(V.a,{placeholder:"Referral Code"}))),m.a.createElement(M.a.Item,Object.assign({label:"SMS Language"},n),a("language",{initialValue:this.state.patientDetails&&this.state.patientDetails.language?this.state.patientDetails.language:this.props.activePracticeData.language})(m.a.createElement(w.a,null,this.state[Q.Fb].map((function(e){return m.a.createElement(w.a.Option,{value:e},e)}))))),m.a.createElement(M.a.Item,Object.assign({label:"Aadhar ID"},n),a("aadhar_id",{initialValue:this.state.patientDetails?this.state.patientDetails.aadhar_id:""})(m.a.createElement(V.a,{placeholder:"Patient Aadhar Number"}))),m.a.createElement(M.a.Item,Object.assign({label:"Gender"},n),a("gender",{initialValue:this.state.patientDetails?this.state.patientDetails.gender:null})(m.a.createElement(w.a,{placeholder:"Select Gender"},this.state[Q.K].map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))),m.a.createElement(M.a.Item,Object.assign({label:" "},n,{colon:!1}),m.a.createElement(D.a.Group,{buttonStyle:"solid",size:"small",onChange:this.changeFormType,defaultValue:this.state.selectedFormType},Q.lb.map((function(e){return m.a.createElement(D.a,{value:e.value},e.label)})))),"DOB"==this.state.selectedFormType?m.a.createElement(M.a.Item,Object.assign({label:"DOB"},n),a("dob",{initialValue:this.state.patientDetails&&this.state.patientDetails.dob?x()(this.state.patientDetails.dob):""})(m.a.createElement(L.a,null))):m.a.createElement(M.a.Item,Object.assign({label:"Age"},n),a("age",{initialValue:this.state.patientDetails&&this.state.patientDetails.dob?x()().diff(this.state.patientDetails.dob,"years"):null})(m.a.createElement(I.a,{min:0,max:120,placeholder:"00"})),m.a.createElement("span",{className:"ant-form-text"},"Years")),m.a.createElement(M.a.Item,Object.assign({label:"Anniversary"},n),a("anniversary",{initialValue:this.state.patientDetails&&this.state.patientDetails.anniversary?x()(this.state.patientDetails.anniversary):null})(m.a.createElement(L.a,null))),m.a.createElement(M.a.Item,Object.assign({label:"Blood Group"},n),a("blood_group",{initialValue:this.state.patientDetails?this.state.patientDetails.blood_group:""})(m.a.createElement(w.a,{placeholder:"Blood Group"},this.state[Q.l].map((function(e){return m.a.createElement(w.a.Option,{value:e},e)}))))),m.a.createElement(M.a.Item,Object.assign({label:"Family"},n),m.a.createElement(M.a.Item,{style:{display:"inline-block",width:"calc(30% - 12px)"}},a("family_relation",{initialValue:this.state.patientDetails&&null!=this.state.patientDetails.family_relation?this.state.patientDetails.family_relation:H.Gb})(m.a.createElement(w.a,{onChange:function(t){return e.handleRelation(t)}},m.a.createElement(w.a.Option,{value:""},H.Gb),this.state[Q.J].map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.name)}))))),m.a.createElement("span",{style:{display:"inline-block",width:"14px",textAlign:"center"}}),m.a.createElement(M.a.Item,{style:{display:"inline-block",width:"calc(50% - 12px)"}},a("attendee",{initialValue:this.state.patientDetails?this.state.patientDetails.attendee:""})(m.a.createElement(V.a,{disabled:(!this.state.patientDetails||!this.state.patientDetails.attendee)&&this.state.relation_text})))),m.a.createElement(M.a.Item,Object.assign({label:"Mobile (Primary)"},n),a("mobile",{initialValue:this.state.patientDetails?this.state.patientDetails.user.mobile:null,rules:[{required:!0,message:"Input Mobile Number"}]})(m.a.createElement(V.a,{placeholder:"Patient Mobile Number (Primary)"}))),m.a.createElement(M.a.Item,Object.assign({label:"Mobile (Secondary)"},n),a("secondary_mobile_no",{initialValue:this.state.patientDetails?this.state.patientDetails.secondary_mobile_no:""})(m.a.createElement(V.a,{placeholder:"Patient Mobile Number (Secondary)"}))),m.a.createElement(M.a.Item,Object.assign({label:"Landline"},n),a("landline_no",{initialValue:this.state.patientDetails?this.state.patientDetails.landline_no:""})(m.a.createElement(V.a,{placeholder:"Patient Landline Number"}))),m.a.createElement(M.a.Item,Object.assign({label:"Address"},n),a("address",{initialValue:this.state.patientDetails?this.state.patientDetails.address:""})(m.a.createElement(V.a,{placeholder:"Patient Address"}))),m.a.createElement(M.a.Item,Object.assign({label:"Locality"},n),a("locality",{initialValue:this.state.patientDetails?this.state.patientDetails.locality:""})(m.a.createElement(V.a,{placeholder:"Patient Locality"}))),this.state.country&&this.state.country==H.W?m.a.createElement(M.a.Item,Object.assign({key:"country_extra",label:"Country"},n),a("country_extra",{initialValue:""})(m.a.createElement(V.a,{placeholder:"Country"})),this.props.user.is_superuser?m.a.createElement("a",{onClick:function(){return t.setFormParams("country",H.Nb)}},"Choose Country"):null):m.a.createElement(M.a.Item,Object.assign({key:"country"},n,{label:"Country"}),a("country",{initialValue:this.state.patientDetails&&this.state.patientDetails.country_data?this.state.patientDetails.country_data.id:""})(m.a.createElement(w.a,{placeholder:"Select Country",onChange:function(t){return e.onChangeValue("country",t)},showSearch:!0,optionFilterProp:"children"},this.state.countrylist.map((function(e){return m.a.createElement(w.a.Option,{value:e.id},e.name)})))),this.props.user.is_superuser?m.a.createElement("a",{onClick:function(){return t.setFormParams("country",H.W)}},"Add New Country"):null),this.state.country==H.W||this.state.state&&this.state.state==H.W?m.a.createElement(M.a.Item,Object.assign({key:"state_extra",label:"State"},n),a("state_extra",{initialValue:""})(m.a.createElement(V.a,{placeholder:"State"})),m.a.createElement("a",{onClick:function(){return t.setFormParams("state",H.Nb)}},"Choose State")):m.a.createElement(M.a.Item,Object.assign({key:"state"},n,{label:"State"}),a("state",{initialValue:this.state.patientDetails&&this.state.patientDetails.state_data?this.state.patientDetails.state_data.id:""})(m.a.createElement(w.a,{placeholder:"Select State",onChange:function(t){return e.onChangeValue("state",t)},showSearch:!0,optionFilterProp:"children"},this.state.stateList.map((function(e){return m.a.createElement(w.a.Option,{value:e.id},e.name)})))),this.props.user.is_superuser?m.a.createElement("a",{onClick:function(){return t.setFormParams("state",H.W)}},"Add New state"):null),this.state.country==H.W||this.state.state==H.W||this.state.city&&this.state.city==H.W?m.a.createElement(M.a.Item,Object.assign({key:"city_extra",label:"City"},n),a("city_extra",{initialValue:""})(m.a.createElement(V.a,{placeholder:"City"})),m.a.createElement("a",{onClick:function(){return t.setFormParams("city",H.Nb)}},"Choose City")):m.a.createElement(M.a.Item,Object.assign({key:"City"},n,{label:"City"}),a("city",{initialValue:this.state.patientDetails&&this.state.patientDetails.city_data?this.state.patientDetails.city_data.id:""})(m.a.createElement(w.a,{showSearch:!0,optionFilterProp:"children",placeholder:"Select City"},this.state.cityList.map((function(e){return m.a.createElement(w.a.Option,{value:e.id},e.name)})))),this.props.user.is_superuser?m.a.createElement("a",{onClick:function(){return t.setFormParams("city",H.W)}},"Add New City"):null),m.a.createElement(M.a.Item,Object.assign({label:"Pincode"},n),a("pincode",{initialValue:this.state.patientDetails?this.state.patientDetails.pincode:""})(m.a.createElement(V.a,{placeholder:"Patient PINCODE"}))),m.a.createElement(M.a.Item,Object.assign({label:"Email"},n),a("email",{initialValue:this.state.patientDetails?this.state.patientDetails.user.email:null})(m.a.createElement(V.a,{placeholder:"Patient Email"}))),m.a.createElement(M.a.Item,Object.assign({label:"Medical History"},n),a("medical_history",{initialValue:this.state.patientDetails?this.state.patientDetails.medical_history:[]})(m.a.createElement(w.a,{placeholder:"Medical History",mode:"multiple"},i.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))),m.a.createElement(M.a.Item,Object.assign({label:"Patient Group"},n),a("patient_group",{initialValue:this.state.patientDetails?this.state.patientDetails.patient_group:[]})(m.a.createElement(w.a,{placeholder:"Patient Group",mode:"multiple"},r.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))),m.a.createElement(M.a.Item,Object.assign({label:"On Dialysis"},n),a("on_dialysis",{initialValue:!!this.state.patientDetails&&this.state.patientDetails.on_dialysis})(m.a.createElement(me.a,{onChange:function(t){return e.onChangeCheckbox(t)},style:{paddingTop:"4px"}}))),m.a.createElement(M.a.Item,Object.assign({label:"Allow File Upload"},n),a("file_enable",{initialValue:!this.state.patientDetails||this.state.patientDetails.file_enable})(m.a.createElement(me.a,{style:{paddingTop:"4px"},defaultChecked:!0}))),m.a.createElement(M.a.Item,Object.assign({label:"Max Uploads Allowed"},n),a("file_count",{initialValue:this.state.patientDetails?this.state.patientDetails.file_count:10})(m.a.createElement(I.a,{min:0}))),m.a.createElement(M.a.Item,null,t.props.history?m.a.createElement(_.a,{style:{margin:5},onClick:function(){return t.props.history.goBack()}},"Cancel"):null,m.a.createElement(_.a,{style:{margin:5},type:"primary",htmlType:"submit",loading:this.state.loading},"Save"))))}}]),t}(m.a.Component),Ee=M.a.create()(ge);function ve(e){return isNaN(e)?{validateStatus:"error",errorMsg:"Patient ID can only be numerical value."}:{validateStatus:"success",errorMsg:null}}a(247);var _e=a(248),Oe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={redirect:!1,appointments:null,practice_doctors:[],procedure_category:null,treatmentNotes:null,practice_staff:[],loading:!1},a.changeRedirect=a.changeRedirect.bind(Object(o.a)(a)),a.editAppointment=a.editAppointment.bind(Object(o.a)(a)),a.deleteAppointment=a.deleteAppointment.bind(Object(o.a)(a)),a.loadProcedureCategory=a.loadProcedureCategory.bind(Object(o.a)(a)),a.loadDoctors=a.loadDoctors.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadDoctors(),this.loadTreatmentNotes(),this.props.match.params.appointmentid?this.loadAppointment(this.props.match.params.appointmentid):this.loadAllAppointments()}},{key:"loadAppointment",value:function(e){var t=this;this.setState({loading:!0});Object(Y.c)(Object(Y.f)(q.o,[e]),(function(e){t.setState({appointments:[e],loading:!1})}),(function(){t.setState({loading:!1})}))}},{key:"loadAllAppointments",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;this.setState({loading:!0});var a=function(e){1==e.current?t.setState({appointments:e.results,total:e.count,loadMoreAppointment:e.next,loading:!1}):t.setState((function(t){return{total:e.count,appointments:[].concat(Object(T.a)(t.appointments),Object(T.a)(e.results)),loading:!1,loadMoreAppointment:e.next}}))},n=function(){t.setState({loading:!1})},i={practice:this.props.active_practiceId,pagination:!0,page:e};this.props.match.params.id&&(i.patient=this.props.match.params.id),Object(Y.c)(q.h,a,n,i)}},{key:"loadProcedureCategory",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Lc,[this.props.active_practiceId]),(function(t){e.setState({procedure_category:t})}),(function(){}))}},{key:"loadDoctors",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Ec,[this.props.active_practiceId]),(function(t){t.staff.forEach((function(t){if(t.role==H.N){var a=e.state.practice_doctors;a.push(t),e.setState({practice_doctors:a})}else{var n=e.state.practice_staff;n.push(t),e.setState({practice_staff:n})}}))}),(function(){}))}},{key:"loadTreatmentNotes",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.kb,[this.props.active_practiceId]),(function(t){e.setState({treatmentNotes:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"editAppointment",value:function(e){var t=e.id;this.props.history.push("/calendar/".concat(t,"/edit-appointment"))}},{key:"deleteAppointment",value:function(e){var t=this;t.setState({loading:!0});Object(Y.l)(Object(Y.f)(q.o,[e.id]),{is_active:!1,status:"Cancelled"},(function(e){t.loadAllAppointments(),t.setState({loading:!1})}),(function(){t.setState({loading:!1})}))}},{key:"render",value:function(){var e=this,t=this,a=[];this.state.practice_doctors.length&&this.state.practice_doctors.forEach((function(e){a[e.id]=e.user.first_name}));var n=[];this.state.treatmentNotes&&this.state.treatmentNotes.forEach((function(e){n[e.id]=e.name}));var i=[{title:"Schedule Time",key:"name",render:function(e,t){return m.a.createElement("span",null,x()(t.schedule_at).format("LLL"),",",t.slot,"mins")}},{title:"Patient ID",key:"id",render:function(e,t){return m.a.createElement("span",null,t.patient.custom_id?t.patient.custom_id:t.patient.id)},exports:function(e,t){return t.patient.custom_id?t.patient.custom_id:t.patient.id}},{title:"Patient Name",dataIndex:"patient.user.first_name",key:"patient_name"},{title:"Patient Mobile",dataIndex:"patient.user.mobile",key:"patient_mobile",render:function(e){return t.props.activePracticePermissions.PatientPhoneNumber?e:Object(X.b)(e)}},{title:"Email",dataIndex:"patient.user.email",key:"email",render:function(e){return t.props.activePracticePermissions.PatientEmailId?e:Object(X.a)(e)}},{title:"Doctor",key:"doctor",render:function(e,t){return m.a.createElement("span",null," ",a[t.doctor])}},{title:"Procedure",key:"procedure"},{title:"Treatment Notes",key:"notes",render:function(e,t){return m.a.createElement("span",null," ",n[t.notes])}},{title:"Category",key:"category",render:function(e,t){return m.a.createElement("span",null," ",t.category?t.category_data.name:"--")}},{title:"NotifyByEmail",key:"notify_via_email",render:function(e,t){return m.a.createElement(me.a,{disabled:!0,checked:t.notify_via_email})}},{title:"NotifyBySMS",key:"notify_via_sms",render:function(e,t){return m.a.createElement(me.a,{disabled:!0,checked:t.notify_via_sms})}},{title:"Action",key:"action",render:function(a,n){return m.a.createElement("span",null,m.a.createElement("a",{onClick:function(){return e.editAppointment(n)},disabled:!t.props.activePracticePermissions.EditAppointment},"Edit"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement(E.a,{title:"Are you sure delete this item?",onConfirm:function(){return e.deleteAppointment(n)},okText:"Yes",cancelText:"No"},m.a.createElement("a",{disabled:!t.props.activePracticePermissions.EditAppointment},"Delete")))}}];M.a.create()(U.a);return this.props.match.params.id?m.a.createElement(j.a,{extra:t.props.activePracticePermissions.AddAppointment||t.props.allowAllPermissions?m.a.createElement(C.b,{to:"/calendar/create-appointment?patient=".concat(this.props.match.params.id)},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"\xa0Add Appointment")):null},m.a.createElement(_e.a,{loading:this.state.loading,columns:i,scroll:{x:1300},pagination:!1,dataSource:this.state.appointments}),m.a.createElement(W.a,{loaderFunction:function(){return e.loadAllAppointments(e.state.loadMoreAppointment)},loading:this.state.loading,hidden:!this.state.loadMoreAppointment})):m.a.createElement(j.a,{extra:t.props.activePracticePermissions.AddAppointment||t.props.allowAllPermissions?m.a.createElement(C.b,{to:"/calendar/create-appointment"},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"\xa0Add Appointment")):null},m.a.createElement(_e.a,{loading:this.state.loading,columns:i,scroll:{x:1300},pagination:!1,dataSource:this.state.appointments}),m.a.createElement(W.a,{loaderFunction:function(){return e.loadAllAppointments(e.state.loadMoreAppointment)},loading:this.state.loading,hidden:!this.state.loadMoreAppointment}))}}]),t}(m.a.Component),Pe=(a(282),a(280)),ke=a(716),je=u.a.Sider,Ce=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},a.onHotKeyInner=a.onHotKeyInner.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"onHotKeyInner",value:function(e){switch(e){case"alt+f":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/profile")):this.props.history.push("/patients/profile");case"alt+a":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/appointments")):this.props.history.push("/patients/appointments");case"alt+o":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/communications")):this.props.history.push("/patients/communications");case"alt+k":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/booking")):this.props.history.push("/patients/profile");case"alt+m":case"alt+n":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/emr/vitalsigns")):this.props.history.push("/patients/emr/vitalsigns");case"alt+t":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/emr/plans")):this.props.history.push("/patients/emr/plans");case"alt+l":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/emr/files")):this.props.history.push("/patients/emr/files");case"alt+i":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/billing/invoices")):this.props.history.push("/patients/billing/invoices");case"alt+e":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/billing/return/invoices")):this.props.history.push("/patients/billing/return/invoices");case"alt+y":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/billing/payments")):this.props.history.push("/patients/billing/payments");case"alt+u":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/emr/workdone")):this.props.history.push("/patients/emr/workdone");case"alt+s":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/emr/prescriptions")):this.props.history.push("/patients/emr/prescriptions");case"alt+g":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/billing/ledger")):this.props.history.push("/patients/profile");case"alt+w":return this.props.currentPatient?this.props.history.push("/patient/".concat(this.props.currentPatient.id,"/emr/timeline")):this.props.history.push("/patients/profile")}}},{key:"render",value:function(){var e=this;return m.a.createElement(ke.a,{keyName:Q.W,onKeyDown:function(t){return e.onHotKeyInner(t)}},m.a.createElement(je,{trigger:null,collapsible:!0,collapsed:this.props.hideSidePanel,style:{overflow:"auto",minHeight:"calc(100vh - 64px)",background:"#fff"}},m.a.createElement(Pe.a,{mode:"inline"},m.a.createElement(Pe.a.ItemGroup,{key:"g1",title:m.a.createElement(v.a,{style:{margin:"0px"}},"Patient")},m.a.createElement(Pe.a.Item,{key:"17"},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/profile"):"/patients/profile"},m.a.createElement(k.a,{type:"user"}),m.a.createElement("span",{className:"nav-text"},"Pro",m.a.createElement("span",{className:"shortcutLetterHighlight"},"f"),"ile"))),this.props.activePracticePermissions.PatientAppointments||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"18"},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/appointments"):"/patients/appointments"},m.a.createElement(k.a,{type:"calendar"}),m.a.createElement("span",{className:"nav-text"},m.a.createElement("span",{className:"shortcutLetterHighlight"},"A"),"ppointments"))):null,this.props.activePracticePermissions.PatientCommunications||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"19"},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/communications"):"/patients/communications"},m.a.createElement(k.a,{type:"message"}),m.a.createElement("span",{className:"nav-text"},"C",m.a.createElement("span",{className:"shortcutLetterHighlight"},"o"),"mmunications"))):null,this.props.activePracticePermissions.PatientBookings||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"booking",disabled:!this.props.currentPatient},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/booking"):"/patients/communications"},m.a.createElement(k.a,{type:"book"}),m.a.createElement("span",{className:"nav-text"},"Boo",m.a.createElement("span",{className:"shortcutLetterHighlight"},"k"),"ing"))):null),m.a.createElement(Pe.a.ItemGroup,{key:"g2",title:m.a.createElement(v.a,{style:{margin:"0px"}},"EMR")},this.props.activePracticePermissions.PatientVitalSigns||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"20"},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/emr/vitalsigns"):"/patients/emr/vitalsigns"},m.a.createElement(k.a,{type:"heart"}),m.a.createElement("span",{className:"nav-text"},"Report ",m.a.createElement("span",{className:"shortcutLetterHighlight"},"M"),"anual"))):null,this.props.activePracticePermissions.PatientClinicalNotes||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"21"},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/emr/clinicnotes"):"/patients/emr/clinicnotes"},m.a.createElement(k.a,{type:"solution"}),m.a.createElement("span",{className:"nav-text"},"Clinical ",m.a.createElement("span",{className:"shortcutLetterHighlight"},"N"),"otes"))):null,this.props.activePracticePermissions.PatientTreatmentPlans||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"30"},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/emr/plans"):"/patients/emr/plans"},m.a.createElement(k.a,{type:"read"}),m.a.createElement("span",{className:"nav-text"},m.a.createElement("span",{className:"shortcutLetterHighlight"},"T"),"reatment Plans"))):null,this.props.activePracticePermissions.PatientCompletedProcedure||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"22"},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/emr/workdone"):"/patients/emr/workdone"},m.a.createElement(k.a,{type:"check-circle"}),m.a.createElement("span",{className:"nav-text"},"Completed Proced",m.a.createElement("span",{className:"shortcutLetterHighlight"},"u"),"re"))):null,this.props.activePracticePermissions.PatientFiles||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"23"},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/emr/files"):"/patients/emr/files"},m.a.createElement(k.a,{type:"picture"}),m.a.createElement("span",{className:"nav-text"},"Fi",m.a.createElement("span",{className:"shortcutLetterHighlight"},"l"),"es"))):null,this.props.activePracticePermissions.PatientPrescriptions||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"24"},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/emr/prescriptions"):"/patients/emr/prescriptions"},m.a.createElement(k.a,{type:"solution"}),m.a.createElement("span",{className:"nav-text"},"Pre",m.a.createElement("span",{className:"shortcutLetterHighlight"},"s"),"criptions"))):null,this.props.activePracticePermissions.PatientTimeline||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"25",disabled:!this.props.currentPatient},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/emr/timeline"):"/patients/profile"},m.a.createElement(k.a,{type:"clock-circle"}),m.a.createElement("span",{className:"nav-text"},"Timeline ",m.a.createElement("span",{className:"shortcutLetterHighlight"},"w")))):null,this.props.activePracticePermissions.PatientLabOrders||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"26",disabled:!this.props.currentPatient||!0},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/emr/labtrackings"):"/patients/profile"},m.a.createElement(k.a,{type:"solution"}),m.a.createElement("span",{className:"nav-text"},"Lab Orders"))):null),m.a.createElement(Pe.a.ItemGroup,{key:"g3",title:m.a.createElement(v.a,{style:{margin:"0px"}},"Billing")},this.props.activePracticePermissions.PatientInvoices||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"27"},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/billing/invoices"):"/patients/billing/invoices"},m.a.createElement(k.a,{type:"audit"}),m.a.createElement("span",{className:"nav-text"},m.a.createElement("span",{className:"shortcutLetterHighlight"},"I"),"nvoices"))):null,this.props.activePracticePermissions.PatientReturns||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"31"},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/billing/return/invoices"):"/patients/billing/return/invoices"},m.a.createElement(k.a,{type:"redo"}),m.a.createElement("span",{className:"nav-text"},"Invoices R",m.a.createElement("span",{className:"shortcutLetterHighlight"},"e"),"turn"))):null,this.props.activePracticePermissions.PatientPayments||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"28"},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/billing/payments"):"/patients/billing/payments"},m.a.createElement(k.a,{type:"dollar"}),m.a.createElement("span",{className:"nav-text"},"Pa",m.a.createElement("span",{className:"shortcutLetterHighlight"},"y"),"ments"))):null,this.props.activePracticePermissions.PatientLedger||this.props.allowAllPermissions?m.a.createElement(Pe.a.Item,{key:"29",disabled:!this.props.currentPatient},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/billing/ledger"):"/patients/profile"},m.a.createElement(k.a,{type:"book"}),m.a.createElement("span",{className:"nav-text"},"Led",m.a.createElement("span",{className:"shortcutLetterHighlight"},"g"),"er"))):null,this.props.currentPatient&&this.props.currentPatient.is_agent&&(this.props.activePracticePermissions.PatientLedger||this.props.allowAllPermissions)?m.a.createElement(Pe.a.Item,{key:"32",disabled:!this.props.currentPatient},m.a.createElement(C.b,{to:this.props.currentPatient?"/patient/".concat(this.props.currentPatient.id,"/billing/wallet"):"/patients/profile"},m.a.createElement(k.a,{type:"wallet"}),m.a.createElement("span",{className:"nav-text"},"Wallet Ledger"))):null))))}}]),t}(m.a.Component),Se=(a(303),a(296)),xe=(a(49),a(1246),a(5)),Ie=a.n(xe),De=a(50),Me=a(104);function we(){return(we=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Te(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Fe=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},Ae=function(e){return d.createElement(Me.a,null,(function(t){var a,n,i=t.getPrefixCls,r=e.prefixCls,l=e.className,c=e.color,o=void 0===c?"":c,s=e.children,u=e.pending,m=e.dot,p=Fe(e,["prefixCls","className","color","children","pending","dot"]),f=i("timeline",r),h=Ie()((Te(a={},"".concat(f,"-item"),!0),Te(a,"".concat(f,"-item-pending"),u),a),l),b=Ie()((Te(n={},"".concat(f,"-item-head"),!0),Te(n,"".concat(f,"-item-head-custom"),m),Te(n,"".concat(f,"-item-head-").concat(o),!0),n));return d.createElement("li",we({},Object(De.default)(p,["position"]),{className:h}),d.createElement("div",{className:"".concat(f,"-item-tail")}),d.createElement("div",{className:b,style:{borderColor:/blue|red|green|gray/.test(o)?void 0:o}},m),d.createElement("div",{className:"".concat(f,"-item-content")},s))}))};Ae.defaultProps={color:"blue",pending:!1,position:""};var Le=Ae;function Ve(e){return(Ve="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(){return(Ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Re(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Be(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ye(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qe(e,t){return!t||"object"!==Ve(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function We(e){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ge(e,t){return(Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var He=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},Ue=function(e){function t(){var e;return ze(this,t),(e=qe(this,We(t).apply(this,arguments))).renderTimeline=function(t){var a,n=t.getPrefixCls,i=e.props,r=i.prefixCls,l=i.pending,c=void 0===l?null:l,o=i.pendingDot,s=i.children,u=i.className,m=i.reverse,p=i.mode,f=He(i,["prefixCls","pending","pendingDot","children","className","reverse","mode"]),h=n("timeline",r),b="boolean"===typeof c?null:c,y=Ie()(h,(Be(a={},"".concat(h,"-pending"),!!c),Be(a,"".concat(h,"-reverse"),!!m),Be(a,"".concat(h,"-").concat(p),!!p),a),u),g=c?d.createElement(Le,{pending:!!c,dot:o||d.createElement(k.a,{type:"loading"})},b):null,E=m?[g].concat(Re(d.Children.toArray(s).reverse())):[].concat(Re(d.Children.toArray(s)),[g]),v=function(e,t){return"alternate"===p?"right"===e.props.position?"".concat(h,"-item-right"):"left"===e.props.position?"".concat(h,"-item-left"):"".concat(h,t%2===0?"-item-left":"-item-right"):"left"===p?"".concat(h,"-item-left"):"right"===p?"".concat(h,"-item-right"):"right"===e.props.position?"".concat(h,"-item-right"):""},_=E.filter((function(e){return!!e})),O=d.Children.count(_),P="".concat(h,"-item-last"),j=d.Children.map(_,(function(e,t){var a=t===O-2?P:"",n=t===O-1?P:"";return d.cloneElement(e,{className:Ie()([e.props.className,!m&&c?a:n,v(e,t)])})}));return d.createElement("ul",Ne({},f,{className:y}),j)},e}var a,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ge(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){return d.createElement(Me.a,null,this.renderTimeline)}}])&&Ye(a.prototype,n),i&&Ye(a,i),t}(d.Component);Ue.Item=Le,Ue.defaultProps={reverse:!1,mode:""};var Ke=Ue,Xe=(a(136),a(100)),Qe=(a(1247),a(1)),Ze=a.n(Qe),Je=a(8),$e=a(348),et=a.n($e);function tt(){if("undefined"!==typeof window&&window.document&&window.document.documentElement){var e=window.document.documentElement;return"flex"in e.style||"webkitFlex"in e.style||"Flex"in e.style||"msFlex"in e.style}return!1}function at(){return(at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function nt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function it(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function rt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lt(e){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ct(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ot(e,t){return(ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function st(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ut=function(e){function t(e){var a,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,i=lt(t).call(this,e),a=!i||"object"!==typeof i&&"function"!==typeof i?ct(n):i,st(ct(a),"onStepClick",(function(e){var t=a.props,n=t.onChange,i=t.current;n&&i!==e&&n(e)})),st(ct(a),"calcStepOffsetWidth",(function(){if(!tt()){var e=a.state.lastStepOffsetWidth,t=Object(Je.findDOMNode)(ct(a));t.children.length>0&&(a.calcTimeout&&clearTimeout(a.calcTimeout),a.calcTimeout=setTimeout((function(){var n=(t.lastChild.offsetWidth||0)+1;e===n||Math.abs(e-n)<=3||a.setState({lastStepOffsetWidth:n})})))}})),a.state={flexSupported:!0,lastStepOffsetWidth:0},a.calcStepOffsetWidth=et()(a.calcStepOffsetWidth,150),a}var a,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}(t,e),a=t,(n=[{key:"componentDidMount",value:function(){this.calcStepOffsetWidth(),tt()||this.setState({flexSupported:!1})}},{key:"componentDidUpdate",value:function(){this.calcStepOffsetWidth()}},{key:"componentWillUnmount",value:function(){this.calcTimeout&&clearTimeout(this.calcTimeout),this.calcStepOffsetWidth&&this.calcStepOffsetWidth.cancel&&this.calcStepOffsetWidth.cancel()}},{key:"render",value:function(){var e,t=this,a=this.props,n=a.prefixCls,i=a.style,r=void 0===i?{}:i,l=a.className,c=a.children,o=a.direction,s=a.type,u=a.labelPlacement,p=a.iconPrefix,f=a.status,h=a.size,b=a.current,y=a.progressDot,g=a.initial,E=a.icons,v=a.onChange,_=it(a,["prefixCls","style","className","children","direction","type","labelPlacement","iconPrefix","status","size","current","progressDot","initial","icons","onChange"]),O="navigation"===s,P=this.state,k=P.lastStepOffsetWidth,j=P.flexSupported,C=m.a.Children.toArray(c).filter((function(e){return!!e})),S=C.length-1,x=y?"vertical":u,I=Ie()(n,"".concat(n,"-").concat(o),l,(st(e={},"".concat(n,"-").concat(h),h),st(e,"".concat(n,"-label-").concat(x),"horizontal"===o),st(e,"".concat(n,"-dot"),!!y),st(e,"".concat(n,"-navigation"),O),st(e,"".concat(n,"-flex-not-supported"),!j),e));return m.a.createElement("div",at({className:I,style:r},_),d.Children.map(C,(function(e,a){if(!e)return null;var i=g+a,l=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?nt(a,!0).forEach((function(t){st(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):nt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({stepNumber:"".concat(i+1),stepIndex:i,prefixCls:n,iconPrefix:p,wrapperStyle:r,progressDot:y,icons:E,onStepClick:v&&t.onStepClick},e.props);return j||"vertical"===o||(O?(l.itemWidth="".concat(100/(S+1),"%"),l.adjustMarginRight=0):a!==S&&(l.itemWidth="".concat(100/S,"%"),l.adjustMarginRight=-Math.round(k/S+1))),"error"===f&&a===b-1&&(l.className="".concat(n,"-next-error")),e.props.status||(l.status=i===b?f:i<b?"finish":"wait"),l.active=i===b,Object(d.cloneElement)(e,l)})))}}])&&rt(a.prototype,n),i&&rt(a,i),t}(d.Component);function dt(){return(dt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function mt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function pt(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ht(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bt(e,t){return!t||"object"!==typeof t&&"function"!==typeof t?gt(e):t}function yt(e){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Et(e,t){return(Et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _t(e){return"string"===typeof e}st(ut,"propTypes",{type:Ze.a.string,prefixCls:Ze.a.string,className:Ze.a.string,iconPrefix:Ze.a.string,direction:Ze.a.string,labelPlacement:Ze.a.string,children:Ze.a.any,status:Ze.a.string,size:Ze.a.string,progressDot:Ze.a.oneOfType([Ze.a.bool,Ze.a.func]),style:Ze.a.object,initial:Ze.a.number,current:Ze.a.number,icons:Ze.a.shape({finish:Ze.a.node,error:Ze.a.node}),onChange:Ze.a.func}),st(ut,"defaultProps",{type:"default",prefixCls:"rc-steps",iconPrefix:"rc",direction:"horizontal",labelPlacement:"horizontal",initial:0,current:0,status:"process",size:"",progressDot:!1});var Ot=function(e){function t(){var e,a;ft(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vt(gt(a=bt(this,(e=yt(t)).call.apply(e,[this].concat(i)))),"onClick",(function(){var e=a.props,t=e.onClick,n=e.onStepClick,i=e.stepIndex;t&&t.apply(void 0,arguments),n(i)})),a}var a,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Et(e,t)}(t,e),a=t,(n=[{key:"renderIconNode",value:function(){var e,t=this.props,a=t.prefixCls,n=t.progressDot,i=t.stepNumber,r=t.status,l=t.title,c=t.description,o=t.icon,s=t.iconPrefix,u=t.icons,d=Ie()("".concat(a,"-icon"),"".concat(s,"icon"),(vt(e={},"".concat(s,"icon-").concat(o),o&&_t(o)),vt(e,"".concat(s,"icon-check"),!o&&"finish"===r&&u&&!u.finish),vt(e,"".concat(s,"icon-close"),!o&&"error"===r&&u&&!u.error),e)),p=m.a.createElement("span",{className:"".concat(a,"-icon-dot")});return n?"function"===typeof n?m.a.createElement("span",{className:"".concat(a,"-icon")},n(p,{index:i-1,status:r,title:l,description:c})):m.a.createElement("span",{className:"".concat(a,"-icon")},p):o&&!_t(o)?m.a.createElement("span",{className:"".concat(a,"-icon")},o):u&&u.finish&&"finish"===r?m.a.createElement("span",{className:"".concat(a,"-icon")},u.finish):u&&u.error&&"error"===r?m.a.createElement("span",{className:"".concat(a,"-icon")},u.error):o||"finish"===r||"error"===r?m.a.createElement("span",{className:d}):m.a.createElement("span",{className:"".concat(a,"-icon")},i)}},{key:"render",value:function(){var e,t=this.props,a=t.className,n=t.prefixCls,i=t.style,r=t.itemWidth,l=t.active,c=t.status,o=void 0===c?"wait":c,s=(t.iconPrefix,t.icon),u=(t.wrapperStyle,t.adjustMarginRight),d=(t.stepNumber,t.disabled),p=t.description,f=t.title,h=t.subTitle,b=(t.progressDot,t.tailContent),y=(t.icons,t.stepIndex,t.onStepClick),g=t.onClick,E=pt(t,["className","prefixCls","style","itemWidth","active","status","iconPrefix","icon","wrapperStyle","adjustMarginRight","stepNumber","disabled","description","title","subTitle","progressDot","tailContent","icons","stepIndex","onStepClick","onClick"]),v=Ie()("".concat(n,"-item"),"".concat(n,"-item-").concat(o),a,(vt(e={},"".concat(n,"-item-custom"),s),vt(e,"".concat(n,"-item-active"),l),vt(e,"".concat(n,"-item-disabled"),!0===d),e)),_=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?mt(a,!0).forEach((function(t){vt(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):mt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},i);r&&(_.width=r),u&&(_.marginRight=u);var O={};return y&&!d&&(O.role="button",O.tabIndex=0,O.onClick=this.onClick),m.a.createElement("div",dt({},E,{className:v,style:_}),m.a.createElement("div",dt({onClick:g},O,{className:"".concat(n,"-item-container")}),m.a.createElement("div",{className:"".concat(n,"-item-tail")},b),m.a.createElement("div",{className:"".concat(n,"-item-icon")},this.renderIconNode()),m.a.createElement("div",{className:"".concat(n,"-item-content")},m.a.createElement("div",{className:"".concat(n,"-item-title")},f,h&&m.a.createElement("div",{title:h,className:"".concat(n,"-item-subtitle")},h)),p&&m.a.createElement("div",{className:"".concat(n,"-item-description")},p))))}}])&&ht(a.prototype,n),i&&ht(a,i),t}(m.a.Component);vt(Ot,"propTypes",{className:Ze.a.string,prefixCls:Ze.a.string,style:Ze.a.object,wrapperStyle:Ze.a.object,itemWidth:Ze.a.oneOfType([Ze.a.number,Ze.a.string]),active:Ze.a.bool,disabled:Ze.a.bool,status:Ze.a.string,iconPrefix:Ze.a.string,icon:Ze.a.node,adjustMarginRight:Ze.a.oneOfType([Ze.a.number,Ze.a.string]),stepNumber:Ze.a.string,stepIndex:Ze.a.number,description:Ze.a.any,title:Ze.a.any,subTitle:Ze.a.any,progressDot:Ze.a.oneOfType([Ze.a.bool,Ze.a.func]),tailContent:Ze.a.any,icons:Ze.a.shape({finish:Ze.a.node,error:Ze.a.node}),onClick:Ze.a.func,onStepClick:Ze.a.func}),ut.Step=Ot;var Pt=ut;function kt(e){return(kt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jt(){return(jt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Ct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function St(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xt(e,t){return!t||"object"!==kt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function It(e){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dt(e,t){return(Dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mt=function(e){function t(){var e;return Ct(this,t),(e=xt(this,It(t).apply(this,arguments))).renderSteps=function(t){var a=t.getPrefixCls,n=a("steps",e.props.prefixCls),i=a("",e.props.iconPrefix),r={finish:d.createElement(k.a,{type:"check",className:"".concat(n,"-finish-icon")}),error:d.createElement(k.a,{type:"close",className:"".concat(n,"-error-icon")})};return d.createElement(Pt,jt({icons:r},e.props,{prefixCls:n,iconPrefix:i}))},e}var a,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dt(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){return d.createElement(Me.a,null,this.renderSteps)}}])&&St(a.prototype,n),i&&St(a,i),t}(d.Component);Mt.Step=Pt.Step,Mt.defaultProps={current:0},Mt.propTypes={prefixCls:Qe.string,iconPrefix:Qe.string,current:Qe.number};var wt=a(273),Tt=a(51),Ft=(Mt.Step,[{label:m.a.createElement("span",{style:{width:"100%"}},"Appointment"),value:"appointments"},{label:m.a.createElement("span",{style:{width:"100%"}},"Report Manual"),value:"vital_signs"},{label:m.a.createElement("span",{style:{width:"100%"}},"Clinic Notes"),value:"clinic_notes"},{label:m.a.createElement("span",{style:{width:"100%"}},"Treatment Plans"),value:"treatment_plans"},{label:m.a.createElement("span",{style:{width:"100%"}},"Procedures"),value:"procedures"},{label:m.a.createElement("span",{style:{width:"100%"}},"Files"),value:"files"},{label:m.a.createElement("span",{style:{width:"100%"}},"Prescriptions"),value:"prescriptions"},{label:m.a.createElement("span",{style:{width:"100%"}},"Invoices"),value:"invoices"},{label:m.a.createElement("span",{style:{width:"100%"}},"Payments"),value:"payments"}]),At=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).changeFilters=function(e){var t=Object(o.a)(a);a.setState({filterParams:e,selectedFiltersIntermediate:!!e.length&&e.length<Ft.length,checkAllFilters:e.length===Ft.length},(function(){t.loadTimeline()}))},a.onCheckAllFiltersChange=function(e){var t=Object(o.a)(a);a.setState({filterParams:e.target.checked?Ft.map((function(e){return e.value})):[],selectedFiltersIntermediate:!1,checkAllFilters:e.target.checked},(function(){t.loadTimeline()}))},a.loadTimeline=function(){var e=Object(o.a)(a),t={practice_id:a.props.active_practiceId};e.setState({loading:!0}),a.state.filterParams.forEach((function(e){t[e]=1}));a.props.showAllClinic&&a.props.match.params.id&&delete t.practice_id,Object(Y.c)(Object(Y.f)(q.yc,[a.props.match.params.id]),(function(t){var a=x()().add(5,"year");e.setState((function(){var e=[],n={};return t.forEach((function(t){a.format("YMD")!=x()(t.sort_date).format("YMD")&&(a=x()(t.sort_date),e.push({type:"Time",date:t.sort_date})),e.push(t),"Appointments"!=t.type&&(n[t.type]?n[t.type][t.id]=!0:n[t.type]=Object(F.a)({},t.id,!0))})),{timelineData:e,loading:!1,allCheckList:n}}))}),(function(){e.setState({loading:!1})}),t)},a.onCheckAllTimelineCard=function(e){a.setState((function(t){return{checkedTimelineCards:e.target.checked?Object(A.a)({},t.allCheckList):{},indeterminate:!1,checkAll:e.target.checked}}))},a.toggleTimelineCheckbox=function(e,t,n){a.setState((function(a){var i={},r=a.checkedTimelineCards;if(r[e]?r[e][t]=!!n:r[e]=Object(F.a)({},t,!!n),n){if(i.indeterminate=!0,Object.keys(a.allCheckList).length==Object.keys(r).length){for(var l=Object.keys(a.allCheckList),c=!1,o=0;o<l.length;o++)if(Object.keys(a.allCheckList[l[o]]).length!=Object.keys(r[l[o]]).length){c=!0,i.checkAll=!1;break}c||(i.indeterminate=!1,i.checkAll=!0)}}else i.checkAll=!1,i.indeterminate=!0,delete r[e][t],Object.keys(r[e]).length||(delete r[e],Object.keys(r).length||(i.indeterminate=!1));return i.checkedTimelineCards=r,i}))},a.printCaseSheet=function(){var e=Object(o.a)(a),t=Object(Y.o)("Starting print case sheet..."),n={practice:e.props.active_practiceId,timeline:[]};Object.keys(a.state.checkedTimelineCards).forEach((function(t){n.timeline.push({type:t,id:Object.keys(e.state.checkedTimelineCards[t])})}));Object(Y.j)(Object(Y.f)(q.zc,[a.props.match.params.id]),n,(function(e){Object(Y.p)(t,H.Sb,"Fetched report successfully!!"),window.open(Tt.a+e.report)}),(function(){Object(Y.p)(t,H.Q,"Case sheet printing failed!!")}))},a.updateFormValue=function(e,t){a.setState(Object(F.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendCaseSheet=function(){a.mailModalOpen(),a.setState({mail_to:wt.get(a.props.currentPatient,"user.email")})},a.sendMailToPatient=function(){var e=Object(o.a)(a),t={mail_to:a.state.mail_to,practice:e.props.active_practiceId,timeline:[]};Object.keys(a.state.checkedTimelineCards).forEach((function(a){t.timeline.push({type:a,id:Object.keys(e.state.checkedTimelineCards[a])})}));Object(Y.j)(Object(Y.f)(q.zc,[a.props.match.params.id]),t,(function(e){}),(function(e){})),a.mailModalClose()},a.state={filterParams:["appointments","vital_signs","clinic_notes","treatment_plans","procedures","files","prescriptions","invoices","payments"],checkAllFilters:!0,selectedFiltersIntermediate:!1,timelineData:[],checkedTimelineCards:[]},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadTimeline()}},{key:"render",value:function(){var e=this,t=this;this.state.timelineData;return m.a.createElement(j.a,{title:"Timeline",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{onClick:function(){return e.sendCaseSheet(e.state.timelineData)}},m.a.createElement(k.a,{type:"mail"})," Case Sheet"),m.a.createElement(_.a,{type:"primary",onClick:function(){return e.printCaseSheet()}},"Print Case Sheet"))},m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null,m.a.createElement(g.a,{span:4},m.a.createElement(me.a,{indeterminate:this.state.selectedFiltersIntermediate,onChange:this.onCheckAllFiltersChange,checked:this.state.checkAllFilters},m.a.createElement("b",null,"Select all")),m.a.createElement("br",null),m.a.createElement(me.a.Group,{size:"large",value:this.state.filterParams,options:Ft,onChange:this.changeFilters})),m.a.createElement(g.a,{span:20},m.a.createElement(Xe.a,{top:10},m.a.createElement("h4",{style:{textAlign:"right",padding:"5px",backgroundImage:"linear-gradient(to left, white , transparent)"}},m.a.createElement(me.a,{indeterminate:this.state.indeterminate,onChange:this.onCheckAllTimelineCard,checked:this.state.checkAll},"Select All"))),m.a.createElement(Ke,{progressDot:!0,current:1,direction:"vertical"},this.state.timelineData.map((function(e){return m.a.createElement(Ke.Item,{dot:"Time"==e.type?m.a.createElement(k.a,{type:"clock-circle-o",style:{fontSize:"25px"}}):null},function(e){switch(e.type){case"Clinical Notes":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"solution"})," Clinical Note Added",m.a.createElement(me.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null),e.chief_complaints?m.a.createElement("p",null,"Chief Complaints",m.a.createElement("ul",null,e.chief_complaints.split(Q.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null,e.observations?m.a.createElement("p",null,"Observations",m.a.createElement("ul",null,e.observations.split(Q.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null,e.investigations?m.a.createElement("p",null,"Investigations",m.a.createElement("ul",null,e.investigations.split(Q.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null,e.diagnosis?m.a.createElement("p",null,"Diagnosis",m.a.createElement("ul",null,e.diagnosis.split(Q.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null,e.notes?m.a.createElement("p",null,"Notes",m.a.createElement("ul",null,e.notes.split(Q.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null)}(e);case"Appointments":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"calendar"})," Appointment",e.practice_data?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),e.doctor_data?m.a.createElement("p",{style:{borderLeft:"5px solid ".concat(e.doctor_data.calendar_colour),paddingLeft:"5px"}},e.doctor_data.user.first_name):null,x()(e.schedule_at).format("hh:mm A")," to ",x()(e.schedule_at).add(e.slot,"mins").format("HH:mm A"))}(e);case"Files":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"picture"})," File",m.a.createElement(me.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice_data?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),m.a.createElement("img",{src:Object(Y.g)(e.file_type),alt:"",style:{height:100}}))}(e);case"Invoices":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"audit"})," Invoice",m.a.createElement(me.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice_data?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),e.procedure.map((function(e){return m.a.createElement(y.a,null,e.name)})),e.inventory.map((function(e){return m.a.createElement(y.a,null,e.name)})),m.a.createElement("br",null),m.a.createElement("b",null,e.invoice_id),m.a.createElement("br",null),m.a.createElement("b",null,"Invoice Amount: INR ",e.total),m.a.createElement("br",null),m.a.createElement("b",null,"Paid Amount: INR ",e.payments_data),m.a.createElement("br",null),m.a.createElement("b",null,"Due Amount: INR ",e.total-e.payments_data))}(e);case"Vital Signs":return function(e){var t=[{title:"Time",dataIndex:"created_at",key:"name",render:function(e){return m.a.createElement("span",null,x()(e).format("hh:mm A"))}},{title:"Temp(F)",key:"temperature",render:function(e,t){return m.a.createElement("span",null," ",t.temperature,m.a.createElement("br",null),",",t.temperature_part)}},{title:"Pulse (BPM)",dataIndex:"pulse",key:"pulse"},{title:"RR breaths/min",dataIndex:"resp_rate",key:"resp_rate"},{title:"SYS/DIA mmhg",key:"address",render:function(e,t){return m.a.createElement(m.a.Fragment,null,t.blood_pressure_up?m.a.createElement("span",null," ",t.blood_pressure_up,"/",t.blood_pressure_down,m.a.createElement("br",null),",",t.position):null)}},{title:"WEIGHT kg",dataIndex:"weight",key:"weight"},{title:"Creatinine Level",key:"creatinine",dataIndex:"creatinine"},{title:"Haemoglobin Level",key:"haemoglobin",dataIndex:"haemoglobin"},{title:"Urea Level",key:"urea",dataIndex:"urea"},{title:"Uric Acid Level",key:"uric_acid",dataIndex:"uric_acid"}];return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"heart"})," Report Manual Recorded",m.a.createElement(me.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice_data?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),e.doctor_data?m.a.createElement("p",{style:{borderLeft:"5px solid ".concat(e.doctor_data.calendar_colour),paddingLeft:"5px"}},e.doctor_data.user.first_name):null,m.a.createElement(_e.a,{columns:t,size:"small",pagination:!1,dataSource:[e]}))}(e);case"Prescriptions":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"solution"})," Prescription Added",m.a.createElement(me.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null),e.doctor?m.a.createElement("p",{style:{borderLeft:"5px solid ".concat(e.doctor.calendar_colour),paddingLeft:"5px"}},e.doctor.user.first_name):null,e.drugs.map((function(e){return m.a.createElement(y.a,null,e.name)})))}(e);case"Payments":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"dollar"})," Payment",m.a.createElement(me.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice_data?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),m.a.createElement("b",null,e.payment_id),m.a.createElement("br",null),m.a.createElement("b",null,"Amount Paid: INR ",e.total))}(e);case"Time":return function(e){return m.a.createElement("span",null,m.a.createElement(Xe.a,{top:20,offsetTop:30},m.a.createElement("h2",{style:{marginLeft:"10px",padding:"5px",backgroundImage:"linear-gradient(to right, #ddd , white)",borderRadius:"4px"}},x()(e.date).format("LL"))))}(e);case"Procedures":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,"Procedure Performed",m.a.createElement(me.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null),e.doctor?m.a.createElement("p",{style:{borderLeft:"5px solid ".concat(e.doctor.calendar_colour),paddingLeft:"5px"}},e.doctor.user.first_name):null,e.treatment_plans.map((function(e){return m.a.createElement(y.a,null,e.procedure.name)})))}(e);case"Treatment Plans":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,"Treatment Plan ",m.a.createElement(me.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null),e.doctor?m.a.createElement("p",{style:{borderLeft:"5px solid ".concat(e.doctor.calendar_colour),paddingLeft:"5px"}},e.doctor.user.first_name):null,e.treatment_plans.map((function(e){return m.a.createElement(y.a,null,e.procedure.name)})))}(e);default:return e.type}}(Object(A.a)({},e,{checkedTimelineCards:t.state.checkedTimelineCards,toggleTimelineCheckbox:t.toggleTimelineCheckbox})))}))),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Timeline To ",wt.get(this.props.currentPatient,"user.first_name")," ?"),m.a.createElement(V.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}}))))))}}]),t}(m.a.Component);a(285);var Lt=a(284),Vt=a(1248),Nt=a.n(Vt);function Rt(e){return(Rt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yt(e,t){return!t||"object"!==Rt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qt(e){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wt(e,t){return(Wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Gt=function(e){function t(){return Bt(this,t),Yt(this,qt(t).apply(this,arguments))}var a,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wt(e,t)}(t,e),a=t,(n=[{key:"componentDidMount",value:function(){!function(e,t){if(!document.head.querySelector("#"+e)){var a=document.createElement("style");a.textContent=t,a.type="text/css",a.id=e,document.head.appendChild(a)}}(this.props.name,this.props.css)}},{key:"componentWillUnmount",value:function(){var e=document.getElementById(this.props.name);e.parentNode.removeChild(e)}},{key:"render",value:function(){return null}}])&&zt(a.prototype,n),i&&zt(a,i),t}(d.Component),Ht=function(e){var t=e.imageBackgroundColor;return"\n  body {\n    overflow: hidden;\n  }\n\n  .__react_modal_image__modal_container {\n    position: fixed;\n    z-index: 5000;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.8);\n    touch-action: none;\n    overflow: hidden;\n  }\n\n  .__react_modal_image__modal_content {\n    position: relative;\n    height: 100%;\n    width: 100%;\n  }\n\n  .__react_modal_image__modal_content img, \n  .__react_modal_image__modal_content svg {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate3d(-50%, -50%, 0);\n    -webkit-transform: translate3d(-50%, -50%, 0);\n    -ms-transform: translate3d(-50%, -50%, 0);\n    overflow: hidden;\n  }\n\n  .__react_modal_image__medium_img {\n    max-width: 98%;\n    max-height: 98%;\n    background-color: ".concat(t,";\n  }\n\n  .__react_modal_image__large_img {\n    cursor: move;\n    background-color: ").concat(t,"\n  }\n\n  .__react_modal_image__icon_menu a {\n    display: inline-block;\n    font-size: 40px;\n    cursor: pointer;\n    line-height: 40px;\n    box-sizing: border-box;\n    border: none;\n    padding: 0px 5px 0px 5px;\n    margin-left: 10px;\n    color: white;\n    background-color: rgba(0, 0, 0, 0);\n  }\n\n  .__react_modal_image__icon_menu {\n    display: inline-block;\n    float: right;\n  }\n\n  .__react_modal_image__caption {\n    display: inline-block;\n    color: white;\n    font-size: 120%;\n    padding: 10px;\n    margin: 0;\n  }\n\n  .__react_modal_image__header {\n    position: absolute;\n    top: 0;\n    width: 100%;\n    background-color: rgba(0, 0, 0, 0.7);\n    overflow: hidden;\n  }\n")},Ut=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),m.a.createElement("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"}))},Kt=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),m.a.createElement("path",{d:"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"}))},Xt=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),m.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))},Qt=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),m.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))},Zt=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"48",viewBox:"0 0 24 24",width:"48",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5l-4-4V4h8v3.5l-4 4z"}),m.a.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}))},Jt=function(){return m.a.createElement("svg",{fill:"#ffffff",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0zm0 0h24v24H0V0z"}),m.a.createElement("path",{d:"M7.47 21.49C4.2 19.93 1.86 16.76 1.5 13H0c.51 6.16 5.66 11 11.95 11 .23 0 .44-.02.66-.03L8.8 20.15l-1.33 1.34zM12.05 0c-.23 0-.44.02-.66.04l3.81 3.81 1.33-1.33C19.8 4.07 22.14 7.24 22.5 11H24c-.51-6.16-5.66-11-11.95-11zM16 14h2V8c0-1.11-.9-2-2-2h-6v2h6v6zm-8 2V4H6v2H4v2h2v8c0 1.1.89 2 2 2h8v2h2v-2h2v-2H8z"}))},$t=function(e){var t=e.image,a=e.alt,n=e.zoomed,i=e.toggleZoom,r=e.toggleRotate,l=e.onClose,c=e.enableDownload,o=e.enableZoom,s=e.enableRotate;return m.a.createElement("div",{className:"__react_modal_image__header"},m.a.createElement("span",{className:"__react_modal_image__icon_menu"},c&&m.a.createElement("a",{href:t,download:!0},m.a.createElement(Xt,null)),o&&m.a.createElement("a",{onClick:i},n?m.a.createElement(Kt,null):m.a.createElement(Ut,null)),s&&m.a.createElement("a",{onClick:r},m.a.createElement(Jt,null)),m.a.createElement("a",{onClick:l},m.a.createElement(Qt,null))),a&&m.a.createElement("span",{className:"__react_modal_image__caption"},a))};function ea(e){return(ea="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ta(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aa(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function na(e,t){return!t||"object"!==ea(t)&&"function"!==typeof t?ra(e):t}function ia(e){return(ia=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ra(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function la(e,t){return(la=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ca(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var oa=function(e){function t(){var e,a;ta(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ca(ra(a=na(this,(e=ia(t)).call.apply(e,[this].concat(i)))),"state",{loading:!0}),ca(ra(a),"handleOnLoad",(function(){a.setState({loading:!1})})),ca(ra(a),"handleOnContextMenu",(function(e){!a.props.contextMenu&&e.preventDefault()})),a}var a,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&la(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e=this.props,t=e.id,a=e.className,n=e.src,i=e.style,r=e.handleDoubleClick;return m.a.createElement("div",null,this.state.loading&&m.a.createElement(Zt,null),m.a.createElement("img",{id:t,className:a,src:n,style:i,onLoad:this.handleOnLoad,onDoubleClick:r,onContextMenu:this.handleOnContextMenu}))}}])&&aa(a.prototype,n),i&&aa(a,i),t}(d.Component);function sa(e){return(sa="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ua(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function da(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ma(e,t){return!t||"object"!==sa(t)&&"function"!==typeof t?fa(e):t}function pa(e){return(pa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ha(e,t){return(ha=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ba(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ya=function(e){function t(){var e,a;ua(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ba(fa(a=ma(this,(e=pa(t)).call.apply(e,[this].concat(i)))),"state",{move:{x:0,y:0},moveStart:void 0,zoomed:!1,rotationDeg:0}),ba(fa(a),"handleKeyDown",(function(e){27!==e.keyCode&&13!==e.keyCode||a.props.onClose()})),ba(fa(a),"getCoordinatesIfOverImg",(function(e){var t=e.changedTouches?e.changedTouches[0]:e;if("react-modal-image-img"===t.target.id){var n=a.contentEl.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}})),ba(fa(a),"handleMouseDownOrTouchStart",(function(e){if(e.preventDefault(),!(e.touches&&e.touches.length>1)){var t=a.getCoordinatesIfOverImg(e);t||a.props.onClose(),a.state.zoomed&&a.setState((function(e){return{moveStart:{x:t.x-e.move.x,y:t.y-e.move.y}}}))}})),ba(fa(a),"handleMouseMoveOrTouchMove",(function(e){if(e.preventDefault(),a.state.zoomed&&a.state.moveStart&&!(e.touches&&e.touches.length>1)){var t=a.getCoordinatesIfOverImg(e);t&&a.setState((function(e){return{move:{x:t.x-e.moveStart.x,y:t.y-e.moveStart.y}}}))}})),ba(fa(a),"handleMouseUpOrTouchEnd",(function(e){a.setState({moveStart:void 0})})),ba(fa(a),"toggleZoom",(function(e){e.preventDefault(),a.setState((function(e){return{zoomed:!e.zoomed,move:e.zoomed?{x:0,y:0}:e.move}}))})),ba(fa(a),"toggleRotate",(function(e){e.preventDefault(),360!==a.state.rotationDeg?a.setState((function(e){return{rotationDeg:e.rotationDeg+=90}})):a.setState({rotationDeg:90})})),a}var a,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ha(e,t)}(t,e),a=t,(n=[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown,!1)}},{key:"render",value:function(){var e=this,t=this.props,a=t.medium,n=t.large,i=t.alt,r=t.onClose,l=t.hideDownload,c=t.hideZoom,o=t.showRotate,s=t.imageBackgroundColor,u=void 0===s?"black":s,d=this.state,p=d.move,f=d.zoomed,h=d.rotationDeg;return m.a.createElement("div",null,m.a.createElement(Gt,{name:"__react_modal_image__lightbox",css:Ht({imageBackgroundColor:u})}),m.a.createElement("div",{className:"__react_modal_image__modal_container"},m.a.createElement("div",{className:"__react_modal_image__modal_content",onMouseDown:this.handleMouseDownOrTouchStart,onMouseUp:this.handleMouseUpOrTouchEnd,onMouseMove:this.handleMouseMoveOrTouchMove,onTouchStart:this.handleMouseDownOrTouchStart,onTouchEnd:this.handleMouseUpOrTouchEnd,onTouchMove:this.handleMouseMoveOrTouchMove,ref:function(t){e.contentEl=t}},f&&m.a.createElement(oa,{id:"react-modal-image-img",className:"__react_modal_image__large_img",src:n||a,style:{transform:"translate3d(-50%, -50%, 0) translate3d(".concat(p.x,"px, ").concat(p.y,"px, 0) rotate(").concat(h,"deg)"),WebkitTransform:"translate3d(-50%, -50%, 0) translate3d(".concat(p.x,"px, ").concat(p.y,"px, 0) rotate(").concat(h,"deg)"),MsTransform:"translate3d(-50%, -50%, 0) translate3d(".concat(p.x,"px, ").concat(p.y,"px, 0) rotate(").concat(h,"deg)")},handleDoubleClick:this.toggleZoom}),!f&&m.a.createElement(oa,{id:"react-modal-image-img",className:"__react_modal_image__medium_img",src:a||n,handleDoubleClick:this.toggleZoom,contextMenu:!a,style:{transform:"translate3d(-50%, -50%, 0) rotate(".concat(h,"deg)"),WebkitTransform:"translate3d(-50%, -50%, 0) rotate(".concat(h,"deg)"),MsTransform:"translate3d(-50%, -50%, 0) rotate(".concat(h,"deg)")}})),m.a.createElement($t,{image:n||a,alt:i,zoomed:f,toggleZoom:this.toggleZoom,toggleRotate:this.toggleRotate,onClose:r,enableDownload:!l,enableZoom:!c,enableRotate:!!o})))}}])&&da(a.prototype,n),i&&da(a,i),t}(d.Component);function ga(e){return(ga="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ea(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function va(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _a(e,t){return!t||"object"!==ga(t)&&"function"!==typeof t?Pa(e):t}function Oa(e){return(Oa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ka(e,t){return(ka=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ja(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ca=function(e){function t(){var e,a;Ea(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ja(Pa(a=_a(this,(e=Oa(t)).call.apply(e,[this].concat(i)))),"state",{modalOpen:!1}),ja(Pa(a),"toggleModal",(function(){a.setState((function(e){return{modalOpen:!e.modalOpen}}))})),a}var a,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ka(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e=this.props,t=e.className,a=e.small,n=e.smallSrcSet,i=e.medium,r=e.large,l=e.alt,c=e.hideDownload,o=e.hideZoom,s=e.showRotate,u=e.imageBackgroundColor,d=this.state.modalOpen;return m.a.createElement("div",null,m.a.createElement("img",{className:t,style:{cursor:"pointer",maxWidth:"100%",maxHeight:"100%"},onClick:this.toggleModal,src:a,srcSet:n,alt:l}),d&&m.a.createElement(ya,{medium:i,large:r,alt:l,onClose:this.toggleModal,hideDownload:c,hideZoom:o,showRotate:s,imageBackgroundColor:u}))}}])&&va(a.prototype,n),i&&va(a,i),t}(d.Component),Sa=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadMailedFiles=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(o.a)(a),n=function(e){t.setState((function(t){return 1==e.current?{files:Object(T.a)(e.results),total:e.count,loadMoreFiles:e.next,loading:!1}:{files:[].concat(Object(T.a)(t.files),Object(T.a)(e.results)),loadMoreFiles:e.next,loading:!1}}))},i=function(){},r={mailed:!0,page:e,practice:a.props.active_practiceId};a.props.currentPatient&&(r.patient=a.props.currentPatient.id),a.props.showAllClinic&&a.props.currentPatient&&delete r.practice,Object(Y.c)(q.tc,n,i,r)},a.filterTags=function(e){var t=Object(o.a)(a);a.setState({filterSearchTag:e.target.value},(function(){t.loadData()}))},a.showModal=function(e){a.setState((function(){return{visible:!0,filesData:Object(A.a)({},e)}}))},a.handleCancel=function(){a.setState({visible:!1})},a.togglePDFModal=function(e){a.setState({showPDFFile:e})},a.updateFormValue=function(e,t){a.setState(Object(F.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendFiles=function(){a.mailModalOpen(),a.setState({mail_to:wt.get(a.props.currentPatient,"user.email")})},a.handleVisibleChange=function(){console.log("sdad"),a.setState({visibleTag:!a.state.visibleTag})},a.state={files:[],tags:[],showAddModal:!1,loading:!0,selectedFiles:{},selectedTags:{},filterSearchTag:null,showAddMedicalModel:!1,medicalCertificate:[],visible:!1,filesData:{},mailedfiles:[],visibleTag:!1},a.loadData=a.loadData.bind(Object(o.a)(a)),a.loadMedicalCertificate=a.loadMedicalCertificate.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentWillMount",value:function(){this.loadData(),this.loadTags(),this.loadMedicalCertificate()}},{key:"loadData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;this.setState({loading:!0});var a=function(e){t.setState((function(t){var a=null;if(1==e.current)return{files:e.results.map((function(e){return x()(e.created_at).format("YYYYMMDD")!=x()(a).format("YYYYMMDD")?(a=x()(e.created_at),Object(A.a)({},e,{newDate:!0})):Object(A.a)({},e,{newDate:!1})})),total:e.count,loadMoreFiles:e.next,loading:!1};var n=e.results.map((function(e){return x()(e.created_at).format("YYYYMMDD")!=x()(a).format("YYYYMMDD")?(a=x()(e.created_at),Object(A.a)({},e,{newDate:!0})):Object(A.a)({},e,{newDate:!1})}));return{files:[].concat(Object(T.a)(t.files),Object(T.a)(n)),loadMoreFiles:e.next,loading:!1}}))},n=function(){t.setState({loading:!1})},i={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(i.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete i.practice,this.state.filterSearchTag?i.tag=this.state.filterSearchTag:""==this.state.filterSearchTag&&(i.notag=!0),Object(Y.c)(q.qc,a,n,i)}},{key:"loadTags",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.fb,[this.props.active_practiceId]),(function(t){e.setState({tags:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"loadMedicalCertificate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;t.setState({loading:!0});var a=function(e){1==e.current?t.setState({total:e.count,medicalCertificate:e.results,loading:!1,loadMoreCertificate:e.next}):t.setState((function(t){return{total:e.count,medicalCertificate:[].concat(Object(T.a)(t.medicalCertificate),Object(T.a)(e.results)),loading:!1,loadMoreCertificate:e.next}}))},n=function(){t.setState({loading:!1})};this.props.currentPatient&&Object(Y.c)(Object(Y.f)(q.Tb,[this.props.active_practiceId,this.props.currentPatient.id,e]),a,n),this.props.showAllClinic&&this.props.currentPatient?Object(Y.c)(Object(Y.f)(q.i,[this.props.currentPatient.id,e]),a,n):Object(Y.c)(Object(Y.f)(q.i,[this.props.active_practiceId,e]),a,n)}},{key:"triggerAddModal",value:function(e){this.setState({showAddModal:!!e})}},{key:"triggerAddMedicalCertificateModal",value:function(e){this.setState({showAddMedicalModel:!!e})}},{key:"filesCompleteToggle",value:function(e,t){this.setState((function(a){var n=Object(A.a)({},a.selectedFiles);return t?n[e]=!!t:delete n[e],{selectedFiles:Object(A.a)({},n)}}))}},{key:"tagsCompleteToggle",value:function(e,t){this.setState((function(a){var n=Object(A.a)({},a.selectedTags);return t?n[e]=!!t:delete n[e],{selectedTags:Object(A.a)({},n)}}))}},{key:"filesWithTags",value:function(){var e=this,t={id:Object.keys(this.state.selectedFiles),file_tags:Object.keys(this.state.selectedTags),patient:this.props.match.params.id};Object(Y.j)(Object(Y.f)(q.qc,[this.props.match.params.id]),t,(function(){e.setState({selectedFiles:{},visibleTag:!1}),e.loadData()}),(function(){}))}},{key:"deleteMedicalCertificate",value:function(e){var t=this,a={is_active:!1,patient:e.patient,id:e.id};Object(Y.j)(Object(Y.f)(q.Tb,[t.props.active_practiceId]),a,(function(e){t.loadData(),t.loadMedicalCertificate()}),(function(){}))}},{key:"deleteFile",value:function(e){var t=this,a={id:e.id,patient:e.patient,is_active:!1};Object(Y.j)(Object(Y.f)(q.qc,[this.props.match.params.id]),a,(function(e){t.setState({showPDFFile:!1}),t.loadData()}),(function(){Object(Y.a)(H.Q,"Please Select Patient.")}))}},{key:"loadPDF",value:function(e){Object(Y.c)(Object(Y.f)(q.Ub,[e]),(function(e){e.report&&window.open(Tt.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=M.a.create()(U.a),n=[{key:"file_type",label:"File",type:H.Pb,required:!0},{key:"file_tags",label:"Tags",type:H.mb,options:this.state.tags.map((function(e){return{label:e.name,value:e.id}}))}],i={method:"post",successFn:function(){t.triggerAddModal(!1),t.loadData()},errorFn:function(){},action:Object(Y.f)(q.qc,[this.props.match.params.id])},r=m.a.createElement("div",{style:{boxShadow:"0 2px 4px #111",border:"1px solid #bbb",borderRadius:2,paddingBottom:"30px",backgroundColor:"white"}},m.a.createElement("ul",{style:{listStyle:"none",paddingInlineStart:0,paddingTop:10}},this.state.tags?m.a.createElement("div",null,this.state.tags.map((function(e){return m.a.createElement("li",{key:e.id},m.a.createElement(me.a,{value:e.id,onChange:function(a){return t.tagsCompleteToggle(e.id,a.target.checked)},checked:t.state.selectedTags[e.id]},e.name))}))):null),m.a.createElement("span",null,m.a.createElement(_.a,{type:"primary",onClick:function(){return e.filesWithTags()},style:{float:"right",borderStyle:"none"}},"Done"))),l=[{key:"is_active",value:!0},{key:"patient",value:this.props.currentPatient?this.props.currentPatient.id:null},{key:"practice",value:this.props.active_practiceId}];return m.a.createElement(j.a,{title:"Files",extra:this.props.match.params.id?m.a.createElement(_.a.Group,null,m.a.createElement(C.b,{to:"/patient/".concat(this.props.match.params.id,"/emr/create-medicalCertificate")},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"\xa0Add Medical Certificate")),m.a.createElement(Lt.a,{overlay:r,trigger:["click"],placement:"bottomLeft",onVisibleChange:t.handleVisibleChange,visible:t.state.visibleTag},m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"plus"}),"Add/Remove File Tags")),m.a.createElement(_.a,{onClick:function(){return e.triggerAddModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"),m.a.createElement(_.a,{style:{marginRight:"10px"},onClick:function(){return t.sendFiles()}},m.a.createElement(k.a,{type:"mail"})," \xa0 Send to patient")):m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{type:"primary",style:{marginRight:"10px"},onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"\xa0 Add Medical Certificate"),m.a.createElement(Lt.a,{overlay:r,trigger:["click"],placement:"bottomLeft",onVisibleChange:t.handleVisibleChange,visible:t.state.visibleTag},m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"plus"}),"Add/Remove File Tags")),m.a.createElement(_.a,{type:"primary",style:{marginRight:"10px"},onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"})," \xa0 Add"))},m.a.createElement(f.a,{gutter:8},m.a.createElement(g.a,{span:6,style:{height:"calc(100vh - 55px)",overflow:"auto",paddingRight:"10px",borderRight:"1px solid #ccc"}},m.a.createElement(D.a.Group,{buttonStyle:"solid",defaultValue:"all",onChange:this.filterTags},m.a.createElement("h2",null,"Uploaded Files"),m.a.createElement(D.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:null},"All Files"),this.state.tags.map((function(e){return m.a.createElement(D.a.Button,{key:e.id,style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:e.id},e.name)})),m.a.createElement(D.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:""},"Untagged Files"),m.a.createElement("p",null,m.a.createElement("br",null))),m.a.createElement(D.a.Group,{buttonStyle:"solid",defaultValue:""},m.a.createElement("h2",null,"Generated Files"),m.a.createElement(D.a.Button,{key:"0",style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:"a",onClick:function(){return e.loadMailedFiles()}},"Emailed Files"),m.a.createElement(D.a.Button,{key:"1",style:{width:"100%",backgroundColor:"transparent",border:"0px"},onClick:function(){return e.loadMedicalCertificate()}},"Medical Leave Certificate"))),m.a.createElement(g.a,{span:18},m.a.createElement(f.a,null,this.state.files.map((function(a){return m.a.createElement(m.a.Fragment,null,a.newDate?m.a.createElement(g.a,{span:24},m.a.createElement(Xe.a,{top:20,offsetTop:30},m.a.createElement("h2",{style:{marginLeft:"10px",padding:"5px",backgroundImage:"linear-gradient(to right, #ddd , white)",borderRadius:"4px"}},x()(a.created_at).format("LL")))):null,m.a.createElement(g.a,{span:8},m.a.createElement("div",{style:{width:"100%",height:"150px",border:"1px solid #bbb",backgroundSize:"cover",padding:"auto",overflow:"hidden"}},m.a.createElement(me.a,{key:a.id,disabled:a.practice!=e.props.active_practiceId,style:{margin:10,position:"absolute",top:5,left:5,boxShadow:"0 0px 5px #000 "},onChange:function(e){return t.filesCompleteToggle(a.id,e.target.checked)},checked:t.state.selectedFiles[a.id]}),Object(Y.b)(a.file_type)==Q.sb?m.a.createElement("div",{style:{textAlign:"center",paddingTop:30,height:"100%"},onClick:function(){return e.togglePDFModal(a)}},m.a.createElement(k.a,{type:"file-pdf",style:{fontSize:"56px",color:"#08c"}}),m.a.createElement("h4",null,"Preview Not Avaialable")):m.a.createElement(Ca,{style:{border:"3px solid red"},large:Object(Y.g)(a.file_type),small:Object(Y.g)(a.file_type),alt:m.a.createElement(_.a,{type:"danger",onClick:function(){return e.deleteFile(a)}},m.a.createElement(k.a,{type:"delete"}))})),m.a.createElement(j.a,{bodyStyle:{padding:3},style:{marginBottom:15}},m.a.createElement(C.b,{to:"/patient/".concat(a.patient_data.id,"/emr/files/")},m.a.createElement("h4",null,m.a.createElement("b",null,a.patient_data.user.first_name,"\xa0(",a.patient_data.custom_id,")"))),m.a.createElement(y.a,null,m.a.createElement("b",null,a.practice_data?a.practice_data.name:"--")))))}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:24},m.a.createElement(W.a,{loaderFunction:function(){return e.loadData(t.state.loadMoreFiles)},loading:this.state.loading,hidden:!this.state.loadMoreFiles}))),m.a.createElement(j.a,{title:"Medical Certificate"},m.a.createElement(b.a,{loading:this.state.loading,grid:{gutter:16,column:3},dataSource:this.state.medicalCertificate,renderItem:function(t){return m.a.createElement(j.a,{style:{width:600},actions:[m.a.createElement("p",null,"Issued on : ".concat(t.date)),m.a.createElement("a",{onClick:function(){return e.loadPDF(t.id)}},m.a.createElement(k.a,{type:"printer"})),m.a.createElement(E.a,{title:"Are you sure delete this item?",onConfirm:function(){return e.deleteMedicalCertificate(t)},okText:"Yes",cancelText:"No"},m.a.createElement(k.a,{type:"delete"}))]},m.a.createElement(Nt.a,{title:"".concat("Medical Leave #").concat(t.id),description:"Excused From :".concat(t.excused_duty_from," till ").concat(t.excused_duty_to)}))}}),m.a.createElement(W.a,{loaderFunction:function(){return e.loadData(t.state.loadMoreCertificate)},loading:this.state.loading,hidden:!this.state.loadMoreCertificate})))),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Timeline To ",wt.get(this.props.currentPatient,"user.first_name")," ?"),m.a.createElement(V.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),m.a.createElement(h.a,{visible:this.state.showAddModal,onCancel:function(){return e.triggerAddModal(!1)},footer:null},m.a.createElement(a,{title:"Add Files",fields:n,defaultValues:l,formProp:i})),m.a.createElement(h.a,{visible:this.state.showPDFFile,key:this.state.showPDFFile,centered:!0,width:1e3,onCancel:function(){return e.togglePDFModal(!1)},footer:null,style:{padding:0},title:m.a.createElement("h4",null,m.a.createElement("span",{style:{color:"red",textAlign:"right"},onClick:function(){return e.deleteFile(e.state.showPDFFile)}},"DELETE"))},this.state.showPDFFile?m.a.createElement("iframe",{src:Object(Y.g)(this.state.showPDFFile.file_type),frameBorder:"0",style:{width:"100%",minHeight:"80vh"}}):null))}}]),t}(m.a.Component),xa=(m.a.Component,a(287),a(288)),Ia=xa.a.TabPane,Da=["Complaints","Observations","Diagnoses","Investigations","Notes","Recent Medication"],Ma={Complaints:q.db,Observations:q.ib,Diagnoses:q.eb,Investigations:q.gb,Notes:q.kb,"Recent Medication":q.hb},wa=0,Ta=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).setInitialData=function(){var e=Object(o.a)(a),t=a.state.editClinicNotes;t.chief_complaints&&t.chief_complaints.split(Q.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Complaints",t)}),500)})),t.investigations&&t.investigations.split(Q.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Investigations",t)}),500)})),t.diagnosis&&t.diagnosis.split(Q.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Diagnoses",t)}),500)})),t.notes&&t.notes.split(Q.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Notes",t)}),500)})),t.observations&&t.observations.split(Q.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Observations",t)}),500)})),t.medication&&t.medication.split(Q.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Recent Medication",t)}),500)}))},a.loadRequiredResources=function(e,t){var n=Object(o.a)(a);Object(Y.c)(e,(function(e){n.setState((function(a){var n=Object(A.a)({},a.resourceList,Object(F.a)({},t,e));return{resourceList:n,filteredResourceList:n,filterStrings:{}}}))}),(function(){console.log("".concat(t," fetching error"))}))},a.add=function(e){var t=a.props.form,n=t.getFieldValue(e).concat(++wa);t.setFieldsValue(Object(F.a)({},e,n))},a.remove=function(e,t){var n=a.props.form,i=n.getFieldValue(e);1!==i.length&&n.setFieldsValue(Object(F.a)({},e,i.filter((function(e){return e!==t}))))},a.addValues=function(e,t){var n,i=a.props.form,r=i.getFieldValue(e),l=r.concat(++wa);i.setFieldsValue((n={},Object(F.a)(n,e,l),Object(F.a)(n,"field[".concat(r[r.length-1],"]"),t),n))},a.changeValues=function(e,t){var n=a.props.form.getFieldValue(e);n.indexOf(t)==n.length-1&&a.add(e)},a.toggleModal=function(e){var t=null,n=Object(o.a)(a);a.setState((function(a){return console.log(a.resourceAddModal),a.resourceAddModal&&(t=a.resourceAddModal),{resourceAddModal:e}}),(function(){t&&n.loadRequiredResources(Object(Y.f)(Ma[t],[n.props.active_practiceId]),t)}))},a.searchValues=function(e,t){var n=Object(o.a)(a);a.setState((function(a){var n=Object(A.a)({},a.searchStrings);return n[e]=t,{searchStrings:n}}),(function(){n.filterValues(e)}))},a.filterValues=function(e){a.setState((function(t){var a=[];return t.resourceList[e]&&(t.searchStrings[e]?t.resourceList[e].forEach((function(n){n.name&&n.name.toString().toLowerCase().includes(t.searchStrings[e].toLowerCase())&&a.push(n)})):a=t.resourceList[e]),{filteredResourceList:Object(A.a)({},t.filteredResourceList,Object(F.a)({},e,a))}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFieldsAndScroll((function(e,n){if(!e){var i={};i.chief_complaints=n.Complaints.map((function(e){return n.field[e]})).join(Q.r),i.investigations=n.Investigations.map((function(e){return n.field[e]})).join(Q.r),i.diagnosis=n.Diagnoses.map((function(e){return n.field[e]})).join(Q.r),i.notes=n.Notes.map((function(e){return n.field[e]})).join(Q.r),i.observations=n.Observations.map((function(e){return n.field[e]})).join(Q.r),i.medication=n["Recent Medication"].map((function(e){return n.field[e]})).join(Q.r),i.patient=t.props.match.params.id,i.practice=t.props.active_practiceId,i.doctor=t.state.selectedDoctor&&t.state.selectedDoctor.id?t.state.selectedDoctor.id:t.state.selectedDoctor,i.date=t.state.selectedDate&&x()(t.state.selectedDate).isValid()?x()(t.state.selectedDate).format("YYYY-MM-DD"):null,t.state.editClinicNotes&&(i.id=t.state.editClinicNotes.id);Object(Y.j)(Object(Y.f)(q.oc,[a.props.match.params.id]),i,(function(e){t.props.loadData&&t.props.loadData(),t.props.history&&t.props.history.replace("/patient/".concat(t.props.match.params.id,"/emr/clinicnotes/"))}),(function(){}))}}))},a.changeTab=function(e,t){},a.selectDoctor=function(e){a.setState({selectedDoctor:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.state={resourceList:{},filteredResourceList:{},filterStrings:{},practiceDoctors:[],selectedDoctor:{},selectedDate:x()(),resourceAddModal:null,selectedTab:"Complaints",editClinicNotes:a.props.editClinicNotes?a.props.editClinicNotes:null},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){Object(se.d)(this),this.loadRequiredResources(Object(Y.f)(q.db,[this.props.active_practiceId]),"Complaints"),this.loadRequiredResources(Object(Y.f)(q.ib,[this.props.active_practiceId]),"Observations"),this.loadRequiredResources(Object(Y.f)(q.eb,[this.props.active_practiceId]),"Diagnoses"),this.loadRequiredResources(Object(Y.f)(q.gb,[this.props.active_practiceId]),"Investigations"),this.loadRequiredResources(Object(Y.f)(q.kb,[this.props.active_practiceId]),"Notes"),this.loadRequiredResources(Object(Y.f)(q.hb,[this.props.active_practiceId]),"Recent Medication"),this.state.editClinicNotes&&this.setInitialData()}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,n=a.getFieldDecorator,i=a.getFieldValue,r={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},l={};Da.forEach((function(e){n(e,{initialValue:[++wa]}),l[e]=i(e)}));var c=l,o=M.a.create()(U.a);return m.a.createElement(j.a,null,m.a.createElement(f.a,null,m.a.createElement(g.a,{span:18},m.a.createElement("h2",null,"Clinical Notes"),m.a.createElement(M.a,{onSubmit:this.handleSubmit},Da.map((function(a){return m.a.createElement("div",null,m.a.createElement(v.a,{style:{margin:5}},a),m.a.createElement("div",{style:{backgroundColor:a==t.state.selectedTab?"#ddd":"initial",padding:10}},c[a].map((function(i,l){return m.a.createElement(M.a.Item,Object.assign({},r,{label:"".concat(a," ").concat(l+1),key:i}),n("field[".concat(i,"]"),{validateTrigger:["onChange","onBlur"],rules:[{whitespace:!0}]})(m.a.createElement(V.a,{placeholder:a,style:{width:"60%",marginRight:8},key:i,onFocus:function(e){return t.changeTab(e,a)},onChange:function(){return t.changeValues(a,i)}})),c[a].length-1!=l?m.a.createElement(_.a,{shape:"circle",type:"danger",size:"small",icon:"delete",onClick:function(){return e.remove(a,i)}}):null)}))))})),m.a.createElement(Xe.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement(f.a,null,m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(Lt.a,{placement:"topCenter",overlay:m.a.createElement(Pe.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Pe.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(L.a,{value:this.state.selectedDate,allowClear:!1,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY"}),m.a.createElement(_.a,{type:"primary",htmlType:"submit",style:{float:"right",margin:5}},"Save"),t.props.history?m.a.createElement(_.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null),m.a.createElement(f.a,null,"Next Follow up"))))),m.a.createElement(g.a,{span:6},m.a.createElement(xa.a,{type:"card"},Da.map((function(a){return m.a.createElement(Ia,{tab:a,key:a},m.a.createElement("div",{style:{padding:5}},m.a.createElement(_.a,{type:"primary",block:!0,size:"small",onClick:function(){return t.toggleModal(a)}},m.a.createElement(k.a,{type:"plus"}),"Add\xa0",a),m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(V.a.Search,{placeholder:"Search in ".concat(a," ..."),onChange:function(t){return e.searchValues(a,t.target.value)}})),m.a.createElement(b.a,{key:a,size:"small",dataSource:t.state.filteredResourceList[a],renderItem:function(t){return m.a.createElement(b.a.Item,{key:t.id,onClick:function(){return e.addValues(a,t.name)}},t.name)}})))})))),m.a.createElement(h.a,{visible:!!this.state.resourceAddModal,onCancel:function(){return t.toggleModal(null)},title:"Add ".concat(this.state.resourceAddModal),footer:null},this.state.resourceAddModal?m.a.createElement(o,{fields:[{label:this.state.resourceAddModal,required:!0,type:H.W,key:"name"}],defaultValues:[{key:"practice",value:this.props.active_practiceId}],formProp:{method:"post",action:Object(Y.f)(Ma[this.state.resourceAddModal],[this.props.active_practiceId]),successFn:function(){t.toggleModal(null),Object(Y.a)(H.Sb,"".concat(t.state.resourceAddModal," added successfully!!"))},errorFn:function(e){console.log(e)}}}):null)))}}]),t}(m.a.Component),Fa=M.a.create()(Ta),Aa=h.a.confirm,La=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).updateFormValue=function(e,t){a.setState(Object(F.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:wt.get(e,"patient.user.first_name"),clinicId:wt.get(e,"id"),mail_to:wt.get(e,"patient.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.clinicId,i={mail_to:t};Object(se.g)(Object(Y.f)(q.R,[n]),i),a.mailModalClose()},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,clinicNotes:[],editClinicNotes:null,loading:!0,mail_to:null},a.loadClinicNotes=a.loadClinicNotes.bind(Object(o.a)(a)),a.editClinicNotesData=a.editClinicNotesData.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadClinicNotes()}},{key:"loadClinicNotes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=function(e){t.setState((function(t){return 1==e.current?{clinicNotes:Object(T.a)(e.results),next:e.next,loading:!1}:{clinicNotes:[].concat(Object(T.a)(t.clinicNotes),Object(T.a)(e.results)),next:e.next,loading:!1}}))},n=function(){t.setState({loading:!1})},i={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(i.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete i.practice,Object(Y.c)(q.oc,a,n,i)}},{key:"editClinicNotesData",value:function(e){this.setState({editClinicNotes:e,loading:!1});var t=this.props.match.params.id;this.props.history.push("/patient/".concat(t,"/emr/clinicnotes/edit"))}},{key:"deleteClinicNote",value:function(e){var t=this;Aa({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a={id:e.id,patient:e.patient,is_active:!1};Object(Y.j)(Object(Y.f)(q.oc,[t.props.match.params.id]),a,(function(e){t.loadClinicNotes()}),(function(){}))},onCancel:function(){console.log("Cancel")}})}},{key:"loadPDF",value:function(e){Object(Y.c)(Object(Y.f)(q.R,[e]),(function(e){e.report&&window.open(Tt.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this;return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/clinicnotes/add",render:function(t){return m.a.createElement(Fa,Object.assign({},t,e.props,{loadData:e.loadClinicNotes}))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/clinicnotes/edit",render:function(a){return e.state.editClinicNotes?m.a.createElement(Fa,Object.assign({},e.state,a,{loadData:e.loadClinicNotes})):m.a.createElement(p.a,{to:"/patient/".concat(t.props.match.params.id,"/emr/clinicnotes/")})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," ClinicNotes"):"ClinicNotes",extra:m.a.createElement(_.a.Group,null,m.a.createElement(C.b,{to:"/patient/".concat(this.props.match.params.id,"/emr/clinicnotes/add")},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"Add")))}),this.state.clinicNotes.map((function(a){return m.a.createElement(j.a,{style:{marginTop:20},title:m.a.createElement("small",null,a.date?x()(a.date).format("ll"):null),extra:m.a.createElement(Lt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Pe.a,null,m.a.createElement(Pe.a.Item,{key:"1",onClick:function(){return t.editClinicNotesData(a)},disabled:a.practice&&a.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Pe.a.Item,{key:"2",onClick:function(){return t.deleteClinicNote(a)},disabled:a.practice&&a.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"3"},m.a.createElement(C.b,{to:"/patient/".concat(a.patient,"/emr/timeline")},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(a)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(a.id)}},m.a.createElement(k.a,{type:"printer"})))},m.a.createElement(h.a,{title:null,visible:e.state.visibleMail,onOk:e.sendMailToPatient,onCancel:e.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:e.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:e.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Clinical Notes To ",wt.get(a,"patient.user.first_name")," ?"),m.a.createElement(V.a,{value:e.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Complaints")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.chief_complaints?a.chief_complaints.split(Q.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Observations")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.observations?a.observations.split(Q.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Investigations")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.investigations?a.investigations.split(Q.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Diagnoses")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.diagnosis?a.diagnosis.split(Q.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Notes")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.notes?a.notes.split(Q.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Recent Medications")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.medication?a.medication.split(Q.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement("div",null,a.doctor?m.a.createElement(y.a,{color:a.doctor?a.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  ".concat(a.doctor.user.first_name)," ")):null,a.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,a.practice.name," "))):null))})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(W.a,{loaderFunction:function(){return e.loadClinicNotes(t.state.next)},loading:this.state.loading,hidden:!this.state.next}))))):m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," Clinic Notes"):"Clinic Notes",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))}),this.state.clinicNotes.map((function(a){return m.a.createElement(j.a,{style:{marginTop:10},key:a.id,extra:m.a.createElement(Lt.a.Button,{size:"small",overlay:m.a.createElement(Pe.a,null,m.a.createElement(Pe.a.Item,{key:"1",onClick:function(){return t.editClinicNotesData(a)},disabled:a.practice&&a.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Pe.a.Item,{key:"2",onClick:function(){return t.deleteClinicNote(a)},disabled:a.practice&&a.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"3"},m.a.createElement(C.b,{to:"/patient/".concat(a.patient,"/emr/timeline")},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(a)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(a.id)}},m.a.createElement(k.a,{type:"printer"}))),title:m.a.createElement("div",null,m.a.createElement("small",null,a.date?x()(a.date).format("ll"):null,m.a.createElement(C.b,{to:"/patient/".concat(a.patient.id,"/emr/clinicnotes")},"\xa0\xa0 ",a.patient.user?a.patient.user.first_name:null," (ID: ",a.patient.custom_id?a.patient.custom_id:a.patient.id,")\xa0"),m.a.createElement("span",null,", ",a.patient.gender)))},m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Complaints")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.chief_complaints?a.chief_complaints.split(Q.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Observations")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.observations?a.observations.split(Q.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Investigations")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.investigations?a.investigations.split(Q.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Diagnoses")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.diagnosis?a.diagnosis.split(Q.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Notes")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.notes?a.notes.split(Q.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Recent Medications")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.medication?a.medication.split(Q.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement("div",null,a.doctor?m.a.createElement(y.a,{color:a.doctor?a.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  ".concat(a.doctor.user.first_name)," ")):null,a.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,a.practice.name," "))):null))})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(W.a,{loaderFunction:function(){return e.loadClinicNotes(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Clinical Notes To ",t.state.patientName," ?"),m.a.createElement(V.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})))}}]),t}(m.a.Component),Va=(a(527),a(529)),Na=u.a.Header,Ra=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.refreshWallet&&this.props.refreshWallet()}},{key:"render",value:function(){var e=this,t=this;return m.a.createElement(Na,{className:"header",style:{background:"#e4e4e4",padding:"0px 20px"}},m.a.createElement("div",null,this.props.currentPatient?m.a.createElement("div",{style:{display:"inline"}},m.a.createElement("div",{style:{display:"inline",textSize:"15px"}},m.a.createElement(Se.a,{title:"Switch Back to All Patients"},m.a.createElement(_.a,{onClick:function(){return e.props.setCurrentPatient(null)},type:"primary",ghost:!0},m.a.createElement(k.a,{type:"arrow-left"})))),m.a.createElement("a",{style:{padding:"8px",fontSize:"15px"},onClick:function(){return e.props.togglePatientListModal(!0)}},this.props.currentPatient.image?m.a.createElement(P.a,{src:Object(Y.g)(this.props.currentPatient.image)}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"}},this.props.currentPatient.user.first_name?this.props.currentPatient.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),"\xa0\xa0",t.props.currentPatient.user.first_name.length<16?t.props.currentPatient.user.first_name:"".concat(t.props.currentPatient.user.first_name.slice(0,12),"..."),m.a.createElement("small",null,m.a.createElement("i",null,m.a.createElement("b",null," [ID: ",t.props.currentPatient.custom_id?t.props.currentPatient.custom_id:t.props.currentPatient.id,"]")))),this.props.MedicalMembership?m.a.createElement(fe.a,{placement:"rightTop",title:"Patient Membership",content:m.a.createElement("div",null,m.a.createElement("p",null,m.a.createElement("strong",null,"Membership Code : "),m.a.createElement("span",null,this.props.MedicalMembership.membership_code)),m.a.createElement("p",null,m.a.createElement("strong",null,"Start Date : "),m.a.createElement("span",null,this.props.MedicalMembership.medical_from)),m.a.createElement("p",null,m.a.createElement("strong",null,"Valid Till : "),m.a.createElement("span",null,this.props.MedicalMembership.medical_to)))},m.a.createElement("div",{style:{display:"inline",maxWidth:50,fontSize:30,lineHeight:"40px"}},m.a.createElement(k.a,{type:"crown",theme:"twoTone",twoToneColor:"#FFBA3A"}))):null,m.a.createElement(fe.a,{placement:"topLeft",title:"Medical History",content:m.a.createElement("div",{style:{width:250}},t.props.currentPatient.medical_history_data?t.props.currentPatient.medical_history_data.map((function(e,t){return m.a.createElement(y.a,{color:"#".concat(Object(se.b)(Object(se.a)(e.name)))},e.name)})):null)},t.props.currentPatient.medical_history_data?t.props.currentPatient.medical_history_data.map((function(e,a){return a>0?1==a&&m.a.createElement(y.a,null,"+",t.props.currentPatient.medical_history_data.length-1):m.a.createElement(y.a,{color:"#".concat(Object(se.b)(Object(se.a)(e.name)))},e.name)})):null),m.a.createElement(Va.a,{style:{marginLeft:20},checked:this.props.showAllClinic,onChange:function(t){return e.props.toggleShowAllClinic(t)},checkedChildren:"All Clinics",unCheckedChildren:"Current Clinic"}),this.props.pendingAmount?m.a.createElement(m.a.Fragment,null,m.a.createElement(_.a,{style:{marginLeft:"20px"},type:"primary",size:"small"},m.a.createElement(C.b,{to:"/patient/".concat(this.props.currentPatient.id,"/billing/payments/add")},"Pay!")),m.a.createElement(fe.a,{placement:"rightTop",content:m.a.createElement(b.a,{size:"small",dataSource:this.props.pendingAmount.practice_data,renderItem:function(e){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:e.name,description:"Rs. ".concat(e.total<0?"".concat(-1*e.total," (Advance)"):e.total)}))}}),title:"Pending Payments"},m.a.createElement("div",{style:{display:"inline",float:"left",maxWidth:200,position:"absolute",margin:"5px 15px",zIndex:5}},m.a.createElement(O.a,{title:"Amount Due",value:this.props.pendingAmount.grand_total,valueStyle:{color:this.props.pendingAmount.grand_total>0?"#cf1322":"initial",fontWeight:500,fontSize:20},precision:2})))):null,this.props.walletAmount&&this.props.walletAmount.length?m.a.createElement(fe.a,{placement:"rightTop",title:"Agent Wallet Amount",content:m.a.createElement("p",null,"Non-Refundable : ",this.props.walletAmount[0].non_refundable)},m.a.createElement("div",{style:{display:"inline",float:"left",maxWidth:400,position:"absolute",paddingLeft:150,margin:"20px 15px"}},m.a.createElement(O.a,{tile:"wallet",value:this.props.walletAmount[0].refundable_amount+this.props.walletAmount[0].non_refundable,precision:2,valueStyle:{fontSize:20},prefix:m.a.createElement(k.a,{type:"wallet",twoToneColor:"#a2711c"})}))):null):m.a.createElement("a",{style:{padding:"8px",fontSize:"20px"},onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement("div",{style:{display:"inline"}},m.a.createElement(k.a,{type:"solution"})," \xa0 All Patient")),m.a.createElement(Lt.a,{overlay:se.f},m.a.createElement(_.a,{style:{float:"right",margin:"15px"}},m.a.createElement(k.a,{type:"setting"})," Settings ",m.a.createElement(k.a,{type:"down"}))),t.props.activePracticePermissions.AddPatient||t.props.allowAllPermissions?m.a.createElement(C.b,{to:"/patients/profile/add"},m.a.createElement(_.a,{type:"primary",style:{float:"right",margin:"15px"}},m.a.createElement(k.a,{type:"plus"})," Add Patient")):null),m.a.createElement(h.a,{width:1300,maskClosable:!1,centered:!0,footer:null,closable:!1,visible:this.props.listModalVisible,style:{height:"calc(100vh - 120px)"}},m.a.createElement(_.a,{icon:"close",type:"danger",shape:"circle",style:{position:"absolute",top:"-50px",right:0},onClick:function(){return e.props.togglePatientListModal(!1)}}),m.a.createElement(ne,this.props)))}}]),t}(m.a.Component),Ba=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).onChanged=function(e,t){a.setState(Object(F.a)({},e,t))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var i=Object(A.a)({},n,{medicine_till:x()(n.medicine_till).format("YYYY-MM-DD"),follow_up_date:x()(n.follow_up_date).format("YYYY-MM-DD")});t.setState({saving:!0});Object(Y.l)(Object(Y.f)(q.xc,[a.props.currentPatient.id]),i,(function(e){Object(Y.a)(H.Sb,"Communication Settings Saved Successfully!!"),t.setState({saving:!1})}),(function(){t.setState({saving:!1})}))}}))},a.state={parient_communication_history:null,patientProfile:null,saving:!1},a.loadCommunication=a.loadCommunication.bind(Object(o.a)(a)),a.loadProfile=a.loadProfile.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.currentPatient&&(this.loadCommunication(),this.loadProfile())}},{key:"loadProfile",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.xc,[e.props.match.params.id]),(function(t){e.setState({patientProfile:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"loadCommunication",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.pc,[this.props.currentPatient.user.id]),(function(t){e.setState({parient_communication_history:t.user_sms,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a={labelCol:{xs:{span:8},sm:{span:8},md:{span:8},lg:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16},md:{span:16},lg:{span:16}}},n=[{title:"SENT TIME",dataIndex:"created_at",key:"created_at",render:function(e){return m.a.createElement("span",null,x()(e).format("LLL"))}},{title:"MESSAGE",dataIndex:"body",key:"body"},{title:"TYPE",dataIndex:"sms_type",key:"sms_type"},{title:"MESSAGE STATUS",dataIndex:"status",key:"status"}],i=Q.Eb.map((function(e){return m.a.createElement(D.a,{value:e.value},e.title)})),r=Q.B.map((function(e){return m.a.createElement(D.a,{value:e.value},e.title)})),l=Q.j.map((function(e){return m.a.createElement(D.a,{value:e.value},e.title)}));return m.a.createElement(M.a,{onSubmit:this.handleSubmit},m.a.createElement(j.a,{title:this.props.currentPatient?"".concat(this.props.currentPatient.user.first_name," Communication"):"Patient Communication",extra:m.a.createElement(_.a,{type:"primary",htmlType:"submit",loading:this.state.saving},m.a.createElement(k.a,{type:"save"})," Save Communication Setting")},m.a.createElement(M.a.Item,Object.assign({},a,{key:"sms_enable"})," ",m.a.createElement("label",null,m.a.createElement("span",{className:"ant-form-text"},"Enable SMS the patient : "),t("sms_enable",{initialValue:!!this.state.patientProfile&&this.state.patientProfile.sms_enable})(m.a.createElement(D.a.Group,{onChange:function(t){return e.onChanged("sms_enable",t.target.value)}},i)))),m.a.createElement(M.a.Item,Object.assign({},a,{key:"email_enable"})," ",m.a.createElement("label",null," ",m.a.createElement("span",{className:"ant-form-text"},"Enable Email the patient :"),t("email_enable",{initialValue:!!this.state.patientProfile&&this.state.patientProfile.email_enable})(m.a.createElement(D.a.Group,{onChange:function(t){return e.onChanged("email_enable",t.target.value)}},r)))),m.a.createElement(M.a.Item,Object.assign({},a,{key:"birthday_sms_email"})," ",m.a.createElement("label",null," ",m.a.createElement("span",{className:"ant-form-text"}," Send Birthday wish SMS & Email :"),t("birthday_sms_email",{initialValue:!!this.state.patientProfile&&this.state.patientProfile.birthday_sms_email})(m.a.createElement(D.a.Group,{onChange:function(t){return e.onChanged("birthday_sms_email",t.target.value)}},l)))),m.a.createElement(M.a.Item,Object.assign({},a,{key:"medicine_till"})," ",m.a.createElement("label",null,m.a.createElement("span",{className:"ant-form-text"}," Medicine Till Date :"),t("medicine_till",{initialValue:this.state.patientProfile&&this.state.patientProfile.medicine_till?x()(this.state.patientProfile.medicine_till):x()()})(m.a.createElement(L.a,{allowClear:!1,format:"YYYY-MM-DD"})))),m.a.createElement(M.a.Item,Object.assign({},a,{key:"medicine_till"})," ",m.a.createElement("label",null,m.a.createElement("span",{className:"ant-form-text"}," Next follow-up To :"),t("follow_up_date",{initialValue:this.state.patientProfile&&this.state.patientProfile.follow_up_date?x()(this.state.patientProfile.follow_up_date):x()()})(m.a.createElement(L.a,{allowClear:!1,format:"YYYY-MM-DD"})))),m.a.createElement("div",null,m.a.createElement(v.a,{dashed:!0}),m.a.createElement("h2",null,"Past Communication"),m.a.createElement(G.a,{loading:this.state.loading,columns:n,dataSource:this.state.parient_communication_history}))))}}]),t}(m.a.Component),za=M.a.create()(Ba),Ya=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return m.a.createElement(za,Object.assign({},this.state,this.props))}}]),t}(m.a.Component),qa=a(258),Wa=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={redirect:!1,vitalSign:null,editVitalSign:a.props.editVitalSign?a.props.editVitalSign:null},a.changeRedirect=a.changeRedirect.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"render",value:function(){var e,t=this,a=[{label:"Pulse",key:"pulse",initialValue:this.props.editVitalSign?this.props.editVitalSign.pulse:null,type:H.pb,follow:"BPM"},{label:"Temperature",key:"temperature",initialValue:this.props.editVitalSign?this.props.editVitalSign.temperature:null,type:H.pb,follow:"Fahrenheit"},{label:"Temperature Part",key:"temperature_part",type:H.Nb,initialValue:this.props.editVitalSign?this.props.editVitalSign.temperature_part:null,options:[{label:"forehead",value:"forehead"},{label:"armpit",value:"armpit"},{label:"oral ",value:"oral"}]},{label:"Blood Pressure Up",key:"blood_pressure_up",initialValue:this.props.editVitalSign?this.props.editVitalSign.blood_pressure_up:null,type:H.pb,follow:"mmhg"},{label:"Blood Pressure Down",key:"blood_pressure_down",initialValue:this.props.editVitalSign?this.props.editVitalSign.blood_pressure_down:null,type:H.pb,follow:"mmhg"},{label:"Position",key:"position",type:H.Nb,initialValue:this.props.editVitalSign?this.props.editVitalSign.position:null,options:[{label:"standing",value:"standing"},{label:"sitting",value:"sitting"}]},{label:"Weight",key:"weight",initialValue:this.props.editVitalSign?this.props.editVitalSign.weight:null,type:H.pb,follow:"kg."},{label:"Resp Rate",key:"resp_rate",initialValue:this.props.editVitalSign?this.props.editVitalSign.resp_rate:null,type:H.pb,follow:"breaths/min"},{label:"Creatinine Level",key:"creatinine",initialValue:this.props.editVitalSign?this.props.editVitalSign.creatinine:null,type:H.pb},{label:"Haemoglobin Level",key:"haemoglobin",initialValue:this.props.editVitalSign?this.props.editVitalSign.haemoglobin:null,type:H.pb},{label:"Urea Level",key:"urea",initialValue:this.props.editVitalSign?this.props.editVitalSign.urea:null,type:H.pb},{label:"Uric Acid Level",key:"uric_acid",initialValue:this.props.editVitalSign?this.props.editVitalSign.uric_acid:null,type:H.pb},{label:"Date",key:"date",initialValue:this.props.editVitalSign&&this.props.editVitalSign.date?this.props.editVitalSign.date:x()(),type:H.K,required:!0}],n=[{key:"patient",value:this.props.match.params.id},{key:"practice",value:this.props.active_practiceId}],i=this,r=M.a.create()(U.a);this.state.editVitalSign&&(e={successFn:function(e){Object(Y.a)(H.Sb,"success"),i.props.loadData&&i.props.loadData(),i.props.history&&i.props.history.replace("/patient/".concat(i.props.match.params.id,"/emr/vitalsigns"))},errorFn:function(){},action:Object(Y.f)(q.Od,[this.props.match.params.id]),method:"post"},n.push({key:"id",value:this.state.editVitalSign.id}));var l={successFn:function(e){Object(Y.a)(H.Sb,"success"),i.props.loadData&&i.props.loadData(),i.props.history&&i.props.history.replace("/patient/".concat(i.props.match.params.id,"/emr/vitalsigns"))},errorFn:function(){},action:Object(Y.f)(q.Od,[this.props.match.params.id]),method:"post"};return m.a.createElement(f.a,null,m.a.createElement(j.a,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/vitalsigns/edit",render:function(){return t.state.editVitalSign?m.a.createElement(r,{defaultValues:n,title:"Edit Report Manual",changeRedirect:t.changeRedirect,formProp:e,fields:a}):m.a.createElement(p.a,{to:"/patients/profile"})}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/vitalsigns/add",render:function(){return m.a.createElement(r,{title:"Add Report Manual",defaultValues:n,changeRedirect:t.changeRedirect,formProp:l,fields:a})}})),this.state.redirect&&m.a.createElement(p.a,{to:"/patient/".concat(this.props.match.params.id,"/emr/vitalsigns")}))}}]),t}(m.a.Component),Ga=h.a.confirm,Ha=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).deleteVitalSign=function(e){var t=Object(o.a)(a);Ga({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a=Object(A.a)({},e,{is_active:!1});Object(Y.j)(Object(Y.f)(q.Od,[e.patient]),a,(function(e){t.loadVitalsigns(),Object(Y.a)(H.Sb,"Deleted Successfully!!")}),(function(){}))},onCancel:function(){console.log("Cancel")}})},a.editObject=function(e){if(a.setState({editVitalSign:e,loading:!1}),a.props.match.params.id){var t=a.props.match.params.id;a.props.history.push("/patient/".concat(t,"/emr/vitalsigns/edit"))}else a.props.history.push("/patient/".concat(e.patient,"/emr/vitalsigns"))},a.updateFormValue=function(e,t){a.setState(Object(F.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:wt.get(e,"patient_data.user.first_name"),reportManualId:wt.get(e,"id"),mail_to:wt.get(e,"patient_data.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.reportManualId,i={mail_to:t};Object(se.g)(Object(Y.f)(q.Pd,[n]),i),a.mailModalClose()},a.state={currentPatient:a.props.currentPatient,vitalsign:[],loading:!0},a.loadVitalsigns=a.loadVitalsigns.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadVitalsigns()}},{key:"loadVitalsigns",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=function(e){t.setState((function(t){return 1==e.current?{vitalsign:Object(T.a)(e.results),next:e.next,loading:!1}:{vitalsign:[].concat(Object(T.a)(t.vitalsign),Object(T.a)(e.results)),next:e.next,loading:!1}}))},n=function(){},i={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(i.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete i.practice,Object(Y.c)(q.Od,a,n,i)}},{key:"loadPDF",value:function(e){Object(Y.c)(Object(Y.f)(q.Pd,[e]),(function(e){e.report&&window.open(Tt.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=(this.state.vitalsign,[{title:"Date",dataIndex:"date",key:"date",render:function(e,t){return m.a.createElement("span",null,t.date?x()(t.date).format("LL"):"")}},{title:"Temp(F)",key:"temperature",render:function(e,t){return m.a.createElement("span",null," ",t.temperature,m.a.createElement("br",null),",",t.temperature_part)}},{title:"Pulse (BPM)",dataIndex:"pulse",key:"pulse"},{title:"RR breaths/min",dataIndex:"resp_rate",key:"resp_rate"},{title:"SYS/DIA mmhg",key:"address",render:function(e,t){return m.a.createElement("span",null," ",t.blood_pressure_up,"/",t.blood_pressure_down,m.a.createElement("br",null),",",t.position)}},{title:"WEIGHT kg",dataIndex:"weight",key:"weight"},{title:"Creatinine Level",key:"creatinine",dataIndex:"creatinine"},{title:"Haemoglobin Level",key:"haemoglobin",dataIndex:"haemoglobin"},{title:"Urea Level",key:"urea",dataIndex:"urea"},{title:"Uric Acid Level",key:"uric_acid",dataIndex:"uric_acid"},{title:"Action",key:"action",render:function(a,n){return m.a.createElement("span",null,m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},"Print"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{onClick:function(){return e.editObject(n)},disabled:n.practice!=t.props.active_practiceId},"Edit"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{onClick:function(){return t.deleteVitalSign(n)},disabled:n.practice!=t.props.active_practiceId},"Delete"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{onClick:function(){return t.sendPatientMail(n)}},"Send to patient"))}}]);return this.props.match.params.id?m.a.createElement(p.d,null,m.a.createElement(p.b,{path:"/patient/:id/emr/vitalsigns/add",render:function(t){return m.a.createElement(Wa,Object.assign({},e.props,{key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t,{loadData:e.loadVitalsigns}))}}),m.a.createElement(p.b,{path:"/patient/:id/emr/vitalsigns/edit",render:function(t){return m.a.createElement(Wa,Object.assign({},e.props,{key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t,{loadData:e.loadVitalsigns}))}}),m.a.createElement(p.b,null,m.a.createElement(j.a,{title:this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," Report Manual"):"Patient Report Manual",extra:m.a.createElement(_.a.Group,null,m.a.createElement(C.b,{to:"/patient/".concat(this.props.match.params.id,"/emr/vitalsigns/add")},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"Add")))},m.a.createElement(xa.a,null,m.a.createElement(xa.a.TabPane,{tab:"Charts",key:1,style:{margin:"auto"}},m.a.createElement(v.a,null,"Pulse Chart (bpm)"),m.a.createElement("div",{style:{height:200}},m.a.createElement(qa.k,null,m.a.createElement(qa.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement(qa.n,{dataKey:"date",tickFormatter:function(e){return x()(e).format("LL")},tickCount:t.state.vitalsign.length}),m.a.createElement(qa.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(qa.b,{strokeDasharray:"3 3"}),m.a.createElement(qa.m,{labelFormatter:function(e){return e&&x()(e).isValid()?x()(e).format("LL"):"--"}}),m.a.createElement(qa.g,{type:"monotone",dataKey:"pulse",stroke:"#8884d8",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Temperature (F)"),m.a.createElement("div",{style:{height:200}},m.a.createElement(qa.k,null,m.a.createElement(qa.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement(qa.f,{verticalAlign:"top",height:36}),m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(qa.n,{dataKey:"date",tickFormatter:function(e){return x()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(qa.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(qa.b,{strokeDasharray:"3 3"}),m.a.createElement(qa.m,{labelFormatter:function(e){return e&&x()(e).isValid()?x()(e).format("LL"):"--"}}),m.a.createElement(qa.g,{type:"monotone",dataKey:"temperature",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Blood Pressure (mmhg)"),m.a.createElement("div",{style:{height:200}},m.a.createElement(qa.k,null,m.a.createElement(qa.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#ffc658",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#ffc658",stopOpacity:0}))),m.a.createElement(qa.n,{dataKey:"date",tickFormatter:function(e){return x()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(qa.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(qa.b,{strokeDasharray:"3 3"}),m.a.createElement(qa.m,{labelFormatter:function(e){return e&&x()(e).isValid()?x()(e).format("LL"):"--"}}),m.a.createElement(qa.g,{type:"monotone",dataKey:"blood_pressure_up",stroke:"#ffc658",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"}),m.a.createElement(qa.g,{type:"monotone",dataKey:"blood_pressure_down",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Weight (kg)"),m.a.createElement("div",{style:{height:200}},m.a.createElement(qa.k,null,m.a.createElement(qa.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#8884d8",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#8884d8",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(qa.n,{dataKey:"date",tickFormatter:function(e){return x()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(qa.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(qa.b,{strokeDasharray:"3 3"}),m.a.createElement(qa.m,{labelFormatter:function(e){return e&&x()(e).isValid()?x()(e).format("LL"):"--"}}),m.a.createElement(qa.g,{type:"monotone",dataKey:"weight",stroke:"#8884d8",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Respiratory Rate (breaths/min)"),m.a.createElement("div",{style:{height:200}},m.a.createElement(qa.k,null,m.a.createElement(qa.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(qa.n,{dataKey:"date",tickFormatter:function(e){return x()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(qa.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(qa.b,{strokeDasharray:"3 3"}),m.a.createElement(qa.m,{labelFormatter:function(e){return e&&x()(e).isValid()?x()(e).format("LL"):"--"}}),m.a.createElement(qa.g,{type:"monotone",dataKey:"resp_rate",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Creatinine Level"),m.a.createElement("div",{style:{height:200}},m.a.createElement(qa.k,null,m.a.createElement(qa.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(qa.n,{dataKey:"date",tickFormatter:function(e){return x()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(qa.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(qa.b,{strokeDasharray:"3 3"}),m.a.createElement(qa.m,{labelFormatter:function(e){return e&&x()(e).isValid()?x()(e).format("LL"):"--"}}),m.a.createElement(qa.g,{type:"monotone",dataKey:"creatinine",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Haemoglobin Level"),m.a.createElement("div",{style:{height:200}},m.a.createElement(qa.k,null,m.a.createElement(qa.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(qa.n,{dataKey:"date",tickFormatter:function(e){return x()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(qa.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(qa.b,{strokeDasharray:"3 3"}),m.a.createElement(qa.m,{labelFormatter:function(e){return e&&x()(e).isValid()?x()(e).format("LL"):"--"}}),m.a.createElement(qa.g,{type:"monotone",dataKey:"haemoglobin",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Urea Level"),m.a.createElement("div",{style:{height:200}},m.a.createElement(qa.k,null,m.a.createElement(qa.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(qa.n,{dataKey:"date",tickFormatter:function(e){return x()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(qa.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(qa.b,{strokeDasharray:"3 3"}),m.a.createElement(qa.m,{labelFormatter:function(e){return e&&x()(e).isValid()?x()(e).format("LL"):"--"}}),m.a.createElement(qa.g,{type:"monotone",dataKey:"urea",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Uric Acid Level"),m.a.createElement("div",{style:{height:200}},m.a.createElement(qa.k,null,m.a.createElement(qa.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(qa.n,{dataKey:"date",tickFormatter:function(e){return x()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(qa.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(qa.b,{strokeDasharray:"3 3"}),m.a.createElement(qa.m,{labelFormatter:function(e){return e&&x()(e).isValid()?x()(e).format("LL"):"--"}}),m.a.createElement(qa.g,{type:"monotone",dataKey:"uric_acid",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"}))))),m.a.createElement(xa.a.TabPane,{tab:"Details",key:2},m.a.createElement(G.a,{columns:a,pagination:!1,dataSource:this.state.vitalsign}),m.a.createElement(W.a,{loaderFunction:function(){return e.loadInvoices(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Report Manual To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}}))))))):m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," Report Manual"):"Patients Report Manual",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{type:"primary",onClick:function(){return t.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))}),this.state.vitalsign.map((function(e){return m.a.createElement("div",null,m.a.createElement(j.a,{style:{marginTop:10},title:m.a.createElement("small",null,e.date?x()(e.date).format("ll"):null,m.a.createElement(C.b,{to:"/patient/".concat(e.patient_data.id,"/emr/vitalsigns")},"\xa0\xa0 ",e.patient_data.user?e.patient_data.user.first_name:null," (ID: ",e.patient_data.custom_id?e.patient_data.custom_id:e.patient_data.id,")\xa0"),m.a.createElement("span",null,", ",e.patient_data.gender)),bodyStyle:{padding:0}},m.a.createElement(_e.a,{columns:a,pagination:!1,dataSource:[e],footer:function(){return function(e){if(e)return console.log(e),m.a.createElement("div",null,e.doctor?m.a.createElement(y.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  ".concat(e.doctor.user.first_name)," ")):null,e.practice_data?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null);return null}(e)}})))})),m.a.createElement(W.a,{loaderFunction:function(){return e.loadVitalsigns(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Report Manual  To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})))}}]),t}(m.a.Component);var Ua=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).calculateItem=function(e){a.props.form.getFieldsValue;a.setState((function(e){Object(T.a)(e.tableFormValues).forEach((function(e){}))}))},a.addNotes=function(e,t){a.setState((function(a){return{addNotes:Object(A.a)({},a.addNotes,Object(F.a)({},e,!!t))}}))},a.removeTreatment=function(e){a.setState((function(t){return{tableFormValues:Object(T.a)(Object(wt.remove)(t.tableFormValues,(function(t){return t._id!=e})))}}))},a.add=function(e){Object(o.a)(a);a.setState((function(t){var a=Math.random().toFixed(7);return{addNotes:Object(A.a)({},t.addNotes,Object(F.a)({},a,!!e.default_notes)),tableFormValues:[Object(A.a)({},e,{_id:a})].concat(Object(T.a)(t.tableFormValues))}}),(function(){}))},a.selectDoctor=function(e){a.setState({selectedDoctor:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(!e){var n={treatment_plans:[],patient:t.props.match.params.id,doctor:t.state.selectedDoctor.id,date:t.state.selectedDate&&x()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null,practice:t.props.active_practiceId};t.props.editId&&(n.id=t.props.editTreatmentPlan.id),t.state.tableFormValues.forEach((function(e){e.quantity=a.quantity[e._id],e.cost=a.cost[e._id],e.discount=a.discount[e._id],a.notes&&(e.notes=a.notes[e._id]);var t={procedure:e.id,cost:e.cost,quantity:e.quantity,margin:e.margin,default_notes:e.notes,is_active:!0,is_completed:!0,discount:e.discount,discount_type:"%"};n.treatment_plans.push(t)}));Object(Y.j)(Object(Y.f)(q.Gd,[t.props.match.params.id]),n,(function(e){Object(Y.a)("Inventory updated successfully"),t.props.loadData&&t.props.loadData();var a="/patient/".concat(t.props.match.params.id,"/emr/workdone");t.props.history.replace(a)}),(function(){}))}}))},a.searchValues=function(e){var t=Object(o.a)(a);return a.setState((function(t){return{searchString:e}}),(function(){t.loadProcedures()})),!1},a.state={loadingProcedures:!0,procedure_category:[],tableFormValues:[],addNotes:{},practiceDoctors:[],selectedDoctor:{},selectedDate:x()()},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.editId&&this.setState((function(e){var t=[];return this.props.editTreatmentPlan.treatment_plans.forEach((function(e){var a=Math.random().toFixed(7);t.push(Object(A.a)({},e,{},e.procedure,{_id:a}))})),Object(A.a)({},this.props.editTreatmentPlan,{tableFormValues:t,selectedDate:x()(this.props.editTreatmentPlan.date),selectedDoctor:this.props.editTreatmentPlan.doctor})})),this.loadProcedures(),Object(se.d)(this)}},{key:"loadProcedures",value:function(){var e=this,t={};this.state.searchString&&(t.name=this.state.searchString),e.setState({loadingProcedures:!0});Object(Y.c)(Object(Y.f)(q.Lc,[this.props.active_practiceId]),(function(a){t.name&&e.state.searchString!=t.name||e.setState({loadingProcedures:!1,filteredItems:a.results})}),(function(){e.setState({loadingProcedures:!1})}),t)}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,n=a.getFieldDecorator,i=(a.getFieldValue,a.getFieldsValue,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}}),r=[{title:"Treatments",dataIndex:"name",key:"name",render:function(t,a){return m.a.createElement("span",null,m.a.createElement("b",null,t),m.a.createElement("br",null),e.state.addNotes[a._id]||e.props.editId?m.a.createElement(M.a.Item,Object.assign({key:"default_notes[".concat(a._id,"]")},i),n("notes[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.default_notes})(m.a.createElement(V.a.TextArea,{min:0,placeholder:"Notes..."}))):m.a.createElement("a",{onClick:function(){return e.addNotes(a._id,!0)}},"+ Add Note"))}},{title:"Quantity",dataIndex:"quantity",key:"quantity",render:function(t,a){return m.a.createElement(M.a.Item,Object.assign({key:"quantity[".concat(a._id,"]")},i),n("quantity[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:a.quantity})(m.a.createElement(I.a,{min:0,placeholder:"Quantity",size:"small",onChange:function(){return e.calculateItem(a._id)}})))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(t,a){return m.a.createElement(M.a.Item,Object.assign({key:"cost[".concat(a._id,"]")},i),n("cost[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:a.cost})(m.a.createElement(I.a,{min:0,placeholder:"Cost",size:"small",onChange:function(){return e.calculateItem(a._id)}})))}},{title:"Discount",dataIndex:"discount",key:"discount",render:function(t,a){return m.a.createElement(M.a.Item,Object.assign({key:"discount[".concat(a._id,"]")},i),n("discount[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}]})(m.a.createElement(I.a,{min:0,placeholder:"Discount",size:"small",onChange:function(){return e.calculateItem(a._id)}}))," %")}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement(_.a,{icon:"close",onClick:function(){return e.removeTreatment(a._id)},type:"danger",shape:"circle",size:"small"}))}}];return m.a.createElement("div",null,m.a.createElement(j.a,{title:"Completed Procedures"},m.a.createElement(f.a,null,m.a.createElement(g.a,{span:17},m.a.createElement(M.a,{onSubmit:this.handleSubmit},m.a.createElement(_e.a,{pagination:!1,bordered:!0,dataSource:this.state.tableFormValues,columns:r}),m.a.createElement(Xe.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(Lt.a,{placement:"topCenter",overlay:m.a.createElement(Pe.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Pe.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(L.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement(M.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0,float:"right"}}),m.a.createElement(_.a,{type:"primary",htmlType:"submit",style:{margin:5}},"Save Treatment Plan"),t.props.history?m.a.createElement(_.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null))),m.a.createElement("div",{ref:function(e){t.bottomPoint=e}}))),m.a.createElement(g.a,{span:7},m.a.createElement(Xe.a,{offsetTop:0},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(V.a.Search,{placeholder:"Search in plans ...",onChange:function(t){return e.searchValues(t.target.value)}})),m.a.createElement(b.a,{size:"small",loading:this.state.loadingProcedures,style:{maxHeight:"100vh",overflowX:"scroll"},itemLayout:"horizontal",dataSource:this.state.filteredItems,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.add(t)}},m.a.createElement(b.a.Item.Meta,{title:t.name}))}}))))))}}]),t}(m.a.Component),Ka=M.a.create()(Ua),Xa=h.a.confirm,Qa=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).updateFormValue=function(e,t){a.setState(Object(F.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:wt.get(e,"patient.user.first_name"),treatmentId:wt.get(e,"id"),mail_to:wt.get(e,"patient.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.treatmentId,i={mail_to:t};Object(se.g)(Object(Y.f)(q.Id,[n]),i),a.mailModalClose()},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,treatmentPlans:[],procedure_category:null,completedTreatmentPlans:[],incompletedTreatmentPlans:[],productMargin:[],loading:!0},a.loadTreatmentPlans=a.loadTreatmentPlans.bind(Object(o.a)(a)),a.editTreatmentPlanData=a.editTreatmentPlanData.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadTreatmentPlans(),this.loadProductMargin()}},{key:"loadProductMargin",value:function(){var e=this;Object(Y.c)(q.Nc,(function(t){e.setState({productMargin:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"loadTreatmentPlans",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=[],a=this,n=function(e){a.setState((function(t){return 1==e.current?{treatmentPlans:Object(T.a)(e.results),next:e.next,loading:!1}:{treatmentPlans:[].concat(Object(T.a)(t.treatmentPlans),Object(T.a)(e.results)),next:e.next,loading:!1}})),e.results.forEach((function(e){e.is_completed||t.push(e)})),a.setState((function(e){return{incompletedTreatmentPlans:[].concat(Object(T.a)(e.incompletedTreatmentPlans),t),loading:!1}}))},i=function(){a.setState({loading:!1})},r={page:e,practice:this.props.active_practiceId,complete:!0};this.props.match.params.id&&(r.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete r.practice,Object(Y.c)(q.Gd,n,i,r)}},{key:"editTreatmentPlanData",value:function(e){this.setState({editTreatmentPlan:e});var t=this.props.match.params.id;this.props.history.push("/patient/".concat(t,"/emr/workdone/edit"))}},{key:"deleteTreatmentPlans",value:function(e){var t=this;Xa({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a={id:e.id,patient:e.patient.id,is_active:!1};Object(Y.j)(Object(Y.f)(q.Gd,[t.props.match.params.id],null),a,(function(e){Object(Y.a)(H.Sb,"Completed Procedure Deleted Successfully!"),t.loadTreatmentPlans()}),(function(){}))},onCancel:function(){console.log("Cancel")}})}},{key:"loadPDF",value:function(e){Object(Y.c)(Object(Y.f)(q.Id,[e]),(function(e){e.report&&window.open(Tt.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=[{title:"",key:"is_completed",render:function(e,t){return t.is_completed?m.a.createElement(k.a,{type:"check-circle",theme:"twoTone",style:{marginLeft:"8px",fontSize:"20px"}}):null}},{title:"Procedure",key:"procedure.name",dataIndex:"procedure.name"},{title:"Quantity",dataIndex:"quantity",initialValue:this.state.editFields?this.state.editFields.quantity:null,key:"quantity"},{title:"Discount",dataIndex:"discount",key:"discount"},{title:"Cost per  Unit",dataIndex:"cost",key:"cost"},{title:"Notes",dataIndex:"default_notes",key:"default_notes"}];return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/workdone/add",render:function(a){return m.a.createElement(Ka,Object.assign({},e.state,t.props,a,{loadData:e.loadTreatmentPlans}))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/workdone/edit",render:function(a){return e.state.editTreatmentPlan?m.a.createElement(Ka,Object.assign({},e.state,a,t.props,{editId:e.state.editTreatmentPlan.id,loadData:e.loadTreatmentPlans})):m.a.createElement(p.a,{to:"/patient/".concat(e.props.match.params.id,"/emr/workdone")})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," Completed Procedures"):"Completed Procedures ",extra:m.a.createElement(_.a.Group,null,m.a.createElement(C.b,{to:"/patient/".concat(this.props.match.params.id,"/emr/workdone/add")},m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"plus"}),"Add")))}),this.state.treatmentPlans.map((function(n){return m.a.createElement(j.a,{bodyStyle:{padding:0},style:{marginTop:15}},m.a.createElement("div",{style:{padding:16}},m.a.createElement("h4",null,n.date?x()(n.date).format("ll"):null,m.a.createElement(Lt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Pe.a,null,m.a.createElement(Pe.a.Item,{key:"1",onClick:function(){return t.editTreatmentPlanData(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Pe.a.Item,{key:"2",onClick:function(){return t.deleteTreatmentPlans(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"3"},m.a.createElement(C.b,{to:"/patient/".concat(n.patient,"/emr/timeline")},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(n)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},m.a.createElement(k.a,{type:"printer"}))))),m.a.createElement(_e.a,{loading:e.state.loading,columns:a,dataSource:n.treatment_plans,footer:function(){return Za(n)},pagination:!1,key:n.id}))})),m.a.createElement(W.a,{loaderFunction:function(){return e.loadTreatmentPlans(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send complete procedure To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})))))):m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," Completed Procedures"):"Completed Procedures ",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))}),this.state.treatmentPlans.map((function(n){return m.a.createElement(j.a,{bodyStyle:{padding:0},key:n.id,style:{marginTop:15}},m.a.createElement("div",{style:{padding:16}},m.a.createElement("h4",null,n.date?x()(n.date).format("ll"):null,m.a.createElement(C.b,{to:"/patient/".concat(n.patient.id,"/emr/workdone")},"\xa0\xa0 ",n.patient.user?n.patient.user.first_name:null," (ID: ",n.patient.custom_id?n.patient.custom_id:n.patient.id,")\xa0"),m.a.createElement("span",null,", ",n.patient.gender),m.a.createElement(Lt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Pe.a,null,m.a.createElement(Pe.a.Item,{key:"1",disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(C.b,{to:"/patient/".concat(n.patient.id,"/emr/workdone/edit")},m.a.createElement(k.a,{type:"edit"}),"\xa0 Edit")),m.a.createElement(Pe.a.Item,{key:"2",onClick:function(){return t.deleteTreatmentPlans(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"3"},m.a.createElement(C.b,{to:"/patient/".concat(n.patient.id,"/emr/timeline")},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(n)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},m.a.createElement(k.a,{type:"printer"}))))),m.a.createElement(_e.a,{loading:e.state.loading,columns:a,dataSource:n.treatment_plans,footer:function(){return Za(n)},pagination:!1,key:n.id}))})),m.a.createElement(W.a,{loaderFunction:function(){return e.loadTreatmentPlans(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Treatment Notes To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})))}}]),t}(m.a.Component);function Za(e){return e?m.a.createElement("div",null,e.doctor?m.a.createElement(y.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"Completed by  ".concat(e.doctor.user.first_name)," ")):null,e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null):null}var Ja=xa.a.TabPane,$a=0,en=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).addInstructions=function(e,t){a.setState((function(a){return{addInstructions:Object(A.a)({},a.addInstructions,Object(F.a)({},e,!!t))}}))},a.changeDurationUnits=function(e,t){a.setState((function(a){return{changeDurationUnits:Object(A.a)({},a.changeDurationUnits,Object(F.a)({},e,!!t))}}))},a.removeDrug=function(e){a.setState((function(t){return{formDrugList:Object(T.a)(Object(wt.remove)(t.formDrugList,(function(t){return t._id!=e})))}}))},a.removeLabs=function(e,t){a.setState((function(a){return{addedLabs:Object(A.a)({},a.addedLabs,Object(F.a)({},t.id,!1)),formLabList:Object(T.a)(Object(wt.remove)(a.formLabList,(function(t){return t._id!=e})))}}))},a.addLabs=function(e){a.setState((function(t){var a=Math.random().toFixed(7);return console.log("LAb state",t),t.addedLabs[e.id]?(Object(Y.a)(H.bc,"Item Already Added"),!1):{addedLabs:Object(A.a)({},t.addedLabs,Object(F.a)({},e.id,!0)),formLabList:[].concat(Object(T.a)(t.formLabList),[Object(A.a)({},e,{_id:a})])}}))},a.addTemplate=function(e){a.setState((function(t){Math.random().toFixed(7);if(t.addTemplate[e.id])return Object(Y.a)(H.bc,"Item Already Added"),!1;var a=Object(T.a)(t.formLabList),n=Object(A.a)({},t.addedLabs);e.labs&&e.labs.forEach((function(e){var t=Math.random().toFixed(7);a.push(Object(A.a)({},e,{_id:t})),n=Object(A.a)({},n,Object(F.a)({},e.id,!0))}));var i=Object(T.a)(t.formDrugList),r=Object(A.a)({},t.addedDrugs);return e.drugs&&e.drugs.forEach((function(t){var a=Math.random().toFixed(7);i.push(Object(A.a)({},t,{_id:a,advice_data:e.advice_data})),r=Object(A.a)({},r,Object(F.a)({},t.id,!0))})),{addedLabs:n,formLabList:a,addedDrugs:r,formDrugList:i}}))},a.removeTemplates=function(e,t){a.setState((function(a){return{addTemplate:Object(A.a)({},a.addTemplate,Object(F.a)({},t.id,!1)),formTemplateList:Object(T.a)(Object(wt.remove)(a.formTemplateList,(function(t){return t._id!=e})))}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(console.log("value form",a),!e){var n=Object(A.a)({},a,{drug:[],labs:[],advice_data:[],patient:t.props.match.params.id,practice:t.props.active_practiceId});t.state.formDrugList.forEach((function(e){console.log("advice search",e),e.dosage=a.does[e._id],e.duration_type=a.duration_unit[e._id],e.duration=a.duration[e._id],e.frequency=a.does_frequency[e._id],a.instruction&&(e.instruction=a.instruction[e._id]),a.food_time[e._id]?(e.after_food=!0,e.before_food=!1):(e.before_food=!0,e.after_food=!1),e.advice_data&&e.advice_data.map((function(e){n.advice_data.push(e.id)}));var i={inventory:e.id,name:e.name,dosage:e.dosage,frequency:e.frequency,duration:e.duration,duration_type:e.duration_type,instruction:e.instruction,before_food:e.before_food,after_food:e.after_food,advice_data:t.state.prescriptionTemplate.advice_data,is_active:!0};n.drug.push(i)})),t.state.formLabList.forEach((function(e){n.labs.push(e.id)}));console.log("final",n),Object(Y.j)(Object(Y.f)(q.Jc,[t.props.active_practiceId]),n,(function(e){t.props.history.goBack()}),(function(){}))}}))},a.handleAddFields=function(){var e=a.props.form,t=e.getFieldValue("keys").concat($a++);e.setFieldsValue({keys:t})},a.remove=function(e){var t=a.props.form,n=t.getFieldValue("keys");1!==n.length&&t.setFieldsValue({keys:n.filter((function(t){return t!==e}))})},a.onChange=function(e){a.setState({})},a.searchValues=function(e,t){var n=Object(o.a)(a);a.setState((function(a){var n=Object(A.a)({},a.searchStrings);return n[e]=t,{searchStrings:n}}),(function(){"Drugs"==e?n.loadDrugList():n.filterValues(e)}))},a.filterValues=function(e){a.setState((function(t){var a=[];return t.items[e]&&(t.searchStrings[e]?t.items[e].forEach((function(n){n.name&&n.name.toString().toLowerCase().includes(t.searchStrings[e].toLowerCase())&&a.push(n)})):a=t.items[e]),{filteredItems:Object(A.a)({},t.filteredItems,Object(F.a)({},e,a))}}))},a.state={items:{},filteredItems:{},drugList:[],labList:[],formDrugList:[],formLabList:[],addInstructions:{},changeDurationUnits:{},addedDrugs:{},addedLabs:{},addTemplate:{},formTemplateList:[],searchStrings:{}},a.loadPrescriptionTemplate=a.loadPrescriptionTemplate.bind(Object(o.a)(a)),a.deletePrescriptionTemplate=a.deletePrescriptionTemplate.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadDrugList(),this.loadLabList(),this.loadPrescriptionTemplate()}},{key:"loadPrescriptionTemplate",value:function(){var e=this;console.log("template",e.state.prescriptionTemplate),Object(Y.c)(Object(Y.f)(q.Jc,[e.props.active_practiceId]),(function(t){e.setState({prescriptionTemplate:t.results})}),(function(){}))}},{key:"loadLabList",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Gb,[e.props.active_practiceId]),(function(t){e.setState({labList:t.results})}),(function(){}))}},{key:"loadDrugList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=function(e){t.setState((function(t){var a=Object(A.a)({},t.items);return{items:Object(A.a)({},a,{Drugs:e.results}),filteredItems:Object(A.a)({},t.filteredItems,{Drugs:e.results})}}))},n=function(){},i={practice:this.props.active_practiceId,item_type:Q.z,page:e};t.state.searchStrings.Drugs&&(i.item_name=t.state.searchStrings.Drugs),Object(Y.c)(q.xb,a,n,i)}},{key:"addDrug",value:function(e){this.setState((function(t){var a=Math.random().toFixed(7);return t.addedDrugs[e.id]?(Object(Y.a)(H.bc,"Item Already Added"),!1):{addedDrugs:Object(A.a)({},t.addedDrugs,Object(F.a)({},e.id,!0)),formDrugList:[].concat(Object(T.a)(t.formDrugList),[Object(A.a)({},e,{_id:a})])}}))}},{key:"deletePrescriptionTemplate",value:function(e){var t=this,a={id:e,is_active:!1};Object(Y.j)(Object(Y.f)(q.Jc,[t.props.active_practiceId]),a,(function(e){t.loadPrescriptionTemplate()}),(function(){}))}},{key:"render",value:function(){var e=this,a=this,n={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:12}}},i={wrapperCol:{xs:{span:24,offset:0},sm:{span:12,offset:4}}},r=this.props.form,l=r.getFieldDecorator,c=r.getFieldValue;r.getFieldsValue;l("keys",{initialValue:[]});var o=c("keys"),s=o.map((function(t,a){return m.a.createElement(M.a.Item,Object.assign({},0===a?n:i,{label:0===a?"Advice":"",required:!1,key:t}),l("advice_data[".concat(t,"]"),{validateTrigger:["onChange","onBlur"]})(m.a.createElement(V.a,{style:{width:"60%",marginRight:8}})),o.length>1?m.a.createElement(k.a,{className:"dynamic-delete-button",type:"minus-circle-o",onClick:function(){return e.remove(t)}}):null)})),u=[{title:"Drug Name",dataIndex:"name",key:"name",render:function(e){return m.a.createElement("h2",null,e)}},{title:"Dosage & Frequency",dataIndex:"dosage",key:"dosage",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(M.a.Item,{extra:m.a.createElement("span",null,"does(s)"),key:"does[".concat(a._id,"]")},l("does[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"]},{rules:[{message:"This field is required."}]})(m.a.createElement(I.a,{min:0,size:"small"}))),m.a.createElement(M.a.Item,{key:"does_frequency[".concat(a._id,"]")},l("does_frequency[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:"twice daily"})(m.a.createElement(w.a,{size:"small",onChange:function(){return e.changeDurationUnits(a._id,!1)}},Q.y.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))))}},{title:"Duration",dataIndex:"duration",key:"duration",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(M.a.Item,{key:"duration[".concat(a._id,"]")},l("duration[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"]},{rules:[{message:"This field is required."}]})(m.a.createElement(I.a,{min:0,size:"small"}))),m.a.createElement(M.a.Item,{key:"duration_unit[".concat(a._id,"]")},l("duration_unit[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:"day(s)"})(m.a.createElement(w.a,{size:"small",onChange:function(){return e.changeDurationUnits(a._id,!1)}},Q.A.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))))}},{title:"Instructions",dataIndex:"instruction",key:"instruction",render:function(t,a){return m.a.createElement("div",null,e.state.addInstructions[a._id]?m.a.createElement(M.a.Item,{extra:m.a.createElement("a",{onClick:function(){return e.addInstructions(a._id,!1)}},"Remove Instructions"),key:"instruction[".concat(a._id,"]")},l("instruction[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}]})(m.a.createElement(V.a.TextArea,{min:0,placeholder:"Instructions...",size:"small"}))):m.a.createElement("a",{onClick:function(){return e.addInstructions(a._id,!0)}},"+ Add Instructions"))}},{title:"Timing",dataIndex:"food_time",key:"food_time",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(M.a.Item,{key:"food_time[".concat(a._id,"]")},l("food_time[".concat(a._id,"]"))(m.a.createElement(D.a.Group,{onChange:e.onChange},m.a.createElement(D.a,{value:1},"After Food"),m.a.createElement(D.a,{value:0},"Before Food")))))}},{title:"",dataIndex:"action",key:"action",render:function(t,a){return m.a.createElement(M.a.Item,null,m.a.createElement(_.a,{icon:"close",onClick:function(){return e.removeDrug(a._id)},type:"danger",shape:"circle",size:"small"}))}}],d=[{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return m.a.createElement("span",null,m.a.createElement("b",null,e))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(e,t){return m.a.createElement("span",null,t.cost)}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement(_.a,{icon:"close",onClick:function(){return e.removeLabs(a._id,a)},type:"danger",shape:"circle",size:"small"}))}}];return m.a.createElement(j.a,{title:"Prescriptions Template"},m.a.createElement(f.a,null,m.a.createElement(g.a,{span:18},m.a.createElement(M.a,{onSubmit:this.handleSubmit},m.a.createElement(M.a.Item,Object.assign({},n,{label:"Template Name"}),l("name",{})(m.a.createElement(V.a,null))),m.a.createElement(M.a.Item,Object.assign({},n,{label:"Schedule"}),l("schedule",{})(m.a.createElement(I.a,{min:1}))),m.a.createElement(_e.a,{pagination:!1,bordered:!1,columns:u,dataSource:this.state.formDrugList}),m.a.createElement(v.a,null," Lab Test"),m.a.createElement(_e.a,{pagination:!1,bordered:!1,columns:d,dataSource:this.state.formLabList}),m.a.createElement(v.a,null),s,m.a.createElement(M.a.Item,i,m.a.createElement(_.a,{type:"dashed",onClick:this.handleAddFields,style:{width:"60%"}},m.a.createElement(k.a,{type:"plus"})," Add advice field")),m.a.createElement(Xe.a,{target:function(){return e.container}},m.a.createElement(_.a,{type:"primary",htmlType:"submit"},"Save")))),m.a.createElement(g.a,{span:6},m.a.createElement(xa.a,{type:"card"},m.a.createElement(Ja,{tab:"Drugs",key:"1"},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(V.a.Search,{key:"Drugs",placeholder:"Search in Medicine...",onChange:function(t){return e.searchValues("Drugs",t.target.value)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.filteredItems.Drugs,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.addDrug(t)},actions:t.maintain_inventory?null:[m.a.createElement(y.a,null,"Not Sold")]},m.a.createElement(b.a.Item.Meta,{title:t.name}))}})),m.a.createElement(Ja,{tab:"Labs",key:"2"},m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.labList,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.addLabs(t)}},m.a.createElement(b.a.Item.Meta,{title:t.name}))}})),m.a.createElement(Ja,{tab:"Template",key:"3"},m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.prescriptionTemplate,renderItem:function(t){return m.a.createElement(b.a.Item,{onConfirm:function(){return a.deletePrescriptionTemplate(t.id)}},m.a.createElement(b.a.Item.Meta,{onClick:function(){return e.addTemplate(t)},title:t.name}),m.a.createElement(E.a,{title:"Are you sure delete this item?",onConfirm:function(){return a.deletePrescriptionTemplate(t.id)},okText:"Yes",cancelText:"No"},m.a.createElement("a",null,"Delete")))}})))),m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/prescriptions/template/add",renderRoute:function(a){return m.a.createElement(t,Object.assign({},e.state,a))}}))))}}]),t}(m.a.Component),tn=M.a.create()(en),an=xa.a.TabPane,nn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).selectDoctor=function(e){a.setState({selectedDoctor:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.addInstructions=function(e,t){a.setState((function(a){return{addInstructions:Object(A.a)({},a.addInstructions,Object(F.a)({},e,!!t))}}))},a.changeDurationUnits=function(e,t){a.setState((function(a){return{changeDurationUnits:Object(A.a)({},a.changeDurationUnits,Object(F.a)({},e,!!t))}}))},a.removeDrug=function(e){a.setState((function(t){return{formDrugList:Object(T.a)(Object(wt.remove)(t.formDrugList,(function(t){return t._id!=e})))}}))},a.removeLabs=function(e,t){a.setState((function(a){return{addedLabs:Object(A.a)({},a.addedLabs,Object(F.a)({},t.id,!1)),formLabList:Object(T.a)(Object(wt.remove)(a.formLabList,(function(t){return t._id!=e})))}}))},a.addLabs=function(e){a.setState((function(t){var a=Math.random().toFixed(7);return t.addedLabs[e.id]?(Object(Y.a)(H.bc,"Item Already Added"),!1):{addedLabs:Object(A.a)({},t.addedLabs,Object(F.a)({},e.id,!0)),formLabList:[].concat(Object(T.a)(t.formLabList),[Object(A.a)({},e,{_id:a})])}}))},a.addTemplate=function(e){a.setState((function(t){if(t.addTemplate[e.id])return Object(Y.a)(H.bc,"Item Already Added"),!1;var a=Object(T.a)(t.formLabList),n=Object(A.a)({},t.addedLabs);e.labs.forEach((function(e){var t=Math.random().toFixed(7);a.push(Object(A.a)({},e,{_id:t})),n=Object(A.a)({},n,Object(F.a)({},e.id,!0))}));var i=Object(T.a)(t.formDrugList),r=Object(A.a)({},t.addedDrugs);return e.drugs.forEach((function(t){var a=Math.random().toFixed(7);i.push(Object(A.a)({},t,{_id:a,advice_data:e.advice_data})),n=Object(A.a)({},r,Object(F.a)({},t.id,!0))})),{addedLabs:n,formLabList:a,addedDrugs:r,formDrugList:i}}))},a.removeTemplates=function(e,t){a.setState((function(a){return{addTemplate:Object(A.a)({},a.addTemplate,Object(F.a)({},t.id,!1)),formTemplateList:Object(T.a)(Object(wt.remove)(a.formTemplateList,(function(t){return t._id!=e})))}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(!e){var n={drugs:[],labs:[],patient:parseInt(t.props.match.params.id),practice:t.props.active_practiceId,doctor:t.state.selectedDoctor?t.state.selectedDoctor.id:null,date:t.state.selectedDate?t.state.selectedDate.format("YYYY-MM-DD"):null,advice_data:[]};t.props.editId&&(n.id=t.props.editId),t.state.formDrugList.forEach((function(e){e.dosage=a.dosage[e._id],e.duration_type=a.duration_type[e._id],e.duration=a.duration[e._id],e.frequency=a.frequency[e._id],a.instruction&&(e.instruction=a.instruction[e._id]),a.food_time[e._id]?(e.after_food=!0,e.before_food=!1):(e.before_food=!0,e.after_food=!1);var t={inventory:e.id,name:e.name,dosage:e.dosage,frequency:e.frequency,duration_type:e.duration_type,duration:e.duration,instruction:e.instruction,before_food:e.before_food,after_food:e.after_food,is_active:!0};n.drugs.push(t)})),t.state.formLabList.forEach((function(e){n.labs.push(e.id)}));Object(Y.j)(Object(Y.f)(q.Hc,[t.props.match.params.id]),n,(function(e){t.props.loadData&&t.props.loadData();var a="/patient/".concat(t.props.match.params.id,"/emr/prescriptions");t.props.history.replace(a)}),(function(){}))}}))},a.onChange=function(e){a.setState({})},a.searchValues=function(e,t){var n=Object(o.a)(a);a.setState((function(a){var n=Object(A.a)({},a.searchStrings);return n[e]=t,{searchStrings:n}}),(function(){"Drugs"==e?n.loadDrugList():n.filterValues(e)}))},a.filterValues=function(e){a.setState((function(t){var a=[];return t.items[e]&&(t.searchStrings[e]?t.items[e].forEach((function(n){n.name&&n.name.toString().toLowerCase().includes(t.searchStrings[e].toLowerCase())&&a.push(n)})):a=t.items[e]),{filteredItems:Object(A.a)({},t.filteredItems,Object(F.a)({},e,a))}}))},a.state={items:{},filteredItems:{},formDrugList:[],formLabList:[],addInstructions:{},changeDurationUnits:{},addedDrugs:{},addedLabs:{},addTemplate:{},formTemplateList:[],practiceDoctors:[],selectedDoctor:{},selectedDate:x()(),searchStrings:{}},a.loadPrescriptionTemplate=a.loadPrescriptionTemplate.bind(Object(o.a)(a)),a.deletePrescriptionTemplate=a.deletePrescriptionTemplate.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.loadDrugList(),this.loadLabList(),this.loadPrescriptionTemplate(),Object(se.d)(this),this.props.editId&&this.setState((function(t){var a=[],n={},i={};e.props.editPrescription.drugs.forEach((function(e){var t=Math.random();a.push(Object(A.a)({},e,{_id:t,food_time:e.after_food?1:0})),n[t]=!!e.instruction}));var r=[];return e.props.editPrescription.labs.forEach((function(e){r.push(Object(A.a)({},e,{_id:Math.random()})),i[e.id]=!0})),Object(A.a)({},e.props.editPrescription,{formDrugList:[].concat(a),formLabList:[].concat(r),addInstructions:Object(A.a)({},n),addedLabs:Object(A.a)({},i),selectedDoctor:e.props.editPrescription.doctor,selectedDate:x()(e.props.editPrescription.date).isValid()?x()(e.props.editPrescription.date):x()()})}))}},{key:"loadPrescriptionTemplate",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Jc,[e.props.active_practiceId]),(function(t){e.setState((function(e){var a=Object(A.a)({},e.items);return{items:Object(A.a)({},a,{Template:t.results}),filteredItems:Object(A.a)({},e.filteredItems,{Template:t.results})}}))}),(function(){}))}},{key:"loadLabList",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Gb,[e.props.active_practiceId]),(function(t){e.setState((function(e){var a=Object(A.a)({},e.items);return{items:Object(A.a)({},a,{Labs:t.results}),filteredItems:Object(A.a)({},e.filteredItems,{Labs:t.results})}}))}),(function(){}))}},{key:"loadDrugList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=t.state.searchStrings.Drugs,n=function(e){a==t.state.searchStrings.Drugs&&t.setState((function(t){var a=Object(A.a)({},t.items);return{items:Object(A.a)({},a,{Drugs:e.results}),filteredItems:Object(A.a)({},t.filteredItems,{Drugs:e.results})}}))},i=function(){},r={practice:this.props.active_practiceId,item_type:Q.z,page:e};a&&(r.item_name=a),Object(Y.c)(q.xb,n,i,r)}},{key:"addDrug",value:function(e){this.setState((function(t){var a=Math.random().toFixed(7);return{addedDrugs:Object(A.a)({},t.addedDrugs,Object(F.a)({},e.id,!0)),formDrugList:[Object(A.a)({},e,{_id:a})].concat(Object(T.a)(t.formDrugList))}}))}},{key:"deletePrescriptionTemplate",value:function(e){var t=this,a={id:e,is_active:!1};Object(Y.j)(Object(Y.f)(q.Jc,[t.props.active_practiceId]),a,(function(e){t.loadPrescriptionTemplate()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,n=a.getFieldDecorator,i=(a.getFieldValue,a.getFieldsValue,[{title:"Medicine Name",dataIndex:"name",key:"name",render:function(e){return m.a.createElement("h2",null,e)}},{title:"Dosage & Frequency",dataIndex:"dosage",key:"dosage",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(M.a.Item,{extra:m.a.createElement("span",null,"does(s)"),key:"dosage[".concat(a._id,"]")},n("dosage[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.dosage,min:0})(m.a.createElement(I.a,{size:"small"}))),m.a.createElement(M.a.Item,{key:"frequency[".concat(a._id,"]")},n("frequency[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.frequency||Q.y[0].value})(m.a.createElement(w.a,{size:"small",onChange:function(){return e.changeDurationUnits(a._id,!1)}},Q.y.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))))}},{title:"Duration",dataIndex:"duration",key:"duration",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(M.a.Item,{key:"duration[".concat(a._id,"]")},n("duration[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.duration,min:0})(m.a.createElement(I.a,{size:"small"}))),m.a.createElement(M.a.Item,{key:"duration_type[".concat(a._id,"]")},n("duration_type[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.duration_type||Q.A[0].value})(m.a.createElement(w.a,{size:"small",onChange:function(){return e.changeDurationUnits(a._id,!1)}},Q.A.map((function(e){return m.a.createElement(w.a.Option,{value:e.value},e.label)}))))))}},{title:"Instructions",dataIndex:"instruction",key:"instruction",render:function(t,a){return m.a.createElement("div",null,e.state.addInstructions[a._id]?m.a.createElement(M.a.Item,{extra:m.a.createElement("a",{onClick:function(){return e.addInstructions(a._id,!1)}},"Remove Instructions"),key:"instruction[".concat(a._id,"]")},n("instruction[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.instruction})(m.a.createElement(V.a.TextArea,{placeholder:"Instructions...",size:"small"}))):m.a.createElement("a",{onClick:function(){return e.addInstructions(a._id,!0)}},"+ Add Instructions"))}},{title:"Timing",dataIndex:"food_time",key:"food_time",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(M.a.Item,{key:"food_time[".concat(a._id,"]")},n("food_time[".concat(a._id,"]"),{initialValue:a.food_time||0})(m.a.createElement(D.a.Group,{onChange:e.onChange},m.a.createElement(D.a,{value:1},"after"),m.a.createElement(D.a,{value:0},"before")))))}},{title:"",dataIndex:"action",key:"action",render:function(t,a){return m.a.createElement(M.a.Item,null,m.a.createElement(_.a,{icon:"close",onClick:function(){return e.removeDrug(a._id)},type:"danger",shape:"circle",size:"small"}))}}]),r=[{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return m.a.createElement("span",null,m.a.createElement("b",null,e))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(e,t){return m.a.createElement("span",null,t.cost)}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement(_.a,{icon:"close",onClick:function(){return e.removeLabs(a._id,a)},type:"danger",shape:"circle",size:"small"}))}}];return m.a.createElement(j.a,{title:"Prescriptions"},m.a.createElement(f.a,null,m.a.createElement(g.a,{span:18},m.a.createElement(M.a,{onSubmit:this.handleSubmit},m.a.createElement(_e.a,{pagination:!1,bordered:!1,columns:i,dataSource:this.state.formDrugList}),m.a.createElement(v.a,null," Lab Test"),m.a.createElement(_e.a,{pagination:!1,bordered:!1,columns:r,dataSource:this.state.formLabList}),m.a.createElement(Xe.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(Lt.a,{placement:"topCenter",overlay:m.a.createElement(Pe.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Pe.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(L.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement(_.a,{type:"primary",htmlType:"submit",style:{margin:5,float:"right"}},"Save"),t.props.history?m.a.createElement(_.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null)))),m.a.createElement(g.a,{span:6},m.a.createElement(xa.a,{type:"card"},m.a.createElement(an,{tab:"Medicine",key:"1"},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(V.a.Search,{key:"Drugs",placeholder:"Search in Medicine...",onChange:function(t){return e.searchValues("Drugs",t.target.value)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.filteredItems.Drugs,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.addDrug(t)},actions:t.maintain_inventory?null:[m.a.createElement(y.a,null,"Not Sold")]},m.a.createElement(b.a.Item.Meta,{title:t.name}))}})),m.a.createElement(an,{tab:"Labs",key:"2"},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(V.a.Search,{key:"Labs",placeholder:"Search in Labs...",onChange:function(t){return e.searchValues("Labs",t.target.value)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.filteredItems.Labs,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.addLabs(t)}},m.a.createElement(b.a.Item.Meta,{title:t.name}))}})),m.a.createElement(an,{tab:"Template",key:"3"},m.a.createElement("div",null,m.a.createElement(C.b,{to:"/patient/".concat(this.props.match.params.id,"/prescriptions/template/add")},m.a.createElement(_.a,{type:"primary",block:!0,size:"small"},m.a.createElement(k.a,{type:"plus"}),"\xa0Add Template"))),m.a.createElement(v.a,{style:{margin:0}}),m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(V.a.Search,{key:"Template",placeholder:"Search in Template...",onChange:function(t){return e.searchValues("Template",t.target.value)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.filteredItems.Template,renderItem:function(a){return m.a.createElement(b.a.Item,{onConfirm:function(){return t.deletePrescriptionTemplate(a.id)}},m.a.createElement(b.a.Item.Meta,{onClick:function(){return e.addTemplate(a)},title:a.name}),m.a.createElement(E.a,{title:"Are you sure delete this item?",onConfirm:function(){return t.deletePrescriptionTemplate(a.id)},okText:"Yes",cancelText:"No"},m.a.createElement("a",null,"Delete")))}})))),m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/prescriptions/template/add",render:function(t){return m.a.createElement(tn,Object.assign({},e.state,t))}}))))}}]),t}(m.a.Component),rn=M.a.create()(nn),ln=h.a.confirm,cn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).updateFormValue=function(e,t){a.setState(Object(F.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:wt.get(e,"patient.user.first_name"),prescriptionId:wt.get(e,"id"),mail_to:wt.get(e,"patient.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.prescriptionId,i={mail_to:t};Object(se.g)(Object(Y.f)(q.Id,[n]),i),a.mailModalClose()},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,prescription:[],drug_catalog:null,editPrescription:null,loading:!0},a.loadPrescriptions=a.loadPrescriptions.bind(Object(o.a)(a)),a.loadDrugCatalog=a.loadDrugCatalog.bind(Object(o.a)(a)),a.editPrescriptionData=a.editPrescriptionData.bind(Object(o.a)(a)),a.deletePrescriptions=a.deletePrescriptions.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadPrescriptions(),this.loadDrugCatalog()}},{key:"loadPrescriptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;this.setState({loading:!0});var a=function(e){t.setState({prescription:e.results,nextPrescriptionPage:e.next,loading:!1})},n=function(){t.setState({loading:!1})},i={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(i.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete i.practice,Object(Y.c)(q.Hc,a,n,i)}},{key:"loadPDF",value:function(e){Object(Y.c)(Object(Y.f)(q.Ic,[e]),(function(e){e.report&&window.open(Tt.a+e.report)}),(function(){}))}},{key:"loadDrugCatalog",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Z,[this.props.active_practiceId]),(function(t){e.setState({drug_catalog:t})}),(function(){e.setState({})}))}},{key:"editPrescriptionData",value:function(e){var t=this;this.setState({editPrescription:e},(function(){t.props.history.push("/patient/".concat(e.patient,"/emr/prescriptions/edit"))}))}},{key:"deletePrescriptions",value:function(e){var t=this;ln({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a={id:e.id,patient:e.patient,is_active:!1};Object(Y.j)(Object(Y.f)(q.Hc,[t.props.match.params.id]),a,(function(e){t.loadPrescriptions()}),(function(){}))},onCancel:function(){console.log("Cancel")}})}},{key:"render",value:function(){var e=this,t={};this.state.drug_catalog&&this.state.drug_catalog.forEach((function(e){t[e.id]="".concat(e.name,",").concat(e.strength)}));var a=this,i=[{title:"Drug",key:"name",dataIndex:"name"},{title:"Frequency",dataIndex:"frequency",key:"frequency",render:function(e,t){return m.a.createElement("span",null,t.dosage,"\xa0",t.frequency)}},{title:"Duration",dataIndex:"duration",key:"duration",render:function(e,t){return m.a.createElement("span",null,e,"\xa0",t.duration_type)}},{title:"Instruction",dataIndex:"instruction",key:"instruction",render:function(e,t){return m.a.createElement("span",null,t.before_food?m.a.createElement(y.a,null,"before food "):null,t.after_food?m.a.createElement(y.a,null,"after food"):null,e)}}];return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/prescriptions/add",render:function(t){return m.a.createElement(rn,Object.assign({},e.state,e.props,{loadData:e.loadPrescriptions},t))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/prescriptions/edit",render:function(t){return a.state.editPrescription?m.a.createElement(rn,Object.assign({},e.state,t,e.props,{loadData:e.loadPrescriptions,editId:a.state.editPrescription.id})):m.a.createElement(p.a,{to:"/patient/".concat(a.props.match.params.id,"/emr/prescriptions")})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," Prescriptions"):"Prescriptions",extra:m.a.createElement(_.a.Group,{style:{float:"right"}},m.a.createElement(C.b,{to:"/patient/".concat(this.props.match.params.id,"/emr/prescriptions/add")},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"Add")))}),this.state.prescription.map((function(t){return m.a.createElement("div",null,m.a.createElement(j.a,{style:{marginTop:10},bodyStyle:{padding:0},title:m.a.createElement("small",null,t.date?x()(t.date).format("ll"):null),extra:m.a.createElement(Lt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Pe.a,null,m.a.createElement(Pe.a.Item,{key:"1",onClick:function(){return a.editPrescriptionData(t)},disabled:t.practice&&t.practice.id!=a.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Pe.a.Item,{key:"2",onClick:function(){return a.deletePrescriptions(t)},disabled:t.practice&&t.practice.id!=a.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"3"},m.a.createElement(C.b,{to:"/patient/".concat(t.patient,"/emr/timeline")},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(t)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(t.id)}},m.a.createElement(k.a,{type:"printer"})))},m.a.createElement(h.a,{title:null,visible:e.state.visibleMail,onOk:e.sendMailToPatient,onCancel:e.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:e.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:e.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Prescription  To ",e.state.patientName," ?"),m.a.createElement(V.a,{value:e.state.mail_to,placeholder:"Email",onChange:function(e){return a.updateFormValue("mail_to",e.target.value)}})),m.a.createElement(_e.a,{columns:i,dataSource:t.drugs,pagination:!1,footer:function(){return on(t)},key:t.id})))})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(W.a,{loading:this.state.loading,loaderFunction:function(){return e.loadPrescriptions(e.state.nextPrescriptionPage)},hidden:!this.state.nextPrescriptionPage}))))):m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," Prescriptions"):"Prescriptions",extra:m.a.createElement(_.a.Group,{style:{float:"right"}},m.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))}),this.state.prescription.map((function(t){return m.a.createElement("div",{key:t.id},m.a.createElement(j.a,{style:{marginTop:10},bodyStyle:{padding:0},title:m.a.createElement("small",null,t.date?x()(t.date).format("ll"):null,m.a.createElement(C.b,{to:"/patient/".concat(t.patient.id,"/emr/prescriptions")},"\xa0\xa0 ",t.patient.user?t.patient.user.first_name:null," (ID: ",t.patient.custom_id?t.patient.custom_id:t.patient.id,")\xa0"),m.a.createElement("span",null,", ",t.patient.gender)),extra:m.a.createElement(Lt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Pe.a,null,m.a.createElement(Pe.a.Item,{key:"1",onClick:function(){return a.editPrescriptionData(t)},disabled:t.practice&&t.practice.id!=a.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Pe.a.Item,{key:"2",onClick:function(){return a.deletePrescriptions(t)},disabled:t.practice&&t.practice.id!=a.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"3"},m.a.createElement(C.b,{to:"/patient/".concat(t.patient,"/emr/timeline")},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(t)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(t.id)}},m.a.createElement(k.a,{type:"printer"})))},m.a.createElement(_e.a,{columns:i,dataSource:t.drugs,pagination:!1,footer:function(){return on(t)},key:t.id})))})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(W.a,{loading:this.state.loading,loaderFunction:function(){return e.loadPrescriptions(e.state.nextPrescriptionPage)},hidden:!this.state.nextPrescriptionPage}),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Prescription To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return a.updateFormValue("mail_to",e.target.value)}})))}}]),t}(m.a.Component);function on(e){return e?m.a.createElement("div",null,e.doctor?m.a.createElement(Se.a,{title:"Doctor"},m.a.createElement(y.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  ".concat(e.doctor.user.first_name)," "))):null,e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null,e.labs.length?m.a.createElement("div",null,"+",e.labs.length,"\xa0Lab Orders"):null):null}var sn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).calculateItem=function(e){a.props.form.getFieldsValue;a.setState((function(e){Object(T.a)(e.tableFormValues).forEach((function(e){}))}))},a.addNotes=function(e,t){a.setState((function(a){return{addNotes:Object(A.a)({},a.addNotes,Object(F.a)({},e,!!t))}}))},a.removeTreatment=function(e){a.setState((function(t){return{tableFormValues:Object(T.a)(Object(wt.remove)(t.tableFormValues,(function(t){return t._id!=e})))}}))},a.add=function(e){Object(o.a)(a);a.setState((function(t){var a=Math.random().toFixed(7);return{addNotes:Object(A.a)({},t.addNotes,Object(F.a)({},a,!!e.default_notes)),tableFormValues:[Object(A.a)({},e,{_id:a})].concat(Object(T.a)(t.tableFormValues))}}),(function(){}))},a.selectDoctor=function(e){a.setState({selectedDoctor:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(!e){var n={treatment_plans:[],patient:t.props.match.params.id,doctor:t.state.selectedDoctor.id,date:t.state.selectedDate&&x()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null,practice:t.props.active_practiceId};t.props.editId&&(n.id=t.props.editTreatmentPlan.id),t.state.tableFormValues.forEach((function(e){e.quantity=a.quantity[e._id],e.cost=a.cost[e._id],e.discount=a.discount[e._id],a.notes&&(e.notes=a.notes[e._id]);var t={procedure:e.id,cost:e.cost,quantity:e.quantity,margin:e.margin,default_notes:e.default_notes,is_active:!0,is_completed:e.is_completed||!1,discount:e.discount,discount_type:"%"};n.treatment_plans.push(t)}));Object(Y.j)(Object(Y.f)(q.Gd,[t.props.match.params.id]),n,(function(e){Object(Y.a)("Inventory updated successfully"),t.props.loadData&&t.props.loadData();var a="/patient/".concat(t.props.match.params.id,"/emr/plans");t.props.history.replace(a)}),(function(){}))}}))},a.searchValues=function(e){var t=Object(o.a)(a);return a.setState((function(t){return{searchString:e}}),(function(){t.loadProcedures()})),!1},a.state={loadingProcedures:!0,procedure_category:[],tableFormValues:[],addNotes:{},practiceDoctors:[],selectedDoctor:{},selectedDate:x()()},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.editId&&this.setState((function(e){var t=[];return this.props.editTreatmentPlan.treatment_plans.forEach((function(e){var a=Math.random().toFixed(7);t.push(Object(A.a)({},e,{},e.procedure,{_id:a}))})),Object(A.a)({},this.props.editTreatmentPlan,{tableFormValues:t,selectedDate:x()(this.props.editTreatmentPlan.date),selectedDoctor:this.props.editTreatmentPlan.doctor})})),this.loadProcedures(),Object(se.d)(this)}},{key:"loadProcedures",value:function(){var e=this,t={};this.state.searchString&&(t.name=this.state.searchString),e.setState({loadingProcedures:!0});Object(Y.c)(Object(Y.f)(q.Lc,[this.props.active_practiceId]),(function(a){t.name&&e.state.searchString!=t.name||e.setState({loadingProcedures:!1,filteredItems:a.results})}),(function(){e.setState({loadingProcedures:!1})}),t)}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,n=a.getFieldDecorator,i=(a.getFieldValue,a.getFieldsValue,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}}),r=[{title:"Treatments",dataIndex:"name",key:"name",render:function(t,a){return m.a.createElement("span",null,m.a.createElement("b",null,t),m.a.createElement("br",null),e.state.addNotes[a._id]?m.a.createElement(M.a.Item,Object.assign({key:"default_notes[".concat(a._id,"]")},i),n("default_notes[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.default_notes})(m.a.createElement(V.a.TextArea,{min:0,placeholder:"Notes..."}))):m.a.createElement("a",{onClick:function(){return e.addNotes(a._id,!0)}},"+ Add Note"))}},{title:"Quantity",dataIndex:"quantity",key:"quantity",render:function(t,a){return m.a.createElement(M.a.Item,Object.assign({key:"quantity[".concat(a._id,"]")},i),n("quantity[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:1})(m.a.createElement(I.a,{min:0,placeholder:"Quantity",size:"small",onChange:function(){return e.calculateItem(a._id)}})))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(t,a){return m.a.createElement(M.a.Item,Object.assign({key:"cost[".concat(a._id,"]")},i),n("cost[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:a.cost})(m.a.createElement(I.a,{min:0,placeholder:"Cost",size:"small",onChange:function(){return e.calculateItem(a._id)}})))}},{title:"Discount",dataIndex:"discount",key:"discount",render:function(t,a){return m.a.createElement(M.a.Item,Object.assign({key:"discount[".concat(a._id,"]")},i),n("discount[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}]})(m.a.createElement(I.a,{min:0,placeholder:"Discount",size:"small",onChange:function(){return e.calculateItem(a._id)}}))," %")}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement(_.a,{icon:"close",onClick:function(){return e.removeTreatment(a._id)},type:"danger",shape:"circle",size:"small"}))}}];return m.a.createElement("div",null,m.a.createElement(j.a,{title:"Treatment Plans"},m.a.createElement(f.a,null,m.a.createElement(g.a,{span:17},m.a.createElement(M.a,{onSubmit:this.handleSubmit},m.a.createElement(_e.a,{pagination:!1,bordered:!0,dataSource:this.state.tableFormValues,columns:r}),m.a.createElement(Xe.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(Lt.a,{placement:"topCenter",overlay:m.a.createElement(Pe.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Pe.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(L.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement(M.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0,float:"right"}}),m.a.createElement(_.a,{type:"primary",htmlType:"submit",style:{margin:5}},"Save Treatment Plan"),t.props.history?m.a.createElement(_.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null))),m.a.createElement("div",{ref:function(e){t.bottomPoint=e}}))),m.a.createElement(g.a,{span:7},m.a.createElement(Xe.a,{offsetTop:0},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(V.a.Search,{placeholder:"Search in plans ...",onChange:function(t){return e.searchValues(t.target.value)}})),m.a.createElement(b.a,{size:"small",style:{maxHeight:"100vh",overflowX:"scroll"},itemLayout:"horizontal",dataSource:this.state.filteredItems,loading:this.state.loadingProcedures,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.add(t)}},m.a.createElement(b.a.Item.Meta,{title:t.name}))}}))))))}}]),t}(m.a.Component),un=M.a.create()(sn),dn=h.a.confirm,mn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).updateFormValue=function(e,t){a.setState(Object(F.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:wt.get(e,"patient.user.first_name"),treatmentId:wt.get(e,"id"),mail_to:wt.get(e,"patient.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.treatmentId,i={mail_to:t};Object(se.g)(Object(Y.f)(q.Id,[n]),i),a.mailModalClose()},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,treatmentPlans:[],procedure_category:null,incompletedTreatmentPlans:[],loading:!0,selectedTreatments:{}},a.loadTreatmentPlans=a.loadTreatmentPlans.bind(Object(o.a)(a)),a.editTreatmentPlanData=a.editTreatmentPlanData.bind(Object(o.a)(a)),a.submitCompleteTreatment=a.submitCompleteTreatment.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadTreatmentPlans()}},{key:"loadTreatmentPlans",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=[],a=this;this.setState({loading:!0});var n=function(e){a.setState((function(t){return 1==e.current?{treatmentPlans:Object(T.a)(e.results),next:e.next,loading:!1}:{treatmentPlans:[].concat(Object(T.a)(t.treatmentPlans),Object(T.a)(e.results)),next:e.next,loading:!1}})),e.results.forEach((function(e){e.is_completed||t.push(e)})),a.setState((function(a){return 1==e.current?{incompletedTreatmentPlans:[].concat(t),loading:!1}:{incompletedTreatmentPlans:[].concat(Object(T.a)(a.incompletedTreatmentPlans),t),loading:!1}}))},i=function(){a.setState({loading:!1})},r={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(r.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete r.practice,Object(Y.c)(q.Gd,n,i,r)}},{key:"editTreatmentPlanData",value:function(e){console.log("record",e.id),this.setState({editTreatmentPlan:e,loading:!1});e.patient;this.props.history.push("/patient/".concat(e.id,"/emr/plans/edit"))}},{key:"deleteTreatmentPlans",value:function(e){var t=this;dn({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a={id:e.id,patient:e.patient.id,is_active:!1};Object(Y.j)(Object(Y.f)(q.Gd,[t.props.match.params.id],null),a,(function(e){t.loadTreatmentPlans(),Object(Y.a)(H.Sb,"Treatment Plan Deleted Successfully!")}),(function(){}))},onCancel:function(){console.log("Cancel")}})}},{key:"treatmentCompleteToggle",value:function(e,t){this.setState((function(a){return{selectedTreatments:Object(A.a)({},a.selectedTreatments,Object(F.a)({},e,!!t))}}))}},{key:"submitCompleteTreatment",value:function(){var e=this,t=this.state.selectedTreatments,a=Object.keys(t),n={treatment:[],patient:e.props.match.params.id};a.forEach((function(e){var a={id:e,is_completed:t[e]};n.treatment.push(a)}));Object(Y.j)(Object(Y.f)(q.Hd,[this.props.match.params.id]),n,(function(t){e.loadTreatmentPlans(),e.setState({selectedTreatments:{}})}),(function(){}))}},{key:"loadPDF",value:function(e){Object(Y.c)(Object(Y.f)(q.Id,[e]),(function(e){e.report&&window.open(Tt.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=[{title:"",key:"is_completed",render:function(t,a){return a.is_completed?m.a.createElement(k.a,{type:"check-circle",theme:"twoTone",style:{marginLeft:"8px",fontSize:"20px"}}):m.a.createElement(me.a,{key:a.id,onChange:function(t){return e.treatmentCompleteToggle(a.id,t.target.checked)},value:e.state.selectedTreatments[a.id]})}},{title:"Procedure",dataIndex:"procedure",key:"procedure",render:function(e,t){return m.a.createElement("span",null," ",e.name)}},{title:"Quantity",dataIndex:"quantity",key:"quantity"},{title:"Discount",dataIndex:"discount",key:"discount"},{title:"Cost per  Unit",dataIndex:"cost",key:"cost"},{title:"Notes",dataIndex:"default_notes",key:"default_notes"}];return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/plans/add",render:function(a){return m.a.createElement(un,Object.assign({},e.state,a,t.props,{loadData:e.loadTreatmentPlans}))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/plans/edit",render:function(a){return e.state.editTreatmentPlan?m.a.createElement(un,Object.assign({},e.state,a,t.props,{loadData:e.loadTreatmentPlans,editId:e.state.editTreatmentPlan.id})):m.a.createElement(p.a,{to:"/patient/".concat(e.props.match.params.id,"/emr/plans")})}}),m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," TreatmentPlans"):"TreatmentPlans",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{onClick:this.submitCompleteTreatment},m.a.createElement(k.a,{type:"save"}),"Save"),m.a.createElement(C.b,{to:"/patient/".concat(this.props.match.params.id,"/emr/plans/add")},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"Add")))}),m.a.createElement(n.a,{spinning:this.state.loading},this.state.treatmentPlans.map((function(n){return m.a.createElement(j.a,{bodyStyle:{padding:0},style:{marginTop:15}},m.a.createElement("div",{style:{padding:16}},m.a.createElement("h4",null,n.date?x()(n.date).format("ll"):null,m.a.createElement(Lt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Pe.a,null,m.a.createElement(Pe.a.Item,{key:"1",onClick:function(){return t.editTreatmentPlanData(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Pe.a.Item,{key:"2",onClick:function(){return t.deleteTreatmentPlans(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"3"},m.a.createElement(C.b,{to:"/patient/".concat(n.patient,"/emr/timeline")},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(n)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},m.a.createElement(k.a,{type:"printer"}))))),m.a.createElement(_e.a,{loading:e.state.loading,columns:a,dataSource:n.treatment_plans,footer:function(){return pn(n)},pagination:!1,key:n.id}))}))),m.a.createElement(W.a,{loaderFunction:function(){return e.loadTreatmentPlans(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Treatment  To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}}))))):m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," TreatmentPlans"):"TreatmentPlans",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{onClick:this.submitCompleteTreatment},m.a.createElement(k.a,{type:"save"}),"Save"),m.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))}),m.a.createElement(n.a,{spinning:this.state.loading},this.state.treatmentPlans.map((function(n){return m.a.createElement(j.a,{bodyStyle:{padding:0},key:n.id,style:{marginTop:15}},m.a.createElement("div",{style:{padding:16}},m.a.createElement("h4",null,n.date?x()(n.date).format("ll"):null,m.a.createElement(C.b,{to:"/patient/".concat(n.patient.id,"/emr/plans")},"\xa0\xa0 ",n.patient.user?n.patient.user.first_name:null," (ID: ",n.patient.custom_id?n.patient.custom_id:n.patient.id,")\xa0"),m.a.createElement("span",null,", ",n.patient.gender),m.a.createElement(Lt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Pe.a,null,m.a.createElement(Pe.a.Item,{key:"1",disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(C.b,{to:"/patient/".concat(n.patient.id,"/emr/plans/edit")},m.a.createElement(k.a,{type:"edit"}),"\xa0 Edit")),m.a.createElement(Pe.a.Item,{key:"2",onClick:function(){return t.deleteTreatmentPlans(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"3"},m.a.createElement(C.b,{to:"/patient/".concat(n.patient,"/emr/timeline")},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(n)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},m.a.createElement(k.a,{type:"printer"}))))),m.a.createElement(_e.a,{loading:e.state.loading,columns:a,dataSource:n.treatment_plans,footer:function(){return pn(n)},pagination:!1,key:n.id}))}))),m.a.createElement(W.a,{loaderFunction:function(){return e.loadTreatmentPlans(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Treatment To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})))}}]),t}(m.a.Component);function pn(e){return e?m.a.createElement("div",null,e.doctor?m.a.createElement(y.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  ".concat(e.doctor.user.first_name)," ")):null,e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null):null}var fn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).calculateItem=function(e){var t=a.props.form.getFieldsValue;console.log(t()),a.setState((function(e){Object(T.a)(e.tableFormValues).forEach((function(e){}))}))},a.removeTests=function(e,t){a.setState((function(a){return{addedLabs:Object(A.a)({},a.addedLabs,Object(F.a)({},t.id,!1)),tableFormValues:Object(T.a)(Object(wt.remove)(a.tableFormValues,(function(t){return t._id!=e})))}}))},a.add=function(e){console.log("item",e),a.setState((function(t){console.log("preview",t);var a=Math.random().toFixed(7);return t.addedLabs[e.id]?(Object(Y.a)(H.bc,"Item Already Added"),!1):{addedLabs:Object(A.a)({},t.addedLabs,Object(F.a)({},e.id,!0)),tableFormValues:[].concat(Object(T.a)(t.tableFormValues),[Object(A.a)({},e,{_id:a})])}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(!e){var n={treatment:[],patient:t.props.match.params.id};t.state.tableFormValues.forEach((function(e){e.cost=a.cost[e._id];var t={name:e.id,cost:e.cost,instruction:e.instruction,is_active:!0,practice:e.practice,margin:e.margin};n.treatment.push(t)}));console.log("DataSet",n)}}))},a.state={lab_test:[],tableFormValues:[],addedLabs:{}},console.log("urgent",a.props.active_practiceId),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadLabs()}},{key:"loadLabs",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Gb,[e.props.active_practiceId]),(function(t){e.setState({lab_test:t})}),(function(){}))}},{key:"render",value:function(){var e=this,t=this.props.form,a=t.getFieldDecorator,n=(t.getFieldValue,t.getFieldsValue,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}}),i=[{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return m.a.createElement("span",null,m.a.createElement("b",null,e))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(e,t){return m.a.createElement("span",null,m.a.createElement(M.a.Item,Object.assign({key:"cost[".concat(t._id,"]")},n),a("cost[".concat(t._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:t.cost})))}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement("a",{onClick:function(){return e.removeTests(a._id,a)}},m.a.createElement(k.a,{type:"close-circle",theme:"twoTone",twoToneColor:"#f00"})))}}];return m.a.createElement("div",null,m.a.createElement(M.a,{onSubmit:this.handleSubmit},m.a.createElement(j.a,{title:"Patient Lab Orders",bodyStyle:{padding:0},extra:m.a.createElement(M.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0}}),m.a.createElement(_.a,{type:"primary",htmlType:"submit"},"Save Lab Orders"))},m.a.createElement(f.a,{gutter:16},m.a.createElement(g.a,{span:7},m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.lab_test,renderItem:function(t){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:t.name}),m.a.createElement(_.a,{type:"primary",size:"small",shape:"circle",onClick:function(){return e.add(t)},icon:"arrow-right"}))}})),m.a.createElement(g.a,{span:17},m.a.createElement(_e.a,{pagination:!1,bordered:!0,dataSource:this.state.tableFormValues,columns:i}))))))}}]),t}(m.a.Component),hn=M.a.create()(fn),bn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,loading:!1},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"Time",dataIndex:"created_at",key:"name",render:function(e){return m.a.createElement("span",null,x()(e).format("LLL"))}},{title:"Drug",key:"drug"},{title:"Quantity",dataIndex:"qunatity",key:"quantity"},{title:"Cost Per  Unit",dataIndex:"cost",key:"cost"},{title:"Completed",key:"is_completed",render:function(e,t){return m.a.createElement(me.a,{checked:t.is_completed})}},{title:"Action",key:"action",render:function(t,a){return m.a.createElement("span",null,m.a.createElement("a",{onClick:function(){return e.editPrescriptionData(a)}},"Edit"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{href:"javascript:;"},"Delete"))}}];return m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/labtrackings/add",render:function(t){return m.a.createElement(hn,Object.assign({},e.state,t))}}),m.a.createElement(j.a,{title:this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," Lab Order"):"Patients Lab Order",extra:m.a.createElement(_.a.Group,null,m.a.createElement(C.b,{to:"/patient/".concat(this.props.match.params.id,"/emr/labtrackings/add")},m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"plus"}),"Add")))},m.a.createElement(_e.a,{loading:this.state.loading,columns:t,dataSource:this.state.payments}))))}}]),t}(m.a.Component),yn=(a(139),a(101)),gn=(a(374),a(378)),En=(a(92),V.a.Search),vn=xa.a.TabPane,_n=gn.a.Text,On={_id:null,quantity:0,batch:null},Pn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).selectedDefaultDate=function(e){a.setState({selectedDate:e})},a.loadEditInvoiceData=function(){var e=Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.jd,[a.props.editId]),(function(t){var a=t;e.setState((function(e){var t=[];a.procedure.forEach((function(e){t.push(Object(A.a)({},e.procedure_data,{},e,{selectedDoctor:e.doctor_data,selectedDate:x()(e.date).isValid()?x()(e.date):null,_id:Math.random().toFixed(7),item_type:Q.vb}))}));var n=Object(A.a)({},e.stocks),i=Object(A.a)({},e.itemBatches);return a.inventory.forEach((function(e){if(i[e.inventory]=e.inventory_item_data.item_type_stock.item_stock||[],n[e.inventory]){var a=n[e.inventory];e.inventory_item_data.item_type_stock&&e.inventory_item_data.item_type_stock.item_stock&&e.inventory_item_data.item_type_stock.item_stock.forEach((function(e){a[e.batch_number]?a[e.batch_number]+=e.quantity:a[e.batch_number]=e.quantity}))}else{var r={};e.inventory_item_data.item_type_stock&&e.inventory_item_data.item_type_stock.item_stock&&e.inventory_item_data.item_type_stock.item_stock.forEach((function(e){r[e.batch_number]=e.quantity})),n[e.inventory_item_data.id]=r}if(n[e.inventory]){var l=n[e.inventory];l[e.batch_number]?l[e.batch_number]+=e.unit:l[e.batch_number]=e.unit}else{var c={};c[e.batch_number]=e.unit,n[e.inventory]=c}i[e.inventory]&&i[e.inventory].forEach((function(t){t.batch_number==e.batch_number&&(e.selectedBatch=t)})),t.push(Object(A.a)({},e.inventory_item_data,{},e,{selectedDoctor:e.doctor_data,_id:Math.random().toFixed(7),item_type:Q.X}))})),{tableFormValues:t,selectedDate:x()(a.date).isValid()?x()(a.date):null,stocks:n,itemBatches:i}}))}),(function(){}))},a.remove=function(e){a.setState((function(t){var a=[];return t.tableFormValues.forEach((function(t){t._id!=e&&a.push(t)})),{tableFormValues:a}}))},a.add=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random().toFixed(7);a.setState((function(a){e.item_type==Q.vb?e=Object(A.a)({},e,{id:void 0,unit:1,unit_cost:e.cost,procedure:e.id,selectedDoctor:a.selectedDoctor?a.selectedDoctor:null,selectedDate:x()(),taxes:e.taxes.map((function(e){return e.id}))}):e.item_type==Q.X&&(e=Object(A.a)({},e,{id:void 0,inventory:e.id,unit_cost:e.retail_without_tax,selectedDoctor:a.selectedDoctor?a.selectedDoctor:null}));var n=0;return this.props.MedicalMembership&&(n=this.props.MedicalMembership.medical_membership.benefit),{tableFormValues:[Object(A.a)({},On,{},e,{id:void 0,_id:t,discount:n})].concat(Object(T.a)(a.tableFormValues))}}))},a.selectDoctor=function(e,t,n){a.setState((function(a){var i=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?i.push(Object(A.a)({},a,{selectedDoctor:e})):i.push(a)})),{tableFormValues:i}}))},a.selectedDate=function(e,t,n){a.setState((function(a){var i=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?i.push(Object(A.a)({},a,{selectedDate:e})):i.push(a)})),{tableFormValues:i}}))},a.selectBatch=function(e,t,n){a.setState((function(a){var i=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?i.push(Object(A.a)({},a,{selectedBatch:e})):i.push(a)})),{tableFormValues:i}}))},a.addPrescription=function(e){var t=Object(o.a)(a);e.drugs.forEach((function(a){a.inventory.maintain_inventory&&t.add(Object(A.a)({},a.inventory,{item_type:Q.X,inventory:e.inventory.id,id:void 0}))})),t.setState((function(t){return{selectedPrescriptions:[].concat(Object(T.a)(t.selectedPrescriptions),[e.id])}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);a.props.form.validateFields((function(a,n){if(!a){t.setState({});var i={promo_code:t.state.promoCode,practice:t.props.active_practiceId,patient:t.props.match.params.id,unit:null,cost:null,discount:null,taxes:0,total:null,procedure:[],inventory:[],prescription:t.state.selectedPrescriptions,notes:n.notes,date:t.state.selectedDate&&x()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null};t.state.tableFormValues.forEach((function(e){switch(e.unit=n.unit[e._id],e.taxes=n.taxes[e._id],e.item_type){case Q.vb:i.procedure.push({name:e.name,unit:e.unit,procedure:e.procedure,default_notes:null,is_active:!0,margin:e.margin,taxes:e.taxes,unit_cost:e.unit_cost,discount:e.discount,discount_type:e.discount_type,offers:e.offers,doctor:e.selectedDoctor?e.selectedDoctor.id:null,id:t.props.editId?e.id:void 0});break;case Q.X:i.inventory.push({inventory:e.inventory,name:e.name,unit:e.unit,taxes:e.taxes,unit_cost:e.unit_cost,discount:e.discount,discount_type:e.discount_type,offers:e.offers,doctor:e.selectedDoctor?e.selectedDoctor.id:null,instruction:e.instruction,is_active:!0,batch_number:e.selectedBatch?e.selectedBatch.batch_number:null,id:t.props.editId?e.id:void 0});break;default:return null}}));var r=function(a){if(t.setState({saveLoading:!1}),Object(Y.a)("Inventory updated successfully"),t.props.loadData(),e)t.props.history.goBack();else{var n="/patient/".concat(t.props.match.params.id,"/billing/payments/add?invoices=").concat(a.id);t.props.history.replace(n)}},l=function(){t.setState({saveLoading:!1})};t.props.editId?Object(Y.l)(Object(Y.f)(q.jd,[t.props.editId]),i,r,l):Object(Y.j)(q.V,i,r,l)}}))},a.addItemThroughQR=function(e){var t=Object(o.a)(a);t.setState({loadingQr:!0});var n=e.split("*");Object(Y.c)(q.Xc,(function(e){var a=t.props.form,i=a.setFieldsValue,r=(a.getFieldsValue,a.getFieldValue),l=Math.random().toFixed(7),c=!0;if(t.state.tableFormValues.forEach((function(e){if(e.name==n[0]){var t=e._id,a=e.selectedBatch.batch_number,l=r("unit[".concat(t,"]"));a==n[1]&&(c=!1,i(Object(F.a)({},"unit[".concat(t,"]"),l+1)))}})),c){var o=null;e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(t){t.batch_number==n[1]&&(e.selectedBatch=t,o=t.unit_cost)})),t.add(Object(A.a)({},e,{item_type:Q.X}),l),i(Object(F.a)({},"unit_cost[".concat(l,"]"),o))}t.setState((function(e){return{loadingQr:!1,qrValue:""}}))}),(function(){}),{qr:e,form:"Invoice"})},a.setQrValue=function(e){var t=e.target.value;a.setState({qrValue:t})},a.searchValues=function(e,t){var n=Object(o.a)(a),i=e.target.value;a.setState({searchItem:i},(function(){t==Q.X?n.loadInventoryItemList():t==Q.tb?n.loadPrescriptions():t==Q.vb&&n.loadProcedures()}))},a.changeNetPrice=function(e,t){var n=Object(o.a)(a),i=a.props.form,r=i.getFieldsValue;i.setFields;setTimeout((function(){var a=r();a.unit_cost[e]||a.unit[e]||a.discount[e]||a.discount_type[e]?n.setState((function(n){var i=[];return n.tableFormValues.forEach((function(r){if(r._id==e){var l=0,c=0,o="%",s=null,u=!(!r.selectOption&&0!=r.selectOption)&&r.selectOption;a.taxes[e].forEach((function(e){n.taxes_list.forEach((function(t){t.id==e&&(l+=t.tax_value)}))})),t&&"0"==t&&(u=!1),a.discount_type&&a.discount_type[e]?(c=a.discount[e],o=a.discount_type[e],s=null):(c=a.discount[e]?a.discount[e].toString().split("#")[0]:"",o=a.discount[e]?a.discount[e].toString().split("#")[1]:"",s=a.discount[e]?a.discount[e].toString().split("#")[2]:null);var d=a.unit[e]*(a.unit_cost[e]?a.unit_cost[e]:0);"%"==o&&c?(c>100&&(c=100),d*=1-.01*c):"INR"==o&&c&&(d>c?d-=c:d=0);var m=(d*=1+.01*l)/a.unit[e];i.push(Object(A.a)({},r,{total_unit_cost:m,total:d,selectOption:u,discount:c,discount_type:o,offers:s}))}else i.push(r)})),{tableFormValues:i}})):n.setState({retail_price:0}),n.checkPromoCode()}),1e3)},a.applyPromoCodeDiscounts=function(e){var t=Object(o.a)(a),n=t.props.form,i=n.setFieldsValue,r=n.getFieldsValue,l=[],c=r(),s=e,u={};t.state.tableFormValues.forEach((function(e){var a=0,n=0,i=!(!e.selectOption&&0!=e.selectOption)&&e.selectOption;c.taxes[e._id].forEach((function(e){t.state.taxes_list.forEach((function(t){t.id==e&&(a+=t.tax_value)}))}));var r=c.unit[e._id]*(c.unit_cost[e._id]?c.unit_cost[e._id]:0),o=0;s&&(r>s?(r-=s,o=s,n=s,s=0):(s-=r,o=r,n=r,r=0));var d=(r*=1+.01*a)/c.unit[e._id];l.push(Object(A.a)({},e,{total_unit_cost:d,total:r,selectOption:i,discount:o,discount_type:"INR",offers:null})),u["discount[".concat(e._id,"]")]=n.toFixed(2),u["discount_type[".concat(e._id,"]")]="INR"})),t.setState({tableFormValues:l}),i(u)},a.loadLoyaltyDiscount=function(){var e=Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.hc,[a.props.active_practiceId]),(function(t){e.setState({offers:t})}),(function(){e.setState({})}))},a.onChangeOption=function(e,t){Object(o.a)(a).setState((function(e){var a=[];return e.tableFormValues.forEach((function(e){e._id==t?a.push(Object(A.a)({},e,{selectOption:!0})):a.push(e)})),{tableFormValues:a}}))},a.onChangeOffer=function(e,t){Object(o.a)(a).setState((function(a){var n=[];return a.tableFormValues.forEach((function(i){i._id==t?("none"==e&&n.push(Object(A.a)({},i,{loyaltyDiscount:null})),"0"==e?n.push(Object(A.a)({},i,{selectOption:!1})):a.offers.forEach((function(t){t.id==e&&n.push(Object(A.a)({},i,{loyaltyDiscount:t.discount}))}))):n.push(i)})),{tableFormValues:n}}))},a.onchangeDiscountSimple=function(e,t){console.log(e,t),Object(o.a)(a).setState((function(a){var n=[];return a.tableFormValues.forEach((function(a){if(a._id==t){var i=a.unit_cost/(1+.01*e);console.log(i),n.push(Object(A.a)({},a,{loyaltyDiscount:e}))}else n.push(a)})),{tableFormValues:n}}))},a.enterPromoCode=function(e){a.setState({promoCode:e.target.value})},a.calculateGrandTotalWithoutDiscount=function(){var e=0,t=Object(o.a)(a),n=(0,a.props.form.getFieldsValue)();return a.state.tableFormValues.forEach((function(a){var i=0;n.taxes[a._id].forEach((function(e){t.state.taxes_list.forEach((function(t){t.id==e&&(i+=t.tax_value)}))}));var r=n.unit[a._id]*(n.unit_cost[a._id]?n.unit_cost[a._id]:0);e+=r*=1+.01*i})),e},a.checkPromoCode=function(e){var t=Object(o.a)(a);t.setState({promoCodeCheckLoading:!0});var n={promo_code:a.state.promoCode,practice:a.props.active_practiceId,patient:t.props.match.params.id,amount:a.calculateGrandTotalWithoutDiscount()};n.promo_code?Object(Y.c)(q.O,(function(e){t.setState({appliedPromoCodeDiscount:e.discount,promoCodeCheckLoading:!1}),t.applyPromoCodeDiscounts(e.discount)}),(function(){t.setState({promoCodeCheckLoading:!1,appliedPromoCodeDiscount:null,promoCode:""})}),n):t.setState({promoCodeCheckLoading:!1})},a.removePromoCode=function(){a.setState({appliedPromoCodeDiscount:0,promoCodeCheckLoading:!1,promoCode:""}),a.applyPromoCodeDiscounts(0)},a.state={classType:e.type,tableFormValues:[],maxQuantityforConsume:{},items:{},practiceDoctors:[],selectedPrescriptions:[],selectedDate:x()(),stocks:{},itemBatches:{},saveLoading:!1,qrValue:"",searchItem:"",selectedDoctor:{},tempValues:{},offers:[],loading:!1,taxes_list:[],promoCode:"",appliedPromoCodeDiscount:null,promoCodeCheckLoading:!1},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(se.d)(this),this.loadInventoryItemList(),this.loadProcedures(),this.loadPrescriptions(),this.loadTaxes(),this.loadLoyaltyDiscount(),this.props.editId&&setTimeout((function(){e.setState({loading:!1}),e.loadEditInvoiceData()}),2e3)}},{key:"loadInventoryItemList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=this.state.searchItem;t.setState({loadingInventory:!0});var n=function(e){var n=e.results,i=[];t.state.searchItem==a&&t.setState((function(t){var a=Object(A.a)({},t.stocks),r=Object(A.a)({},t.itemBatches);n.forEach((function(e){if(i.push(e),a[e.id]){var t=a[e.id];e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(e){t[e.batch_number]?t[e.batch_number]+=e.quantity:t[e.batch_number]=e.quantity}))}else{var n={};e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(e){n[e.batch_number]=e.quantity})),a[e.id]=n}e.item_type_stock.item_stock&&(console.log(r,r[e.id],e),r[e.id]?r[e.id]=[].concat(Object(T.a)(r[e.id]),Object(T.a)(e.item_type_stock.item_stock)):r[e.id]=Object(T.a)(e.item_type_stock.item_stock))}));var l=t.items;return l[Q.X]=Object(A.a)({},e,{results:i}),{items:l,stocks:Object(A.a)({},t.stocks,{},a),itemBatches:Object(A.a)({},t.itemBatches,{},r),loadingInventory:!1}}),(function(){t.props.editId&&t.loadEditInvoiceData()}))},i=function(){t.setState({loadingInventory:!1})},r={practice:this.props.active_practiceId,maintain_inventory:!0,page:e};this.state.searchItem&&(r.item_name=a),Object(Y.c)(q.xb,n,i,r)}},{key:"loadProcedures",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=this.state.searchItem,n=function(e){var n=t.state.items;n[Q.vb]=e,t.state.searchItem==a&&t.setState({items:n})},i=function(){},r={practice:this.props.active_practiceId,page:e};this.state.searchItem&&(r.name=a),Object(Y.c)(Object(Y.f)(q.Lc,[this.props.active_practiceId]),n,i,r)}},{key:"loadPrescriptions",value:function(){var e=this,t=this.state.searchItem,a={practice:this.props.active_practiceId};this.state.searchItem&&(a.item_name=t),Object(Y.c)(Object(Y.f)(q.Jd,[e.props.match.params.id]),(function(a){e.state.searchItem==t&&e.setState((function(e){return{items:Object(A.a)({},e.items,Object(F.a)({},Q.tb,a))}}))}),(function(){}),a)}},{key:"loadTaxes",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Fd,[this.props.active_practiceId]),(function(t){e.setState({taxes_list:t})}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=this.props.form.getFieldDecorator,i={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:24},md:{span:24},lg:{span:24},xl:{span:24}}};a("keys",{initialValue:[]});var r=[{title:"Item Name",key:"item_name",dataIndex:"name",width:180,render:function(e,n){switch(n.item_type){case Q.vb:return m.a.createElement(M.a.Item,Object.assign({key:"name[".concat(n._id,"]")},i),a("name[".concat(n._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:e,rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(V.a,{min:0,placeholder:"Item name",size:"small"})),m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(Lt.a,{placement:"topCenter",overlay:m.a.createElement(Pe.a,null,t.state.practiceDoctors.map((function(e){return m.a.createElement(Pe.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return t.selectDoctor(e,n._id,Q.vb)}},e.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,n.selectedDoctor.user?n.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(L.a,{value:n.selectedDate,size:"small",onChange:function(e){return t.selectedDate(e,n._id,Q.vb)},format:"DD-MM-YYYY"}));case Q.tb:return m.a.createElement("b",null,n.name);case Q.X:return m.a.createElement("div",null,m.a.createElement("span",null,n.name),m.a.createElement("span",null,m.a.createElement("br",null),"by \xa0\xa0"),m.a.createElement(Lt.a,{placement:"topCenter",overlay:m.a.createElement(Pe.a,null,t.state.practiceDoctors.map((function(e){return m.a.createElement(Pe.a.Item,{key:e.id},m.a.createElement("a",{onClick:function(){return t.selectDoctor(e,n._id,Q.X)}},e.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,n.selectedDoctor.user?n.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null,m.a.createElement("br",null),"from batch \xa0\xa0"),m.a.createElement(Lt.a,{placement:"topCenter",overlay:m.a.createElement(Pe.a,null,t.state.itemBatches[n.inventory]&&t.state.itemBatches[n.inventory].map((function(e,a){return x()()>=x()(e.expiry_date)?m.a.createElement(Pe.a.Item,{key:a,disabled:!0},e.batch_number,"\xa0(",e.quantity,") \xa0\xa0",e.expiry_date):m.a.createElement(Pe.a.Item,{key:a},m.a.createElement("a",{onClick:function(){return t.selectBatch(e,n._id,Q.X)}},e.batch_number,"\xa0(",e.quantity,") \xa0\xa0",e.expiry_date))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,n.selectedBatch?n.selectedBatch.batch_number:"Select Batch"))));default:return null}}}];return r=(r=r.concat([{title:"Unit",key:"unit",width:100,dataIndex:"unit",render:function(n,r){return r.item_type==Q.X?m.a.createElement(M.a.Item,Object.assign({key:"unit[".concat(r._id,"]")},i),a("unit[".concat(r._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:r.unit||0,rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(I.a,{min:1,max:r.selectedBatch&&t.state.stocks[r.inventory]&&t.state.stocks[r.inventory][r.selectedBatch.batch_number]?t.state.stocks[r.inventory][r.selectedBatch.batch_number]:0,placeholder:"units",size:"small",onChange:function(t){return e.changeNetPrice(r._id,r.discount)},disabled:!(r.selectedBatch&&t.state.stocks[r.inventory]&&t.state.stocks[r.inventory][r.selectedBatch.batch_number])}))):m.a.createElement(M.a.Item,Object.assign({key:"unit[".concat(r._id,"]")},i),a("unit[".concat(r._id,"]"),{initialValue:r.unit||0,validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(I.a,{min:1,max:100,placeholder:"unit",size:"small",onChange:function(t){return e.changeNetPrice(r._id,r.discount)}})))}},{title:"Unit Cost",key:"unit_cost",width:100,dataIndex:"unit_cost",render:function(e,n){return m.a.createElement(M.a.Item,Object.assign({key:"unit_cost[".concat(n._id,"]")},i),a("unit_cost[".concat(n._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:n.item_type==Q.X?n.retail_without_tax:n.cost,rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(I.a,{min:1,placeholder:"Unit Cost",size:"small",onChange:function(){return t.changeNetPrice(n._id,n.discount)}})))}},{title:"Discount",key:"discount",dataIndex:"discount",render:function(n,r){return r.selectOption?m.a.createElement(M.a.Item,{key:"discount[".concat(r._id,"]"),extra:m.a.createElement("span",null,r&&r.discount?"".concat(r.discount," ").concat(r.discount_type," Discount"):null," ")},a("discount[".concat(r._id,"]"),{initialValue:r.offers,validateTrigger:["onChange","onBlur"]})(m.a.createElement(w.a,{style:{width:150},onChange:function(e){return t.changeNetPrice(r._id,e)},size:"small",disabled:e.state.appliedPromoCodeDiscount},m.a.createElement(w.a.Option,{value:"0"},"Custom Offer"),t.state.offers.map((function(e){return m.a.createElement(w.a.Option,{value:"".concat(e.discount,"#").concat(e.unit,"#").concat(e.id)},e.code)}))))):m.a.createElement(M.a.Item,Object.assign({extra:m.a.createElement("a",{onClick:function(){return t.onChangeOption("selectOption",r._id)},disabled:e.state.appliedPromoCodeDiscount},"Choose Offer"),key:"discount[".concat(r._id,"]")},i),a("discount[".concat(r._id,"]"),{initialValue:r.discount?r.discount:0,validateTrigger:["onChange","onBlur"]})(m.a.createElement(V.a,{placeholder:"discount",disabled:e.state.appliedPromoCodeDiscount,addonAfter:a("discount_type[".concat(r._id,"]"),{initialValue:r.discount_type||"%"})(m.a.createElement(w.a,{onChange:function(e){return t.changeNetPrice(r._id,e)},disabled:e.state.appliedPromoCodeDiscount},Q.p.map((function(e){return m.a.createElement(w.a.Option,{value:e.value}," ",e.value)})))),size:"small",style:{width:150},onChange:function(t){return e.changeNetPrice(r._id,t.target.value)}})))}},{title:"Taxes",key:"taxes",dataIndex:"taxes",render:function(n,r){return m.a.createElement(M.a.Item,Object.assign({key:"taxes[".concat(r._id,"]")},i),a("taxes[".concat(r._id,"]"),{initialValue:r.taxes||[],validateTrigger:["onChange","onBlur"]})(m.a.createElement(w.a,{placeholder:"Taxes",size:"small",mode:"multiple",style:{width:150},onChange:function(){return t.changeNetPrice(r._id,r.discount)}},e.state.taxes_list&&e.state.taxes_list.map((function(e){return m.a.createElement(w.a.Option,{value:e.id},e.name,"@",e.tax_value,"%")})))))}},{title:"Total Unit Cost",key:"total_unit_cost",width:80,align:"right",dataIndex:"total_unit_cost",render:function(e,t){return m.a.createElement("span",null,e?e.toFixed(2):"0.00")}},{title:"Total",key:"total",width:80,align:"right",dataIndex:"total",render:function(e,t){return e?e.toFixed(2):"0.00"}}])).concat([{key:"_id",dataIndex:"_id",render:function(e,a){return m.a.createElement(_.a,{icon:"close",onClick:function(){return t.remove(a._id)},type:"danger",shape:"circle",size:"small"})}}]),m.a.createElement("div",null,m.a.createElement(n.a,{spinning:this.state.saveLoading,tip:"Saving Invoice..."},m.a.createElement(n.a,{spinning:this.state.promoCodeCheckLoading,tip:"Checking Promo Code and Discounts..."},m.a.createElement(j.a,{title:this.props.editId?"Edit Invoice (INV ".concat(this.props.editId,")"):"Add Invoice",extra:m.a.createElement(En,{loading:this.state.loadingQr,value:this.state.qrValue,onChange:this.setQrValue,placeholder:"Search QR Code",onSearch:this.addItemThroughQR,style:{width:200}}),bodyStyle:{padding:0}},m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement(xa.a,{size:"small",type:"card"},m.a.createElement(vn,{tab:Q.X,key:Q.X},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(V.a.Search,{placeholder:"Search in ".concat(Q.X),onChange:function(t){return e.searchValues(t,Q.X)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",loading:this.state.loadingInventory,dataSource:this.state.items&&this.state.items[Q.X]?this.state.items[Q.X].results:[],renderItem:function(t){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:"".concat(t.name," (").concat(t.total_quantity,")")}),m.a.createElement(_.a,{type:"primary",size:"small",shape:"circle",onClick:function(){return e.add(Object(A.a)({},t,{item_type:Q.X}))},icon:"arrow-right"}))}}),this.state.items&&this.state.items[Q.X]?m.a.createElement("div",{style:{textAlign:"center"}},m.a.createElement("a",{style:{margin:5},disabled:!this.state.items[Q.X].previous,onClick:function(){return e.loadInventoryItemList(e.state.items[Q.X].previous)}},m.a.createElement(k.a,{type:"left"}),"Previous"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{style:{margin:5},disabled:!this.state.items[Q.X].next,onClick:function(){return e.loadInventoryItemList(e.state.items[Q.X].next)}},"Next",m.a.createElement(k.a,{type:"right"}))):null),m.a.createElement(vn,{tab:Q.tb,key:Q.tb},m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.items?this.state.items[Q.tb]:[],renderItem:function(t){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:t.drugs.map((function(e){return m.a.createElement("div",null,m.a.createElement("span",null,e.name)," ",e.inventory.maintain_inventory?null:m.a.createElement(y.a,{color:"red",style:{float:"right",lineHeight:"18px"}},"Not Sold"),m.a.createElement("br",null))})),description:t.doctor?m.a.createElement(y.a,{color:t.doctor?t.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  ".concat(t.doctor.user.first_name)," ")):null}),m.a.createElement(_.a,{type:"primary",size:"small",shape:"circle",onClick:function(){return e.addPrescription(Object(A.a)({},t))},icon:"arrow-right"}))}})),m.a.createElement(vn,{tab:Q.vb,key:Q.vb},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(V.a.Search,{placeholder:"Search in ".concat(Q.vb),onChange:function(t){return e.searchValues(t,Q.vb)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.items&&this.state.items[Q.vb]?this.state.items[Q.vb].results:[],renderItem:function(t){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:t.name}),m.a.createElement(_.a,{type:"primary",size:"small",shape:"circle",onClick:function(){return e.add(Object(A.a)({},t,{item_type:Q.vb}))},icon:"arrow-right"}))}}),this.state.items&&this.state.items[Q.vb]?m.a.createElement("div",{style:{textAlign:"center"}},m.a.createElement("a",{style:{margin:5},disabled:!this.state.items[Q.vb].previous,onClick:function(){return e.loadProcedures(e.state.items[Q.vb].previous)}},m.a.createElement(k.a,{type:"left"}),"Previous"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{style:{margin:5},disabled:!this.state.items[Q.vb].next,onClick:function(){return e.loadProcedures(e.state.items[Q.vb].next)}},"Next",m.a.createElement(k.a,{type:"right"}))):null))),m.a.createElement(g.a,{span:18},m.a.createElement(M.a,null,m.a.createElement(_e.a,{pagination:!1,loading:t.state.loading,bordered:!0,dataSource:this.state.tableFormValues,columns:r}),m.a.createElement(Xe.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement(g.a,{span:8},m.a.createElement(M.a.Item,Object.assign({label:"Notes",key:"notes"},i),a("notes",{initialValue:this.state.notes,validateTrigger:["onChange","onBlur"]})(m.a.createElement(V.a.TextArea,{row:2,placeholder:"Notes...",size:"small"}))),m.a.createElement("h3",null,"Grand Total: ",m.a.createElement("b",null,this.state.tableFormValues.reduce((function(e,t){return(parseFloat(e)+(t&&t.total?t.total:0)).toFixed(2)}),0)))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(L.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDefaultDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement(M.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0,float:"right"}}),m.a.createElement(_.a,{type:"primary",htmlType:"submit",onClick:function(){return e.handleSubmit(!0)},style:{margin:5}},"Save Invoice"),m.a.createElement(_.a,{type:"primary",htmlType:"submit",onClick:function(){return e.handleSubmit(!1)},style:{margin:5}},"Save & Create Payment"),t.props.history?m.a.createElement(_.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null)))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:12,style:{padding:10}},m.a.createElement("div",null,this.state.appliedPromoCodeDiscount?m.a.createElement("div",null,m.a.createElement(y.a,null,"'",this.state.promoCode,"' Applied ",m.a.createElement(k.a,{onClick:function(){return e.removePromoCode()},theme:"twoTone",twoToneColor:"#f00",type:"close-circle"})),m.a.createElement(_n,{type:"success"},m.a.createElement("br",null),"Discount INR ",this.state.appliedPromoCodeDiscount)):m.a.createElement("div",null,m.a.createElement(En,{enterButton:"Apply",value:this.state.promoCode,placeholder:"Promo Code",onChange:this.enterPromoCode,onSearch:this.checkPromoCode,style:{width:200}})))))))))))}}]),t}(m.a.Component),kn=M.a.create()(Pn),jn=(V.a.Search,L.a.MonthPicker,xa.a.TabPane,{_id:null,quantity:0,batch:null}),Cn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).selectedDefaultDate=function(e){a.setState({selectedDate:e})},a.loadEditInvoiceData=function(){var e=Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.jd,[a.props.editId]),(function(t){var a=t;e.setState((function(e){var t=[];a.procedure.forEach((function(e){t.push(Object(A.a)({},e.procedure_data,{},e,{selectedDoctor:e.doctor_data,selectedDate:x()(e.date).isValid()?x()(e.date):null,_id:Math.random().toFixed(7),item_type:Q.vb}))}));var n=Object(A.a)({},e.stocks),i=Object(A.a)({},e.itemBatches);return a.inventory.forEach((function(e){if(i[e.inventory]||(i[e.inventory]=e.inventory_item_data.item_type_stock.item_stock),n[e.inventory]){var a=n[e.inventory];e.inventory_item_data.item_type_stock&&e.inventory_item_data.item_type_stock.item_stock&&e.inventory_item_data.item_type_stock.item_stock.forEach((function(e){a[e.batch_number]?a[e.batch_number]+=e.quantity:a[e.batch_number]=e.quantity}))}else{var r={};e.inventory_item_data.item_type_stock&&e.inventory_item_data.item_type_stock.item_stock&&e.inventory_item_data.item_type_stock.item_stock.forEach((function(e){r[e.batch_number]=e.quantity})),n[e.inventory_item_data.id]=r}if(n[e.inventory]){var l=n[e.inventory];l[e.batch_number]?l[e.batch_number]+=e.unit:l[e.batch_number]=e.unit}else{var c={};c[e.batch_number]=e.unit,n[e.inventory]=c}i[e.inventory]&&i[e.inventory].forEach((function(t){t.batch_number==e.batch_number&&(e.selectedBatch=t)})),t.push(Object(A.a)({},e.inventory_item_data,{},e,{selectedDoctor:e.doctor_data,_id:Math.random().toFixed(7),item_type:Q.X}))})),{tableFormValues:t,selectedDate:x()(a.date).isValid()?x()(a.date):null,stocks:n,itemBatches:i}}))}),(function(){}))},a.remove=function(e){a.setState((function(t){var a=[];return t.tableFormValues.forEach((function(t){t._id!=e&&a.push(t)})),{tableFormValues:a}}))},a.add=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random().toFixed(7);a.setState((function(a){return e.item_type==Q.vb?e=Object(A.a)({},e,{id:void 0,unit_cost:e.cost,procedure:e.id,selectedDoctor:a.selectedDoctor?a.selectedDoctor:null,selectedDate:x()(),taxes:e.taxes.map((function(e){return e.id}))}):e.item_type==Q.X&&(e=Object(A.a)({},e,{id:void 0,inventory:e.id,unit_cost:e.retail_without_tax,selectedDoctor:a.selectedDoctor?a.selectedDoctor:null})),{tableFormValues:[].concat(Object(T.a)(a.tableFormValues),[Object(A.a)({},jn,{},e,{id:void 0,_id:t})])}}))},a.selectDoctor=function(e,t,n){a.setState((function(a){var i=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?i.push(Object(A.a)({},a,{selectedDoctor:e})):i.push(a)})),{tableFormValues:i}}))},a.selectedDate=function(e,t,n){a.setState((function(a){var i=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?i.push(Object(A.a)({},a,{selectedDate:e})):i.push(a)})),{tableFormValues:i}}))},a.selectBatch=function(e,t,n){a.setState((function(a){var i=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?i.push(Object(A.a)({},a,{selectedBatch:e})):i.push(a)})),{tableFormValues:i}}))},a.addPrescription=function(e){var t=Object(o.a)(a);e.drugs.forEach((function(a){a.inventory.maintain_inventory&&t.add(Object(A.a)({},a.inventory,{item_type:Q.X,inventory:e.inventory.id,id:void 0}))})),t.setState((function(t){return{selectedPrescriptions:[].concat(Object(T.a)(t.selectedPrescriptions),[e.id])}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){t.setState({saveLoading:!0});var i={bank:"",number:"",practice:t.props.active_practiceId,return_mode:null,invoice:a.props.editInvoice.id,procedure:[],inventory:[],notes:n.notes,patient:t.props.match.params.id,staff:a.props.editInvoice.staff_data?a.props.editInvoice.staff_data.id:null,prescription:t.state.selectedPrescriptions,date:t.state.selectedDate&&x()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null,with_tax:!!a.state.return_with_tax,cash_return:n.cash_return,advance_value:a.state.returnCashAvailable-n.cash_return||0};t.state.tableFormValues.forEach((function(e){e.unit=n.unit[e._id];var t=e.id;if(delete e.id,e.unit)switch(e.item_type){case Q.vb:i.procedure.push(Object(A.a)({},e,{unit:e.unit,procedure_inv:t}));break;case Q.X:i.inventory.push(Object(A.a)({},e,{unit:e.unit,inventory_inv:t}));break;default:return null}}));Object(Y.j)(q.Eb,i,(function(e){t.setState({saveLoading:!1}),Object(Y.a)("Inventory updated successfully"),t.props.loadData();var a="/patient/".concat(t.props.match.params.id,"/billing/invoices");t.props.history.replace(a)}),(function(){t.setState({saveLoading:!1})}))}}))},a.addItemThroughQR=function(e){var t=Object(o.a)(a);t.setState({loadingQr:!0});var n=e.split("*");Object(Y.c)(q.Xc,(function(e){var a=t.props.form,i=a.setFieldsValue,r=(a.getFieldsValue,a.getFieldValue),l=Math.random().toFixed(7),c=!0;if(t.state.tableFormValues.forEach((function(e){if(e.name==n[0]){var t=e._id,a=e.selectedBatch.batch_number,l=r("unit[".concat(t,"]"));a==n[1]&&(c=!1,i(Object(F.a)({},"unit[".concat(t,"]"),l+1)))}})),c){var o=null;e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(t){t.batch_number==n[1]&&(e.selectedBatch=t,o=t.unit_cost)})),t.add(Object(A.a)({},e,{item_type:Q.X}),l),i(Object(F.a)({},"unit_cost[".concat(l,"]"),o))}t.setState((function(e){return{loadingQr:!1,qrValue:""}}))}),(function(){}),{qr:e,form:"Invoice"})},a.setQrValue=function(e){var t=e.target.value;a.setState({qrValue:t})},a.searchValues=function(e){var t=e.target.value;a.setState({searchItem:t},(function(){this.loadInventoryItemList()}))},a.changeNetPrice=function(e){var t=Object(o.a)(a),n=a.props.form,i=n.getFieldsValue;n.setFields;setTimeout((function(){var a=i();a.total_unit_cost[e]?t.setState((function(t){var n=[];return t.tableFormValues.forEach((function(i){if(i._id==e){var r=0;a.taxes[e].forEach((function(e){t.taxes_list.forEach((function(t){t.id==e&&(r+=t.tax_value)}))}));var l=a.total_unit_cost[e]/(1+.01*r);n.push(Object(A.a)({},i,{unit_cost:l}))}else n.push(i)})),{tableFormValues:n}})):t.setState({retail_price:0})}),1e3)},a.onChangeHandle=function(e){var t=Object(o.a)(a);a.setState({return_with_tax:e.target.checked},(function(){t.calculateReturnCashAvailable()}))},a.calculateReturnCashAvailable=function(){var e=Object(o.a)(a),t=a.state.editInvoice.payments.reduce((function(e,t){return e+t.pay_amount}),0),n=a.state.editInvoice.total-t,i=0,r=a.props.form.getFieldsValue;setTimeout((function(){var t=r(),a=e.state.return_with_tax;e.state.tableFormValues.forEach((function(e){var n=t.unit[e._id];e.item_type==Q.X?(i+=n*e.unit_cost,i+=a?e.tax_value/e.unit*n:null):e.item_type==Q.tb?(i+=n*e.unit_cost,i+=a?e.tax_value/e.unit*n:null):e.item_type==Q.vb&&(i+=n*e.unit_cost,i+=a?e.tax_value/e.unit*n:null)})),e.setState({returnCashAvailable:(i>n?i-n:0).toFixed(2)})}),500)},a.state={editInvoice:a.props.editInvoice,classType:e.type,tableFormValues:[],maxQuantityforConsume:{},items:{},practiceDoctors:[],selectedPrescriptions:[],selectedDate:x()(),stocks:{},itemBatches:{},saveLoading:!1,qrValue:"",searchItem:"",return_with_tax:!1,returnCashAvailable:0},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){Object(se.d)(this),this.loadProcedures(),this.loadPrescriptions(),this.loadTaxes(),this.props.editId&&this.loadEditInvoiceData()}},{key:"loadInventoryItemList",value:function(){var e=this,t={page_size:1e3,practice:this.props.active_practiceId,maintain_inventory:!0};this.state.searchItem&&(t.item_name=this.state.searchItem),Object(Y.c)(q.xb,(function(t){var a=t.results,n=[];e.setState((function(t){var i=Object(A.a)({},t.stocks),r={};a.forEach((function(e){if(e.item_type==Q.z){if(n.push(e),i[e.id]){var t=i[e.id];e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(e){t[e.batch_number],t[e.batch_number]+=e.quantity}))}else{var a={};e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(e){a[e.batch_number]=e.quantity})),i[e.id]=a}r[e.id]=e.item_type_stock.item_stock}}));var l=e.state.items;return l[Q.X]=n,{items:l,stocks:Object(A.a)({},t.stocks,{},i),itemBatches:Object(A.a)({},t.itemBatches,{},r)}}),(function(){e.props.editId&&e.loadEditInvoiceData()}))}),(function(){}),t)}},{key:"loadProcedures",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Lc,[this.props.active_practiceId]),(function(t){var a=e.state.items;a[Q.vb]=t,e.setState({items:a})}),(function(){}))}},{key:"loadPrescriptions",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Jd,[e.props.match.params.id]),(function(t){e.setState((function(e){return{items:Object(A.a)({},e.items,Object(F.a)({},Q.tb,t))}}))}),(function(){}))}},{key:"loadTaxes",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Fd,[this.props.active_practiceId]),(function(t){e.setState({taxes_list:t})}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,i=a.getFieldDecorator,r=(a.getFieldValue,a.getFieldsValue,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:24},md:{span:24},lg:{span:24},xl:{span:24}}});i("keys",{initialValue:[]});var l=[{title:"Item Name",key:"item_name",dataIndex:"name",render:function(e,a){switch(a.item_type){case Q.vb:return m.a.createElement(M.a.Item,Object.assign({key:"name[".concat(a._id,"]")},r),i("name[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:e,rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(V.a,{min:0,placeholder:"Item name",size:"small",disabled:!0})),m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(Lt.a,{placement:"topCenter",disabled:!0,overlay:m.a.createElement(Pe.a,null,t.state.practiceDoctors.map((function(e){return m.a.createElement(Pe.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return t.selectDoctor(e,a._id,Q.vb)}},e.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,a.selectedDoctor.user?a.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(L.a,{value:a.selectedDate,disabled:!0,size:"small",onChange:function(e){return t.selectedDate(e,a._id,Q.vb)},format:"DD-MM-YYYY"}));case Q.tb:return m.a.createElement("b",null,a.name);case Q.X:return m.a.createElement("div",null,a.name,m.a.createElement("span",null,m.a.createElement("br",null),"by \xa0\xa0"),m.a.createElement(Lt.a,{placement:"topCenter",disabled:!0,overlay:m.a.createElement(Pe.a,null,t.state.practiceDoctors.map((function(e){return m.a.createElement(Pe.a.Item,{key:e.id},m.a.createElement("a",{onClick:function(){return t.selectDoctor(e,a._id,Q.vb)}},e.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,a.selectedDoctor&&a.selectedDoctor.user?a.selectedDoctor.user.first_name:"+Add Doctor"))),m.a.createElement("span",null,m.a.createElement("br",null),"from batch \xa0\xa0"),m.a.createElement(Lt.a,{placement:"topCenter",disabled:!0,overlay:m.a.createElement(Pe.a,null,t.state.itemBatches[a.inventory]&&t.state.itemBatches[a.inventory].map((function(e,n){return x()()>=x()(e.expiry_date)?m.a.createElement(Pe.a.Item,{key:n,disabled:!0},e.batch_number,"\xa0(",e.quantity,") \xa0\xa0",e.expiry_date):m.a.createElement(Pe.a.Item,{key:n},m.a.createElement("a",{onClick:function(){return t.selectBatch(e,a._id,Q.X)}},e.batch_number,"\xa0(",e.quantity,") \xa0\xa0",e.expiry_date))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,a.selectedBatch?a.selectedBatch.batch_number:"Select Batch"))),a.selectedBatch&&a.selectedBatch.expiry_date&&x()(a.selectedBatch.expiry_date)<x()()?m.a.createElement(y.a,{color:"#f50"},"Expired"):null);default:return null}}}];return l=l.concat([{title:"Returning Unit",key:"unit",width:100,dataIndex:"unit",render:function(a,n){return n.item_type==Q.X?m.a.createElement(M.a.Item,Object.assign({key:"unit[".concat(n._id,"]")},r),i("unit[".concat(n._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:0})(m.a.createElement(I.a,{max:n.unit,onChange:e.calculateReturnCashAvailable,min:0,placeholder:"units",size:"small",disabled:!(n.selectedBatch&&t.state.stocks[n.inventory]&&t.state.stocks[n.inventory][n.selectedBatch.batch_number])})),m.a.createElement("span",{className:"ant-form-text"},"Items: ",n.unit)):m.a.createElement(M.a.Item,Object.assign({key:"unit[".concat(n._id,"]")},r),i("unit[".concat(n._id,"]"),{initialValue:0,validateTrigger:["onChange","onBlur"]})(m.a.createElement(I.a,{min:0,max:n.unit,placeholder:"unit",size:"small",onChange:e.calculateReturnCashAvailable})),m.a.createElement("span",{className:"ant-form-text"},"Items: ",n.unit))}},{title:"Unit Cost",key:"unit_cost",width:100,dataIndex:"unit_cost",render:function(e,t){return e?e.toFixed(2):null}},{title:"discount %",key:"discount",width:100,dataIndex:"discount",render:function(e,t){return m.a.createElement(M.a.Item,Object.assign({key:"discount[".concat(t._id,"]")},r),i("discount[".concat(t._id,"]"),{initialValue:t.discount,validateTrigger:["onChange","onBlur"]})(m.a.createElement(I.a,{min:0,max:100,placeholder:"discount",size:"small",disabled:!0})))}},{title:"Taxes",key:"taxes",dataIndex:"taxes",render:function(a,n){return m.a.createElement(M.a.Item,Object.assign({key:"taxes[".concat(n._id,"]")},r),i("taxes[".concat(n._id,"]"),{initialValue:n.taxes||[],validateTrigger:["onChange","onBlur"]})(m.a.createElement(w.a,{placeholder:"Taxes",size:"small",mode:"multiple",disabled:!0,style:{width:150},onChange:function(){return t.changeNetPrice(n._id)}},e.state.taxes_list&&e.state.taxes_list.map((function(e){return m.a.createElement(w.a.Option,{value:e.id},e.name,"@",e.tax_value,"%")})))))}},{title:"Total Unit Cost",key:"total",width:100,dataIndex:"total",render:function(e,t){return t.unit?(t.total/t.unit).toFixed(2):t.total.toFixed(2)}}]),m.a.createElement("div",null,m.a.createElement(n.a,{spinning:this.state.saveLoading,tip:"Saving Invoice..."},m.a.createElement(f.a,{gutter:16},m.a.createElement(g.a,{span:20},m.a.createElement(j.a,{title:this.props.editId?"Return Invoice (INV ".concat(this.props.editId,")"):"Add Invoice",bodyStyle:{padding:0}},m.a.createElement(f.a,{gutter:16},m.a.createElement(g.a,{span:24},m.a.createElement(M.a,{onSubmit:this.handleSubmit,layout:"inline"},m.a.createElement(_e.a,{pagination:!1,bordered:!0,dataSource:this.state.tableFormValues,columns:l}),m.a.createElement(Xe.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement(f.a,{gutter:16},m.a.createElement(g.a,{span:6},m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(L.a,{value:this.state.selectedDate,disabled:!0,onChange:function(t){return e.selectedDefaultDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement("br",null),m.a.createElement("br",null),m.a.createElement(me.a,{onChange:this.onChangeHandle,defaultChecked:this.state.return_with_tax},"Return With Tax")),m.a.createElement(g.a,{span:8},m.a.createElement(M.a.Item,{label:"Returned Cash "},i("cash_return")(m.a.createElement(I.a,{min:0,max:this.state.returnCashAvailable,placeholder:"Cash Returned"})),m.a.createElement("span",null,m.a.createElement("br",null),"Max Cash Return Allowed (INR) ",this.state.returnCashAvailable))),m.a.createElement(g.a,{span:10},m.a.createElement(M.a.Item,{label:"Notes",key:"notes"},i("notes",{initialValue:this.state.tableFormValues.notes,validateTrigger:["onChange","onBlur"]})(m.a.createElement(V.a.TextArea,{row:2,placeholder:"Notes...",size:"small",style:{width:"100%"}}))),m.a.createElement(M.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0,float:"right"}}),m.a.createElement(_.a,{type:"primary",htmlType:"submit",style:{margin:5}},"Save Return Invoice"),t.props.history?m.a.createElement(_.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null)))))))))),m.a.createElement(g.a,{span:4},m.a.createElement(v.a,null,"Payments Done"),m.a.createElement(b.a,{dataSource:this.state.editInvoice.payments,renderItem:function(e){return m.a.createElement(j.a,{title:e.payment_id,style:{marginBottom:10},bodyStyle:{padding:5}},m.a.createElement("p",null,"Paid (INR)",m.a.createElement("span",{style:{float:"right",fontWeight:600}}," ",e.pay_amount.toFixed(2))))}})))))}}]),t}(m.a.Component),Sn=M.a.create()(Cn),xn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitReturnInvoice=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var i=Object(A.a)({},n,{practice:a.props.active_practiceId});Object(Y.j)(q.M,i,(function(e){t.setState({returnIncoiceVisible:!1}),t.returnInvoiceData(t.props.editInvoice),t.props.returnInvoiceClose()}),(function(){}))}}))},a.returnInvoiceData=function(e){var t=Object(o.a)(a);a.setState({editInvoice:e},(function(){t.props.history.push("/patient/".concat(e.patient_data.id,"/billing/invoices/return/"))}))},a.state={returnIncoiceVisible:a.props.returnIncoiceVisible,otpSent:a.props.otpSent},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"sendOTP",value:function(){Object(Y.c)(q.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return m.a.createElement(h.a,{visible:this.state.returnIncoiceVisible&&this.props.editInvoice&&this.props.editInvoice.id==this.props.invoice.id,title:"Return Invoice",footer:null,onOk:this.props.handleSubmitReturnInvoice,onCancel:this.props.returnInvoiceClose},m.a.createElement(M.a,null,m.a.createElement(M.a.Item,null,e("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(V.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(M.a.Item,null,this.props.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitReturnInvoice},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:this.props.returnInvoiceClose},"Close"))))}}]),t}(m.a.Component),In=M.a.create()(xn),Dn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitEditInvoice=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var i=Object(A.a)({},n,{practice:a.props.active_practiceId});Object(Y.j)(q.M,i,(function(e){t.setState({editIncoiceVisible:!1}),t.editInvoiceData(t.props.editInvoice),t.props.editInvoiceClose()}),(function(){}))}}))},a.editInvoiceData=function(e){var t=Object(o.a)(a);a.setState({editInvoice:e},(function(){t.props.history.push("/patient/".concat(e.patient_data.id,"/billing/invoices/edit/"))}))},a.state={otpSent:a.props.otpSent,returnIncoiceVisible:a.props.returnIncoiceVisible,editIncoiceVisible:a.props.editIncoiceVisible},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"sendOTP",value:function(){Object(Y.c)(q.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return m.a.createElement(h.a,{visible:this.state.editIncoiceVisible&&this.props.editInvoice&&this.props.editInvoice.id==this.props.invoice.id,title:"Edit Invoice",footer:null,onOk:this.handleSubmitEditInvoice,onCancel:this.props.editInvoiceClose},m.a.createElement(M.a,null,m.a.createElement(M.a.Item,null,e("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(V.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(M.a.Item,null,this.props.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitEditInvoice},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:this.props.editInvoiceClose},"Close"))))}}]),t}(m.a.Component),Mn=M.a.create()(Dn),wn=a(26),Tn=V.a.TextArea,Fn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitCancelInvoice=function(e){var t=Object(o.a)(a),n=t.state.otpField;e.preventDefault(),a.props.form.validateFields((function(e,i){if(!e){var r=Object(A.a)({},i,{practice:a.props.active_practiceId});n?Object(Y.j)(q.M,r,(function(e){t.setState({cancelIncoiceVisible:!1}),t.deleteInvoice(t.props.editInvoice.patient,t.props.editInvoice.id,i.cancel_note)}),(function(){})):t.deleteInvoice(t.props.editInvoice.patient,t.props.editInvoice.id,i.cancel_note)}}))},a.state={cancelIncoiceVisible:a.props.cancelIncoiceVisible,otpSent:a.props.otpSent,otpField:!1},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){x()().diff(this.props.editInvoice.created_at,"minutes")>H.qb&&this.setState({otpField:!0})}},{key:"deleteInvoice",value:function(e,t,a){var n=this,i={patient:e,is_cancelled:!0,cancel_note:a};Object(Y.l)(Object(Y.f)(q.id,[t]),i,(function(e){n.props.cancelInvoiceClose(),Object(Y.a)(H.Sb,"Invoice cancelled successfully"),n.props.loadInvoices()}),(function(){}))}},{key:"sendOTP",value:function(){Object(Y.c)(q.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.state.otpField,t=this.props.form.getFieldDecorator;return m.a.createElement(h.a,{visible:this.state.cancelIncoiceVisible,title:"Cancel Invoice",footer:null,onOk:this.handleSubmitCancelInvoice,onCancel:this.props.cancelInvoiceClose},m.a.createElement(M.a,null,m.a.createElement(M.a.Item,{key:"cancel_notes"},t("cancel_note",{rules:[{required:!0,message:wn.j}]})(m.a.createElement(Tn,{placeholder:"cancel notes"}))),e&&m.a.createElement(M.a.Item,{key:"cancelOtp"},t("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(V.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(M.a.Item,null,this.props.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitCancelInvoice},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:this.cancelInvoiceClose},"Close"))))}}]),t}(m.a.Component),An=M.a.create()(Fn),Ln=(h.a.confirm,function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPDF=function(e){Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.Db,[e]),(function(e){e.report&&window.open(Tt.a+e.report)}),(function(){}))},a.returnModelOpen=function(e){var t=Object(o.a)(a);t.setState({returnIncoiceVisible:!0,editIncoiceVisible:!1,cancelIncoiceVisible:!1,editInvoice:e});var n={practice:a.props.active_practiceId,type:"".concat("Invoice:").concat(e.invoice_id," ")+"Return"};Object(Y.j)(q.K,n,(function(a){t.setState({otpSent:!0,patientId:e.patient,invoiceId:e.id})}),(function(){}))},a.cancelModalOpen=function(e){var t=Object(o.a)(a),n=x()().diff(e.created_at,"minutes");t.setState({cancelIncoiceVisible:!0,editIncoiceVisible:!1,returnIncoiceVisible:!1,editInvoice:e});var i={practice:a.props.active_practiceId,type:"".concat("Invoice:").concat(e.invoice_id," ")+" Cancellation"};n>H.qb&&Object(Y.j)(q.K,i,(function(a){t.setState({otpSent:!0,patientId:e.patient,invoiceId:e.id})}),(function(){}))},a.editInvoiceClose=function(){a.setState({editIncoiceVisible:!1})},a.returnInvoiceClose=function(){a.setState({returnIncoiceVisible:!1})},a.cancelInvoiceClose=function(){a.setState({cancelIncoiceVisible:!1})},a.updateFormValue=function(e,t){a.setState(Object(F.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:wt.get(e,"patient_data.user.first_name"),paymentId:wt.get(e,"id"),mail_to:wt.get(e,"patient_data.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.paymentId,i={mail_to:t};Object(se.g)(Object(Y.f)(q.Db,[n]),i),a.mailModalClose()},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,invoices:[],drug_catalog:null,procedure_category:null,taxes_list:null,editInvoice:null,loading:!0,returnIncoiceVisible:!1,editIncoiceVisible:!1,cancelIncoiceVisible:!1},a.loadInvoices=a.loadInvoices.bind(Object(o.a)(a)),a.loadDrugCatalog=a.loadDrugCatalog.bind(Object(o.a)(a)),a.loadProcedureCategory=a.loadProcedureCategory.bind(Object(o.a)(a)),a.loadTaxes=a.loadTaxes.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadInvoices()}},{key:"loadInvoices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;t.props.refreshWallet&&1==e&&t.props.refreshWallet(),t.setState({loading:!0});var a=function(e){1==e.current?t.setState({total:e.count,invoices:e.results,loading:!1,loadMoreInvoice:e.next}):t.setState((function(t){return{total:e.count,invoices:[].concat(Object(T.a)(t.invoices),Object(T.a)(e.results)),loading:!1,loadMoreInvoice:e.next}}))},n=function(){t.setState({loading:!1})},i={page:e,practice:this.props.active_practiceId,summary:!0};this.props.match.params.id&&(i.patient=this.props.match.params.id),Object(Y.c)(q.Cb,a,n,i)}},{key:"loadDrugCatalog",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Z,[this.props.active_practiceId]),(function(t){e.setState({drug_catalog:t})}),(function(){}))}},{key:"loadProcedureCategory",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Lc,[this.props.active_practiceId]),(function(t){e.setState({procedure_category:t})}),(function(){}))}},{key:"loadTaxes",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Fd,[this.props.active_practiceId]),(function(t){e.setState({taxes_list:t})}),(function(){}))}},{key:"editModelOpen",value:function(e){var t=this,a=x()().diff(e.created_at,"minutes");t.setState({editIncoiceVisible:!0,cancelIncoiceVisible:!1,returnIncoiceVisible:!1,editInvoice:e});var n={practice:this.props.active_practiceId,type:"".concat("Invoice:").concat(e.invoice_id," ")+"Edit"};a>H.qb&&Object(Y.j)(q.K,n,(function(a){t.setState({otpSent:!0,patientId:e.patient,invoiceId:e.id})}),(function(){}))}},{key:"deleteInvoice",value:function(e,t){var a=this,n={patient:e,is_cancelled:!0};Object(Y.l)(Object(Y.f)(q.id,[t]),n,(function(e){Object(Y.a)(H.Sb,"Invoice cancelled successfully"),a.loadInvoices()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a={};this.state.drug_catalog&&this.state.drug_catalog.forEach((function(e){a[e.id]="".concat(e.name,",").concat(e.strength)}));var i={};this.state.procedure_category&&this.state.procedure_category.forEach((function(e){i[e.id]=e.name}));var r={};return this.state.taxes_list&&this.state.taxes_list.forEach((function(e){r[e.id]=e.name})),this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{path:"/patient/:id/billing/invoices/add",render:function(t){return m.a.createElement(kn,Object.assign({},t,e.props,{loadData:e.loadInvoices}))}}),m.a.createElement(p.b,{path:"/patient/:id/billing/invoices/edit",render:function(t){return e.state.editInvoice?m.a.createElement(kn,Object.assign({},e.state,t,e.props,{editId:e.state.editInvoice.id,loadData:e.loadInvoices})):m.a.createElement(p.a,{to:"/patient/".concat(e.props.match.params.id,"/billing/invoices")})}}),m.a.createElement(p.b,{path:"/patient/:id/billing/invoices/return",render:function(t){return e.state.editInvoice?m.a.createElement(Sn,Object.assign({},e.state,t,{editId:e.state.editInvoice.id,loadData:e.loadInvoices})):m.a.createElement(p.a,{to:"/patient/".concat(e.props.match.params.id,"/billing/invoices")})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(yn.a,{banner:!0,showIcon:!0,type:"info",message:"The invoices shown are only for the current selected practice!"}),m.a.createElement(Xe.a,{offsetTop:0},m.a.createElement(j.a,{bodyStyle:{padding:0},style:{boxShadow:"0 5px 8px rgba(0, 0, 0, 0.09)"},title:(this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," Invoice "):"Invoices ")+(this.state.total?"(Total:".concat(this.state.total,")"):""),extra:m.a.createElement(_.a.Group,null,m.a.createElement(C.b,{to:"/patient/".concat(this.props.match.params.id,"/billing/invoices/add")},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"Add")))})),this.state.invoices.map((function(e){return Rn(e,t)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(W.a,{loaderFunction:function(){return e.loadInvoices(e.state.loadMoreInvoice)},loading:this.state.loading,hidden:!this.state.loadMoreInvoice})))),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Invoice To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:t.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),t.state.cancelIncoiceVisible?m.a.createElement(An,Object.assign({key:"cancelInvoice1"},t.state,{cancelInvoiceClose:t.cancelInvoiceClose,loadInvoices:t.loadInvoices})):null):m.a.createElement("div",null,m.a.createElement(Xe.a,{offsetTop:0},m.a.createElement(j.a,{bodyStyle:{padding:0},style:{boxShadow:"0 5px 8px rgba(0, 0, 0, 0.09)"},title:(this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," Invoice "):"Invoice ")+(this.state.total?"(Total:".concat(this.state.total,")"):""),extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))})),this.state.invoices.map((function(e){return Rn(e,t)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(W.a,{loaderFunction:function(){return e.loadInvoices(e.state.loadMoreInvoice)},loading:this.state.loading,hidden:!this.state.loadMoreInvoice}),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send invoice To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:t.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),t.state.cancelIncoiceVisible?m.a.createElement(An,Object.assign({key:"cancelInvoice2"},t.state,{cancelInvoiceClose:t.cancelInvoiceClose,loadInvoices:t.loadInvoices})):null)}}]),t}(m.a.Component)),Vn=M.a.create()(Ln);function Nn(e){return e?m.a.createElement("p",null,e.doctor?m.a.createElement(Se.a,{title:"Doctor"},m.a.createElement(y.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  ".concat(e.doctor.user.first_name)," "))):null,e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null,e.notes?m.a.createElement("p",null,"Notes: ",e.notes):null,e.cancel_note?m.a.createElement("p",null,"Cancel Notes: ",e.cancel_note):null):null}function Rn(e,t){var a=[];t.props.form.getFieldDecorator;if(e.reservation){var n=e.reservation_data.medicines.map((function(e){return Object.create(Object(A.a)({},e,{unit:1,total:e.final_price,unit_cost:e.price,discount:0}))})),i={NORMAL:{total:"final_normal_price",tax:"normal_tax_value",unit_cost:"normal_price"},TATKAL:{total:"final_tatkal_price",tax:"tatkal_tax_value",unit_cost:"tatkal_price"}};a=[].concat(Object(T.a)(a),[Object(A.a)({},e.reservation_data.bed_package,{unit:1,total:e.reservation_data.bed_package?e.reservation_data.bed_package[i[e.reservation_data.seat_type].total]:null,tax_value:e.reservation_data.bed_package?e.reservation_data.bed_package[i[e.reservation_data.seat_type].tax]:null,unit_cost:e.reservation_data.bed_package?e.reservation_data.bed_package[i[e.reservation_data.seat_type].unit_cost]:null})],Object(T.a)(n))}return m.a.createElement(j.a,{key:e.id,style:{marginTop:10},bodyStyle:{padding:0},title:m.a.createElement("small",null,e.date?x()(e.date).format("ll"):null,t.state.currentPatient?null:m.a.createElement("span",null,m.a.createElement(C.b,{to:"/patient/".concat(e.patient_data?e.patient_data.id:null,"/billing/invoices")},"\xa0\xa0 ",e.patient_data?e.patient_data.user.first_name:null," (ID: ",e.patient_data&&e.patient_data.custom_id?e.patient_data.custom_id:e.patient_data.id,")\xa0"),", ",e.patient_data?e.patient_data.gender:null)),extra:m.a.createElement(Lt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Pe.a,null,m.a.createElement(Pe.a.Item,{key:"1"},m.a.createElement(C.b,{to:"/patient/".concat(e.patient_data?e.patient_data.id:null,"/billing/payments/add?invoices=").concat(e.id)},m.a.createElement(k.a,{type:"dollar"}),"\xa0 Pay")),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"2",onClick:function(){return t.editModelOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.payments_data||e.is_cancelled},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Pe.a.Item,{key:"5",onClick:function(){return t.returnModelOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.is_cancelled},m.a.createElement(k.a,{type:"redo"}),"Return"),m.a.createElement(Pe.a.Item,{key:"3",onClick:function(){return t.cancelModalOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.payments_data||e.is_cancelled},m.a.createElement(k.a,{type:"delete"}),"Cancel"),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"4"},m.a.createElement(C.b,{to:"/patient/".concat(e.patient,"/emr/timeline")},m.a.createElement(k.a,{type:"clock-circle"}),"Patient Timeline")),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"5"},m.a.createElement("a",{onClick:function(){return t.sendPatientMail(e)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return t.loadPDF(e.id)}},m.a.createElement(k.a,{type:"printer"})))},m.a.createElement(f.a,{gutter:8},m.a.createElement(g.a,{xs:24,sm:24,md:6,lg:4,xl:4,xxl:4,style:{padding:10}},e.is_cancelled?m.a.createElement(yn.a,{message:"Cancelled",type:"error",showIcon:!0}):null,m.a.createElement(v.a,{style:{marginBottom:0}},e.invoice_id),m.a.createElement(O.a,{title:"Paid / Total ",value:e.payments_data?e.payments_data.toFixed(2):0,suffix:"/ ".concat(e.total.toFixed(2))})),m.a.createElement(g.a,{xs:24,sm:24,md:18,lg:20,xl:20,xxl:20},"Membership Amount."==e.type?m.a.createElement(_e.a,{bordered:!0,pagination:!1,columns:Bn,dataSource:[{inventory:!0,name:"Membership",unit_cost:e.total,unit:1,discount_value:0,tax_value:0,total:e.total}],footer:function(){return Nn({practice:e.practice_data,notes:e.notes,cancel_note:e.cancel_note})}}):m.a.createElement(_e.a,{bordered:!0,pagination:!1,columns:Bn,dataSource:[].concat(Object(T.a)(a),Object(T.a)(e.inventory),Object(T.a)(e.procedure)),footer:function(){return Nn({practice:e.practice_data,notes:e.notes,cancel_note:e.cancel_note})}}))),t.state.editIncoiceVisible&&t.state.otpSent&&m.a.createElement(Mn,Object.assign({key:"editInvoice"},t.state,{invoice:e,editInvoiceClose:t.editInvoiceClose},t.props)),t.state.returnIncoiceVisible&&t.state.otpSent&&m.a.createElement(In,Object.assign({key:"returnInvoice"},t.state,{invoice:e,returnInvoiceClose:t.returnInvoiceClose},t.props)))}var Bn=[{title:"Treatment & Products",dataIndex:"drug",key:"drug",render:function(e,t){return m.a.createElement("span",null," ",m.a.createElement("b",null,t.name?t.name:null),m.a.createElement("br",null)," ",t.doctor_data?m.a.createElement(y.a,{color:t.doctor_data?t.doctor_data.calendar_colour:null},m.a.createElement("b",null,"prescribed by  ".concat(t.doctor_data.user.first_name)," ")):null)}},{title:"Cost",dataIndex:"unit_cost",key:"unit_cost",render:function(e,t){return m.a.createElement("span",null,t.unit_cost?t.unit_cost.toFixed(2):null)}},{title:"Unit",dataIndex:"unit",key:"unit"},{title:"Discount",dataIndex:"discount_value",key:"discount_value",render:function(e,t){return m.a.createElement("span",null,t.discount_value?t.discount_value.toFixed(2):null)}},{title:"Tax",dataIndex:"tax_value",key:"tax_value",render:function(e,t){return m.a.createElement("span",null,t.tax_value?t.tax_value.toFixed(2):null)}},{title:"Total",dataIndex:"total",key:"total",render:function(e){return e?e.toFixed(2):null}}],zn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadEditPyament=function(e){var t=Object(o.a)(a),n={},i=[],r=0;a.setState((function(a){return e.forEach((function(e){n[e.invoice]=!0,i.push(Object(A.a)({},e,{},e.invoice_data)),r+=e.pay_amount+e.pay_amount_wallet}),(function(){t.calculateInvoicePayments(),t.setPaymentAmount(r)})),{addedInvoice:i,addedInvoiceId:n}}))},a.loadAvailableAdvance=function(){var e=Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.t,[e.props.match.params.id]),(function(t){e.setState({availableAdvance:t})}),(function(){}),{practice_id:a.props.active_practiceId})},a.loadPaymentModes=function(){var e=Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.Ac,[a.props.active_practiceId]),(function(t){t.length&&(t[0].mode==Q.ob&&e.setState({paymentModeOffline:!0}),e.setState({paymentModes:t,selectedPaymentMode:t[0].id}))}),(function(){}))},a.loadInvoices=function(e){var t=Object(o.a)(a);t.setState({invoiceLoading:!0});Object(Y.c)(q.Cb,(function(a){t.setState((function(e){return{invoicesList:[].concat(Object(T.a)(a.results),Object(T.a)(e.addedInvoice)),invoiceLoading:!1,loadMoreInvoice:a.next}}),(function(){e&&e.forEach((function(e){t.addInvoiceToPayments(e)})),t.calculateInvoicePayments()}))}),(function(){t.setState({invoiceLoading:!1})}),{page:t.state.loadMoreInvoice||1,is_cancelled:!1,is_pending:!0,patient:a.props.match.params.id,practice:a.props.active_practiceId})},a.addInvoiceToPayments=function(e){var t=Object(o.a)(a);a.setState((function(t){var a=null;return t.invoicesList.forEach((function(t){t.id==e&&(a=t)})),a?{addedInvoice:[].concat(Object(T.a)(t.addedInvoice),[a]),addedInvoiceId:Object(A.a)({},t.addedInvoiceId,Object(F.a)({},e,!0)),invoicePayments:Object(A.a)({},t.addedInvoiceId,Object(F.a)({},e,0))}:null}),(function(){t.calculateInvoicePayments()}))},a.removeInvoiceToPayments=function(e){var t=Object(o.a)(a);a.setState((function(t){var a=[];return t.addedInvoice.forEach((function(t){t.id!=e&&a.push(t)})),a?{addedInvoice:a,addedInvoiceId:Object(A.a)({},t.addedInvoiceId,Object(F.a)({},e,!1))}:null}),(function(){t.calculateInvoicePayments()}))},a.calculateInvoicePayments=function(){a.setState((function(e){var t=0,a=e.totalPayingAmount+e.totalPayingFromAdvanceAmount,n={};return e.addedInvoice.forEach((function(e){var i=e.total-e.payments_data;e.pay_amount&&(i+=e.pay_amount),e.pay_amount_wallet&&(i+=e.pay_amount_wallet),t+=i,a>=i?(a-=i,n[e.id]=i):(n[e.id]=a,a=0)})),{advanceToBeSent:a,totalPayableAmount:t.toFixed(2),invoicePayments:n}}))},a.setPaymentAmount=function(e){var t=Object(o.a)(a);a.setState({totalPayingAmount:e},(function(){t.calculateInvoicePayments()}))},a.setPaymentFromAdvanceAmount=function(e){var t=Object(o.a)(a);a.setState({totalPayingFromAdvanceAmount:e},(function(){t.calculateInvoicePayments()}))},a.changeSelectedPaymentMode=function(e){a.state.paymentModes.forEach((function(t){t.id==e&&(t.mode==Q.ob?a.setState({paymentModeOffline:!0}):a.setState({paymentModeOffline:!1}))})),a.setState({selectedPaymentMode:e})},a.changeNotes=function(e){a.setState({notes:e})},a.selectedDate=function(e){Object(o.a)(a).setState({selectDate:e})},a.handleSubmit=function(e){if(!a.state.totalPayingAmount)return Object(Y.a)(H.bc,"Payment Amount of O INR is not allowed."),!1;a.setState({loading:!0});var t=Object(o.a)(a),n={invoices:[],bank:"",number:0,is_active:!0,notes:t.state.notes,is_cancelled:!1,practice:t.props.active_practiceId,patient:t.props.match.params.id,payment_mode:t.state.selectedPaymentMode,advance_value:t.state.advanceToBeSent,is_advance:!!t.state.advanceToBeSent,date:x()(t.state.selectDate).format("YYYY-MM-DD")},i=[];t.state.totalPayingAmount-t.state.totalPayableAmount>1&&(i.advance_value=t.state.totalPayingAmount-t.state.totalPayableAmount,i.is_advance=!0);var r=Object.keys(t.state.invoicePayments),l=Object(A.a)({},t.state.invoicePayments),c=t.state.totalPayingFromAdvanceAmount,s=0;for(c&&t.state.availableAdvance.data.forEach((function(e){var t=c;e.advance_value<t&&(t=e.advance_value),t<0&&(t=0);for(var a=0;c&&r.length>s;)l[r[s]]&&t>l[r[s]]?(e.advance_value-=l[r[s]],e.invoices.push({pay_amount_advance:l[r[s]],pay_amount:l[r[s]],is_active:!0,invoice:r[s]}),s++,c-=l[r[s]],l[r[s]]-=l[r[s]]):l[r[s]]&&(e.invoices.push({pay_amount_advance:t,pay_amount:t,is_active:!0,invoice:r[s]}),l[r[s]]-=t,c-=t,e.advance_value-=t),e.advance_value||(e.is_advance=!1),console.log(a++);i.push(e)}));r.length>s;s++)n.invoices.push({pay_amount:l[r[s]],type:"Invoice",is_active:!0,invoice:r[s]});a.props.editPayment&&a.props.editPayment.id&&(n.id=a.props.editPayment.id),(n.invoices.length||n.id||n.is_advance)&&i.push(n),t.state.receivedPayIdFromRazorPay&&(n.bank="RazorPay",n.number=t.state.receivedPayIdFromRazorPay),console.log(i);Object(Y.j)(q.H,i,(function(e){t.setState({loading:!1}),t.props.loadData(),t.props.history.replace("/patient/".concat(t.props.match.params.id,"/billing/payments"))}),(function(){t.setState({loading:!1})}))},a.state={invoicesList:[],invoiceLoading:!0,addedInvoiceId:{},addedInvoice:[],paymentModes:[],totalPayableAmount:0,invoicePayments:{},totalPayingAmount:0,totalPayingFromAdvanceAmount:0,selectedPaymentMode:null,availableAdvance:null,advanceToBeSent:0,selectDate:x()(),loading:!1,paymentModeOffline:!1},a.loadEditPyament=a.loadEditPyament.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentWillMount",value:function(){this.props.editPayment&&this.props.editPayment.invoices&&this.loadEditPyament(this.props.editPayment.invoices);var e=[];if(this.props.history&&this.props.history.location.search){var t=this.props.history.location.search.substr(1).split("&");t.length&&t.forEach((function(t){"invoices"==t.split("=")[0]&&(e=t.split("=")[1].split(","))}))}this.loadInvoices(e),this.loadPaymentModes(),this.loadAvailableAdvance()}},{key:"paymentHandler",value:function(e,t,a){if(!a)return Object(Y.a)(H.bc,"Payment Amount of O INR is not allowed."),!1;var n=this,i={key:Tt.c,amount:100*a.toFixed(2),name:t.custom_id,description:"Payment for ".concat(e),prefill:{name:t.user.first_name,email:t.user.email,contact:t.user.mobile},handler:function(e){var t=e.razorpay_payment_id,i={payment_id:t,amount:a};n.setState({loading:!0});Object(Y.j)(q.a,i,(function(e){Object(Y.a)(H.Sb,e.detail),n.setState({loading:!1,receivedPayIdFromRazorPay:t},(function(){n.handleSubmit()}))}),(function(){n.setState({loading:!1}),console.log("Request failed")}))}};new window.Razorpay(i).open()}},{key:"render",value:function(){var e=this,t=this;return m.a.createElement("div",null,m.a.createElement(n.a,{spinning:this.state.loading,size:"large"},m.a.createElement(f.a,{gutter:8},m.a.createElement(g.a,{xs:24,sm:24,md:16,lg:16,xl:18,xxl:18},m.a.createElement(j.a,null,m.a.createElement(f.a,null,m.a.createElement(g.a,{span:24},m.a.createElement("table",{style:{width:"100%"}},m.a.createElement("tbody",null,m.a.createElement("tr",{style:{borderBottom:"2px solid #ccc"}},m.a.createElement("td",{style:{width:"20%"}},m.a.createElement("small",null,"INVOICE NO")),m.a.createElement("td",{style:{width:"20%"}},m.a.createElement("small",null,"PROCEDURE")),m.a.createElement("td",{style:{width:"20%",textAlign:"right"}},m.a.createElement("small",null,"DUE(INR)")),m.a.createElement("td",{style:{width:"20%",textAlign:"right"}},m.a.createElement("small",null,"PAY NOW(INR)")),m.a.createElement("td",{style:{width:"20%",textAlign:"right"}},m.a.createElement("small",null,"DUE AFTER PAYMENT(INR)"))),this.state.addedInvoice.map((function(a){return m.a.createElement("tr",{style:{borderBottom:"2px solid #ccc"}},m.a.createElement("td",null,m.a.createElement(_.a,{size:"small",type:"danger",shape:"circle",icon:"close",style:{position:"absolute",right:"-35px"},onClick:function(){return e.removeInvoiceToPayments(a.id)}}),m.a.createElement("h3",null,a.invoice_id),a.date),m.a.createElement("td",null,a.procedure.map((function(e){return"".concat(e.procedure_data.name,", ")})),a.inventory.map((function(e){return"".concat(e.inventory_item_data.name,", ")})),a.reservation?"".concat(a.type,","):null,a.reservation_data&&a.reservation_data.medicines?a.reservation_data.medicines.map((function(e){return"".concat(e.name,",")})):null),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(a.total-a.payments_data+(a.pay_amount||0)+(a.pay_amount_wallet||0)).toFixed(2))),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,t.state.invoicePayments[a.id])),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(a.total-a.payments_data+(a.pay_amount||0)+(a.pay_amount_wallet||0)-t.state.invoicePayments[a.id]).toFixed(2))))})))))),m.a.createElement(f.a,{style:{borderBottom:"2px dashed #ccc",marginTop:"20px"}},m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Total Payable :")),m.a.createElement(g.a,{span:6},m.a.createElement("h2",null,this.state.totalPayableAmount))),m.a.createElement(f.a,{gutter:16,style:{marginTop:"20px"}},m.a.createElement(g.a,{span:12},m.a.createElement(f.a,null,m.a.createElement(g.a,{span:12},m.a.createElement("h3",null,"Amount From Advance :",m.a.createElement("br",null),m.a.createElement("small",null,"Available: ",this.state.availableAdvance?this.state.availableAdvance.max_allowed:0," INR"))),m.a.createElement(g.a,{span:12},m.a.createElement(I.a,{min:0,step:1,max:this.state.availableAdvance?this.state.availableAdvance.max_allowed:0,disabled:!this.state.availableAdvance||!this.state.availableAdvance.max_allowed,value:this.state.totalPayingFromAdvanceAmount,onChange:this.setPaymentFromAdvanceAmount}))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:12},m.a.createElement("h3",null,"Pay Now:")),m.a.createElement(g.a,{span:12},m.a.createElement(I.a,{min:0,step:1,value:this.state.totalPayingAmount,onChange:this.setPaymentAmount})))),m.a.createElement(g.a,{span:12},m.a.createElement(f.a,null,m.a.createElement(g.a,{span:10},m.a.createElement("h3",null,"Payment Mode :")),m.a.createElement(g.a,{span:12},m.a.createElement(w.a,{style:{width:"100%"},value:this.state.selectedPaymentMode,onChange:this.changeSelectedPaymentMode},this.state.paymentModes.map((function(e){return m.a.createElement(w.a.Option,{value:e.id,key:e.id},e.mode)}))),m.a.createElement("br",null),m.a.createElement("br",null))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:24},m.a.createElement(V.a.TextArea,{row:2,placeholder:"Notes...",size:"small",onChange:function(t){return e.changeNotes(t.target.value)}},this.state.notes))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("br",null),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(L.a,{style:{width:150},defaultValue:x()(),onChange:function(e){return t.selectedDate(e)},allowClear:!1}))))),m.a.createElement(f.a,null,m.a.createElement(g.a,{span:24,style:{align:"center"}},m.a.createElement(E.a,{title:"Are you sure to take payment of INR ".concat(this.state.totalPayingAmount,"?"),onConfirm:function(){return e.paymentHandler(e.state.addedInvoice.map((function(e){return e.invoice_id})).join(", "),e.props.currentPatient,e.state.totalPayingAmount)}},m.a.createElement(_.a,{type:"primary",style:{margin:5},disabled:t.props.editPayment&&t.props.editPayment.invoices||t.state.paymentModeOffline},"Pay Online & Save Payments")),m.a.createElement(E.a,{title:"Are you sure to take payment of INR ".concat(this.state.totalPayingAmount,"?"),onConfirm:this.handleSubmit},m.a.createElement(_.a,{type:"primary",style:{margin:5}},"Only Save Payments")))))),m.a.createElement(g.a,{xs:24,sm:24,md:6,lg:8,xl:6,xxl:6},m.a.createElement(b.a,{loading:this.state.invoiceLoading,dataSource:this.state.invoicesList,renderItem:function(a){return t.state.addedInvoiceId[a.id]?m.a.createElement("div",null):m.a.createElement(j.a,{hoverable:!0,onClick:function(){return e.addInvoiceToPayments(a.id)},style:{marginBottom:"10px"}},m.a.createElement("table",{style:{width:"100%"}},m.a.createElement("tbody",null,m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},m.a.createElement("h4",null,a.invoice_id)),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,a.date))))),m.a.createElement(v.a,{style:{margin:0}}),m.a.createElement("table",{style:{width:"100%"}},m.a.createElement("tbody",null,a.procedure.map((function(e){return m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},e.procedure_data.name),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(e.unit*e.unit_cost).toFixed(2))))})),a.inventory.map((function(e){return m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},e.inventory_item_data.name),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(e.unit*e.unit_cost).toFixed(2))))})),a.reservation?m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},a.type),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,a.reservation_data.bed_package_price?a.reservation_data.bed_package_price.toFixed(2):null))):null,a.reservation_data&&a.reservation_data.medicines?m.a.createElement(m.a.Fragment,null,a.reservation_data.medicines.map((function(e){return m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},e.name),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,e.final_price.toFixed(2))))}))):null)),m.a.createElement(v.a,{style:{margin:0}}),m.a.createElement("table",{style:{width:"100%"}},m.a.createElement("tbody",null,m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},"Invoice Amount"),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,a.total.toFixed(2)))),m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},"Paid Amount"),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,a.payments_data?a.payments_data.toFixed(2):0))),m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},m.a.createElement("b",null,"Amount Due")),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(a.total-a.payments_data).toFixed(2)))))))}})))))}}]),t}(m.a.Component),Yn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitEditPayment=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var i=Object(A.a)({},n,{practice:a.props.active_practiceId});Object(Y.j)(q.M,i,(function(e){t.setState({editPaymentVisible:!1}),t.editPaymentData(t.props.editPayment),t.props.editPaymentClose()}),(function(){}))}}))},a.editPaymentData=function(e){Object(o.a)(a).props.history.push("/patient/".concat(e.patient,"/billing/payments/edit/"))},a.state={otpSent:a.props.otpSent,editPaymentVisible:a.props.editPaymentVisible,cancelPaymentVisible:a.props.cancelPaymentVisible},a.editPaymentData=a.editPaymentData.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"sendOTP",value:function(){Object(Y.c)(q.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return m.a.createElement(h.a,{visible:this.state.editPaymentVisible&&this.props.editPayment&&this.props.editPayment.id==this.props.payment.id,title:"Edit Invoice",footer:null,onOk:this.handleSubmitEditPayment,onCancel:this.props.editPaymentClose},m.a.createElement(M.a,null,m.a.createElement(M.a.Item,null,e("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(V.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(M.a.Item,null,this.props.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitEditPayment},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:this.props.editPaymentClose},"Close"))))}}]),t}(m.a.Component),qn=M.a.create()(Yn),Wn=V.a,Gn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitCancelPayment=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var i=Object(A.a)({},n,{practice:a.props.active_practiceId});t.state.otpField?Object(Y.j)(q.M,i,(function(e){t.setState({cancelPaymentVisible:!1}),t.deletePayment(t.props.editPayment.patient_data,t.props.editPayment.id,n.cancel_note)}),(function(){})):t.deletePayment(t.props.editPayment.patient_data,t.props.editPayment.id,n.cancel_note)}}))},a.state={cancelPaymentVisible:a.props.cancelPaymentVisible,otpSent:a.props.otpSent,otpField:!1},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){x()().diff(this.props.editPayment.created_at,"minutes")>H.qb&&this.setState({otpField:!0})}},{key:"deletePayment",value:function(e,t,a){var n=this;console.log("log",e,t,a);var i={patient:e.id,is_cancelled:!0,cancel_note:a};Object(Y.l)(Object(Y.f)(q.qd,[t]),i,(function(e){n.props.cancelPaymentClose(),Object(Y.a)(H.Sb,"Payment cancelled successfully"),n.props.loadPayments()}),(function(){}))}},{key:"sendOTP",value:function(){Object(Y.c)(q.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.state.otpField,t=this.props.form.getFieldDecorator;return m.a.createElement(h.a,{visible:this.state.cancelPaymentVisible,title:"Cancel Payment",footer:null,onOk:this.handleSubmitCancelPayment,onCancel:this.props.cancelPaymentClose},m.a.createElement(M.a,null,m.a.createElement(M.a.Item,{key:"text-area-note"},t("cancel_note",{rules:[{required:!0,message:wn.j}]})(m.a.createElement(Wn,{placeholder:"cancel notes"}))),e?m.a.createElement(M.a.Item,{key:"otp"},t("otp",{rules:[{required:e,message:"Please input Otp!"}]})(m.a.createElement(V.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))):null,m.a.createElement(M.a.Item,{key:"btn"},this.state.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitCancelPayment},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:this.props.cancelPaymentClose},"Close"))))}}]),t}(m.a.Component),Hn=M.a.create()(Gn),Un=(h.a.confirm,function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPayments=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(o.a)(a);t.props.refreshWallet&&1==e&&t.props.refreshWallet(),a.setState({loading:!0});var n=function(e){t.setState((function(t){return 1==e.current?{payments:Object(T.a)(e.results),next:e.next,loading:!1}:{payments:[].concat(Object(T.a)(t.payments),Object(T.a)(e.results)),next:e.next,loading:!1}}))},i=function(){t.setState({loading:!1})},r={page:e,practice:a.props.active_practiceId};a.props.match.params.id&&(r.patient=a.props.match.params.id),Object(Y.c)(q.vc,n,i,r)},a.loadPDF=function(e){Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.Bc,[e]),(function(e){e.report&&window.open(Tt.a+e.report)}),(function(){}))},a.updateFormValue=function(e,t){a.setState(Object(F.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:wt.get(e,"patient_data.user.first_name"),paymentId:wt.get(e,"id"),mail_to:wt.get(e,"patient_data.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.paymentId,i={mail_to:t};Object(se.g)(Object(Y.f)(q.Bc,[n]),i),a.mailModalClose()},a.editModelOpen=function(e){var t=Object(o.a)(a),n=x()().diff(e.created_at,"minutes");if(console.log("otp",n),n>H.qb){t.setState({editPaymentVisible:!0,cancelPaymentVisible:!1,editPayment:e});var i={practice:a.props.active_practiceId,type:"".concat("Payment:").concat(e.payment_id," ")+"Edit"};Object(Y.j)(q.K,i,(function(a){t.setState({otpSent:!0,patientId:e.patient,paymentId:e.payment_id})}),(function(){}))}else t.setState({editPayment:e},(function(){t.props.history.push("/patient/".concat(e.patient,"/billing/payments/edit"))}))},a.editPaymentData=function(e){var t=Object(o.a)(a);t.setState({editPayment:e},(function(){t.props.history.push("/patient/".concat(e.patient,"/billing/payments/edit/"))}))},a.cancelModalOpen=function(e){var t=Object(o.a)(a),n=x()().diff(e.created_at,"minutes");console.log("otp",n,H.qb,e),console.log(n>H.qb),t.setState({editPaymentVisible:!1,cancelPaymentVisible:!0,editPayment:e});var i={practice:a.props.active_practiceId,type:"".concat("Payment:").concat(e.payment_id," ")+" Cancellation"};n>H.qb&&Object(Y.j)(q.K,i,(function(a){t.setState({otpSent:!0,patientId:e.patient,paymentId:e.id})}),(function(){}))},a.editPaymentClose=function(){a.setState({editPaymentVisible:!1})},a.cancelPaymentClose=function(){a.setState({cancelPaymentVisible:!1})},a.state={payments:[],active_practiceId:a.props.active_practiceId,loading:!0,otpSent:!1,editPaymentVisible:!1,editPayment:null},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadPayments()}},{key:"deletePayment",value:function(e,t){var a=this,n={patient:e,is_cancelled:!0};Object(Y.l)(Object(Y.f)(q.qd,[t]),n,(function(e){Object(Y.a)(H.Sb,"Payment cancelled successfully"),a.loadPayments()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a={};return this.state.paymentModes&&this.state.paymentModes.forEach((function(e){a[e.id]=e.mode})),this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/payments/add",render:function(t){return m.a.createElement(zn,Object.assign({},e.state,t,e.props,{loadData:e.loadPayments}))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/payments/edit",render:function(a){return t.state.editPayment?m.a.createElement(zn,Object.assign({},e.state,a,e.props,{paymentId:e.state.paymentId,loadData:e.loadPayments})):m.a.createElement(p.a,{to:"/patient/".concat(a.match.params.id,"/billing/payments")})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(yn.a,{banner:!0,showIcon:!0,type:"info",message:"The payments shown are only for the current selected practice!"}),m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?"".concat(this.state.currentPatient.name," Payments"):"Payments",extra:m.a.createElement(_.a.Group,null,m.a.createElement(C.b,{to:"/patient/".concat(this.props.match.params.id,"/billing/payments/add")},m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"plus"}),"Add")))}),this.state.payments.map((function(t){return Qn(t,e)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(W.a,{loaderFunction:function(){return e.loadPayments(t.state.next)},loading:this.state.loading,hidden:!this.state.next})))),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Payment To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:t.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),t.state.cancelPaymentVisible?m.a.createElement(Hn,Object.assign({},t.state,{key:"cancel_payment",cancelPaymentClose:t.cancelPaymentClose,loadPayments:t.loadPayments})):null):m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?"".concat(this.state.currentPatient.name," Payments"):"Payments",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))}),this.state.payments.map((function(t){return Qn(t,e)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(W.a,{loaderFunction:function(){return e.loadPayments(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Payment To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:t.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),t.state.cancelPaymentVisible?m.a.createElement(Hn,Object.assign({},t.state,{key:"cancel_payment",cancelPaymentClose:t.cancelPaymentClose,loadPayments:t.loadPayments})):null)}}]),t}(m.a.Component)),Kn=M.a.create()(Un),Xn=[{title:"INVOICE",dataIndex:"invoice_id",key:"invoice",render:function(e){return m.a.createElement("span",null,e)}},{title:"Amount Paid",key:"pay_amount",dataIndex:"pay_amount",render:function(e){return e?e.toFixed(2):0}}];function Qn(e,t){t.props.form.getFieldDecorator;var a=[];return e.is_advance&&a.push({invoice_id:"Advance Payment",pay_amount:e.advance_value}),m.a.createElement(j.a,{style:{marginTop:10},key:e.id,bodyStyle:{padding:0},title:e.patient_data&&!t.props.currentPatient?m.a.createElement("small",null,e.date?x()(e.date).format("lll"):null,m.a.createElement(C.b,{to:"/patient/".concat(e.patient_data.id,"/billing/payments")},"\xa0\xa0 ",e.patient_data.user.first_name," (ID: ",e.patient_data.custom_id?e.patient_data.custom_id:e.patient_data.id,")\xa0"),m.a.createElement("span",null,", ",e.patient_data.gender)):m.a.createElement("small",null,e.created_at?x()(e.created_at).format("lll"):null),extra:m.a.createElement(Lt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Pe.a,null,m.a.createElement(Pe.a.Item,{key:"2",onClick:function(){return t.editModelOpen(e)},disabled:e.practice!=t.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Pe.a.Item,{key:"3",onClick:function(){return t.cancelModalOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.is_cancelled},m.a.createElement(k.a,{type:"delete"}),"Cancel"),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"4"},m.a.createElement(C.b,{to:"/patient/".concat(e.patient,"/emr/timeline")},m.a.createElement(k.a,{type:"clock-circle"}),"Patient Timeline")),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return t.sendPatientMail(e)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return t.loadPDF(e.id)}},m.a.createElement(k.a,{type:"printer"})))},m.a.createElement(f.a,{gutter:8},m.a.createElement(g.a,{xs:24,sm:24,md:6,lg:4,xl:4,xxl:4,style:{padding:10}},e.is_cancelled?m.a.createElement(yn.a,{message:"Cancelled",type:"error",showIcon:!0}):null,m.a.createElement(v.a,{style:{marginBottom:0}},e.payment_id)),m.a.createElement(g.a,{xs:24,sm:24,md:18,lg:20,xl:20,xxl:20},m.a.createElement(_e.a,{columns:Xn,pagination:!1,footer:function(){return function(e){if(e)return m.a.createElement("p",null,e.doctor?m.a.createElement(Se.a,{title:"Doctor"},m.a.createElement(y.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  ".concat(e.doctor.user.first_name)," "))):null,e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null,e.notes?m.a.createElement("p",null,"Notes: ",e.notes):null,e.cancel_note?m.a.createElement("p",null,"Cancel Notes: ",e.cancel_note):null);return null}({practice:e.practice_data,notes:e.notes,cancel_note:e.cancel_note})},dataSource:[].concat(Object(T.a)(e.invoices),a),rowKey:e.id}))),t.state.editPaymentVisible&&t.state.otpSent&&m.a.createElement(qn,Object.assign({},t.state,{payment:e,editPaymentClose:t.editPaymentClose,key:e.id,editPaymentData:t.editPaymentData},t.props)))}var Zn=V.a.TextArea,Jn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPDF=function(e){Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.Rc,[e]),(function(e){e.report&&window.open(Tt.a+e.report)}),(function(){}))},a.updateFormValue=function(e,t){a.setState(Object(F.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:wt.get(e,"patient_data.user.first_name"),paymentId:wt.get(e,"id"),mail_to:wt.get(e,"patient_data.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.paymentId,i={mail_to:t};Object(se.g)(Object(Y.f)(q.Rc,[n]),i),a.mailModalClose()},a.cancelModalOpen=function(e){var t=Object(o.a)(a),n=x()().diff(e.created_at,"minutes");n>H.qb&&t.setState({otpField:!0}),t.setState({cancelReturnIncoiceVisible:!0,editReturnInvoice:e,patientId:e.patient});var i={practice:a.props.active_practiceId,type:"".concat("Return Invoice:").concat(e.return_id," ")+" Cancellation"};n>H.qb&&Object(Y.j)(q.K,i,(function(a){t.setState({otpSent:!0,patientId:e.patient,returnInvoiceId:e.id})}),(function(){}))},a.cancelReturnInvoiceClose=function(){a.setState({cancelReturnIncoiceVisible:!1})},a.handleSubmitCancelReturnInvoice=function(e){var t=Object(o.a)(a),n=x()().diff(t.state.editReturnInvoice.created_at,"minutes");e.preventDefault(),a.props.form.validateFields((function(e,i){if(!e){var r=Object(A.a)({},i,{practice:a.props.active_practiceId});n>H.qb?Object(Y.j)(q.M,r,(function(e){t.setState({cancelReturnIncoiceVisible:!1,otpField:!1}),t.deleteReturnInvoice(t.state.patientId,t.state.returnInvoiceId,i.cancel_note)}),(function(){})):t.deleteReturnInvoice(t.state.patientId,t.state.editReturnInvoice.id,i.cancel_note)}}))},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,returnInvoices:[],drug_catalog:null,procedure_category:null,taxes_list:null,loading:!0,cancelReturnIncoiceVisible:!1,otpField:!1},a.loadReturnInvoices=a.loadReturnInvoices.bind(Object(o.a)(a)),a.loadDrugCatalog=a.loadDrugCatalog.bind(Object(o.a)(a)),a.loadProcedureCategory=a.loadProcedureCategory.bind(Object(o.a)(a)),a.loadTaxes=a.loadTaxes.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadReturnInvoices()}},{key:"loadReturnInvoices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;t.props.refreshWallet&&1==e&&t.props.refreshWallet(),t.setState({loading:!0});var a=function(e){1==e.current?t.setState({total:e.count,returnInvoices:e.results,loading:!1,loadMoreReturnInvoice:e.next}):t.setState((function(t){return{total:e.count,returnInvoices:[].concat(Object(T.a)(t.returnInvoices),Object(T.a)(e.results)),loading:!1,loadMoreReturnInvoice:e.next}}))},n=function(){t.setState({loading:!1})},i={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(i.patient=this.props.match.params.id),Object(Y.c)(q.Eb,a,n,i)}},{key:"loadDrugCatalog",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Z,[this.props.active_practiceId]),(function(t){e.setState({drug_catalog:t})}),(function(){}))}},{key:"loadProcedureCategory",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Lc,[this.props.active_practiceId]),(function(t){e.setState({procedure_category:t})}),(function(){}))}},{key:"loadTaxes",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Fd,[this.props.active_practiceId]),(function(t){e.setState({taxes_list:t})}),(function(){}))}},{key:"sendOTP",value:function(){Object(Y.c)(q.L,(function(e){}),(function(){}))}},{key:"deleteReturnInvoice",value:function(e,t,a){var n=this,i={patient:e,is_cancelled:!0,cancel_note:a};Object(Y.l)(Object(Y.f)(q.vd,[t]),i,(function(e){Object(Y.a)(H.Sb,"Return Invoice cancelled successfully"),n.loadReturnInvoices(),n.cancelReturnInvoiceClose()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a={};this.state.drug_catalog&&this.state.drug_catalog.forEach((function(e){a[e.id]="".concat(e.name,",").concat(e.strength)}));var i={};this.state.procedure_category&&this.state.procedure_category.forEach((function(e){i[e.id]=e.name}));var r={};this.state.taxes_list&&this.state.taxes_list.forEach((function(e){r[e.id]=e.name}));var l=t.props.form.getFieldDecorator;return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(yn.a,{banner:!0,showIcon:!0,type:"info",message:"The invoices return shown are only for the current selected practice!"}),m.a.createElement(Xe.a,{offsetTop:0},m.a.createElement(j.a,{bodyStyle:{padding:0},style:{boxShadow:"0 5px 8px rgba(0, 0, 0, 0.09)"},title:(this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," Invoice Return"):"Invoices Return ")+(this.state.total?"(Total:".concat(this.state.total,")"):"")})),this.state.returnInvoices.map((function(e){return ei(e,t)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(W.a,{loaderFunction:function(){return e.loadInvoices(e.state.loadMoreInvoice)},loading:this.state.loading,hidden:!this.state.loadMoreInvoice})))),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send invoice To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:t.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),m.a.createElement(h.a,{visible:t.state.cancelReturnIncoiceVisible,title:"Cancel Return Invoice",footer:null,onOk:t.handleSubmitCancelReturnInvoice,onCancel:t.cancelReturnInvoiceClose},m.a.createElement(M.a,null,m.a.createElement(M.a.Item,{key:"cancel_notes"},l("cancel_note",{rules:[{required:!0,message:wn.j}]})(m.a.createElement(Zn,{placeholder:"cancel notes"}))),t.state.otpField&&m.a.createElement(M.a.Item,null,l("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(V.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(M.a.Item,null,t.state.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:t.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:t.handleSubmitCancelReturnInvoice},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:t.cancelReturnInvoiceClose},"Close"))))):m.a.createElement("div",null,m.a.createElement(Xe.a,{offsetTop:0},m.a.createElement(j.a,{bodyStyle:{padding:0},style:{boxShadow:"0 5px 8px rgba(0, 0, 0, 0.09)"},title:(this.state.currentPatient?"".concat(this.state.currentPatient.user.first_name," Invoice Return"):"Invoice Return ")+(this.state.total?"(Total:".concat(this.state.total,")"):"")})),this.state.returnInvoices.map((function(e){return ei(e,t)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(W.a,{loaderFunction:function(){return e.loadInvoices(e.state.loadMoreInvoice)},loading:this.state.loading,hidden:!this.state.loadMoreInvoice}),m.a.createElement(h.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send invoice To ",this.state.patientName," ?"),m.a.createElement(V.a,{value:t.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),m.a.createElement(h.a,{visible:t.state.cancelReturnIncoiceVisible,title:"Cancel Return Invoice",footer:null,onOk:t.handleSubmitCancelReturnInvoice,onCancel:t.cancelReturnInvoiceClose},m.a.createElement(M.a,null,m.a.createElement(M.a.Item,{key:"cancel_notes"},l("cancel_note",{rules:[{required:!0,message:wn.j}]})(m.a.createElement(Zn,{placeholder:"cancel notes"}))),t.state.otpField&&m.a.createElement(M.a.Item,null,l("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(V.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(M.a.Item,null,t.state.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:t.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:t.handleSubmitCancelReturnInvoice},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:t.cancelReturnInvoiceClose},"Close")))))}}]),t}(m.a.Component),$n=M.a.create()(Jn);function ei(e,t){return m.a.createElement(j.a,{key:e.id,style:{marginTop:10},bodyStyle:{padding:0},title:m.a.createElement("small",null,e.date?x()(e.date).format("ll"):null,t.state.currentPatient?null:m.a.createElement("span",null,m.a.createElement(C.b,{to:"/patient/".concat(e.patient_data?e.patient_data.id:null,"/billing/return/invoices")},"\xa0\xa0 ",e.patient_data?e.patient_data.user.first_name:null," (ID: ",e.patient_data.custom_id?e.patient_data.custom_id:e.patient_data.id,")\xa0"),", ",e.patient_data?e.patient_data.gender:null)),extra:m.a.createElement(Lt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Pe.a,null,m.a.createElement(Pe.a.Item,{key:"1",onClick:function(){return t.cancelModalOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.payments_data||e.is_cancelled},m.a.createElement(k.a,{type:"delete"}),"Cancel"),m.a.createElement(Pe.a.Divider,null),m.a.createElement(Pe.a.Item,{key:"2"},m.a.createElement("a",{onClick:function(){return t.sendPatientMail(e)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return t.loadPDF(e.id)}},m.a.createElement(k.a,{type:"printer"})))},m.a.createElement(f.a,{gutter:8},m.a.createElement(g.a,{xs:24,sm:24,md:6,lg:4,xl:4,xxl:4,style:{padding:10}},e.is_cancelled?m.a.createElement(yn.a,{message:"Cancelled",type:"error",showIcon:!0}):null,m.a.createElement(v.a,{style:{marginBottom:0}},e.return_id),m.a.createElement(O.a,{title:"Cash / Return ",value:e.cash_return?e.cash_return.toFixed(2):0,suffix:"/ ".concat(e.return_value?e.return_value.toFixed(2):0)})),m.a.createElement(g.a,{xs:24,sm:24,md:18,lg:20,xl:20,xxl:20},m.a.createElement(_e.a,{bordered:!0,pagination:!1,columns:ti,dataSource:[].concat(Object(T.a)(e.inventory),Object(T.a)(e.procedure)),footer:function(){return(t=Object(A.a)({},e))?m.a.createElement("p",null,t.staff?m.a.createElement(Se.a,{title:"Staff"},m.a.createElement(y.a,{color:t.staff?t.staff_data.calendar_colour:null},m.a.createElement("b",null,"Return by  ".concat(t.staff_data.user.first_name)," "))):null,t.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(Se.a,{title:"Practice Name"},m.a.createElement("b",null,t.practice_data.name," "))):null,t.notes?m.a.createElement("p",null,"Notes: ",t.notes):null,t.cancel_note?m.a.createElement("p",null,"Cancel Notes: ",t.cancel_note):null):null;var t}}))))}var ti=[{title:"Treatment & Products",dataIndex:"drug",key:"drug",render:function(e,t){return m.a.createElement("span",null," ",m.a.createElement("b",null,t.name?t.name:null))}},{title:"Cost",dataIndex:"unit_cost",key:"unit_cost",render:function(e,t){return m.a.createElement("span",null,t.unit_cost?t.unit_cost.toFixed(2):null)}},{title:"Unit",dataIndex:"unit",key:"unit"},{title:"Discount",dataIndex:"discount_value",key:"discount_value",render:function(e,t){return m.a.createElement("span",null,t.discount_value?t.discount_value.toFixed(2):null)}},{title:"Tax",dataIndex:"tax_value",key:"tax_value",render:function(e,t){return m.a.createElement("span",null,t.tax_value?t.tax_value.toFixed(2):null)}},{title:"Total",dataIndex:"total",key:"total",render:function(e){return e?e.toFixed(2):null}}],ai=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPatientLedger=function(){var e=Object(o.a)(a);e.props.refreshWallet&&e.props.refreshWallet(),a.setState({loadingLedger:!0});var t={practice_id:a.props.active_practiceId};a.props.showAllClinic&&a.props.match.params.id&&delete t.practice,Object(Y.c)(Object(Y.f)(q.sc,[e.props.currentPatient.id]),(function(t){var a=[],n=0,i=0,r=0;t.forEach((function(e){var t={date:e.date,type:e.ledger_type};"Invoice"==e.ledger_type?(t.type_id=e.invoice_id,t.details=function(e){var t="";return"Invoice"!=e.type&&(t+="".concat(e.type,", ")),e.procedure&&e.procedure.forEach((function(e){e.procedure_data&&(t+="".concat(e.procedure_data.name,", "))})),e.inventory&&e.inventory.forEach((function(e){e.inventory_item_data&&(t+="".concat(e.inventory_item_data.name,", "))})),e.reservation&&(t+="".concat(e.type,",")),e.reservation_data&&e.reservation_data.medicines&&e.reservation_data.medicines.forEach((function(e){t+="".concat(e.name,",")})),t.trim(",")}(e),t.credit=e.total,t.debit=0,t.return=0,t.cash_return=0):"Payment"==e.ledger_type?(t.type_id=e.payment_id,t.details=function(e){var t="";return e.invoices&&e.invoices.forEach((function(e){e.invoice&&(t+="".concat(e.invoice.invoice_id,", "))})),t}(e),e.return_pay?(t.credit=0,t.debit=0,t.return=-1*(e.total+e.advance_value)):(t.credit=0,t.debit=e.total+e.advance_value,t.return=0),t.cash_return=0):"Return"==e.ledger_type&&(t.type_id=e.return_id,t.details=function(e){var t="";return e.procedure&&e.procedure.forEach((function(e){e.procedure_data&&(t+="".concat(e.procedure_data.name,", "))})),e.inventory&&e.inventory.forEach((function(e){t+="".concat(e.name,", ")})),e.reservation&&(t+="".concat(e.type,",")),e.reservation_data&&e.reservation_data.medicines&&e.reservation_data.medicines.forEach((function(e){t+="".concat(e.name,",")})),t.trim(",")}(e),t.credit=e.cash_return,t.debit=0,t.return=e.return_value,0==e.with_tax&&(t.credit+=e.taxes),t.cash_return=e.cash_return),n+=t.credit,n-=t.debit,r+=t.debit,i+=t.credit,t.balance=n,a.push(t)})),e.setState({loadingLedger:!1,credit:i,debit:r,balance:n,ledger:a})}),(function(){e.setState({loadingLedger:!1})}),t)},a.loadPDF=function(e){Object(o.a)(a)},a.state={loading:!1,ledger:[],loadingLedger:!1,selectedList:{},credit:0,debit:0,balance:0},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadPatientLedger()}},{key:"ledgerCompleteToggle",value:function(e,t){this.setState((function(a){return{selectedList:Object(A.a)({},a.selectedList,Object(F.a)({},e,!!t))}}))}},{key:"render",value:function(){return m.a.createElement(f.a,null,m.a.createElement(j.a,{title:this.state.currentPatient?"".concat(this.state.currentPatient.name," Payment Ledger"):"Patient Ledgers",extra:m.a.createElement(_.a.Group,null,m.a.createElement(C.b,{to:"/patient/".concat(this.props.match.params.id,"/billing/payments")}," ",m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"\xa0Add Payment")),m.a.createElement(C.b,{to:"/patient/".concat(this.props.match.params.id,"/billing/invoices")}," ",m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"\xa0Add Invoice")),"\xa0")},m.a.createElement(_e.a,{loading:this.state.loadingLedger,columns:[{title:"Date",key:"date",dataIndex:"date",width:120},{title:"Invoice/ Receipt/ Return No",key:"type_id",dataIndex:"type_id"},{title:"Details",key:"details",dataIndex:"details"},{title:"Type",key:"type",dataIndex:"type"},{title:"Return(INR)",key:"return",dataIndex:"return",align:"right",render:function(e){return e.toFixed(2)}},{title:"Cash Return(INR)",key:"cash_return",dataIndex:"cash_return",align:"right",render:function(e){return e.toFixed(2)}},{title:"Credit(INR)",key:"credit",dataIndex:"credit",align:"right",render:function(e){return e.toFixed(2)}},{title:"Debit(INR)",key:"debit",dataIndex:"debit",align:"right",render:function(e){return e.toFixed(2)}},{title:"Balance(INR)",key:"balance",dataIndex:"balance",align:"right",render:function(e){return e.toFixed(2)}}],dataSource:this.state.ledger,pagination:!1}),m.a.createElement(f.a,{style:{marginTop:20,textAlign:"center"}},m.a.createElement(g.a,{span:8},m.a.createElement("h3",null,"Total Credit: ",this.state.credit.toFixed(2))),m.a.createElement(g.a,{span:8},m.a.createElement("h3",null,"Total Debit: ",this.state.debit.toFixed(2))),m.a.createElement(g.a,{span:8},m.a.createElement("h3",null,"Total Balance: ",this.state.balance<0?"".concat((-1*this.state.balance).toFixed(2)," (Advance)"):this.state.balance.toFixed(2))))))}}]),t}(m.a.Component),ni=(a(349),a(359)),ii=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).searchPatient=function(e){a.setState({searchPatientString:e});var t=Object(o.a)(a);e&&Object(Y.c)(Object(Y.f)(q.Wc,[e]),(function(e){e&&t.setState({patientListData:e.results})}),(function(){}))},a.removePatient=function(e){a.setState(Object(F.a)({},e,null))},a.handlePatientSelect=function(e,t){if(console.log(e),e){var n=Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.xc,[e]),(function(e){n.setState(Object(F.a)({},t,e))}),(function(){}))}},a.mergePatient=function(){a.setState({loading:!0});var e=Object(o.a)(a),t={patient_from:a.state.patient_from.id,patient_to:a.state.patient_to.id};Object(Y.j)(q.dc,t,(function(t){Object(Y.a)(H.Sb,"Patients Merged Successfully!!"),e.setState({loading:!1,patient_from:null,patient_to:null})}),(function(){Object(Y.a)(H.Q,"Patients Merging Failed!!"),e.setState({loading:!1})}))},a.state={patient_from:null,patient_to:null,loading:!1,patientListData:[]},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return m.a.createElement("div",null,m.a.createElement("h2",null,"Merge Patients"),m.a.createElement(j.a,null,m.a.createElement(yn.a,{message:"Profile details and records of Patient 1 will be moved to Patient 2. You cannot undo this action once done.",type:"warning"}),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,{gutter:16,style:{marginTop:10}},m.a.createElement(g.a,{span:12,style:{textAlign:"center"}},m.a.createElement("h3",null,"Patient 1"),this.state.patient_from?m.a.createElement(j.a,{bordered:!1,style:{background:"#ECECEC",textAlign:"left"}},m.a.createElement(j.a.Meta,{avatar:this.state.patient_from.image?m.a.createElement(P.a,{src:Object(Y.g)(this.state.patient_from.image)}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"}},this.state.patient_from.user.first_name?this.state.patient_from.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),title:this.state.patient_from.user.first_name,description:this.state.patient_from.user.mobile}),m.a.createElement(_.a,{type:"primary",style:{float:"right"},onClick:function(){return e.removePatient("patient_from")}},"Select Different Patient")):m.a.createElement(ni.a,{placeholder:"Patient Name",showSearch:!0,onSearch:this.searchPatient,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onChange:this.handleChange,onSelect:function(t){return e.handlePatientSelect(t,"patient_from")}},this.state.patientListData.map((function(e){return m.a.createElement(ni.a.Option,{value:e.id.toString()},m.a.createElement(b.a.Item,{style:{padding:0}},m.a.createElement(b.a.Item.Meta,{avatar:e.image?m.a.createElement(P.a,{src:Object(Y.g)(e.image)}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"}},e.user.first_name?e.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),title:"".concat(e.user.first_name," (").concat(e.user.id,")"),description:m.a.createElement("small",null,e.user.mobile)})))})))),m.a.createElement(g.a,{span:12,style:{textAlign:"center"}},m.a.createElement("h3",null,"Patient 2"),this.state.patient_to?m.a.createElement(j.a,{bordered:!1,style:{background:"#ECECEC",textAlign:"left"}},m.a.createElement(j.a.Meta,{avatar:this.state.patient_to.image?m.a.createElement(P.a,{src:Object(Y.g)(this.state.patient_to.image)}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"}},this.state.patient_to.user.first_name?this.state.patient_to.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),title:this.state.patient_to.user.first_name,description:this.state.patient_to.user.mobile}),m.a.createElement(_.a,{type:"primary",style:{float:"right"},onClick:function(){return e.removePatient("patient_to")}},"Select Different Patient")):m.a.createElement(ni.a,{placeholder:"Patient Name",showSearch:!0,onSearch:this.searchPatient,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onChange:this.handleChange,onSelect:function(t){return e.handlePatientSelect(t,"patient_to")}},this.state.patientListData.map((function(e){return m.a.createElement(ni.a.Option,{value:e.id.toString()},m.a.createElement(b.a.Item,{style:{padding:0}},m.a.createElement(b.a.Item.Meta,{avatar:e.image?m.a.createElement(P.a,{src:Object(Y.g)(e.image)}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"}},e.user.first_name?e.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),title:"".concat(e.user.first_name," (").concat(e.user.id,")"),description:m.a.createElement("small",null,e.user.mobile)})))})))),m.a.createElement(g.a,{span:24,style:{textAlign:"center",marginTop:30}},m.a.createElement(_.a,{disabled:this.state.loading||!this.state.patient_from||!this.state.patient_to,type:"primary",onClick:this.mergePatient},m.a.createElement(k.a,{type:"plus"}),"Merge Patients"))))))}}]),t}(m.a.Component),ri=function(e){function t(e){return Object(i.a)(this,t),Object(l.a)(this,Object(c.a)(t).call(this,e))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return m.a.createElement(j.a,{style:{textAlign:"center"}},m.a.createElement("h2",null," Please select patient to further continue !!"),this.props.togglePatientListModal?m.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"user"})," Select Patient"):null)}}]),t}(m.a.Component),li=(a(345),a(358)),ci=V.a.TextArea,oi=w.a.Option,si=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleCheck=function(e){a.setState({excused_duty_checked:!a.state.excused_duty_checked})},a.handleLighDutyCheck=function(e){a.setState({fit_light_duty_checked:!a.state.fit_light_duty_checked})},a.onChangeHandle=function(e){a.setState({value:e.target.value})},a.handleAttendanceCheck=function(e){a.setState({attendance_checked:!a.state.attendance_checked})},a.handleChangeStart=function(e){a.setState({startDate:e})},a.onChange=function(e){a.setState({proof_attendance_from:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.selectDoctor=function(e){a.setState({selectedDoctor:e})},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(n.excused_duty||n.fit_light_duty||n.proof_attendance){if(!e){var i=Object(A.a)({},n,{doctor:t.state.selectedDoctor.id,practice:t.props.active_practiceId,date:t.state.selectedDate&&x()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null,excused_duty_from:x()(n.excused_duty_from).format("YYYY-MM-DD"),excused_duty_to:x()(n.excused_duty_to).format("YYYY-MM-DD"),fit_light_duty_from:x()(n.fit_light_duty_from).format("YYYY-MM-DD"),fit_light_duty_to:x()(n.fit_light_duty_to).format("YYYY-MM-DD"),proof_attendance_date:x()(n.proof_attendance_date).format("YYYY-MM-DD"),proof_attendance_from:x()(n.proof_attendance_from).format("LT"),proof_attendance_to:x()(n.proof_attendance_to).format("LT"),patient:t.props.match.params.id,is_active:!0,valid_court:!1,invalid_court:!1,no_mention:!1});n.group&&(i[n.group]=!0),delete i.group;Object(Y.j)(Object(Y.f)(q.Tb,[a.props.currentPatient.id]),i,(function(e){Object(Y.a)(H.Sb,"Medical Certificate Generated."),t.props.history.replace("/patient/".concat(t.props.match.params.id,"/emr/files"))}),(function(){t.setState({})}))}}else Object(Y.a)(H.Q,"Please select at least one of the above options")}))},a.state={redirect:!1,excused_duty_checked:!1,fit_light_duty_checked:!1,attendance_checked:!1,startDate:a.props.value,endDate:new Date,proof_attendance_from:null,days:0,practiceDoctors:[],selectedDoctor:{},selectedDate:x()(),value:""},a.handleChangeStart=a.handleChangeStart.bind(Object(o.a)(a)),a.handleChangeEnd=a.handleChangeEnd.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){Object(se.d)(this)}},{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"handleChangeEnd",value:function(e){this.setState({endDate:e})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=Q.fb.map((function(e){return m.a.createElement(D.a,{value:e.value},e.label)}));return m.a.createElement(M.a,Object.assign({onSubmit:this.handleSubmit},{labelCol:{xs:{span:24},sm:{span:8},md:{span:8},lg:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16},md:{span:16},lg:{span:16}}}),m.a.createElement(j.a,{title:"ADD MEDICAL LEAVE CERTIFICATE",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{type:"primary",htmlType:"submit"},"Save Certificate"))},m.a.createElement(M.a.Item,null,t("excused_duty",{})(m.a.createElement(me.a,{onClick:this.handleCheck,defaultChecked:this.state.excused_duty_checked},"Excused from duty"))),this.state.excused_duty_checked?m.a.createElement(f.a,null,m.a.createElement(g.a,{span:6,offset:6},m.a.createElement(M.a.Item,{label:"From"},t("excused_duty_from",{})(m.a.createElement(L.a,null))),m.a.createElement(M.a.Item,{label:"till"},t("excused_duty_to",{})(m.a.createElement(L.a,null)))),m.a.createElement(g.a,{span:6},m.a.createElement(M.a.Item,null,t("excused_duty_from_session",{initialValue:"Morning"})(m.a.createElement(w.a,null,m.a.createElement(oi,{value:"Morning"},"Morning Session"),m.a.createElement(oi,{value:"Morning"},"Evening Session")))),m.a.createElement(M.a.Item,null,t("excused_duty_to_session",{initialValue:"Morning"})(m.a.createElement(w.a,null,m.a.createElement(oi,{value:"Morning"},"Morning Session"),m.a.createElement(oi,{value:"Morning"},"Evening Session")))))):null,m.a.createElement(M.a.Item,null,t("fit_light_duty",{})(m.a.createElement(me.a,{onClick:this.handleLighDutyCheck,defaultChecked:this.state.fit_light_duty_checked},"Fit for light duty"))),this.state.fit_light_duty_checked?m.a.createElement(f.a,null,m.a.createElement(g.a,null,m.a.createElement(M.a.Item,{label:"From"},t("fit_light_duty_from",{})(m.a.createElement(L.a,null))),m.a.createElement(M.a.Item,{label:"till"},t("fit_light_duty_to",{})(m.a.createElement(L.a,null))))):null,m.a.createElement(M.a.Item,null,t("proof_attendance",{})(m.a.createElement(me.a,{onClick:this.handleAttendanceCheck,defaultChecked:this.state.attendance_checked},"Proof of attendance at practice"))),this.state.attendance_checked?m.a.createElement(f.a,null,m.a.createElement(M.a.Item,{label:"on"},t("proof_attendance_date",{})(m.a.createElement(L.a,null))),m.a.createElement(g.a,{span:6,offset:6},m.a.createElement(M.a.Item,{label:"From"},t("proof_attendance_from",{})(m.a.createElement(li.a,{use12Hours:!0,format:"h:mm A"}))),m.a.createElement(M.a.Item,{label:"till"},t("proof_attendance_to",{})(m.a.createElement(li.a,{use12Hours:!0,format:"h:mm A"}))))):null,m.a.createElement(M.a.Item,{label:"Notes"},t("notes",{})(m.a.createElement(ci,null))),m.a.createElement(M.a.Item,null,t("group",{initialValue:"no_mention"})(m.a.createElement(D.a.Group,null,a))),m.a.createElement(Xe.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement("span",null,"Issued by \xa0\xa0"),m.a.createElement(Lt.a,{placement:"topCenter",overlay:m.a.createElement(Pe.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Pe.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(L.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY",allowClear:!1})))))}}]),t}(m.a.Component),ui=M.a.create()(si),di=j.a.Meta,mi=(V.a.Group,1),pi=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPackages=function(){var e=Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.v,[a.props.active_practiceId]),(function(t){e.setState({packages:t})}),(function(){}))},a.loadDiseases=function(){var e=Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.X,[a.props.active_practiceId]),(function(t){e.setState({diseases:t})}),(function(){}))},a.searchPatient=function(e){var t=Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.Wc,[e]),(function(e){e&&t.setState({patientList:e,ptr:e})}),(function(){}))},a.handlePatientSelect=function(e){if(e){var t=Object(o.a)(a);Object(Y.c)(Object(Y.f)(q.xc,[e]),(function(e){t.setState({patientDetails:e})}),(function(){}))}},a.checkBedStatus=function(e,t){var n=Object(o.a)(a);n.handleRoomType(),a.setState(Object(F.a)({},e,t),(function(){n.calculateTotalAmount();var e=n.state,t=e.from_date,a=e.bed_package;if(t&&a){var i=null;if(n.state.packages.forEach((function(e){a==e.id&&(i=x()(t).add(e.no_of_days-1,"day"))})),t&&i&&a)(0,n.props.form.setFieldsValue)({to_date:i}),Object(Y.c)(Object(Y.f)(q.P,[n.props.active_practiceId]),(function(e){n.setState({availabilitySeatTatkal:e.TATKAL,availabilitySeatNormal:e.NORMAL}),e[n.props.form.getFieldValue("seat_type")]||(n.props.form.setFieldsValue({seat_type:null}),n.calculateTotalAmount())}),(function(){}),{start:x()(t).format("YYYY-MM-DD"),end:x()(i).format("YYYY-MM-DD"),bed_package:a})}}))},a.handleSubmit=function(e){a.setState({loading:!0});var t=Object(o.a)(a),n=[];e.preventDefault(),a.props.form.validateFields((function(e,i){if(!e){var r=i.label,l=i.value;r.map((function(e,t){return n.push({key:e,value:l[t]})}));var c=Object(A.a)({},i,{to_date:x()(i.to_date).format("YYYY-MM-DD"),from_date:x()(i.from_date).format("YYYY-MM-DD"),paid:!1,total_price:a.state.totalPayableAmount,date:x()().format("YYYY-MM-DD"),total_tax:a.state.tax,patient:a.state.patientDetails.id,rest_diseases:i.rest_diseases?i.rest_diseases.join(","):null,report_upload:i.file&&i.file.file.response?i.file.file.response.image_path:null,details:n});delete c.label,delete c.value,delete c.keys;Object(Y.j)(Object(Y.f)(q.G,[a.props.active_practiceId]),c,(function(e){Object(Y.a)(H.Sb,"Saved Successfully!!"),t.props.history&&(t.props.history.goBack(),t.props.history.replace("/patient/".concat(t.props.match.params.id,"/booking"))),t.props.loadData&&t.props.loadData()}),(function(){}))}}))},a.handleClick=function(e){a.setState({patientDetails:null})},a.handleRoomType=function(e,t){var n=Object(o.a)(a);a.setState(Object(F.a)({},e,t),(function(){n.calculateTotalAmount()}))},a.calculateTotalAmount=function(){Object(o.a)(a).setState((function(e){var t=0,a=0,n={},i=[],r=0;return e.packages.forEach((function(r){e.bed_package==r.id&&("NORMAL"==e.seat_type&&(t=r.normal_price+r.normal_tax_value,a+=r.normal_tax_value,n=Object(A.a)({},r,{type:"BED",price_with_tax:t,tax:r.normal_tax_value,price:r.normal_price,_id:Math.random().toFixed(7)}),i=[n]),"TATKAL"==e.seat_type&&(t=r.tatkal_price+r.tatkal_tax_value,a+=r.tatkal_tax_value,n=Object(A.a)({},r,{type:"BED",price_with_tax:t,tax:r.tatkal_tax_value,price:r.tatkal_price,_id:Math.random().toFixed(7)}),i=[n]))})),e.medicinePackage.forEach((function(t){e.medicineItem.forEach((function(e){t.id==e&&(r+=t.final_price,a+=t.tax_value,i=[].concat(Object(T.a)(i),[Object(A.a)({},t,{type:"MEDICINE",price_with_tax:t.final_price,tax:t.tax_value,_id:Math.random().toFixed(7)})]))}))})),{totalPayableAmount:t+r,tax:a,choosePkg:Object(T.a)(i)}}))},a.setPaymentAmount=function(e){var t=Object(o.a)(a);a.setState({totalPayingAmount:e},(function(){t.calculateTotalAmount()}))},a.handleMedicineSelect=function(e){var t=e;a.setState({medicineItem:t},(function(){this.calculateTotalAmount()}))},a.changeDiscount=function(e,t){Object(o.a)(a).setState((function(a){var n=[];return a.choosePkg.forEach((function(a){a._id==e?n.push(Object(A.a)({},a,{discount:t})):n.push(a)})),{choosePkg:n}}))},a.addNewFields=function(){var e=a.props.form,t=e.getFieldValue("keys").concat(mi++);e.setFieldsValue({keys:t})},a.removeNewOptionField=function(e){var t=a.props.form,n=t.getFieldValue("keys");1!==n.length&&t.setFieldsValue({keys:n.filter((function(t){return t!==e}))})},a.state={packages:[],totalPayableAmount:0,totalPayingAmount:0,patientList:[],paymentModes:[],medicinePackage:[],medicineItem:[],diseases:[]},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.currentPatient&&this.handlePatientSelect(this.props.currentPatient.id),this.loadPackages(),this.loadPaymentModes(),this.loadMedicinePackages(),this.loadDiseases()}},{key:"loadMedicinePackages",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Xb,[this.props.active_practiceId]),(function(t){e.setState({medicinePackage:t})}),(function(){}))}},{key:"loadPaymentModes",value:function(){var e=this;Object(Y.c)(Object(Y.f)(q.Ac,[this.props.active_practiceId]),(function(t){e.setState({paymentModes:t})}),(function(){}))}},{key:"render",value:function(){var e=this,t=[{value:"NORMAL",is_or_not:!(!this.state.availabilitySeatNormal||!this.state.availabilitySeatNormal.available)},{value:"TATKAL",is_or_not:!(!this.state.availabilitySeatTatkal||!this.state.availabilitySeatTatkal.available)}],a=this,n=this.props.form,i=n.getFieldDecorator,r=n.getFieldValue,l={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:14}}},c=[{title:"Item",key:"name",dataIndex:"name"},{title:"Normal Price",key:"normal_price",dataIndex:"normal_price"},{title:"Tatkal Price",key:"tatkal_price",dataIndex:"tatkal_price"},{title:"discount %",key:"discount",width:100,dataIndex:"discount",render:function(e,t){return m.a.createElement(M.a.Item,Object.assign({key:"discount[".concat(t._id,"]")},l),i("discount[".concat(t._id,"]"),{initialValue:t.discount,validateTrigger:["onChange","onBlur"]})(m.a.createElement(I.a,{min:0,max:100,placeholder:"discount",size:"small",value:t.discount,onChange:function(e){return a.changeDiscount(t._id,e)}})))}},{title:"Price",key:"price",dataIndex:"price",render:function(e,t){return m.a.createElement("p",null,e?e.toFixed(2):null)}},{title:"Tax",key:"tax",dataIndex:"tax",render:function(e,t){return m.a.createElement("p",null,e?e.toFixed(2):null)}},{title:"Total Amount",key:"price_with_tax",dataIndex:"price_with_tax",render:function(e,t){return m.a.createElement("p",null,e?e.toFixed(2):null)}}],o={name:"image",data:{name:"hello"},action:Object(Y.h)(q.sb),headers:{authorization:"authorization-text"},onChange:function(e){e.file.status,"done"===e.file.status?he.a.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&he.a.error("".concat(e.file.name," file upload failed."))}};i("keys",{initialValue:[0]});var s=r("keys"),u=s.map((function(t,a){return m.a.createElement(f.a,{key:t},m.a.createElement(g.a,{span:8},m.a.createElement(M.a.Item,{label:""},i("label[".concat(t,"]"))(m.a.createElement(V.a,{placeholder:"name"})))),m.a.createElement(g.a,{span:8},m.a.createElement(M.a.Item,{label:""},i("value[".concat(t,"]"))(m.a.createElement(V.a,{placeholder:"value"})))),m.a.createElement(g.a,{span:8},a?m.a.createElement(_.a,{onClick:function(){return e.removeNewOptionField(t)},size:"small",type:"danger",style:{margin:5},icon:"close",shape:"circle"}):null,a==s.length-1?m.a.createElement(_.a,{type:"dashed",style:{marginTop:"3px"},onClick:e.addNewFields},m.a.createElement(k.a,{type:"plus"})," Add field"):null))}));return m.a.createElement("div",null,m.a.createElement(j.a,{title:"Book a Seat/Bed"},m.a.createElement(M.a,null,m.a.createElement(f.a,null,m.a.createElement(g.a,{xs:24,sm:24,md:12,lg:12,xl:12},m.a.createElement("div",{style:{paddingRight:"10px"}},this.state.patientDetails?m.a.createElement(M.a.Item,Object.assign({key:"id",value:this.state.patientDetails?this.state.patientDetails.id:""},{wrapperCol:{xs:{offset:6,span:24},sm:{offset:6,span:14}}}),m.a.createElement(j.a,{bordered:!1,style:{background:"#ECECEC"}},m.a.createElement(di,{avatar:this.state.patientDetails.image?m.a.createElement(P.a,{src:Object(Y.g)(this.state.patientDetails.image)}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"}},this.state.patientDetails.user.first_name?this.state.patientDetails.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),title:this.state.patientDetails.user.first_name,description:this.state.patientDetails.user.mobile}))):m.a.createElement("div",null,m.a.createElement(M.a.Item,Object.assign({label:"Patient"},l),i("patient",{rules:[{required:!0,message:"this field required"}]})(m.a.createElement(ni.a,{placeholder:"Patient Name",showSearch:!0,onSearch:this.searchPatient,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onSelect:this.handlePatientSelect},this.state.patientList.map((function(e){return m.a.createElement(ni.a.Option,{value:e?e.id.toString():""},m.a.createElement(b.a.Item,{style:{padding:0}},m.a.createElement(b.a.Item.Meta,{avatar:e.image?m.a.createElement(P.a,{style:{backgroundColor:"#ffff"},src:Object(Y.g)(e.image)}):m.a.createElement(k.a,{type:"user"}),title:"".concat(e.user.first_name," (").concat(e.user.id,")"),description:m.a.createElement("small",null,e.user.mobile)})))})))),this.state.ptr?m.a.createElement(yn.a,{message:"Patient Not Found !!",description:"Please Search another patient or create new patient.",type:"error"}):null)),m.a.createElement(M.a.Item,Object.assign({label:"Bed Package"},l),i("bed_package",{rules:[{required:!0,message:"this field required!"}]})(m.a.createElement(w.a,{onChange:function(e){return a.checkBedStatus("bed_package",e)}},a.state.packages.map((function(e){return m.a.createElement(w.a.Option,{value:e.id},e.name)}))))),m.a.createElement(M.a.Item,Object.assign({label:"Book From"},l),i("from_date",{rules:[{required:!0,message:"Input From Date!"}]})(m.a.createElement(L.a,{onChange:function(e){return a.checkBedStatus("from_date",e)},format:"DD-MM-YYYY",allowClear:!1}))),m.a.createElement(M.a.Item,Object.assign({label:"Book To"},l),i("to_date",{rules:[{required:!0,message:"Input To Date!"}]})(m.a.createElement(L.a,{disabled:!0,format:"DD-MM-YYYY"}))),m.a.createElement(M.a.Item,Object.assign({label:"Booking Type"},l),i("seat_type",{rules:[{required:!0,message:"this field required"}]})(m.a.createElement(D.a.Group,{onChange:function(t){return e.handleRoomType("seat_type",t.target.value)}},t.map((function(e){return m.a.createElement(D.a,{value:e.is_or_not?e.value:"",disabled:!e.is_or_not},e.value)}))))),m.a.createElement(M.a.Item,Object.assign({label:"Medicine  Package"},l),i("medicines",{})(m.a.createElement(w.a,{mode:"multiple",onChange:this.handleMedicineSelect},a.state.medicinePackage.map((function(e){return m.a.createElement(w.a.Option,{value:e.id},e.name)}))))),m.a.createElement(M.a.Item,Object.assign({label:"Pay Now : "},l),i("pay_value",{rules:[{required:!0,message:"this field is required"}],initialValue:this.state.totalPayingAmount?this.state.totalPayingAmount:null})(m.a.createElement(I.a,{min:0,step:1,max:this.state.totalPayableAmount,onChange:this.setPaymentAmount}))),m.a.createElement(M.a.Item,Object.assign({label:"Payment Mode"},l),i("payment_mode",{rules:[{required:!0,message:"this field required"}]})(m.a.createElement(w.a,{showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.paymentModes.map((function(e){return m.a.createElement(w.a.Option,{value:e.id},e.mode)}))))),m.a.createElement(v.a,null,"Patient Details"),m.a.createElement(M.a.Item,Object.assign({label:"Creatinine Level"},l),i("creatinine",{})(m.a.createElement(V.a,null))),m.a.createElement(M.a.Item,Object.assign({label:"Urea Level"},l),i("urea_level",{})(m.a.createElement(V.a,null))),m.a.createElement(M.a.Item,Object.assign({label:"Currently on Dialysis?"},l),i("dialysis",{})(m.a.createElement(w.a,{showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},m.a.createElement(w.a.Option,{value:!0},"YES"),m.a.createElement(w.a.Option,{value:!1},"NO")))),m.a.createElement(M.a.Item,Object.assign({label:"Diseases"},l),i("other_diseases",{})(m.a.createElement(w.a,{showSearch:!0,mode:"multiple",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.diseases.map((function(e){return m.a.createElement(w.a.Option,{value:e.id},e.name)}))))),m.a.createElement(M.a.Item,Object.assign({label:"Other Diseases"},l),i("rest_diseases",{})(m.a.createElement(w.a,{mode:"tags"}))),m.a.createElement(M.a.Item,Object.assign({label:"Upload Report"},l),i("file",{})(m.a.createElement(pe.a,o,m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"upload"})," Select File")))))),m.a.createElement(g.a,{xs:24,sm:24,md:12,lg:12,xl:12},m.a.createElement(v.a,null,"Item Details"),m.a.createElement(_e.a,{pagination:!1,columns:c,size:"small",dataSource:this.state.choosePkg}),m.a.createElement(v.a,null,"Extra Details"),m.a.createElement(j.a,null,u)),m.a.createElement(g.a,{span:24},m.a.createElement("h3",null,"Grand Total: ",m.a.createElement("b",null,this.state.totalPayableAmount.toFixed(2))),m.a.createElement(M.a.Item,null,m.a.createElement(E.a,{title:"Are you sure to take payment of INR ".concat(this.state.totalPayingAmount,"?"),onConfirm:this.handleSubmit},m.a.createElement(_.a,{type:"primary"},"Submit")),a.props.history?m.a.createElement(_.a,{style:{margin:5},onClick:function(){return a.props.history.goBack()}},"Cancel"):null))))))}}]),t}(m.a.Component),fi=M.a.create()(pi),hi=u.a.Content,bi=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadBedBookingReport=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(o.a)(a);a.setState({loading:!0});var n=function(e){1==e.current?t.setState({bedBookingReports:e.results,loading:!1,nextReport:e.next}):t.setState((function(t){return{bedBookingReports:[].concat(Object(T.a)(t.bedBookingReports),Object(T.a)(e.results)),loading:!1,nextReport:e.next}}))},i=function(){t.setState({loading:!1})};Object(Y.c)(Object(Y.f)(q.u,[a.props.active_practiceId]),n,i,{patients:a.state.patient.id,page:e})},a.state={loading:!0,bedBookingReports:[],patient:a.props.currentPatient||{}},a.loadBedBookingReport=a.loadBedBookingReport.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadBedBookingReport()}},{key:"render",value:function(){var e=this,t=this,a=[{title:"Bed Package",key:"name",dataIndex:"bed_package.name"},{title:"Medicine Package",key:"medicine",dataIndex:"medicines",render:function(e,t){return m.a.createElement("span",null,e.map((function(e){return m.a.createElement(y.a,null,e.name)})))}},{title:"From ",key:"from_date",render:function(e,t){return m.a.createElement("span",null,x()(t.from_date).format("LL"))}},{title:"To ",key:"to_date",render:function(e,t){return m.a.createElement("span",null,x()(t.to_date).format("LL"))}},{title:"Seat/Bed Type",key:"seat_type",dataIndex:"seat_type"},{title:"Seat Number",key:"seat_no",dataIndex:"seat_no"},{title:"Total price",key:"total_price",dataIndex:"total_price",render:function(e){return m.a.createElement("p",null,e.toFixed(2))}},{title:"Payment Status",key:"payment_status",dataIndex:"payment_status"}];return m.a.createElement(hi,{className:"main-container",style:{minHeight:280}},m.a.createElement(u.a,null,m.a.createElement(p.d,null,m.a.createElement(p.b,{path:"/patient/:patient/booking/bed-booking",render:function(){return t.props.activePracticePermissions.PatientBookings||t.props.allowAllPermissions?m.a.createElement(fi,Object.assign({},e.props,{bedBooking:!0,loadData:e.loadBedBookingReport})):m.a.createElement(Z.a,null)}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement("h2",null,"Bed Booking Management",m.a.createElement(C.b,{to:"/patient/".concat(this.state.patient.id,"/booking/bed-booking")},m.a.createElement(_.a,{type:"primary",style:{float:"right"}},m.a.createElement(k.a,{type:"plus"}),"\xa0Book A Seat"))),m.a.createElement(j.a,null,m.a.createElement(G.a,{pagination:!1,hideReport:!0,loading:this.state.loading,columns:a,size:"small",dataSource:this.state.bedBookingReports}),m.a.createElement(W.a,{loaderFunction:function(){return e.loadBedBookingReport(e.state.nextReport)},loading:this.state.loading,hidden:!this.state.nextReport})))))))}}]),t}(m.a.Component),yi=a(532),gi=u.a.Content,Ei=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPatientPendingAmount=function(){var e=Object(o.a)(a);if(a.state.currentPatient&&a.state.currentPatient.id){Object(Y.c)(Object(Y.f)(q.wc,[a.state.currentPatient.id]),(function(t){e.setState({pendingAmount:t})}),(function(){}))}else a.setState({pendingAmount:null})},a.loadPatientWallet=function(){var e=Object(o.a)(a);if(a.state.currentPatient&&a.state.currentPatient.id){Object(Y.c)(Object(Y.f)(q.g,[a.state.currentPatient.id]),(function(t){e.setState({walletAmount:t})}),(function(){}))}else a.setState({pendingAmount:null})},a.loadMembership=function(){var e=Object(o.a)(a);if(a.state.currentPatient&&a.state.currentPatient.id){Object(Y.c)(Object(Y.f)(q.kc,[e.state.currentPatient.id]),(function(t){e.setState({MedicalMembership:t.length?t[t.length-1]:null})}),(function(){}))}},a.refreshWallet=function(){a.loadPatientWallet(),a.loadPatientPendingAmount(),a.loadMembership()},a.state={currentPatient:null,active_practiceId:a.props.active_practiceId,medicalHistory:[],listModalVisible:!1,loading:!1,showAllClinic:Object(Y.d)("showAllClinic"),pendingAmount:null,walletAmount:null,hideSidePanel:!1},a.setCurrentPatient=a.setCurrentPatient.bind(Object(o.a)(a)),a.togglePatientListModal=a.togglePatientListModal.bind(Object(o.a)(a)),a.toggleShowAllClinic=a.toggleShowAllClinic.bind(Object(o.a)(a)),a.loadPatientPendingAmount=a.loadPatientPendingAmount.bind(Object(o.a)(a)),a.loadPatientWallet=a.loadPatientWallet.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){!this.props.match.params.id||this.state.currentPatient&&this.props.match.params.id==this.state.currentPatient.id||this.getPatientListData(this.props.match.params.id),this.loadPatientPendingAmount(),this.loadPatientWallet(),this.loadMembership()}},{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.state.currentPathLocation!=e.location&&this.setState({currentPathLocation:e.location},(function(){for(var e=!1,t=0;t<Q.Ab.length;t++)Object(p.f)(a.state.currentPathLocation.pathname,{path:Q.Ab[t],exact:!1,strict:!1})&&(e=!0,a.setState({hideSidePanel:!0}));e||a.setState({hideSidePanel:!1})}))}},{key:"getPatientListData",value:function(e){var t=this;t.setState({loading:!0});Object(Y.c)(Object(Y.f)(q.xc,[e]),(function(e){t.setCurrentPatient(e)}),(function(){Object(Y.a)(H.Q,"Patient Loading Failed"),t.setState({loading:!1})}))}},{key:"setCurrentPatient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this,n=this.props.location.pathname.split("/");isNaN(parseInt(n[2]))?e&&(n[1]="patient",n.splice(2,0,e.id)):e?(n[1]="patient",n[2]=e.id):(n[1]="patients",n.splice(2,1)),this.props.history.push(n.join("/")),this.setState({currentPatient:e,loading:!1,listModalVisible:!1},(function(){t&&a.props.history.push(Object(Y.f)(t,[e.id]))}))}},{key:"togglePatientListModal",value:function(e){this.setState({listModalVisible:!!e})}},{key:"toggleShowAllClinic",value:function(e){this.setState({showAllClinic:!!e},(function(){Object(Y.n)("showAllClinic",!!e)}))}},{key:"render",value:function(){var e=this,t=this;return m.a.createElement(gi,null,m.a.createElement(n.a,{spinning:this.state.loading,size:"large"},m.a.createElement(Ra,Object.assign({},this.state,this.props,{togglePatientListModal:this.togglePatientListModal,key:this.state.currentPatient,setCurrentPatient:this.setCurrentPatient,toggleShowAllClinic:this.toggleShowAllClinic,refreshWallet:this.refreshWallet})),m.a.createElement(u.a,null,m.a.createElement(Ce,Object.assign({},this.state,this.props)),m.a.createElement(u.a,null,m.a.createElement(gi,{className:"main-container",key:this.state.showAllClinic.toString(),style:{padding:"0px 5px",minHeight:280}},m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patients/merge",render:function(a){return t.props.activePracticePermissions.MergePatients||t.props.allowAllPermissions?m.a.createElement(ii,e.state):m.a.createElement(Z.a,null)}}),t.props.activePracticePermissions.WebAdmin||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/profile",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/profile")}):m.a.createElement(ue,Object.assign({},e.state,{key:e.state.currentPatient,setCurrentPatient:e.setCurrentPatient,refreshWallet:e.refreshWallet},e.props))}}):null,m.a.createElement(p.b,{exact:!0,path:"/patients/profile/add",render:function(a){return t.props.activePracticePermissions.AddPatient||t.props.allowAllPermissions?m.a.createElement(Ee,Object.assign({key:e.state.currentPatient},e.props,a)):m.a.createElement(Z.a,null)}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/profile",render:function(a){return t.props.activePracticePermissions.ViewPatient||t.props.allowAllPermissions?m.a.createElement(ue,Object.assign({},e.state,{key:e.state.currentPatient,refreshWallet:e.refreshWallet,setCurrentPatient:e.setCurrentPatient},e.props,a)):m.a.createElement(Z.a,null)}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/profile/edit",render:function(a){return t.props.activePracticePermissions.EditPatient||t.props.allowAllPermissions?m.a.createElement(Ee,Object.assign({key:e.state.currentPatient},e.state,e.props,a)):m.a.createElement(Z.a,null)}}),t.props.activePracticePermissions.PatientAppointments||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/appointments",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/appointments")}):m.a.createElement(Oe,Object.assign({key:e.state.currentPatient},e.state,t,e.props))}}):null,t.props.activePracticePermissions.PatientAppointments||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patient/:id/appointments",render:function(t){return m.a.createElement(Oe,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t,e.props))}}):null,t.props.activePracticePermissions.PatientAppointments||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/appointments/:appointmentid",render:function(t){return m.a.createElement(Oe,Object.assign({key:e.state.currentPatient},e.state,t,e.props))}}):null,t.props.activePracticePermissions.PatientCommunications||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/communications",render:function(){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/communications")}):m.a.createElement(ri,{togglePatientListModal:e.togglePatientListModal})}}):null,t.props.activePracticePermissions.PatientCommunications||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patient/:id/communications",render:function(t){return m.a.createElement(Ya,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t))}}):null,t.props.activePracticePermissions.PatientVitalSigns||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/vitalsigns",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/emr/vitalsigns")}):m.a.createElement(Ha,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t))}}):null,m.a.createElement(p.b,{path:"/patient/:id/emr/vitalsigns",render:function(a){return t.props.activePracticePermissions.PatientVitalSigns||t.allowAllPermissions?m.a.createElement(Ha,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(Z.a,null)}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/vitalsigns/edit",render:function(a){return t.props.activePracticePermissions.PatientVitalSigns||t.allowAllPermissions?m.a.createElement(Wa,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(Z.a,null)}}),m.a.createElement(p.b,{path:"/patients/emr/clinicnotes",render:function(t){return m.a.createElement(La,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}),"}/>",m.a.createElement(p.b,{path:"/patient/:id/emr/clinicnotes",render:function(t){return m.a.createElement(La,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}),t.props.activePracticePermissions.PatientCompletedProcedure||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/workdone",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/emr/workdone")}):m.a.createElement(Qa,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}):null,t.props.activePracticePermissions.PatientCompletedProcedure||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/workdone",render:function(a){return m.a.createElement(Qa,Object.assign({},t.props,{key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a))}}):null,t.props.activePracticePermissions.PatientFiles||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/files",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/emr/files")}):m.a.createElement(Sa,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},t,e.state))}}):null,t.props.activePracticePermissions.PatientFiles||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/files",render:function(t){return m.a.createElement(Sa,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,t,e.state))}}):null,t.props.activePracticePermissions.PatientFiles||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/create-medicalCertificate",render:function(t){return m.a.createElement(ui,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,t,e.state))}}):null,t.props.activePracticePermissions.PatientPrescriptions||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/prescriptions",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/emr/prescriptions")}):m.a.createElement(cn,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}):null,t.props.activePracticePermissions.PatientPrescriptions||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/prescriptions",render:function(t){return m.a.createElement(cn,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}):null,t.props.activePracticePermissions.PatientTreatmentPlans||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/plans",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/emr/plans")}):m.a.createElement(mn,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,e.props,t))}}):null,t.props.activePracticePermissions.PatientTreatmentPlans||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/plans",render:function(a){return m.a.createElement(mn,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t.props,a))}}):null,m.a.createElement(p.b,{path:"/patient/:id/emr/timeline",render:function(a){return t.props.activePracticePermissions.PatientTimeline||t.allowAllPermissions?m.a.createElement(At,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(Z.a,null)}}),t.props.activePracticePermissions.PatientLabOrders||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patient/emr/labtrackings",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/emr/labtrackings")}):m.a.createElement(bn,Object.assign({key:e.state.currentPatient},e.state,t))}}):null,m.a.createElement(p.b,{path:"/patient/:id/emr/labtrackings",render:function(a){return t.props.activePracticePermissions.PatientLabOrders||t.allowAllPermissions?m.a.createElement(bn,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(Z.a,null)}}),t.props.activePracticePermissions.PatientInvoices||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/billing/invoices",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/billing/invoices")}):m.a.createElement(Vn,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}):null,m.a.createElement(p.b,{path:"/patient/:id/billing/invoices",render:function(a){return t.props.activePracticePermissions.PatientInvoices||t.allowAllPermissions?m.a.createElement(Vn,Object.assign({},t.state,{refreshWallet:e.refreshWallet,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,a)):m.a.createElement(Z.a,null)}}),t.props.activePracticePermissions.PatientReturns||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/billing/return/invoices",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/billing/return/invoices")}):m.a.createElement($n,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t))}}):null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/return/invoices",render:function(a){return t.props.activePracticePermissions.PatientReturns||t.allowAllPermissions?m.a.createElement($n,Object.assign({refreshWallet:e.refreshWallet,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(Z.a,null)}}),t.props.activePracticePermissions.PatientPayments||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patients/billing/payments",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/billing/payments")}):m.a.createElement(Kn,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,e.props,t))}}):null,m.a.createElement(p.b,{path:"/patient/:id/billing/payments",render:function(a){return t.props.activePracticePermissions.PatientPayments||t.allowAllPermissions?m.a.createElement(Kn,Object.assign({refreshWallet:e.refreshWallet,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(Z.a,null)}}),this.state.currentPatient?m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/ledger",render:function(a){return t.props.activePracticePermissions.PatientLedger||t.allowAllPermissions?m.a.createElement(ai,Object.assign({refreshWallet:e.refreshWallet,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(Z.a,null)}}):null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/prescriptions/template/add",render:function(a){return t.props.activePracticePermissions.PatientPrescriptions||t.allowAllPermissions?m.a.createElement(tn,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(Z.a,null)}}),m.a.createElement(p.b,{path:"/patient/:id/booking",render:function(a){return t.props.activePracticePermissions.PatientBookings||t.props.allowAllPermissions?m.a.createElement(bi,Object.assign({},e.state,e.props,a,{key:e.state.currentPatient?e.state.currentPatient.id:null})):m.a.createElement(Z.a,null)}}),this.state.currentPatient&&this.state.currentPatient.is_agent?m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/wallet",render:function(a){return t.props.activePracticePermissions.PatientBookings||t.props.allowAllPermissions?m.a.createElement(yi.a,Object.assign({},e.state,e.props,a,{key:e.state.currentPatient?e.state.currentPatient.id:null})):m.a.createElement(Z.a,null)}}):null,m.a.createElement(p.b,{render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/".concat(e.state.currentPatient.id,"/profile")}):m.a.createElement(ue,Object.assign({},e.state,{key:e.state.currentPatient,setCurrentPatient:e.setCurrentPatient},e.props))}})))))))}}]),t}(m.a.Component);t.default=Ei},243:function(e,t,a){"use strict";a(247);var n=a(248),i=(a(262),a(263)),r=(a(226),a(227)),l=(a(236),a(237)),c=a(31),o=(a(242),a(19)),s=(a(229),a(228)),u=(a(251),a(254)),d=a(95),m=a(94),p=a(97),f=a(96),h=a(24),b=a(98),y=a(0),g=a.n(y),E=a(230),v=a.n(E),_=a(430),O=a.n(_),P=(a(273),a(373)),k=a.n(P),j=(a(431),function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n="",i=[];return a&&(e.forEach((function(e){i.push(e)})),n+=i.join(","),n+="\r\n"),t.forEach((function(t){i=[],e.forEach((function(e){t[e]?i.push(t[e]):i.push("--")})),n+=i.join(","),n+="\r\n"})),n}),C=function(e,t){var a,n="".concat(t,".csv"),i=[];i.push(255,254);for(var r=0;r<e.length;++r)a=e.charCodeAt(r),i.push(255&a),i.push(a/256>>>0);var l=new Blob([new Uint8Array(i)],{type:"text/csv;charset=UTF-16LE;"});if(navigator.msSaveBlob)navigator.msSaveBlob(l,n);else{var c=document.createElement("a");if(void 0!==c.download){var o=window.URL.createObjectURL(l);c.setAttribute("href",o),c.setAttribute("download",n),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(o)}}};a(23),a(34),a(235);a.d(t,"a",(function(){return S}));var S=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).getColumnSearchProps=function(e){return{filterDropdown:function(t){var n=t.setSelectedKeys,i=t.selectedKeys,r=t.confirm,l=t.clearFilters;return g.a.createElement("div",{style:{padding:8}},g.a.createElement(u.a,{ref:function(e){a.searchInput=e},placeholder:"Search ".concat(e),value:i[0],onChange:function(e){return n(e.target.value?[e.target.value]:[])},onPressEnter:function(){return a.handleSearch(i,r)},style:{width:188,marginBottom:8,display:"block"}}),g.a.createElement(s.a,{type:"primary",onClick:function(){return a.handleSearch(i,r)},icon:"search",size:"small",style:{width:90,marginRight:8}},"Search"),g.a.createElement(s.a,{onClick:function(){return a.handleReset(l)},size:"small",style:{width:90}},"Reset"))},filterIcon:function(e){return g.a.createElement(o.a,{type:"search",style:{color:e?"#1890ff":void 0}})},onFilter:function(t,a){return null!=a[e]?a[e].toString().toLowerCase().includes(t.toLowerCase()):""},onFilterDropdownVisibleChange:function(e){e&&setTimeout((function(){return a.searchInput.select()}))},render:function(e){return g.a.createElement(O.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[a.state.searchText],autoEscape:!0,textToHighlight:e?e.toString():""})}}},a.handleSearch=function(e,t){t(),a.setState({searchText:e[0]})},a.handleReset=function(e){e(),a.setState({searchText:""})},a.state=Object(c.a)({},e,{searchText:""}),a.excelExport=a.excelExport.bind(Object(h.a)(a)),a.pdfExport=a.pdfExport.bind(Object(h.a)(a)),a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.columns==this.state.columns&&e.dataSource==this.state.dataSource&&e.loading==this.state.loading||this.setState(Object(c.a)({},e))}},{key:"pdfExport",value:function(){var e=this,t=[];e.state.columns.forEach((function(e){e.hideExport||t.push({title:e.title,dataKey:e.title})}));var a=[];e.state.dataSource.forEach((function(t,n){var i={};e.state.columns.forEach((function(e){e.export?i[e.title]=e.export(t[e.dataIndex],t,n):i[e.title]=t[e.dataIndex]})),a.push(i)})),function(e,t,a){var n=new k.a("p","mm","a4");!function(e){e.line(10,20,200,20)}(n);var i=Object.create(t);n.autoTable(e,i,{margin:{top:35},startY:n.autoTableEndPosY()+20,headerStyle:{overflow:"linebreak"},bodyStyles:{overflow:"linebreak"}}),function(e){e.line(10,270,200,270),e.setFontSize(8),e.text(10,275,"This is a computer generated report.")}(n),n.save("".concat(a,".pdf"))}(t,a,"Export".concat(v()()))}},{key:"excelExport",value:function(){var e=this,t=[];e.state.columns.forEach((function(e){e.hideExport||t.push(e.title)}));var a=[];e.state.dataSource.forEach((function(t,n){var i={};e.state.columns.forEach((function(e){e.export?i[e.title]=e.export(t[e.dataIndex],t,n):i[e.title]=t[e.dataIndex]})),a.push(i)})),function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"download",n=j(e,t);C(n,a)}(t,a,"Export".concat(v()()))}},{key:"render",value:function(){var e=this,t=this.state.columns.map((function(t){return t.render?Object(c.a)({},t):Object(c.a)({},t,{},e.getColumnSearchProps(t.dataIndex))}));return g.a.createElement("div",null,this.props.hideReport?null:g.a.createElement(r.a,null,g.a.createElement(l.a,null,g.a.createElement(s.a.Group,{size:"small"},g.a.createElement(s.a,{disabled:this.state.loading,type:"primary",onClick:this.excelExport},g.a.createElement(o.a,{type:"file-excel"})," Excel"),g.a.createElement(s.a,{disabled:this.state.loading,type:"primary",onClick:this.pdfExport},g.a.createElement(o.a,{type:"file-pdf"})," PDF")))),g.a.createElement(r.a,null,g.a.createElement(n.a,Object.assign({pagination:{position:"both",pageSizeOptions:["10","20","30","40","50","100"],showSizeChanger:!0,showQuickJumper:!0,size:"small",showTotal:function(e,t){return g.a.createElement(i.a,null,"Showing ",g.a.createElement("b",null,t[0])," to ",g.a.createElement("b",null,t[1])," of ",g.a.createElement("b",null,e)," items")}}},this.state,{columns:t}))))}}]),t}(g.a.Component)},261:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));a(229);var n=a(228),i=(a(244),a(245)),r=(a(226),a(227)),l=a(95),c=a(94),o=a(97),s=a(96),u=a(24),d=a(98),m=a(0),p=a.n(m),f=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(s.a)(t).call(this,e))).startLoading=function(){a.props.loaderFunction&&(a.props.loaderFunction(),a.startMakingExtraLabels())},a.startMakingExtraLabels=function(){var e=Object(u.a)(a);a.setState((function(e){return e.extraLoadingLabel.length>2?{extraLoadingLabel:""}:{extraLoadingLabel:"".concat(e.extraLoadingLabel,".")}}),(function(){e.props.loading&&setTimeout((function(){e.startMakingExtraLabels()}),500)}))},a.state={extraLoadingLabel:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.props.loading?p.a.createElement(i.a,{spinning:this.props.loading},p.a.createElement(r.a,{style:{minHeight:200}})):this.props.hidden?p.a.createElement(r.a,null,p.a.createElement("div",{style:{textAlign:"center",margin:"15px 0px"}},p.a.createElement("small",null,"No More Data Found"))):p.a.createElement(r.a,null,p.a.createElement("div",{style:{textAlign:"center",margin:"15px 0px"}},p.a.createElement(n.a,{type:"primary",onClick:this.startLoading,loading:this.props.loading},this.props.loading?"Loading".concat(this.state.extraLoadingLabel):"Load More")))}}]),t}(p.a.Component)},328:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ConfigConsumer",{enumerable:!0,get:function(){return c.ConfigConsumer}}),t.default=t.configConsumerProps=void 0;var n,i=s(a(0)),r=s(a(519)),l=(n=a(355))&&n.__esModule?n:{default:n},c=a(522);function o(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function s(e){if(e&&e.__esModule)return e;if(null===e||"object"!==u(e)&&"function"!==typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=n?Object.getOwnPropertyDescriptor(e,i):null;r&&(r.get||r.set)?Object.defineProperty(a,i,r):a[i]=e[i]}return a.default=e,t&&t.set(e,a),a}function u(e){return(u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return!t||"object"!==u(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}t.configConsumerProps=["getPopupContainer","rootPrefixCls","getPrefixCls","renderEmpty","csp","autoInsertSpaceInButton","locale","pageHeader"];var y=function(e){function t(){var e;return m(this,t),(e=f(this,h(t).apply(this,arguments))).getPrefixCls=function(t,a){var n=e.props.prefixCls,i=void 0===n?"ant":n;return a||(t?"".concat(i,"-").concat(t):i)},e.renderProvider=function(t,a){var n=e.props,l=n.children,o=n.getPopupContainer,s=n.renderEmpty,u=n.csp,m=n.autoInsertSpaceInButton,p=n.locale,f=n.pageHeader,h=d(d({},t),{getPrefixCls:e.getPrefixCls,csp:u,autoInsertSpaceInButton:m});return o&&(h.getPopupContainer=o),s&&(h.renderEmpty=s),f&&(h.pageHeader=f),i.createElement(c.ConfigContext.Provider,{value:h},i.createElement(r.default,{locale:p||a,_ANT_MARK__:r.ANT_MARK},l))},e}var a,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e=this;return i.createElement(l.default,null,(function(t,a,n){return i.createElement(c.ConfigConsumer,null,(function(t){return e.renderProvider(t,n)}))}))}}])&&p(a.prototype,n),o&&p(a,o),t}(i.Component);t.default=y},340:function(e,t,a){"use strict";function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"resetWarned",{enumerable:!0,get:function(){return i.resetWarned}}),t.default=void 0;var i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!==typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var c=i?Object.getOwnPropertyDescriptor(e,l):null;c&&(c.get||c.set)?Object.defineProperty(a,l,c):a[l]=e[l]}a.default=e,t&&t.set(e,a);return a}(a(140));function r(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}t.default=function(e,t,a){(0,i.default)(e,"[antd: ".concat(t,"] ").concat(a))}},355:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=o(a(0)),r=o(a(1)),l=(n=a(515))&&n.__esModule?n:{default:n};function c(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!==typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=n?Object.getOwnPropertyDescriptor(e,i):null;r&&(r.get||r.set)?Object.defineProperty(a,i,r):a[i]=e[i]}return a.default=e,t&&t.set(e,a),a}function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return!t||"object"!==s(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=function(e){function t(){return d(this,t),p(this,f(t).apply(this,arguments))}var a,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),a=t,(n=[{key:"getLocale",value:function(){var e=this.props,t=e.componentName,a=e.defaultLocale||l.default[t||"global"],n=this.context.antLocale,i=t&&n?n[t]:{};return u(u({},"function"===typeof a?a():a),i||{})}},{key:"getLocaleCode",value:function(){var e=this.context.antLocale,t=e&&e.locale;return e&&e.exist&&!t?l.default.locale:t}},{key:"render",value:function(){return this.props.children(this.getLocale(),this.getLocaleCode(),this.context.antLocale)}}])&&m(a.prototype,n),i&&m(a,i),t}(i.Component);t.default=b,b.defaultProps={componentName:"global"},b.contextTypes={antLocale:r.object}},375:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=c(a(516)),i=c(a(376)),r=c(a(377)),l=c(a(518));function c(e){return e&&e.__esModule?e:{default:e}}var o={locale:"en",Pagination:n.default,DatePicker:i.default,TimePicker:r.default,Calendar:l.default,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",selectAll:"Select current page",selectInvert:"Invert current page",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No Data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"}};t.default=o},376:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(517)),i=r(a(377));function r(e){return e&&e.__esModule?e:{default:e}}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var c={lang:l({placeholder:"Select date",rangePlaceholder:["Start date","End date"]},n.default),timePickerLocale:l({},i.default)};t.default=c},377:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={placeholder:"Select time"};t.default=n},515:function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=((n=a(375))&&n.__esModule?n:{default:n}).default;t.default=i},516:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages"},e.exports=t.default},517:function(e,t,a){"use strict";t.__esModule=!0,t.default={today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},e.exports=t.default},518:function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=((n=a(376))&&n.__esModule?n:{default:n}).default;t.default=i},519:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ANT_MARK=void 0;var n=d(a(0)),i=d(a(1)),r=d(a(230)),l=s(a(520)),c=a(521),o=s(a(340));function s(e){return e&&e.__esModule?e:{default:e}}function u(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function d(e){if(e&&e.__esModule)return e;if(null===e||"object"!==m(e)&&"function"!==typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=n?Object.getOwnPropertyDescriptor(e,i):null;r&&(r.get||r.set)?Object.defineProperty(a,i,r):a[i]=e[i]}return a.default=e,t&&t.set(e,a),a}function m(e){return(m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function f(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return!t||"object"!==m(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){e&&e.locale?(0,l.default)(r).locale(e.locale):(0,l.default)(r).locale("en")}t.ANT_MARK="internalMark";var E=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=h(this,b(t).call(this,e)),g(e.locale),(0,c.changeConfirmLocale)(e.locale&&e.locale.Modal),(0,o.default)("internalMark"===e._ANT_MARK__,"LocaleProvider","`LocaleProvider` is deprecated. Please use `locale` with `ConfigProvider` instead: http://u.ant.design/locale"),a}var a,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),a=t,(n=[{key:"getChildContext",value:function(){return{antLocale:p(p({},this.props.locale),{exist:!0})}}},{key:"componentDidUpdate",value:function(e){var t=this.props.locale;e.locale!==t&&(g(t),(0,c.changeConfirmLocale)(t&&t.Modal))}},{key:"componentWillUnmount",value:function(){(0,c.changeConfirmLocale)()}},{key:"render",value:function(){return this.props.children}}])&&f(a.prototype,n),i&&f(a,i),t}(n.Component);t.default=E,E.propTypes={locale:i.object},E.defaultProps={locale:{}},E.childContextTypes={antLocale:i.object}},520:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.default||e}},521:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeConfirmLocale=function(e){l=e?r(r({},l),e):r({},i.default.Modal)},t.getConfirmLocale=function(){return l};var n,i=(n=a(375))&&n.__esModule?n:{default:n};function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var l=r({},i.default.Modal)},522:function(e,t,a){"use strict";function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.withConfigConsumer=function(e){return function(t){var a=function(a){return i.createElement(d,null,(function(n){var r=e.prefixCls,l=(0,n.getPrefixCls)(r,a.prefixCls);return i.createElement(t,s({},n,a,{prefixCls:l}))}))},n=t.constructor,r=n&&n.displayName||t.name||"Component";return a.displayName="withConfigConsumer(".concat(r,")"),a}},t.ConfigConsumer=t.ConfigContext=void 0;var i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!==typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=i?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}a.default=e,t&&t.set(e,a);return a}(a(0)),r=c(a(37)),l=c(a(523));function c(e){return e&&e.__esModule?e:{default:e}}function o(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var u=(0,r.default)({getPrefixCls:function(e,t){return t||"ant-".concat(e)},renderEmpty:l.default});t.ConfigContext=u;var d=u.Consumer;t.ConfigConsumer=d},523:function(e,t,a){"use strict";function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!==typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=i?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}a.default=e,t&&t.set(e,a);return a}(a(0)),l=(i=a(524))&&i.__esModule?i:{default:i},c=a(328);function o(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var s=function(e){return r.createElement(c.ConfigConsumer,null,(function(t){var a=(0,t.getPrefixCls)("empty");switch(e){case"Table":case"List":return r.createElement(l.default,{image:l.default.PRESENTED_IMAGE_SIMPLE});case"Select":case"TreeSelect":case"Cascader":case"Transfer":case"Mentions":return r.createElement(l.default,{image:l.default.PRESENTED_IMAGE_SIMPLE,className:"".concat(a,"-small")});default:return r.createElement(l.default,null)}}))};t.default=s},524:function(e,t,a){"use strict";function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!==typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=i?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}a.default=e,t&&t.set(e,a);return a}(a(0)),r=u(a(5)),l=a(328),c=u(a(355)),o=u(a(525)),s=u(a(526));function u(e){return e&&e.__esModule?e:{default:e}}function d(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var p=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},f=i.createElement(o.default,null),h=i.createElement(s.default,null),b=function(e){return i.createElement(l.ConfigConsumer,null,(function(t){var a=t.getPrefixCls,n=e.className,l=e.prefixCls,o=e.image,s=void 0===o?f:o,u=e.description,d=e.children,b=e.imageStyle,y=p(e,["className","prefixCls","image","description","children","imageStyle"]);return i.createElement(c.default,{componentName:"Empty"},(function(e){var t,c,o,p=a("empty",l),f="undefined"!==typeof u?u:e.description,g="string"===typeof f?f:"empty",E=null;return E="string"===typeof s?i.createElement("img",{alt:g,src:s}):s,i.createElement("div",m({className:(0,r.default)(p,(t={},c="".concat(p,"-normal"),o=s===h,c in t?Object.defineProperty(t,c,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[c]=o,t),n)},y),i.createElement("div",{className:"".concat(p,"-image"),style:b},E),f&&i.createElement("p",{className:"".concat(p,"-description")},f),d&&i.createElement("div",{className:"".concat(p,"-footer")},d))}))}))};b.PRESENTED_IMAGE_DEFAULT=f,b.PRESENTED_IMAGE_SIMPLE=h;var y=b;t.default=y},525:function(e,t,a){"use strict";function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!==typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var c=i?Object.getOwnPropertyDescriptor(e,l):null;c&&(c.get||c.set)?Object.defineProperty(a,l,c):a[l]=e[l]}a.default=e,t&&t.set(e,a);return a}(a(0));function r(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}var l=function(){return i.createElement("svg",{width:"184",height:"152",viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg"},i.createElement("g",{fill:"none",fillRule:"evenodd"},i.createElement("g",{transform:"translate(24 31.67)"},i.createElement("ellipse",{fillOpacity:".8",fill:"#F5F5F7",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),i.createElement("path",{d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z",fill:"#AEB8C2"}),i.createElement("path",{d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",fill:"url(#linearGradient-1)",transform:"translate(13.56)"}),i.createElement("path",{d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z",fill:"#F5F5F7"}),i.createElement("path",{d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z",fill:"#DCE0E6"})),i.createElement("path",{d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z",fill:"#DCE0E6"}),i.createElement("g",{transform:"translate(149.65 15.383)",fill:"#FFF"},i.createElement("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),i.createElement("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"}))))};t.default=l},526:function(e,t,a){"use strict";function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!==typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var c=i?Object.getOwnPropertyDescriptor(e,l):null;c&&(c.get||c.set)?Object.defineProperty(a,l,c):a[l]=e[l]}a.default=e,t&&t.set(e,a);return a}(a(0));function r(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}var l=function(){return i.createElement("svg",{width:"64",height:"41",viewBox:"0 0 64 41",xmlns:"http://www.w3.org/2000/svg"},i.createElement("g",{transform:"translate(0 1)",fill:"none",fillRule:"evenodd"},i.createElement("ellipse",{fill:"#F5F5F5",cx:"32",cy:"33",rx:"32",ry:"7"}),i.createElement("g",{fillRule:"nonzero",stroke:"#D9D9D9"},i.createElement("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"}),i.createElement("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",fill:"#FAFAFA"}))))};t.default=l},527:function(e,t,a){"use strict";a(49),a(528)},528:function(e,t,a){},529:function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a(0),i=a(1),r=a(530),l=a.n(r),c=a(5),o=a.n(c),s=a(50),u=a(385),d=a(19),m=a(104),p=a(9);function f(e){return(f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function b(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function y(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t){return!t||"object"!==f(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=g(this,E(t).call(this,e))).saveSwitch=function(e){a.rcSwitch=e},a.renderSwitch=function(e){var t,i=e.getPrefixCls,r=a.props,c=r.prefixCls,m=r.size,p=r.loading,f=r.className,y=void 0===f?"":f,g=r.disabled,E=i("switch",c),v=o()(y,(b(t={},"".concat(E,"-small"),"small"===m),b(t,"".concat(E,"-loading"),p),t)),_=p?n.createElement(d.a,{type:"loading",className:"".concat(E,"-loading-icon")}):null;return n.createElement(u.a,{insertExtraNode:!0},n.createElement(l.a,h({},Object(s.default)(a.props,["loading"]),{prefixCls:E,className:v,disabled:g||p,ref:a.saveSwitch,loadingIcon:_})))},Object(p.a)("checked"in e||!("value"in e),"Switch","`value` is not validate prop, do you mean `checked`?"),a}var a,i,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),a=t,(i=[{key:"focus",value:function(){this.rcSwitch.focus()}},{key:"blur",value:function(){this.rcSwitch.blur()}},{key:"render",value:function(){return n.createElement(m.a,null,this.renderSwitch)}}])&&y(a.prototype,i),r&&y(a,r),t}(n.Component);_.__ANT_SWITCH=!0,_.propTypes={prefixCls:i.string,size:i.oneOf(["small","default","large"]),className:i.string}},530:function(e,t,a){e.exports=a(531)},531:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(1),l=a.n(r),c=a(48);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function u(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var h=a(5),b=function(e){function t(e){var a,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,i=d(t).call(this,e),a=!i||"object"!==typeof i&&"function"!==typeof i?p(n):i,f(p(p(a)),"handleClick",(function(e){var t=a.state.checked,n=a.props.onClick,i=!t;a.setChecked(i,e),n&&n(i,e)})),f(p(p(a)),"handleKeyDown",(function(e){37===e.keyCode?a.setChecked(!1,e):39===e.keyCode&&a.setChecked(!0,e)})),f(p(p(a)),"handleMouseUp",(function(e){var t=a.props.onMouseUp;a.node&&a.node.blur(),t&&t(e)})),f(p(p(a)),"saveNode",(function(e){a.node=e}));var r=!1;return r="checked"in e?!!e.checked:!!e.defaultChecked,a.state={checked:r},a}var a,n,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,e),a=t,r=[{key:"getDerivedStateFromProps",value:function(e){var t={},a=e.checked;return"checked"in e&&(t.checked=!!a),t}}],(n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.autoFocus,a=e.disabled;t&&!a&&this.focus()}},{key:"setChecked",value:function(e,t){var a=this.props,n=a.disabled,i=a.onChange;n||("checked"in this.props||this.setState({checked:e}),i&&i(e,t))}},{key:"focus",value:function(){this.node.focus()}},{key:"blur",value:function(){this.node.blur()}},{key:"render",value:function(){var e,t=this.props,a=t.className,n=t.prefixCls,r=t.disabled,l=t.loadingIcon,c=t.checkedChildren,u=t.unCheckedChildren,d=s(t,["className","prefixCls","disabled","loadingIcon","checkedChildren","unCheckedChildren"]),m=this.state.checked,p=h((f(e={},a,!!a),f(e,n,!0),f(e,"".concat(n,"-checked"),m),f(e,"".concat(n,"-disabled"),r),e));return i.a.createElement("button",o({},d,{type:"button",role:"switch","aria-checked":m,disabled:r,className:p,ref:this.saveNode,onKeyDown:this.handleKeyDown,onClick:this.handleClick,onMouseUp:this.handleMouseUp}),l,i.a.createElement("span",{className:"".concat(n,"-inner")},m?c:u))}}])&&u(a.prototype,n),r&&u(a,r),t}(n.Component);b.propTypes={className:l.a.string,prefixCls:l.a.string,disabled:l.a.bool,checkedChildren:l.a.any,unCheckedChildren:l.a.any,onChange:l.a.func,onMouseUp:l.a.func,onClick:l.a.func,tabIndex:l.a.number,checked:l.a.bool,defaultChecked:l.a.bool,autoFocus:l.a.bool,loadingIcon:l.a.node},b.defaultProps={prefixCls:"rc-switch",checkedChildren:null,unCheckedChildren:null,className:"",defaultChecked:!1},Object(c.polyfill)(b),t.default=b},532:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));a(231);var n=a(232),i=(a(252),a(253)),r=(a(242),a(19)),l=(a(226),a(227)),c=(a(278),a(279)),o=(a(234),a(233)),s=(a(236),a(237)),u=a(47),d=a(250),m=a(95),p=a(94),f=a(97),h=a(96),b=a(24),y=a(98),g=(a(374),a(378)),E=a(0),v=a.n(E),_=a(230),O=a.n(_),P=a(243),k=a(23),j=a(34),C=a(261),S=g.a.Text,x=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).loadPatientWallet=function(){var e=Object(b.a)(a);if(a.props.currentPatient&&a.props.currentPatient.id){Object(k.c)(Object(k.f)(j.g,[a.props.currentPatient.id]),(function(t){t.length&&e.setState({walletAmount:t[0]})}),(function(){}))}else a.setState({pendingAmount:null})},a.loadData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(b.a)(a);a.setState({loading:!0});var n=function(e){1==e.current?t.setState({ledger:e.results,loading:!1,nextPage:e.next}):t.setState((function(t){return{ledger:[].concat(Object(d.a)(t.ledger),Object(d.a)(e.results)),loading:!1,nextPage:e.next}}))},i=function(){t.setState({loading:!1})},r={page:e,start:a.state.selectedStartDate.startOf("day").format(),end:a.state.selectedEndDate.endOf("day").format(),agents:a.state.selectedAgents.join(",")};a.state.selectedAgents&&(r.agents=a.state.selectedAgents.join(",")),Object(k.c)(Object(k.f)(j.Qd,[a.props.currentPatient.id]),n,i,r)},a.loadSumData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(b.a)(a),n=function(e){t.setState({ledgerDetails:e,nextPage:e.next})},i=function(){},r={page:e,start:a.state.selectedStartDate.format(),end:a.state.selectedEndDate.format(),agents:a.state.selectedAgents.join(",")};a.state.selectedAgents&&(r.agents=a.state.selectedAgents.join(",")),Object(k.c)(Object(k.f)(j.Rd,[a.props.currentPatient.id]),n,i,r)},a.changeExpenseFilters=function(e,t){var n=Object(b.a)(a);a.setState(Object(u.a)({},e,t),(function(){n.loadData(1)}))},a.state={ledger:[],ledgerDetails:{},loading:!1,walletAmount:null,selectedStartDate:O()().subtract(1,"month"),selectedEndDate:O()(),agents:[],selectedAgents:[]},a}return Object(y.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.loadData(),this.loadPatientWallet(),this.loadAgents(),this.loadSumData()}},{key:"loadAgents",value:function(){var e=this;Object(k.c)(Object(k.f)(j.gc,[this.props.currentPatient.id]),(function(t){e.setState({agents:t})}),(function(){}),{agent:!0,pagination:!1})}},{key:"render",value:function(){var e=this,t=[{title:"Date",dataIndex:"created_at",key:"created_at",render:function(e){return O()(e).format("LLL")}},{title:"Patient",dataIndex:"received_from",key:"received_from",render:function(e,t){return e?v.a.createElement(S,null,e.user.first_name," (",e.custom_id,")"):"--"}},,{title:"Refered By",dataIndex:"received_from.user.referer_data",key:"received_from.user.referer_data",render:function(e,t){return e&&e.referer?v.a.createElement(S,null,e.referer.first_name," (",e.custom_id,")"):"--"}},{title:"Ledger Comment",dataIndex:"comments",key:"comments",render:function(e,t){return t.is_cancelled?v.a.createElement(S,{delete:!0},e):e}},{title:"Cr/Dr",dataIndex:"ledger_type",key:"ledger_type",render:function(e,t){return t.is_cancelled?v.a.createElement(S,{delete:!0},e):e}},{title:"Amount",dataIndex:"amount",key:"amount",render:function(e,t){return t.is_cancelled?v.a.createElement(S,{delete:!0},e.toFixed(2)):e.toFixed(2)}}];return v.a.createElement("div",null,v.a.createElement(n.a,{title:"Wallet Ledger"},v.a.createElement(l.a,{gutter:16,style:{marginBottom:10}},v.a.createElement(s.a,{span:2,style:{textAlign:"right"}},v.a.createElement("b",null," Agents")),v.a.createElement(s.a,{span:4},v.a.createElement(o.a,{style:{width:"100%"},value:this.state.selectedAgents,mode:"multiple",disabled:this.state.loading,onChange:function(t){return e.changeExpenseFilters("selectedAgents",t)}},this.state.agents.map((function(e){return v.a.createElement(o.a.Option,{value:e.id},e.user.first_name)})))),v.a.createElement(s.a,{span:2,style:{textAlign:"right"}},v.a.createElement("b",null," From")),v.a.createElement(s.a,{span:4},v.a.createElement(c.a,{value:this.state.selectedStartDate,disabled:this.state.loading,allowClear:!1,onChange:function(t){return e.changeExpenseFilters("selectedStartDate",t)}})),v.a.createElement(s.a,{span:2,style:{textAlign:"right"}},v.a.createElement("b",null," To")),v.a.createElement(s.a,{span:4},v.a.createElement(c.a,{value:this.state.selectedEndDate,disabled:this.state.loading,allowClear:!1,onChange:function(t){return e.changeExpenseFilters("selectedEndDate",t)}}))),this.state.walletAmount?v.a.createElement(l.a,{style:{textAlign:"center",marginBottom:10}},v.a.createElement(s.a,{span:24},v.a.createElement(i.a,{title:"Wallet Total",prefix:v.a.createElement(r.a,{type:"wallet"}),value:this.state.walletAmount.non_refundable,precision:2}))):null,v.a.createElement(P.a,{dataSource:this.state.ledger,loading:this.state.loading,columns:t,hideReport:!0,pagination:!1}),v.a.createElement(C.a,{loading:this.state.loading,hidden:!this.state.nextPage,loaderFunction:function(){return e.loadData(e.state.nextPage)}}),v.a.createElement(l.a,{style:{textAlign:"center",marginBottom:10}},v.a.createElement(s.a,{span:8},v.a.createElement(i.a,{title:"Credit",value:this.state.ledgerDetails.credit,precision:2})),v.a.createElement(s.a,{span:8},v.a.createElement(i.a,{title:"Debit",value:this.state.ledgerDetails.debit,precision:2})),v.a.createElement(s.a,{span:8},v.a.createElement(i.a,{title:"Profit",value:this.state.ledgerDetails.credit-this.state.ledgerDetails.debit,precision:2})))))}}]),t}(v.a.Component)}}]);
//# sourceMappingURL=11.09a173da.chunk.js.map