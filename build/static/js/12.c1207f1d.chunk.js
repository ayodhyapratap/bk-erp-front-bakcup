(window["webpackJsonpbk-erp-front"]=window["webpackJsonpbk-erp-front"]||[]).push([[12,6],{1784:function(e,t,a){var n=a(477),i=a(509),r=a(401);e.exports=function(e,t){var a={};return t=r(t,3),i(e,(function(e,i,r){n(a,t(e,i,r),e)})),a}},1785:function(e,t,a){},1786:function(e,t,a){},1798:function(e,t,a){"use strict";a.r(t);a(332);var n=a(333),i=a(63),r=a(64),l=a(67),c=a(65),o=a(30),s=a(66),u=(a(187),a(127)),d=a(0),m=a.n(d),p=a(37),h=(a(123),a(33)),f=(a(350),a(351)),b=(a(359),a(362)),y=(a(353),a(354)),g=(a(125),a(17)),E=(a(347),a(348)),v=(a(325),a(326)),_=(a(185),a(124)),O=(a(342),a(343)),P=(a(384),a(385)),k=(a(327),a(14)),j=(a(184),a(58)),C=(a(375),a(377)),S=(a(364),a(361)),I=(a(328),a(329)),x=(a(323),a(322)),D=a(339),w=a(34),M=(a(372),a(373)),T=(a(341),a(344)),F=a(18),A=a(35),L=a(352),V=a(330),N=a(4),R=a(334),B=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).getPatientGroup=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.qc,[a.props.active_practiceId]),(function(t){e.setState({patientGroup:t,loading:!1})}),(function(){e.setState({loading:!1})}))},a.state={patientGroup:[],loading:!0},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.getPatientGroup()}},{key:"deleteObject",value:function(e){var t=this,a=e;a.is_active=!1;Object(F.j)(Object(F.f)(A.qc,[this.props.active_practiceId]),a,(function(e){t.getPatientGroup()}),(function(){}))}},{key:"render",value:function(){var e=this,t=[{title:"Group Name",dataIndex:"name",key:"name"},{title:"Patient Count",dataIndex:"patient_count",key:"patient_count"},{title:"Action",key:"action",render:function(t,a){return m.a.createElement(E.a,{title:"Are you sure delete this prescription?",onConfirm:function(){return e.deleteObject(a)},okText:"Yes",cancelText:"No"},m.a.createElement("a",null,"Delete"))}}],a=[{label:"Group Name",key:"name",required:!0,type:N.W}],n={successFn:function(t){console.log(t),Object(F.a)(N.Sb,"success"),e.getPatientGroup()},errorFn:function(){},action:Object(F.f)(A.qc,[this.props.active_practiceId]),method:"post",beforeSubmit:function(e){console.log(e)}},i=I.a.create()(R.a);return m.a.createElement(h.a,null,m.a.createElement(i,Object.assign({formProp:n,title:"Patient Groups",fields:a},this.props)),m.a.createElement(v.a,null),m.a.createElement(V.a,{dataSource:this.state.patientGroup,loading:this.state.loading,columns:t}))}}]),t}(m.a.Component),z=a(386),Y=a(336),q=a(86),G=a.n(q),W=a(960),H=a.n(W),U=a(1784),K=a.n(U),X=a(389);function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var J=j.a.Meta,$=T.a.Search,ee=M.a.MonthPicker,te=1,ae=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).togglePatientGroupEditing=function(e){a.setState({showPatientGroupModal:!!e}),e||a.getPatientGroup()},a.changeSelectedPatientGroup=function(e){var t=Object(o.a)(a);a.setState({selectedPatientGroup:e.target.value,currentPage:null},(function(){t.getMorePatient()}))},a.addNewOptionField=function(){var e=a.props.form,t=e.getFieldValue("keys").concat(te++);e.setFieldsValue({keys:t})},a.removeNewOptionField=function(e){var t=a.props.form,n=t.getFieldValue("keys");1!==n.length&&t.setFieldsValue({keys:n.filter((function(t){return t!==e}))})},a.handleChangeOption=function(e,t,n){Object(o.a)(a).setState((function(t){return{selectedOption:Z({},t.selectedOption,Object(w.a)({},e,n)),custm_col:n?12:8}}))},a.AdvanceSearchPatient=function(e){var t=Object(o.a)(a);e.preventDefault();var n={};a.props.form.validateFields((function(e,t){e||(n=Z({},t,{dob:t.dob?G()(t.dob).format("YYYY-MM-DD"):null,dob_gte:t.dob_gte?G()(t.dob_gte).format("YYYY-MM-DD"):null,dob_lte:t.dob_lte?G()(t.dob_lte).format("YYYY-MM-DD"):null,dob_month:t.dob_month?G()(t.dob_month).format("MM"):null}))})),delete n.keys,t.setState({patientData:n},(function(){t.loadAdvanceSearchPatient()}))},a.loadAdvanceSearchPatient=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(o.a)(a),n=t.state.patientData;t.setState({advancedSearch:!0,advanceLoading:!0});var i=function(e){t.setState((function(t){return e.current>1?{patientListData:[].concat(Object(D.a)(t.patientListData),Object(D.a)(e.results)),morePatientList:e.next,currentPage:e.current,advanceLoading:!1}:{patientListData:Object(D.a)(e.results),morePatientList:e.next,currentPage:e.current,advanceLoading:!1}}))},r=function(){t.setState({advanceLoading:!1})};n.page=e,Object(F.c)(A.d,i,r,n)},a.state={patientListData:[],patientGroup:[],morePatients:null,loading:!0,selectedPatientGroup:"all",advanced_option:Y.b,selectedOption:{},sourceList:[],custm_col:8,advanceLoading:!1},a.getPatientListData=a.getPatientListData.bind(Object(o.a)(a)),a.searchPatient=a.searchPatient.bind(Object(o.a)(a)),a.getMorePatient=a.getMorePatient.bind(Object(o.a)(a)),a.getSources=a.getSources.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.getPatientListData(),this.getPatientGroup(),this.getSources()}},{key:"getSources",value:function(){var e=this;Object(F.c)(A.yd,(function(t){e.setState({sourceList:t})}),(function(){}))}},{key:"getPatientGroup",value:function(){var e=this;Object(F.c)(Object(F.f)(A.qc,[this.props.active_practiceId]),(function(t){var a=t.sort((function(e,t){return t.patient_count-e.patient_count}));e.setState({patientGroup:a})}),(function(){e.setState({})}))}},{key:"getPatientListData",value:function(){var e=this;Object(F.c)(A.ic,(function(t){e.setState({patientListData:t.results,morePatients:t.next,currentPage:t.current,totalPatients:t.count,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"searchPatient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=this;a.setState({searchvalue:!0,searchString:e});var n=function(t){a.setState((function(a){if(a.searchString==e)return t.current>1?{patientListData:[].concat(Object(D.a)(a.patientListData),Object(D.a)(t.results)),morePatients:t.next,currentPage:t.current}:{patientListData:Object(D.a)(t.results),morePatients:t.next,currentPage:t.current,loading:!1}}))},i=function(){},r={page:t,page_size:20};e?Object(F.c)(Object(F.f)(A.Vc,[e]),n,i,r):this.getPatientListData()}},{key:"getMorePatient",value:function(){var e=this,t=this.state.currentPage,a={};t?a.page=parseInt(t)+1:this.setState({loading:!0});var n=this.state.selectedPatientGroup;if("all"!=n)if("smart_a"==n||"smart_b"==n||"smart_c"==n||"smart_d"==n||"smart_e"==n||"smart_f"==n)switch(n){case"smart_a":a.gender="male";break;case"smart_b":a.gender="female";break;case"smart_c":a.gender="female",a.age=30,a.type="gt";break;case"smart_d":a.gender="female",a.age=30,a.type="lt";break;case"smart_e":a.gender="male",a.age=30,a.type="gt";break;case"smart_f":a.gender="male",a.age=30,a.type="lt"}else a.group=this.state.selectedPatientGroup;Object(F.c)(A.ic,(function(a){a.current==t+1&&e.setState((function(e){return a.current>1?{patientListData:[].concat(Object(D.a)(e.patientListData),Object(D.a)(a.results)),morePatients:a.next,currentPage:a.current}:{patientListData:Object(D.a)(a.results),morePatients:a.next,currentPage:a.current,loading:!1}}))}),(function(){}),Z({},a))}},{key:"advancedOption",value:function(e){this.getPatientListData(),this.setState({advancedOptionShow:!e,selectedOption:""}),e&&this.props.form.setFieldsValue({keys:[0]})}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,i=a.getFieldDecorator,r=a.getFieldValue;i("keys",{initialValue:[0]});var l=r("keys"),c=Z({},K()(this.state.selectedOption,(function(e){return e}))),o=l.map((function(a,n){return m.a.createElement(h.a,{gutter:12,key:a},m.a.createElement(g.a,{span:10},m.a.createElement(x.a,{style:{width:"200px"},defaultValue:N.y,key:a,size:"small",onChange:function(t){return e.handleChangeOption(a,"type",t)}},m.a.createElement(x.a.Option,{value:""},N.y),H()(e.state.advanced_option,(function(e){return t.state.selectedOption[a]==e.value||!c[e.value]})).map((function(e){return m.a.createElement(x.a.Option,{value:e.value,key:a},e.label)})))),e.state.selectedOption?m.a.createElement(m.a.Fragment,null,m.a.createElement(g.a,{span:8},m.a.createElement(re,{k:a,selectedOption:e.state.selectedOption,form:e.props.form,sourceList:e.state.sourceList})),m.a.createElement(g.a,{span:4},n?m.a.createElement(_.a,{onClick:function(){return e.removeNewOptionField(a)},size:"small",style:{margin:5}},m.a.createElement(k.a,{className:"dynamic-delete-button",type:"minus-circle-o",style:{color:"red"}})):null,n==l.length-1&&t.state.selectedOption[a]?m.a.createElement(_.a,{onClick:e.addNewOptionField,size:"small",style:{margin:5}},m.a.createElement(k.a,{className:"dynamic-delete-button",type:"plus-circle-o"})):null)):null)}));return t.props.activePracticePermissions.ViewPatient?m.a.createElement("div",null,m.a.createElement(h.a,{gutter:16},this.state.advancedOptionShow?m.a.createElement(I.a,{onSubmit:this.AdvanceSearchPatient,layout:"inline"},m.a.createElement(h.a,{gutter:16},m.a.createElement(g.a,{span:16},o),m.a.createElement(g.a,{span:4,style:{display:"flex"}},m.a.createElement(I.a.Item,null,m.a.createElement(_.a,{icon:"search",htmlType:"submit",onSubmit:this.AdvanceSearchPatient,type:"primary",style:{margin:5}},"Search")),m.a.createElement(I.a.Item,null,m.a.createElement(_.a,{style:{margin:5},onClick:function(t){return e.advancedOption(!0)},size:"small"},"Basic Search"))))):m.a.createElement(m.a.Fragment,null,m.a.createElement(g.a,{span:12},m.a.createElement($,{style:{margin:5},placeholder:"Search Patient By Name / ID / Mobile No / Aadhar No",size:"small",onChange:function(t){return e.searchPatient(t.target.value)},enterButton:!0})),m.a.createElement(g.a,{span:12,style:{textAlign:"center"}},m.a.createElement(_.a,{style:{margin:5},onClick:function(t){return e.advancedOption(!1)},size:"small"},"Advance Search"))),m.a.createElement(v.a,{style:{margin:0}})),m.a.createElement(h.a,{gutter:16},m.a.createElement(g.a,{span:5,style:{height:"calc(100% - 55px)",overflow:"auto",padding:"10px"}},m.a.createElement(S.a.Group,{buttonStyle:"solid",defaultValue:this.state.selectedPatientGroup,onChange:this.changeSelectedPatientGroup},m.a.createElement("h2",null,"Patients"),m.a.createElement(S.a.Button,{key:"all",style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:"all"},"All Patients",m.a.createElement(y.a,{color:"#87d068",style:{float:"right",margin:4}},this.state.totalPatients?this.state.totalPatients:0)),m.a.createElement("p",null,m.a.createElement("br",null)),m.a.createElement("h2",null,"Groups"),m.a.createElement("p",null,m.a.createElement("b",null,"My Groups"),m.a.createElement("a",{style:{float:"right"},onClick:function(){return e.togglePatientGroupEditing(!0)}},"Manage")),this.state.patientGroup.map((function(e){return m.a.createElement(S.a.Button,{key:e.id,style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:e.id},e.name,m.a.createElement(y.a,{color:"#87d068",style:{float:"right",margin:4}},e.patient_count))})),m.a.createElement("p",null,m.a.createElement("br",null)),m.a.createElement("p",null,m.a.createElement("b",null,"Smart Groups")),m.a.createElement(S.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_a",value:"smart_a"},"All Male"),m.a.createElement(S.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_b",value:"smart_b"},"All Female"),m.a.createElement(S.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_e",value:"smart_e"},"Male Over 30"),m.a.createElement(S.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_c",value:"smart_c"},"Female Over 30"),m.a.createElement(S.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_f",value:"smart_f"},"Male Under 30"),m.a.createElement(S.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_d",value:"smart_d"},"Female Under 30"),m.a.createElement("p",null,m.a.createElement("br",null)))),m.a.createElement(g.a,{span:19,style:{overflow:"scroll",borderLeft:"1px solid #ccc"}},m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,null,this.state.patientListData.length?this.state.patientListData.map((function(e){return m.a.createElement(ie,Object.assign({},e,{key:e.id,showMobile:t.props.activePracticePermissions.PatientPhoneNumber,showEmail:t.props.activePracticePermissions.PatientEmailId,setCurrentPatient:t.props.setCurrentPatient}))})):m.a.createElement("p",{style:{textAlign:"center"}},"No Data Found"))),this.state.searchvalue?m.a.createElement(L.a,{loaderFunction:this.searchPatient,loading:this.state.loading,hidden:!this.state.morePatients}):this.state.advancedSearch?m.a.createElement(L.a,{loading:this.state.advanceLoading,loaderFunction:function(){return e.loadAdvanceSearchPatient(t.state.morePatientList)},hidden:!this.state.morePatientList}):m.a.createElement(L.a,{loaderFunction:this.getMorePatient,loading:this.state.loading,hidden:!this.state.morePatients})),m.a.createElement(f.a,{visible:this.state.showPatientGroupModal,footer:null,onCancel:function(){return e.togglePatientGroupEditing(!1)}},m.a.createElement(B,this.props)))):m.a.createElement(X.a,null)}}]),t}(m.a.Component),ne=I.a.create()(ae);function ie(e){return m.a.createElement(g.a,{xs:24,sm:24,md:12,lg:8,xl:8,xxl:6},m.a.createElement(j.a,{onClick:function(){return e.setCurrentPatient(e)},style:{margin:"3px",paddingBottom:"8px"}},m.a.createElement(J,{avatar:e.image?m.a.createElement(P.a,{src:Object(F.g)(e.image),size:50}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"},size:50},e.user.first_name?e.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),title:e.user.first_name,description:m.a.createElement("span",null,e.showMobile?e.user.mobile:Object(z.b)(e.user.mobile),m.a.createElement("br",null),e.showEmail?e.user.email:Object(z.a)(e.user.email),m.a.createElement("br",null),m.a.createElement("span",{className:"patientIdHighlight"},"#",e.custom_id?e.custom_id:e.id,e.gender?","+e.gender.charAt(0).toUpperCase():null))})))}function re(e){return m.a.createElement(m.a.Fragment,null,"name"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("name")(m.a.createElement(T.a,{placeholder:"patient Name",size:"small"}))):null,"phone"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("phone")(m.a.createElement(T.a,{placeholder:"Contact Number",size:"small"}))):null,"age"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key},e.form.getFieldDecorator("age")(m.a.createElement(C.a,{placeholder:"Patient Age",size:"small"}))):null,"age_gte"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key},e.form.getFieldDecorator("age_gte")(m.a.createElement(C.a,{placeholder:"Age more than",size:"small"}))):null,"age_lte"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key},e.form.getFieldDecorator("age_lte")(m.a.createElement(C.a,{placeholder:"Age Less than",size:"small"}))):null,"has_age"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,null,e.form.getFieldDecorator("has_age")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.N.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"dob"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key,label:"is"},e.form.getFieldDecorator("dob")(m.a.createElement(M.a,{placeholder:"Date of Birth",size:"small"}))):null,"dob_gte"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key},e.form.getFieldDecorator("dob_gte")(m.a.createElement(M.a,{size:"small"}))):null,"dob_lte"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key},e.form.getFieldDecorator("dob_lte")(m.a.createElement(M.a,{size:"small"}))):null,"dob_month"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key},e.form.getFieldDecorator("dob_month")(m.a.createElement(ee,{size:"small"}))):null,"has_dob"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,null,e.form.getFieldDecorator("has_dob")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.O.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"patient_id"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("patient_id")(m.a.createElement(T.a,{placeholder:"Patient Id",size:"small"}))):null,"has_aadhar"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,null,e.form.getFieldDecorator("has_aadhar")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.M.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"aadhar"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("aadhar")(m.a.createElement(T.a,{placeholder:"Aadhar Id",size:"small"}))):null,"email"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("email")(m.a.createElement(T.a,{placeholder:"Email Id",size:"small"}))):null,"has_email"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,null,e.form.getFieldDecorator("has_email")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.P.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"gender"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key,label:"is"},e.form.getFieldDecorator("gender")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.L.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"has_gender"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,null,e.form.getFieldDecorator("has_gender")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.Q.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"pincode"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("pincode")(m.a.createElement(T.a,{placeholder:"PINCODE",size:"small"}))):null,"has_pincode"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,null,e.form.getFieldDecorator("has_pincode")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.R.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"has_street"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,null,e.form.getFieldDecorator("has_street")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.S.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"street"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("street")(m.a.createElement(T.a,{placeholder:"Street Address",size:"small"}))):null,"blood_group"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,{key:e.key,label:"is"},e.form.getFieldDecorator("blood_group")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.k.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.name," ")}))))):null,"source"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,null,e.form.getFieldDecorator("source")(m.a.createElement(x.a,{style:{width:100},size:"small"},e.sourceList.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name," ")}))))):null,"agent_referal"==e.selectedOption[e.k]?m.a.createElement(I.a.Item,null,e.form.getFieldDecorator("agent_referal")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.yb.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null)}var le=a(87),ce=a(422),oe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPatientCallNotes=function(){var e=Object(o.a)(a);e.setState({callNotesLoading:!0});var t={patient:a.props.patientId};Object(F.c)(A.mc,(function(t){e.setState({callNotes:t,callNotesLoading:!1})}),(function(t){e.setState({callNotesLoading:!1})}),t)},a.state={notes:[],callNotesLoading:!1,loading:!0},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadPatientNotes(),this.loadPatientCallNotes()}},{key:"loadPatientNotes",value:function(){var e=this;e.setState({loading:!0});Object(F.c)(Object(F.f)(A.tc,[this.props.patientId,this.props.active_practiceId]),(function(t){e.setState({notes:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this,t=[{key:"name",required:!0,type:N.W}],a={successFn:function(t){Object(F.a)(N.Sb,"Patient Note Added"),e.loadPatientNotes()},errorFn:function(){},action:Object(F.f)(A.tc,[this.props.patientId,this.props.active_practiceId]),method:"post",beforeSubmit:function(e){}},n=[{key:"patient",value:this.props.patientId},{key:"practice",value:this.props.active_practiceId}],i=ce.Form.create()(R.a);return m.a.createElement("div",null,m.a.createElement(v.a,null,"Patient Notes"),m.a.createElement(i,{formProp:a,defaultValues:n,fields:t}),m.a.createElement(ce.List,{size:"small",loading:this.state.loading,dataSource:this.state.notes,renderItem:function(e){return m.a.createElement(ce.List.Item,null,m.a.createElement(ce.List.Item.Meta,{title:e.name,description:"by "+(e.staff?e.staff.user.first_name:"--")+" on "+G()(e.created_at).format("lll")}))}}),m.a.createElement(v.a,null,"Voice Call Notes"),m.a.createElement(ce.List,{size:"small",loading:this.state.callNotesLoading,dataSource:this.state.callNotes,renderItem:function(e){return m.a.createElement(ce.List.Item,null,m.a.createElement(ce.List.Item.Meta,{title:e.remarks?e.remarks:"--",description:"Created on "+G()(e.timestamp).format("lll")}))}}))}}]),t}(m.a.Component),se=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={redirect:!1,currentPatient:a.props.currentPatient,Membership:[]},a.loadMembership=a.loadMembership.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadMembership()}},{key:"loadMembership",value:function(){var e=this;e.state.currentPatient&&Object(F.c)(Object(F.f)(A.ac,[e.props.active_practiceId]),(function(t){e.setState({Membership:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this;console.log("form state",this.state);var t=[{label:"Type",key:"medical_membership",type:N.Nb,options:this.state.Membership.map((function(e){return{label:e.name,value:e.id}}))},{label:"Start Date",key:"medical_from",initilValue:G()(),type:N.K,format:"YYYY-MM-DD"}],a={successFn:function(t){Object(F.a)(N.Sb,"Medical Membership added"),e.props.loadProfile(),e.props.loadMedicalMembership(),e.props.formChange()},errorFn:function(){},action:Object(F.f)(A.jc,[this.props.patientId]),method:"post"},n=I.a.create()(R.a),i=[{key:"patient",value:this.props.patientId},{key:"practice",value:this.props.active_practiceId}];return m.a.createElement(n,{formProp:a,defaultValues:i,fields:t})}}]),t}(m.a.Component),ue=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={redirect:!1,currentPatient:a.props.currentPatient,agentRoles:[]},a.loadAgentRoles=a.loadAgentRoles.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadAgentRoles()}},{key:"loadAgentRoles",value:function(){var e=this;Object(F.c)(A.e,(function(t){e.setState({agentRoles:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this,t=[{label:"Role Type",key:"role",type:N.Nb,options:this.state.agentRoles.map((function(e){return{label:e.name,value:e.id}}))},{label:"Document Upload",key:"aadhar_upload",type:N.Pb,required:!0}],a={successFn:function(t){Object(F.a)(N.Sb,"Agent Role added"),e.props.loadProfile()},errorFn:function(){},action:Object(F.f)(A.wc,[this.props.patientId]),method:"put"},n=I.a.create()(R.a);return m.a.createElement(n,{formProp:a,defaultValues:[{key:"is_agent",value:!0}],fields:t})}}]),t}(m.a.Component),de=a(324),me=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).formChange=function(e){a.setState({add:e})},a.addAgent=function(){Object(o.a)(a).setState({agentModalVisible:!0})},a.addAgentModalClosed=function(){a.setState({agentModalVisible:!1})},a.state={patientProfile:null,currentPatient:a.props.currentPatient,medicalHistory:{},loading:!0,add:"",MedicalMembership:null,hide:!1,agentModalVisible:!1},a.loadProfile=a.loadProfile.bind(Object(o.a)(a)),a.loadMedicalMembership=a.loadMedicalMembership.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.state.currentPatient&&(this.loadProfile(!1),this.loadMedicalMembership())}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.currentPatient&&e.currentPatient!=this.state.currentPatient&&this.setState({currentPatient:e.currentPatient},(function(){t.loadProfile(!1)}))}},{key:"loadProfile",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this,a=function(a){t.setState({patientProfile:a,loading:!1}),t.props.refreshWallet&&e&&t.props.refreshWallet()},n=function(){t.setState({loading:!1})};t.state.currentPatient&&Object(F.c)(Object(F.f)(A.wc,[t.state.currentPatient.id]),a,n)}},{key:"loadMedicalMembership",value:function(){var e=this;Object(F.c)(Object(F.f)(A.jc,[e.props.currentPatient.id]),(function(t){e.setState({MedicalMembership:t[t.length-1],loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"onClickHandler",value:function(e){this.state.MedicalMembership?(Object(F.a)(N.Q,"Membership !!"),this.setState({add:!1})):this.setState({add:e})}},{key:"deleteMembership",value:function(e){var t=this,a={id:e,is_active:!1};Object(F.j)(Object(F.f)(A.Vb,[t.props.currentPatient.id]),a,(function(e){t.loadProfile(),t.loadMedicalMembership(),t.props.refreshWallet&&t.props.refreshWallet()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this;if(this.props.currentPatient){var a=this.state.patientProfile;return a?m.a.createElement(j.a,{loading:this.state.loading,title:"Patient Profile"},m.a.createElement(h.a,{gutter:16},m.a.createElement(g.a,{span:6,style:{textAlign:"center"}},a.image?m.a.createElement("img",{src:Object(F.g)(a.image),style:{width:"100%"}}):m.a.createElement(P.a,{size:200,shape:"square",style:{backgroundColor:"#87d068"}},a.user.first_name?a.user.first_name:m.a.createElement(k.a,{type:"user"})),a.is_agent&&a.is_approved?m.a.createElement(O.a,{title:"Referral Code",value:a.user.referer_code}):null,t.props.activePracticePermissions.EditPatient?m.a.createElement(le.b,{to:"/patient/"+this.state.currentPatient.id+"/profile/edit"},m.a.createElement(_.a,{type:"primary",style:{margin:10},block:!0},m.a.createElement(k.a,{type:"edit"}),"\xa0Edit Patient Profile")):null,m.a.createElement(g.a,null,m.a.createElement(v.a,null),this.state.add?m.a.createElement("div",null,m.a.createElement("h1",{style:{fontSize:"18px"}},"Medical Membership ",m.a.createElement("a",{href:"#",onClick:function(){return e.onClickHandler(!1)}},"Cancel")),m.a.createElement(se,Object.assign({},this.props,this.state,{patientId:a.id,loadMedicalMembership:t.loadMedicalMembership,formChange:t.formChange,loadProfile:t.loadProfile}))):m.a.createElement("div",{style:{padding:"0px"}},m.a.createElement("h1",{style:{fontSize:"18px",textAlign:"center"}},"Medical Membership ",m.a.createElement("a",{href:"#",onClick:function(){return e.onClickHandler(!0)}},this.state.MedicalMembership?"Renew":"Add")),this.state.MedicalMembership?m.a.createElement(j.a,{size:"small",title:"Membership",extra:m.a.createElement(E.a,{title:"Are you sure delete this Membership?",onConfirm:function(){return t.deleteMembership(e.state.MedicalMembership.id)},okText:"Yes",cancelText:"No"},m.a.createElement(_.a,{icon:"close",type:"danger",shape:"circle",size:"small"})),style:{textAlign:"center"}},m.a.createElement("div",{style:{textAlign:"left"}},m.a.createElement("p",null,m.a.createElement("strong",null,"Membership Code : "),m.a.createElement("span",null,this.state.MedicalMembership.membership_code)),m.a.createElement("p",null,m.a.createElement("strong",null,"Start Date : "),m.a.createElement("span",null,this.state.MedicalMembership.medical_from)),m.a.createElement("p",null,m.a.createElement("strong",null,"Valid Till : "),m.a.createElement("span",null,this.state.MedicalMembership.medical_to)))):null))),m.a.createElement(g.a,{span:12},m.a.createElement(pe,{label:"Patient Name",value:a.user.first_name}),m.a.createElement(pe,{label:"Patient ID",value:a.custom_id?a.custom_id:a.id}),a&&a.role?m.a.createElement(pe,{label:"Advisor Role",value:a.role_data.name}):null,m.a.createElement(pe,{label:"Gender",value:a.gender}),a.is_age?m.a.createElement(pe,{label:"Age",value:a.dob?G()().diff(this.props.currentPatient.dob,"years"):null}):m.a.createElement(pe,{label:"Date of Birth",value:a.dob}),m.a.createElement(pe,{label:"On Dialysis?",value:a.on_dialysis?"Yes":"No"}),m.a.createElement(pe,{label:"Referer",value:a.user.referer_data.referer?m.a.createElement(le.b,{to:"/patient/"+a.user.referer_data.patient+"/profile"},a.user.referer_data.referer.first_name):"--"}),m.a.createElement(v.a,null,"Contact Details"),m.a.createElement(pe,{label:"Email",value:t.props.activePracticePermissions.PatientEmailId?a.user.email:Object(z.a)(a.user.email)}),m.a.createElement(pe,{label:"Primary Mobile",value:t.props.activePracticePermissions.PatientPhoneNumber?a.user.mobile:Object(z.b)(a.user.mobile)}),m.a.createElement(pe,{label:"Secondary Mobile",value:t.props.activePracticePermissions.PatientPhoneNumber?a.secondary_mobile_no:Object(z.b)(a.secondary_mobile_no)}),m.a.createElement(pe,{label:"Landline No",value:a.landline_no}),m.a.createElement(pe,{label:"Address",value:a.address}),m.a.createElement(pe,{label:"Locality",value:a.locality}),m.a.createElement(pe,{label:"City",value:a.city_data?a.city_data.name:null}),m.a.createElement(pe,{label:"State",value:a.state_data?a.state_data.name:null}),m.a.createElement(pe,{label:"Country",value:a.country_data?a.country_data.name:null}),m.a.createElement(pe,{label:"Pincode",value:a.pincode})),m.a.createElement(g.a,{span:6,style:{borderLeft:"1 px solid #ccc"}},m.a.createElement(oe,Object.assign({},this.props,{patientId:a.id})),m.a.createElement(v.a,null,"Medical History"),a.medical_history_data?a.medical_history_data.map((function(e,t){return m.a.createElement(y.a,{color:"#"+Object(de.b)(Object(de.a)(e.name))},e.name)})):null,m.a.createElement(v.a,null,"Groups"),m.a.createElement(b.a,{dataSource:a.patient_group_data,renderItem:function(e){return m.a.createElement(b.a.Item,null,e.name)}})),m.a.createElement(f.a,{title:"Add Agent",visible:this.state.agentModalVisible,onOk:null,footer:null,onCancel:this.addAgentModalClosed},m.a.createElement(ue,Object.assign({patientId:a.id},this.state))))):m.a.createElement(j.a,{loading:this.state.loading})}return m.a.createElement(ne,this.props)}}]),t}(m.a.Component);function pe(e){return m.a.createElement(h.a,{gutter:16,style:{marginBottom:"5px"}},m.a.createElement(g.a,{span:8,style:{textAlign:"right"}},e.label,":"),m.a.createElement(g.a,{span:16},m.a.createElement("strong",null,e.value)))}a(370);var he=a(367),fe=(a(453),a(452)),be=(a(426),a(438)),ye=(a(191),a(22)),ge=a(518);function Ee(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ve(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ee(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ee(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _e=f.a.confirm,Oe=function(e){function t(e){var a,n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadMedicalHistory=function(){var e=Object(o.a)(n);Object(F.c)(Object(F.f)(A.Ub,[n.props.active_practiceId]),(function(t){e.setState({history:t})}),(function(){}))},n.setFormParams=function(e,t){n.setState(Object(w.a)({},e,t))},n.getPatientGroup=function(){var e=Object(o.a)(n);Object(F.c)(Object(F.f)(A.qc,[n.props.active_practiceId]),(function(t){e.setState({patientGroup:t,loading:!1})}),(function(){e.setState({loading:!1})}))},n.handleSubmit=function(e){var t=Object(o.a)(n);e.preventDefault(),n.props.form.validateFields((function(e,a){if(!e){var i=ve({},a,{file_enable:!!a.file_enable,file_count:a.file_count?a.file_count:n.state.file_count,on_dialysis:!!t.state.on_dialysis,medical_history:a.medical_history,patient_group:a.patient_group,user:{first_name:a.first_name?a.first_name:"",mobile:a.mobile,email:a.email}});a.anniversary&&(i.anniversary=G()(a.anniversary).format("YYYY-MM-DD")),a.dob&&(i.dob=G()(a.dob).format("YYYY-MM-DD")),a.age&&(i.is_age=!0,i.dob=G()().subtract(a.age,"years").format("YYYY-MM-DD")),a.custom_id?i.custom_id=a.custom_id_pre+a.custom_id:i.custom_id=null;var r="image";i[r]&&i[r].file&&i[r].file.response&&(i[r]=i[r].file.response.image_path),delete i.first_name,delete i.email,delete i.referer_code,delete i.mobile,delete i.age,delete i.custom_id_pre,t.setState({loading:!0});var l=function(e){Object(F.a)("Patient Saved Successfully!!"),t.setState({loading:!1}),t.props.history.replace("/patient/"+e.id+"/profile")},c=function(){t.setState({loading:!1})};i=Object(F.m)(i),t.props.currentPatient?Object(F.l)(Object(F.f)(A.wc,[t.props.currentPatient.id]),i,l,c):Object(F.j)(Object(F.f)(A.ic,[t.props.match.params.id]),i,l,c)}}))},n.toggleWebCam=function(e,t){n.setState((function(a){return{webCamState:ve({},a.webCamState,Object(w.a)({},e,t))}}))},n.getImageandUpload=function(e,t){var a=Object(o.a)(n),i=new FormData;i.append("image",t),i.append("name","file");Object(F.j)(A.tb,i,(function(t){a.props.form.setFieldsValue(Object(w.a)({},e,{file:{response:t}})),Object(F.a)(N.Sb,"Image Captured and processed."),a.setState((function(t){return{webCamState:ve({},t.webCamState,Object(w.a)({},e,!1))}}))}),(function(){}),{"content-type":"multipart/form-data"})},n.onChangeValue=function(e,t){var a=Object(o.a)(n);a.setState(Object(w.a)({},e,t),(function(){"country"==e&&a.getState(),"state"==e&&a.getCity()}))},n.setFormParams=function(e,t){n.setState(Object(w.a)({},e,t))},n.onChangeCheckbox=function(e){n.setState({on_dialysis:!n.state.on_dialysis})},n.changeFormType=function(e){n.setState({selectedFormType:e.target.value})},n.handleRelation=function(e){e?n.setState({relation_text:!1}):n.setState({relation_text:!0})},n.handleNumberChange=function(e){n.setState({number:ve({},ke(e),{value:e})})},n.state=(a={redirect:!1,history:[],patientGroup:[],membership:[],webCamState:{},countrylist:[],stateList:[],cityList:[],sourceList:[],country:n.props.currentPatient&&n.props.currentPatient.country_data?n.props.currentPatient.country:null,state:n.props.currentPatient&&n.props.currentPatient.state_data?n.props.currentPatient.state:null,selectedFormType:"DOB",file_count:10,file_enable:!0,relation_text:!0,loading:!1},Object(w.a)(a,Y.l,[]),Object(w.a)(a,Y.nb,[]),Object(w.a)(a,Y.Fb,[]),Object(w.a)(a,Y.J,[]),Object(w.a)(a,Y.K,[]),Object(w.a)(a,"number",{}),a),n.changeRedirect=n.changeRedirect.bind(Object(o.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(o.a)(n)),n.getCountry=n.getCountry.bind(Object(o.a)(n)),n.getState=n.getState.bind(Object(o.a)(n)),n.getCity=n.getCity.bind(Object(o.a)(n)),n.getSources=n.getSources.bind(Object(o.a)(n)),n.loadPatientData=n.loadPatientData.bind(Object(o.a)(n)),n}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadMedicalHistory(),this.getPatientGroup(),this.getPatientMembership(),this.getSources(),this.getCountry(),this.state.country&&this.getState(),this.state.state&&this.getCity(),this.props.currentPatient&&this.loadPatientData(this.props.currentPatient.id),Object(de.c)(this,[Y.l,Y.nb,Y.Fb,Y.J,Y.K])}},{key:"getCountry",value:function(){var e=this;Object(F.c)(A.U,(function(t){e.setState({countrylist:t})}),(function(){}))}},{key:"getSources",value:function(){var e=this;Object(F.c)(A.yd,(function(t){e.setState({sourceList:t})}),(function(){}))}},{key:"getState",value:function(){var e=this;Object(F.c)(A.Ad,(function(t){e.setState({stateList:t})}),(function(){}),{country:this.state.country})}},{key:"getCity",value:function(){var e=this;Object(F.c)(A.Q,(function(t){e.setState({cityList:t})}),(function(){}),{state:this.state.state})}},{key:"getPatientMembership",value:function(){var e=this;Object(F.c)(Object(F.f)(A.ac,[this.props.active_practiceId]),(function(t){e.setState({membership:t})}),(function(){}))}},{key:"loadPatientData",value:function(e){var t=this;Object(F.c)(Object(F.f)(A.wc,[e]),(function(e){t.setState({patientDetails:e,loading:!1})}),(function(){t.setState({loading:!1})}))}},{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"onDeletePatient",value:function(){var e=this;_e({title:"Are you sure delete this patient?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){e.patientDelete()}})}},{key:"patientDelete",value:function(){var e=this,t=e.state.patientDetails.id,a={id:t,is_active:!1};Object(F.l)(Object(F.f)(A.wc,[t]),a,(function(t){e.setState({loading:!1}),Object(F.a)("Patient Deleted!!"),e.props.history.push("/patients/profile")}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=this.props.form.getFieldDecorator,n={labelCol:{span:6},wrapperCol:{span:14}},i=[];this.state.history&&this.state.history.forEach((function(e){i.push({label:e.name,value:e.id})}));var r=[];this.state.patientGroup&&this.state.patientGroup.forEach((function(e){r.push({label:e.name,value:e.id})}));var l=[];this.state.membership&&this.state.membership.forEach((function(e){l.push({label:e.name,value:e.id})}));var c={name:"image",data:{name:"hello"},action:Object(F.h)(A.sb),headers:{authorization:"authorization-text"},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?ye.a.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&ye.a.error("".concat(e.file.name," file upload failed."))}};return m.a.createElement(I.a,{onSubmit:t.handleSubmit},m.a.createElement(j.a,{title:m.a.createElement("span",null,t.props.currentPatient?"Edit Profile":"Add Patient","\xa0\xa0",m.a.createElement(le.b,{to:"/patients/patientprintform"},"Print Patient Form")),extra:m.a.createElement("div",null,m.a.createElement(_.a,{style:{margin:5},type:"primary",htmlType:"submit"},"Save"),t.props.history?m.a.createElement(_.a,{style:{margin:5},onClick:function(){return t.props.history.goBack()}},"Cancel"):null,t.props.currentPatient?m.a.createElement(m.a.Fragment,null,this.state.patientDetails&&this.state.patientDetails.is_approved?m.a.createElement(be.a,{placement:"leftBottom",trigger:"hover",content:"An Agent is associated. Patient can not be deleted."},m.a.createElement(_.a,{style:{margin:5},type:"danger",disabled:!0},"Delete")):m.a.createElement(_.a,{style:{margin:5},onClick:function(){return t.onDeletePatient()},type:"danger",disabled:!this.state.patientDetails},"Delete")):null)},m.a.createElement(I.a.Item,Object.assign({key:"image"},n,{label:"Patient Image"}),a("image",{valuePropName:"image"})(m.a.createElement(fe.a,c,m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"upload"})," Select File"),this.state.patientDetails&&this.state.patientDetails.image?m.a.createElement("img",{src:Object(F.g)(this.state.patientDetails?this.state.patientDetails.image:null),style:{maxWidth:"100%"}}):null)),m.a.createElement("span",{className:"ant-form-text"},m.a.createElement("a",{onClick:function(){return t.toggleWebCam("image",Math.random())}},"Open Webcam")),m.a.createElement(f.a,{footer:null,onCancel:function(){return t.toggleWebCam("image",!1)},visible:!!t.state.webCamState.image,width:680,key:t.state.webCamState.image},m.a.createElement(ge.a,{getScreenShot:function(e){return t.getImageandUpload("image",e)}}))),m.a.createElement(I.a.Item,Object.assign({label:"Patient Name"},n),a("first_name",{rules:[{required:!0,message:"Input Patient Name!"}],initialValue:this.state.patientDetails?this.state.patientDetails.user.first_name:""})(m.a.createElement(T.a,{placeholder:"Patient Name"}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:8},m.a.createElement(I.a.Item,{label:"Patient Id",labelCol:{span:18},wrapperCol:{span:6}},a("custom_id_pre",{initialValue:this.state.patientDetails&&this.state.patientDetails.is_agent?"AD":"BK"})(m.a.createElement(x.a,null,m.a.createElement(x.a.Option,{value:"BK"},"BK"),m.a.createElement(x.a.Option,{value:"AD"},"AD"))))),m.a.createElement(g.a,{span:16},m.a.createElement(I.a.Item,{labelCol:{span:0},wrapperCol:{span:18},validateStatus:this.state.number.validateStatus,help:this.state.number.errorMsg||"Only numbers are allowed."},a("custom_id",{initialValue:this.state.patientDetails?this.state.patientDetails.custom_id.replace(/\D/g,""):""})(m.a.createElement(C.a,{style:{width:"100%"},placeholder:"Patient Id",onChange:this.handleNumberChange}))))),this.state.source&&this.state.source==N.W?m.a.createElement(I.a.Item,Object.assign({key:"source_extra",label:"Source"},n),a("source_extra",{initialValue:""})(m.a.createElement(T.a,{placeholder:"Source"})),m.a.createElement("a",{onClick:function(){return t.setFormParams("source",N.Nb)}},"Choose Source")):m.a.createElement(I.a.Item,Object.assign({label:"Source"},n),a("source",{initialValue:this.state.patientDetails?this.state.patientDetails.source:null})(m.a.createElement(x.a,{placeholder:"Select Source",showSearch:!0,optionFilterProp:"children"},this.state.sourceList.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)})))),this.props.user.is_superuser?m.a.createElement("a",{onClick:function(){return t.setFormParams("source",N.W)}},"Enter New Source"):null),m.a.createElement(I.a.Item,Object.assign({label:"Referral Code"},n),a("referal",{initialValue:t.state.patientDetails&&t.state.patientDetails.user.referer_data.referer?t.state.patientDetails.user.referer_data.referer.referer_code:""})(m.a.createElement(T.a,{placeholder:"Referral Code"}))),m.a.createElement(I.a.Item,Object.assign({label:"SMS Language"},n),a("language",{initialValue:this.state.patientDetails&&this.state.patientDetails.language?this.state.patientDetails.language:this.props.activePracticeData.language})(m.a.createElement(x.a,null,this.state[Y.Fb].map((function(e){return m.a.createElement(x.a.Option,{value:e},e)}))))),m.a.createElement(I.a.Item,Object.assign({label:"Aadhar ID"},n),a("aadhar_id",{initialValue:this.state.patientDetails?this.state.patientDetails.aadhar_id:""})(m.a.createElement(T.a,{placeholder:"Patient Aadhar Number"}))),m.a.createElement(I.a.Item,Object.assign({label:"Gender"},n),a("gender",{initialValue:this.state.patientDetails?this.state.patientDetails.gender:null})(m.a.createElement(x.a,{placeholder:"Select Gender"},this.state[Y.K].map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))),m.a.createElement(I.a.Item,Object.assign({label:" "},n,{colon:!1}),m.a.createElement(S.a.Group,{buttonStyle:"solid",size:"small",onChange:this.changeFormType,defaultValue:this.state.selectedFormType},Y.lb.map((function(e){return m.a.createElement(S.a,{value:e.value},e.label)})))),"DOB"==this.state.selectedFormType?m.a.createElement(I.a.Item,Object.assign({label:"DOB"},n),a("dob",{initialValue:this.state.patientDetails&&this.state.patientDetails.dob?G()(this.state.patientDetails.dob):""})(m.a.createElement(M.a,null))):m.a.createElement(I.a.Item,Object.assign({label:"Age"},n),a("age",{initialValue:this.state.patientDetails&&this.state.patientDetails.dob?G()().diff(this.state.patientDetails.dob,"years"):null})(m.a.createElement(C.a,{min:0,max:120,placeholder:"00"})),m.a.createElement("span",{className:"ant-form-text"},"Years")),m.a.createElement(I.a.Item,Object.assign({label:"Anniversary"},n),a("anniversary",{initialValue:this.state.patientDetails&&this.state.patientDetails.anniversary?G()(this.state.patientDetails.anniversary):null})(m.a.createElement(M.a,null))),m.a.createElement(I.a.Item,Object.assign({label:"Blood Group"},n),a("blood_group",{initialValue:this.state.patientDetails?this.state.patientDetails.blood_group:""})(m.a.createElement(x.a,{placeholder:"Blood Group"},this.state[Y.l].map((function(e){return m.a.createElement(x.a.Option,{value:e},e)}))))),m.a.createElement(I.a.Item,Object.assign({label:"Family"},n),m.a.createElement(I.a.Item,{style:{display:"inline-block",width:"calc(30% - 12px)"}},a("family_relation",{initialValue:this.state.patientDetails&&null!=this.state.patientDetails.family_relation?this.state.patientDetails.family_relation:N.Gb})(m.a.createElement(x.a,{onChange:function(t){return e.handleRelation(t)}},m.a.createElement(x.a.Option,{value:""},N.Gb),this.state[Y.J].map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.name)}))))),m.a.createElement("span",{style:{display:"inline-block",width:"14px",textAlign:"center"}}),m.a.createElement(I.a.Item,{style:{display:"inline-block",width:"calc(50% - 12px)"}},a("attendee",{initialValue:this.state.patientDetails?this.state.patientDetails.attendee:""})(m.a.createElement(T.a,{disabled:(!this.state.patientDetails||!this.state.patientDetails.attendee)&&this.state.relation_text})))),m.a.createElement(I.a.Item,Object.assign({label:"Mobile (Primary)"},n),a("mobile",{initialValue:this.state.patientDetails?this.state.patientDetails.user.mobile:null,rules:[{required:!0,message:"Input Mobile Number"}]})(m.a.createElement(T.a,{placeholder:"Patient Mobile Number (Primary)"}))),m.a.createElement(I.a.Item,Object.assign({label:"Mobile (Secondary)"},n),a("secondary_mobile_no",{initialValue:this.state.patientDetails?this.state.patientDetails.secondary_mobile_no:""})(m.a.createElement(T.a,{placeholder:"Patient Mobile Number (Secondary)"}))),m.a.createElement(I.a.Item,Object.assign({label:"Landline"},n),a("landline_no",{initialValue:this.state.patientDetails?this.state.patientDetails.landline_no:""})(m.a.createElement(T.a,{placeholder:"Patient Landline Number"}))),m.a.createElement(I.a.Item,Object.assign({label:"Address"},n),a("address",{initialValue:this.state.patientDetails?this.state.patientDetails.address:""})(m.a.createElement(T.a,{placeholder:"Patient Address"}))),m.a.createElement(I.a.Item,Object.assign({label:"Locality"},n),a("locality",{initialValue:this.state.patientDetails?this.state.patientDetails.locality:""})(m.a.createElement(T.a,{placeholder:"Patient Locality"}))),this.state.country&&this.state.country==N.W?m.a.createElement(I.a.Item,Object.assign({key:"country_extra",label:"Country"},n),a("country_extra",{initialValue:""})(m.a.createElement(T.a,{placeholder:"Country"})),this.props.user.is_superuser?m.a.createElement("a",{onClick:function(){return t.setFormParams("country",N.Nb)}},"Choose Country"):null):m.a.createElement(I.a.Item,Object.assign({key:"country"},n,{label:"Country"}),a("country",{initialValue:this.state.patientDetails&&this.state.patientDetails.country_data?this.state.patientDetails.country_data.id:""})(m.a.createElement(x.a,{placeholder:"Select Country",onChange:function(t){return e.onChangeValue("country",t)},showSearch:!0,optionFilterProp:"children"},this.state.countrylist.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)})))),this.props.user.is_superuser?m.a.createElement("a",{onClick:function(){return t.setFormParams("country",N.W)}},"Add New Country"):null),this.state.country==N.W||this.state.state&&this.state.state==N.W?m.a.createElement(I.a.Item,Object.assign({key:"state_extra",label:"State"},n),a("state_extra",{initialValue:""})(m.a.createElement(T.a,{placeholder:"State"})),m.a.createElement("a",{onClick:function(){return t.setFormParams("state",N.Nb)}},"Choose State")):m.a.createElement(I.a.Item,Object.assign({key:"state"},n,{label:"State"}),a("state",{initialValue:this.state.patientDetails&&this.state.patientDetails.state_data?this.state.patientDetails.state_data.id:""})(m.a.createElement(x.a,{placeholder:"Select State",onChange:function(t){return e.onChangeValue("state",t)},showSearch:!0,optionFilterProp:"children"},this.state.stateList.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)})))),this.props.user.is_superuser?m.a.createElement("a",{onClick:function(){return t.setFormParams("state",N.W)}},"Add New state"):null),this.state.country==N.W||this.state.state==N.W||this.state.city&&this.state.city==N.W?m.a.createElement(I.a.Item,Object.assign({key:"city_extra",label:"City"},n),a("city_extra",{initialValue:""})(m.a.createElement(T.a,{placeholder:"City"})),m.a.createElement("a",{onClick:function(){return t.setFormParams("city",N.Nb)}},"Choose City")):m.a.createElement(I.a.Item,Object.assign({key:"City"},n,{label:"City"}),a("city",{initialValue:this.state.patientDetails&&this.state.patientDetails.city_data?this.state.patientDetails.city_data.id:""})(m.a.createElement(x.a,{showSearch:!0,optionFilterProp:"children",placeholder:"Select City"},this.state.cityList.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)})))),this.props.user.is_superuser?m.a.createElement("a",{onClick:function(){return t.setFormParams("city",N.W)}},"Add New City"):null),m.a.createElement(I.a.Item,Object.assign({label:"Pincode"},n),a("pincode",{initialValue:this.state.patientDetails?this.state.patientDetails.pincode:""})(m.a.createElement(T.a,{placeholder:"Patient PINCODE"}))),m.a.createElement(I.a.Item,Object.assign({label:"Email"},n),a("email",{initialValue:this.state.patientDetails?this.state.patientDetails.user.email:null})(m.a.createElement(T.a,{placeholder:"Patient Email"}))),m.a.createElement(I.a.Item,Object.assign({label:"Medical History"},n),a("medical_history",{initialValue:this.state.patientDetails?this.state.patientDetails.medical_history:[]})(m.a.createElement(x.a,{placeholder:"Medical History",mode:"multiple"},i.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))),m.a.createElement(I.a.Item,Object.assign({label:"Patient Group"},n),a("patient_group",{initialValue:this.state.patientDetails?this.state.patientDetails.patient_group:[]})(m.a.createElement(x.a,{placeholder:"Patient Group",mode:"multiple"},r.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))),m.a.createElement(I.a.Item,Object.assign({label:"On Dialysis"},n),a("on_dialysis",{initialValue:!!this.state.patientDetails&&this.state.patientDetails.on_dialysis})(m.a.createElement(he.a,{onChange:function(t){return e.onChangeCheckbox(t)},style:{paddingTop:"4px"}}))),m.a.createElement(I.a.Item,Object.assign({label:"Allow File Upload"},n),a("file_enable",{initialValue:!this.state.patientDetails||this.state.patientDetails.file_enable})(m.a.createElement(he.a,{style:{paddingTop:"4px"},defaultChecked:!0}))),m.a.createElement(I.a.Item,Object.assign({label:"Max Uploads Allowed"},n),a("file_count",{initialValue:this.state.patientDetails?this.state.patientDetails.file_count:10})(m.a.createElement(C.a,{min:0}))),m.a.createElement(I.a.Item,null,t.props.history?m.a.createElement(_.a,{style:{margin:5},onClick:function(){return t.props.history.goBack()}},"Cancel"):null,m.a.createElement(_.a,{style:{margin:5},type:"primary",htmlType:"submit",loading:this.state.loading},"Save"))))}}]),t}(m.a.Component),Pe=I.a.create()(Oe);function ke(e){return isNaN(e)?{validateStatus:"error",errorMsg:"Patient ID can only be numerical value."}:{validateStatus:"success",errorMsg:null}}a(337);var je=a(338),Ce=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={redirect:!1,appointments:null,practice_doctors:[],procedure_category:null,treatmentNotes:null,practice_staff:[],loading:!1},a.changeRedirect=a.changeRedirect.bind(Object(o.a)(a)),a.editAppointment=a.editAppointment.bind(Object(o.a)(a)),a.deleteAppointment=a.deleteAppointment.bind(Object(o.a)(a)),a.loadProcedureCategory=a.loadProcedureCategory.bind(Object(o.a)(a)),a.loadDoctors=a.loadDoctors.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadDoctors(),this.loadTreatmentNotes(),this.props.match.params.appointmentid?this.loadAppointment(this.props.match.params.appointmentid):this.loadAllAppointments()}},{key:"loadAppointment",value:function(e){var t=this;this.setState({loading:!0});Object(F.c)(Object(F.f)(A.o,[e]),(function(e){t.setState({appointments:[e],loading:!1})}),(function(){t.setState({loading:!1})}))}},{key:"loadAllAppointments",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;this.setState({loading:!0});var a=function(e){1==e.current?t.setState({appointments:e.results,total:e.count,loadMoreAppointment:e.next,loading:!1}):t.setState((function(t){return{total:e.count,appointments:[].concat(Object(D.a)(t.appointments),Object(D.a)(e.results)),loading:!1,loadMoreAppointment:e.next}}))},n=function(){t.setState({loading:!1})},i={practice:this.props.active_practiceId,pagination:!0,page:e};this.props.match.params.id&&(i.patient=this.props.match.params.id),Object(F.c)(A.h,a,n,i)}},{key:"loadProcedureCategory",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),(function(t){e.setState({procedure_category:t})}),(function(){}))}},{key:"loadDoctors",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Dc,[this.props.active_practiceId]),(function(t){t.staff.forEach((function(t){if(t.role==N.N){var a=e.state.practice_doctors;a.push(t),e.setState({practice_doctors:a})}else{var n=e.state.practice_staff;n.push(t),e.setState({practice_staff:n})}}))}),(function(){}))}},{key:"loadTreatmentNotes",value:function(){var e=this;Object(F.c)(Object(F.f)(A.kb,[this.props.active_practiceId]),(function(t){e.setState({treatmentNotes:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"editAppointment",value:function(e){var t=e.id;this.props.history.push("/calendar/"+t+"/edit-appointment")}},{key:"deleteAppointment",value:function(e){var t=this;t.setState({loading:!0});Object(F.l)(Object(F.f)(A.o,[e.id]),{is_active:!1,status:"Cancelled"},(function(e){t.loadAllAppointments(),t.setState({loading:!1})}),(function(){t.setState({loading:!1})}))}},{key:"render",value:function(){var e=this,t=this,a=[];this.state.practice_doctors.length&&this.state.practice_doctors.forEach((function(e){a[e.id]=e.user.first_name}));var n=[];this.state.treatmentNotes&&this.state.treatmentNotes.forEach((function(e){n[e.id]=e.name}));var i=[{title:"Schedule Time",key:"name",render:function(e,t){return m.a.createElement("span",null,G()(t.schedule_at).format("LLL"),",",t.slot,"mins")}},{title:"Patient ID",key:"id",render:function(e,t){return m.a.createElement("span",null,t.patient.custom_id?t.patient.custom_id:t.patient.id)},exports:function(e,t){return t.patient.custom_id?t.patient.custom_id:t.patient.id}},{title:"Patient Name",dataIndex:"patient.user.first_name",key:"patient_name"},{title:"Patient Mobile",dataIndex:"patient.user.mobile",key:"patient_mobile",render:function(e){return t.props.activePracticePermissions.PatientPhoneNumber?e:Object(z.b)(e)}},{title:"Email",dataIndex:"patient.user.email",key:"email",render:function(e){return t.props.activePracticePermissions.PatientEmailId?e:Object(z.a)(e)}},{title:"Doctor",key:"doctor",render:function(e,t){return m.a.createElement("span",null," ",a[t.doctor])}},{title:"Procedure",key:"procedure"},{title:"Treatment Notes",key:"notes",render:function(e,t){return m.a.createElement("span",null," ",n[t.notes])}},{title:"Category",key:"category",render:function(e,t){return m.a.createElement("span",null," ",t.category?t.category_data.name:"--")}},{title:"NotifyByEmail",key:"notify_via_email",render:function(e,t){return m.a.createElement(he.a,{disabled:!0,checked:t.notify_via_email})}},{title:"NotifyBySMS",key:"notify_via_sms",render:function(e,t){return m.a.createElement(he.a,{disabled:!0,checked:t.notify_via_sms})}},{title:"Action",key:"action",render:function(a,n){return m.a.createElement("span",null,m.a.createElement("a",{onClick:function(){return e.editAppointment(n)},disabled:!t.props.activePracticePermissions.EditAppointment},"Edit"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement(E.a,{title:"Are you sure delete this item?",onConfirm:function(){return e.deleteAppointment(n)},okText:"Yes",cancelText:"No"},m.a.createElement("a",{disabled:!t.props.activePracticePermissions.EditAppointment},"Delete")))}}];I.a.create()(R.a);return this.props.match.params.id?m.a.createElement(j.a,{extra:t.props.activePracticePermissions.AddAppointment||t.props.allowAllPermissions?m.a.createElement(le.b,{to:"/calendar/create-appointment?patient="+this.props.match.params.id},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"\xa0Add Appointment")):null},m.a.createElement(je.a,{loading:this.state.loading,columns:i,scroll:{x:1300},pagination:!1,dataSource:this.state.appointments}),m.a.createElement(L.a,{loaderFunction:function(){return e.loadAllAppointments(e.state.loadMoreAppointment)},loading:this.state.loading,hidden:!this.state.loadMoreAppointment})):m.a.createElement(j.a,{extra:t.props.activePracticePermissions.AddAppointment||t.props.allowAllPermissions?m.a.createElement(le.b,{to:"/calendar/create-appointment"},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"\xa0Add Appointment")):null},m.a.createElement(je.a,{loading:this.state.loading,columns:i,scroll:{x:1300},pagination:!1,dataSource:this.state.appointments}),m.a.createElement(L.a,{loaderFunction:function(){return e.loadAllAppointments(e.state.loadMoreAppointment)},loading:this.state.loading,hidden:!this.state.loadMoreAppointment}))}}]),t}(m.a.Component),Se=(a(378),a(374)),Ie=a(974),xe=u.a.Sider,De=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},a.onHotKeyInner=a.onHotKeyInner.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"onHotKeyInner",value:function(e){switch(e){case"alt+f":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/profile"):this.props.history.push("/patients/profile");case"alt+a":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/appointments"):this.props.history.push("/patients/appointments");case"alt+o":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/communications"):this.props.history.push("/patients/communications");case"alt+k":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/booking"):this.props.history.push("/patients/profile");case"alt+m":case"alt+n":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/emr/vitalsigns"):this.props.history.push("/patients/emr/vitalsigns");case"alt+t":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/emr/plans"):this.props.history.push("/patients/emr/plans");case"alt+l":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/emr/files"):this.props.history.push("/patients/emr/files");case"alt+i":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/billing/invoices"):this.props.history.push("/patients/billing/invoices");case"alt+e":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/billing/return/invoices"):this.props.history.push("/patients/billing/return/invoices");case"alt+y":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/billing/payments"):this.props.history.push("/patients/billing/payments");case"alt+u":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/emr/workdone"):this.props.history.push("/patients/emr/workdone");case"alt+s":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/emr/prescriptions"):this.props.history.push("/patients/emr/prescriptions");case"alt+g":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/billing/ledger"):this.props.history.push("/patients/profile");case"alt+w":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/emr/timeline"):this.props.history.push("/patients/profile")}}},{key:"render",value:function(){var e=this;return m.a.createElement(Ie.a,{keyName:Y.W,onKeyDown:function(t){return e.onHotKeyInner(t)}},m.a.createElement(xe,{trigger:null,collapsible:!0,collapsed:this.props.hideSidePanel,style:{overflow:"auto",minHeight:"calc(100vh - 64px)",background:"#fff"}},m.a.createElement(Se.a,{mode:"inline"},m.a.createElement(Se.a.ItemGroup,{key:"g1",title:m.a.createElement(v.a,{style:{margin:"0px"}},"Patient")},m.a.createElement(Se.a.Item,{key:"17"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/profile":"/patients/profile"},m.a.createElement(k.a,{type:"user"}),m.a.createElement("span",{className:"nav-text"},"Pro",m.a.createElement("span",{className:"shortcutLetterHighlight"},"f"),"ile"))),this.props.activePracticePermissions.PatientAppointments||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"18"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/appointments":"/patients/appointments"},m.a.createElement(k.a,{type:"calendar"}),m.a.createElement("span",{className:"nav-text"},m.a.createElement("span",{className:"shortcutLetterHighlight"},"A"),"ppointments"))):null,this.props.activePracticePermissions.PatientCommunications||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"19"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/communications":"/patients/communications"},m.a.createElement(k.a,{type:"message"}),m.a.createElement("span",{className:"nav-text"},"C",m.a.createElement("span",{className:"shortcutLetterHighlight"},"o"),"mmunications"))):null,this.props.activePracticePermissions.PatientBookings||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"booking",disabled:!this.props.currentPatient},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/booking":"/patients/communications"},m.a.createElement(k.a,{type:"book"}),m.a.createElement("span",{className:"nav-text"},"Boo",m.a.createElement("span",{className:"shortcutLetterHighlight"},"k"),"ing"))):null),m.a.createElement(Se.a.ItemGroup,{key:"g2",title:m.a.createElement(v.a,{style:{margin:"0px"}},"EMR")},this.props.activePracticePermissions.PatientVitalSigns||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"20"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/vitalsigns":"/patients/emr/vitalsigns"},m.a.createElement(k.a,{type:"heart"}),m.a.createElement("span",{className:"nav-text"},"Report ",m.a.createElement("span",{className:"shortcutLetterHighlight"},"M"),"anual"))):null,this.props.activePracticePermissions.PatientClinicalNotes||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"21"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/clinicnotes":"/patients/emr/clinicnotes"},m.a.createElement(k.a,{type:"solution"}),m.a.createElement("span",{className:"nav-text"},"Clinical ",m.a.createElement("span",{className:"shortcutLetterHighlight"},"N"),"otes"))):null,this.props.activePracticePermissions.PatientTreatmentPlans||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"30"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/plans":"/patients/emr/plans"},m.a.createElement(k.a,{type:"read"}),m.a.createElement("span",{className:"nav-text"},m.a.createElement("span",{className:"shortcutLetterHighlight"},"T"),"reatment Plans"))):null,this.props.activePracticePermissions.PatientCompletedProcedure||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"22"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/workdone":"/patients/emr/workdone"},m.a.createElement(k.a,{type:"check-circle"}),m.a.createElement("span",{className:"nav-text"},"Completed Proced",m.a.createElement("span",{className:"shortcutLetterHighlight"},"u"),"re"))):null,this.props.activePracticePermissions.PatientFiles||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"23"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/files":"/patients/emr/files"},m.a.createElement(k.a,{type:"picture"}),m.a.createElement("span",{className:"nav-text"},"Fi",m.a.createElement("span",{className:"shortcutLetterHighlight"},"l"),"es"))):null,this.props.activePracticePermissions.PatientPrescriptions||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"24"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/prescriptions":"/patients/emr/prescriptions"},m.a.createElement(k.a,{type:"solution"}),m.a.createElement("span",{className:"nav-text"},"Pre",m.a.createElement("span",{className:"shortcutLetterHighlight"},"s"),"criptions"))):null,this.props.activePracticePermissions.PatientTimeline||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"25",disabled:!this.props.currentPatient},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/timeline":"/patients/profile"},m.a.createElement(k.a,{type:"clock-circle"}),m.a.createElement("span",{className:"nav-text"},"Timeline ",m.a.createElement("span",{className:"shortcutLetterHighlight"},"w")))):null,this.props.activePracticePermissions.PatientLabOrders||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"26",disabled:!this.props.currentPatient||!0},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/labtrackings":"/patients/profile"},m.a.createElement(k.a,{type:"solution"}),m.a.createElement("span",{className:"nav-text"},"Lab Orders"))):null),m.a.createElement(Se.a.ItemGroup,{key:"g3",title:m.a.createElement(v.a,{style:{margin:"0px"}},"Billing")},this.props.activePracticePermissions.PatientInvoices||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"27"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/billing/invoices":"/patients/billing/invoices"},m.a.createElement(k.a,{type:"audit"}),m.a.createElement("span",{className:"nav-text"},m.a.createElement("span",{className:"shortcutLetterHighlight"},"I"),"nvoices"))):null,this.props.activePracticePermissions.PatientReturns||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"31"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/billing/return/invoices":"/patients/billing/return/invoices"},m.a.createElement(k.a,{type:"redo"}),m.a.createElement("span",{className:"nav-text"},"Invoices R",m.a.createElement("span",{className:"shortcutLetterHighlight"},"e"),"turn"))):null,this.props.activePracticePermissions.PatientPayments||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"28"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/billing/payments":"/patients/billing/payments"},m.a.createElement(k.a,{type:"dollar"}),m.a.createElement("span",{className:"nav-text"},"Pa",m.a.createElement("span",{className:"shortcutLetterHighlight"},"y"),"ments"))):null,this.props.activePracticePermissions.PatientLedger||this.props.allowAllPermissions?m.a.createElement(Se.a.Item,{key:"29",disabled:!this.props.currentPatient},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/billing/ledger":"/patients/profile"},m.a.createElement(k.a,{type:"book"}),m.a.createElement("span",{className:"nav-text"},"Led",m.a.createElement("span",{className:"shortcutLetterHighlight"},"g"),"er"))):null,this.props.currentPatient&&this.props.currentPatient.is_agent&&(this.props.activePracticePermissions.PatientLedger||this.props.allowAllPermissions)?m.a.createElement(Se.a.Item,{key:"32",disabled:!this.props.currentPatient},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/billing/wallet":"/patients/profile"},m.a.createElement(k.a,{type:"wallet"}),m.a.createElement("span",{className:"nav-text"},"Wallet Ledger"))):null))))}}]),t}(m.a.Component),we=(a(400),a(390)),Me=(a(31),a(1785),a(2)),Te=a.n(Me),Fe=a(25),Ae=a(11);function Le(){return(Le=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Ve(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ne=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},Re=function(e){return d.createElement(Ae.a,null,(function(t){var a,n,i=t.getPrefixCls,r=e.prefixCls,l=e.className,c=e.color,o=void 0===c?"":c,s=e.children,u=e.pending,m=e.dot,p=Ne(e,["prefixCls","className","color","children","pending","dot"]),h=i("timeline",r),f=Te()((Ve(a={},"".concat(h,"-item"),!0),Ve(a,"".concat(h,"-item-pending"),u),a),l),b=Te()((Ve(n={},"".concat(h,"-item-head"),!0),Ve(n,"".concat(h,"-item-head-custom"),m),Ve(n,"".concat(h,"-item-head-").concat(o),!0),n));return d.createElement("li",Le({},Object(Fe.default)(p,["position"]),{className:f}),d.createElement("div",{className:"".concat(h,"-item-tail")}),d.createElement("div",{className:b,style:{borderColor:/blue|red|green|gray/.test(o)?void 0:o}},m),d.createElement("div",{className:"".concat(h,"-item-content")},s))}))};Re.defaultProps={color:"blue",pending:!1,position:""};var Be=Re;function ze(e){return(ze="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ye(){return(Ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function qe(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ge(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function We(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function He(e,t){return!t||"object"!==ze(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ke(e,t){return(Ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xe=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},Qe=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=He(this,Ue(t).apply(this,arguments))).renderTimeline=function(t){var a,n=t.getPrefixCls,i=e.props,r=i.prefixCls,l=i.pending,c=void 0===l?null:l,o=i.pendingDot,s=i.children,u=i.className,m=i.reverse,p=i.mode,h=Xe(i,["prefixCls","pending","pendingDot","children","className","reverse","mode"]),f=n("timeline",r),b="boolean"===typeof c?null:c,y=Te()(f,(Ge(a={},"".concat(f,"-pending"),!!c),Ge(a,"".concat(f,"-reverse"),!!m),Ge(a,"".concat(f,"-").concat(p),!!p),a),u),g=c?d.createElement(Be,{pending:!!c,dot:o||d.createElement(k.a,{type:"loading"})},b):null,E=m?[g].concat(qe(d.Children.toArray(s).reverse())):[].concat(qe(d.Children.toArray(s)),[g]),v=function(e,t){return"alternate"===p?"right"===e.props.position?"".concat(f,"-item-right"):"left"===e.props.position?"".concat(f,"-item-left"):"".concat(f,t%2===0?"-item-left":"-item-right"):"left"===p?"".concat(f,"-item-left"):"right"===p?"".concat(f,"-item-right"):"right"===e.props.position?"".concat(f,"-item-right"):""},_=E.filter((function(e){return!!e})),O=d.Children.count(_),P="".concat(f,"-item-last"),j=d.Children.map(_,(function(e,t){var a=t===O-2?P:"",n=t===O-1?P:"";return d.cloneElement(e,{className:Te()([e.props.className,!m&&c?a:n,v(e,t)])})}));return d.createElement("ul",Ye({},h,{className:y}),j)},e}var a,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ke(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){return d.createElement(Ae.a,null,this.renderTimeline)}}])&&We(a.prototype,n),i&&We(a,i),t}(d.Component);Qe.Item=Be,Qe.defaultProps={reverse:!1,mode:""};var Ze=Qe,Je=(a(188),a(129)),$e=(a(1786),a(1)),et=a(981);function tt(e){return(tt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(){return(at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function nt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function it(e,t){return!t||"object"!==tt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rt(e){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e,t){return(lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ct=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=it(this,rt(t).apply(this,arguments))).renderSteps=function(t){var a=t.getPrefixCls,n=a("steps",e.props.prefixCls),i=a("",e.props.iconPrefix),r={finish:d.createElement(k.a,{type:"check",className:"".concat(n,"-finish-icon")}),error:d.createElement(k.a,{type:"close",className:"".concat(n,"-error-icon")})};return d.createElement(et.default,at({icons:r},e.props,{prefixCls:n,iconPrefix:i}))},e}var a,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lt(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){return d.createElement(Ae.a,null,this.renderSteps)}}])&&nt(a.prototype,n),i&&nt(a,i),t}(d.Component);ct.Step=et.default.Step,ct.defaultProps={current:0},ct.propTypes={prefixCls:$e.string,iconPrefix:$e.string,current:$e.number};var ot=a(68),st=a(369);function ut(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function dt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ut(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ut(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}ct.Step;var mt=[{label:m.a.createElement("span",{style:{width:"100%"}},"Appointment"),value:"appointments"},{label:m.a.createElement("span",{style:{width:"100%"}},"Report Manual"),value:"vital_signs"},{label:m.a.createElement("span",{style:{width:"100%"}},"Clinic Notes"),value:"clinic_notes"},{label:m.a.createElement("span",{style:{width:"100%"}},"Treatment Plans"),value:"treatment_plans"},{label:m.a.createElement("span",{style:{width:"100%"}},"Procedures"),value:"procedures"},{label:m.a.createElement("span",{style:{width:"100%"}},"Files"),value:"files"},{label:m.a.createElement("span",{style:{width:"100%"}},"Prescriptions"),value:"prescriptions"},{label:m.a.createElement("span",{style:{width:"100%"}},"Invoices"),value:"invoices"},{label:m.a.createElement("span",{style:{width:"100%"}},"Payments"),value:"payments"}],pt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).changeFilters=function(e){var t=Object(o.a)(a);a.setState({filterParams:e,selectedFiltersIntermediate:!!e.length&&e.length<mt.length,checkAllFilters:e.length===mt.length},(function(){t.loadTimeline()}))},a.onCheckAllFiltersChange=function(e){var t=Object(o.a)(a);a.setState({filterParams:e.target.checked?mt.map((function(e){return e.value})):[],selectedFiltersIntermediate:!1,checkAllFilters:e.target.checked},(function(){t.loadTimeline()}))},a.loadTimeline=function(){var e=Object(o.a)(a),t={practice_id:a.props.active_practiceId};e.setState({loading:!0}),a.state.filterParams.forEach((function(e){t[e]=1}));a.props.showAllClinic&&a.props.match.params.id&&delete t.practice_id,Object(F.c)(Object(F.f)(A.xc,[a.props.match.params.id]),(function(t){var a=G()().add(5,"year");e.setState((function(){var e=[],n={};return t.forEach((function(t){a.format("YMD")!=G()(t.sort_date).format("YMD")&&(a=G()(t.sort_date),e.push({type:"Time",date:t.sort_date})),e.push(t),"Appointments"!=t.type&&(n[t.type]?n[t.type][t.id]=!0:n[t.type]=Object(w.a)({},t.id,!0))})),{timelineData:e,loading:!1,allCheckList:n}}))}),(function(){e.setState({loading:!1})}),t)},a.onCheckAllTimelineCard=function(e){a.setState((function(t){return{checkedTimelineCards:e.target.checked?dt({},t.allCheckList):{},indeterminate:!1,checkAll:e.target.checked}}))},a.toggleTimelineCheckbox=function(e,t,n){a.setState((function(a){var i={},r=a.checkedTimelineCards;if(r[e]?r[e][t]=!!n:r[e]=Object(w.a)({},t,!!n),n){if(i.indeterminate=!0,Object.keys(a.allCheckList).length==Object.keys(r).length){for(var l=Object.keys(a.allCheckList),c=!1,o=0;o<l.length;o++)if(Object.keys(a.allCheckList[l[o]]).length!=Object.keys(r[l[o]]).length){c=!0,i.checkAll=!1;break}c||(i.indeterminate=!1,i.checkAll=!0)}}else i.checkAll=!1,i.indeterminate=!0,delete r[e][t],Object.keys(r[e]).length||(delete r[e],Object.keys(r).length||(i.indeterminate=!1));return i.checkedTimelineCards=r,i}))},a.printCaseSheet=function(){var e=Object(o.a)(a),t=Object(F.o)("Starting print case sheet..."),n={practice:e.props.active_practiceId,timeline:[]};Object.keys(a.state.checkedTimelineCards).forEach((function(t){n.timeline.push({type:t,id:Object.keys(e.state.checkedTimelineCards[t])})}));Object(F.j)(Object(F.f)(A.yc,[a.props.match.params.id]),n,(function(e){Object(F.p)(t,N.Sb,"Fetched report successfully!!"),window.open(ot.a+e.report)}),(function(){Object(F.p)(t,N.Q,"Case sheet printing failed!!")}))},a.updateFormValue=function(e,t){a.setState(Object(w.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendCaseSheet=function(){a.mailModalOpen(),a.setState({mail_to:st.get(a.props.currentPatient,"user.email")})},a.sendMailToPatient=function(){var e=Object(o.a)(a),t={mail_to:a.state.mail_to,practice:e.props.active_practiceId,timeline:[]};Object.keys(a.state.checkedTimelineCards).forEach((function(a){t.timeline.push({type:a,id:Object.keys(e.state.checkedTimelineCards[a])})}));Object(F.j)(Object(F.f)(A.yc,[a.props.match.params.id]),t,(function(e){}),(function(e){})),a.mailModalClose()},a.state={filterParams:["appointments","vital_signs","clinic_notes","treatment_plans","procedures","files","prescriptions","invoices","payments"],checkAllFilters:!0,selectedFiltersIntermediate:!1,timelineData:[],checkedTimelineCards:[]},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadTimeline()}},{key:"render",value:function(){var e=this,t=this;this.state.timelineData;return m.a.createElement(j.a,{title:"Timeline",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{onClick:function(){return e.sendCaseSheet(e.state.timelineData)}},m.a.createElement(k.a,{type:"mail"})," Case Sheet"),m.a.createElement(_.a,{type:"primary",onClick:function(){return e.printCaseSheet()}},"Print Case Sheet"))},m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,null,m.a.createElement(g.a,{span:4},m.a.createElement(he.a,{indeterminate:this.state.selectedFiltersIntermediate,onChange:this.onCheckAllFiltersChange,checked:this.state.checkAllFilters},m.a.createElement("b",null,"Select all")),m.a.createElement("br",null),m.a.createElement(he.a.Group,{size:"large",value:this.state.filterParams,options:mt,onChange:this.changeFilters})),m.a.createElement(g.a,{span:20},m.a.createElement(Je.a,{top:10},m.a.createElement("h4",{style:{textAlign:"right",padding:"5px",backgroundImage:"linear-gradient(to left, white , transparent)"}},m.a.createElement(he.a,{indeterminate:this.state.indeterminate,onChange:this.onCheckAllTimelineCard,checked:this.state.checkAll},"Select All"))),m.a.createElement(Ze,{progressDot:!0,current:1,direction:"vertical"},this.state.timelineData.map((function(e){return m.a.createElement(Ze.Item,{dot:"Time"==e.type?m.a.createElement(k.a,{type:"clock-circle-o",style:{fontSize:"25px"}}):null},function(e){switch(e.type){case"Clinical Notes":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"solution"})," Clinical Note Added",m.a.createElement(he.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null),e.chief_complaints?m.a.createElement("p",null,"Chief Complaints",m.a.createElement("ul",null,e.chief_complaints.split(Y.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null,e.observations?m.a.createElement("p",null,"Observations",m.a.createElement("ul",null,e.observations.split(Y.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null,e.investigations?m.a.createElement("p",null,"Investigations",m.a.createElement("ul",null,e.investigations.split(Y.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null,e.diagnosis?m.a.createElement("p",null,"Diagnosis",m.a.createElement("ul",null,e.diagnosis.split(Y.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null,e.notes?m.a.createElement("p",null,"Notes",m.a.createElement("ul",null,e.notes.split(Y.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null)}(e);case"Appointments":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"calendar"})," Appointment",e.practice_data?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),e.doctor_data?m.a.createElement("p",{style:{borderLeft:"5px solid "+e.doctor_data.calendar_colour,paddingLeft:"5px"}},e.doctor_data.user.first_name):null,G()(e.schedule_at).format("hh:mm A")," to ",G()(e.schedule_at).add(e.slot,"mins").format("HH:mm A"))}(e);case"Files":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"picture"})," File",m.a.createElement(he.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice_data?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),m.a.createElement("img",{src:Object(F.g)(e.file_type),alt:"",style:{height:100}}))}(e);case"Invoices":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"audit"})," Invoice",m.a.createElement(he.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice_data?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),e.procedure.map((function(e){return m.a.createElement(y.a,null,e.name)})),e.inventory.map((function(e){return m.a.createElement(y.a,null,e.name)})),m.a.createElement("br",null),m.a.createElement("b",null,e.invoice_id),m.a.createElement("br",null),m.a.createElement("b",null,"Invoice Amount: INR ",e.total),m.a.createElement("br",null),m.a.createElement("b",null,"Paid Amount: INR ",e.payments_data),m.a.createElement("br",null),m.a.createElement("b",null,"Due Amount: INR ",e.total-e.payments_data))}(e);case"Vital Signs":return function(e){var t=[{title:"Time",dataIndex:"created_at",key:"name",render:function(e){return m.a.createElement("span",null,G()(e).format("hh:mm A"))}},{title:"Temp(F)",key:"temperature",render:function(e,t){return m.a.createElement("span",null," ",t.temperature,m.a.createElement("br",null),",",t.temperature_part)}},{title:"Pulse (BPM)",dataIndex:"pulse",key:"pulse"},{title:"RR breaths/min",dataIndex:"resp_rate",key:"resp_rate"},{title:"SYS/DIA mmhg",key:"address",render:function(e,t){return m.a.createElement(m.a.Fragment,null,t.blood_pressure_up?m.a.createElement("span",null," ",t.blood_pressure_up,"/",t.blood_pressure_down,m.a.createElement("br",null),",",t.position):null)}},{title:"WEIGHT kg",dataIndex:"weight",key:"weight"},{title:"Creatinine Level",key:"creatinine",dataIndex:"creatinine"},{title:"Haemoglobin Level",key:"haemoglobin",dataIndex:"haemoglobin"},{title:"Urea Level",key:"urea",dataIndex:"urea"},{title:"Uric Acid Level",key:"uric_acid",dataIndex:"uric_acid"}];return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"heart"})," Report Manual Recorded",m.a.createElement(he.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice_data?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),e.doctor_data?m.a.createElement("p",{style:{borderLeft:"5px solid "+e.doctor_data.calendar_colour,paddingLeft:"5px"}},e.doctor_data.user.first_name):null,m.a.createElement(je.a,{columns:t,size:"small",pagination:!1,dataSource:[e]}))}(e);case"Prescriptions":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"solution"})," Prescription Added",m.a.createElement(he.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null),e.doctor?m.a.createElement("p",{style:{borderLeft:"5px solid "+e.doctor.calendar_colour,paddingLeft:"5px"}},e.doctor.user.first_name):null,e.drugs.map((function(e){return m.a.createElement(y.a,null,e.name)})))}(e);case"Payments":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(k.a,{type:"dollar"})," Payment",m.a.createElement(he.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice_data?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),m.a.createElement("b",null,e.payment_id),m.a.createElement("br",null),m.a.createElement("b",null,"Amount Paid: INR ",e.total))}(e);case"Time":return function(e){return m.a.createElement("span",null,m.a.createElement(Je.a,{top:20,offsetTop:30},m.a.createElement("h2",{style:{marginLeft:"10px",padding:"5px",backgroundImage:"linear-gradient(to right, #ddd , white)",borderRadius:"4px"}},G()(e.date).format("LL"))))}(e);case"Procedures":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,"Procedure Performed",m.a.createElement(he.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null),e.doctor?m.a.createElement("p",{style:{borderLeft:"5px solid "+e.doctor.calendar_colour,paddingLeft:"5px"}},e.doctor.user.first_name):null,e.treatment_plans.map((function(e){return m.a.createElement(y.a,null,e.procedure.name)})))}(e);case"Treatment Plans":return function(e){return m.a.createElement(j.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,"Treatment Plan ",m.a.createElement(he.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null),e.doctor?m.a.createElement("p",{style:{borderLeft:"5px solid "+e.doctor.calendar_colour,paddingLeft:"5px"}},e.doctor.user.first_name):null,e.treatment_plans.map((function(e){return m.a.createElement(y.a,null,e.procedure.name)})))}(e);default:return e.type}}(dt({},e,{checkedTimelineCards:t.state.checkedTimelineCards,toggleTimelineCheckbox:t.toggleTimelineCheckbox})))}))),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Timeline To ",st.get(this.props.currentPatient,"user.first_name")," ?"),m.a.createElement(T.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}}))))))}}]),t}(m.a.Component);a(381);var ht=a(380),ft=a(810),bt=a.n(ft);var yt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){!function(e,t){if(!document.head.querySelector("#"+e)){var a=document.createElement("style");a.textContent=t,a.type="text/css",a.id=e,document.head.appendChild(a)}}(this.props.name,this.props.css)},t.prototype.componentWillUnmount=function(){var e=document.getElementById(this.props.name);e.parentNode.removeChild(e)},t.prototype.render=function(){return null},t}(d.Component),gt=function(e){var t=e.imageBackgroundColor;return"\n  body {\n    overflow: hidden;\n  }\n\n  .__react_modal_image__modal_container {\n    position: fixed;\n    z-index: 1000;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.8);\n    touch-action: none;\n    overflow: hidden;\n  }\n\n  .__react_modal_image__modal_content {\n    position: relative;\n    height: 100%;\n    width: 100%;\n  }\n\n  .__react_modal_image__modal_content img, \n  .__react_modal_image__modal_content svg {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate3d(-50%, -50%, 0);\n    -webkit-transform: translate3d(-50%, -50%, 0);\n    -ms-transform: translate3d(-50%, -50%, 0);\n    overflow: hidden;\n  }\n\n  .__react_modal_image__medium_img {\n    max-width: 98%;\n    max-height: 98%;\n    background-color: "+t+";\n  }\n\n  .__react_modal_image__large_img {\n    cursor: move;\n    background-color: "+t+"\n  }\n\n  .__react_modal_image__icon_menu a {\n    display: inline-block;\n    font-size: 40px;\n    cursor: pointer;\n    line-height: 40px;\n    box-sizing: border-box;\n    border: none;\n    padding: 0px 5px 0px 5px;\n    margin-left: 10px;\n    color: white;\n    background-color: rgba(0, 0, 0, 0);\n  }\n\n  .__react_modal_image__icon_menu {\n    display: inline-block;\n    float: right;\n  }\n\n  .__react_modal_image__caption {\n    display: inline-block;\n    color: white;\n    font-size: 120%;\n    padding: 10px;\n    margin: 0;\n  }\n\n  .__react_modal_image__header {\n    position: absolute;\n    top: 0;\n    width: 100%;\n    background-color: rgba(0, 0, 0, 0.7);\n    overflow: hidden;\n  }\n"},Et=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),m.a.createElement("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"}))},vt=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),m.a.createElement("path",{d:"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"}))},_t=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),m.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))},Ot=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),m.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))},Pt=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"48",viewBox:"0 0 24 24",width:"48",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5l-4-4V4h8v3.5l-4 4z"}),m.a.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}))},kt=function(){return m.a.createElement("svg",{fill:"#ffffff",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0zm0 0h24v24H0V0z"}),m.a.createElement("path",{d:"M7.47 21.49C4.2 19.93 1.86 16.76 1.5 13H0c.51 6.16 5.66 11 11.95 11 .23 0 .44-.02.66-.03L8.8 20.15l-1.33 1.34zM12.05 0c-.23 0-.44.02-.66.04l3.81 3.81 1.33-1.33C19.8 4.07 22.14 7.24 22.5 11H24c-.51-6.16-5.66-11-11.95-11zM16 14h2V8c0-1.11-.9-2-2-2h-6v2h6v6zm-8 2V4H6v2H4v2h2v8c0 1.1.89 2 2 2h8v2h2v-2h2v-2H8z"}))},jt=function(e){var t=e.image,a=e.alt,n=e.zoomed,i=e.toggleZoom,r=e.toggleRotate,l=e.onClose,c=e.enableDownload,o=e.enableZoom,s=e.enableRotate;return m.a.createElement("div",{className:"__react_modal_image__header"},m.a.createElement("span",{className:"__react_modal_image__icon_menu"},c&&m.a.createElement("a",{href:t,download:!0},m.a.createElement(_t,null)),o&&m.a.createElement("a",{onClick:i},n?m.a.createElement(vt,null):m.a.createElement(Et,null)),s&&m.a.createElement("a",{onClick:r},m.a.createElement(kt,null)),m.a.createElement("a",{onClick:l},m.a.createElement(Ot,null))),a&&m.a.createElement("span",{className:"__react_modal_image__caption"},a))};function Ct(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var St=function(e){function t(){var a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),l=0;l<i;l++)r[l]=arguments[l];return a=n=Ct(this,e.call.apply(e,[this].concat(r))),n.state={loading:!0},n.handleOnLoad=function(){n.setState({loading:!1})},n.handleOnContextMenu=function(e){!n.props.contextMenu&&e.preventDefault()},Ct(n,a)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=e.id,a=e.className,n=e.src,i=e.style,r=e.handleDoubleClick;return m.a.createElement("div",null,this.state.loading&&m.a.createElement(Pt,null),m.a.createElement("img",{id:t,className:a,src:n,style:i,onLoad:this.handleOnLoad,onDoubleClick:r,onContextMenu:this.handleOnContextMenu}))},t}(d.Component);function It(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var xt=function(e){function t(){var a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),l=0;l<i;l++)r[l]=arguments[l];return a=n=It(this,e.call.apply(e,[this].concat(r))),n.state={move:{x:0,y:0},moveStart:void 0,zoomed:!1,rotationDeg:0},n.handleKeyDown=function(e){27!==e.keyCode&&13!==e.keyCode||n.props.onClose()},n.getCoordinatesIfOverImg=function(e){var t=e.changedTouches?e.changedTouches[0]:e;if("react-modal-image-img"===t.target.id){var a=n.contentEl.getBoundingClientRect();return{x:t.clientX-a.left,y:t.clientY-a.top}}},n.handleMouseDownOrTouchStart=function(e){if(e.preventDefault(),!(e.touches&&e.touches.length>1)){var t=n.getCoordinatesIfOverImg(e);t||n.props.onClose(),n.state.zoomed&&n.setState((function(e){return{moveStart:{x:t.x-e.move.x,y:t.y-e.move.y}}}))}},n.handleMouseMoveOrTouchMove=function(e){if(e.preventDefault(),n.state.zoomed&&n.state.moveStart&&!(e.touches&&e.touches.length>1)){var t=n.getCoordinatesIfOverImg(e);t&&n.setState((function(e){return{move:{x:t.x-e.moveStart.x,y:t.y-e.moveStart.y}}}))}},n.handleMouseUpOrTouchEnd=function(e){n.setState({moveStart:void 0})},n.toggleZoom=function(e){e.preventDefault(),n.setState((function(e){return{zoomed:!e.zoomed,move:e.zoomed?{x:0,y:0}:e.move}}))},n.toggleRotate=function(e){e.preventDefault(),360!==n.state.rotationDeg?n.setState((function(e){return{rotationDeg:e.rotationDeg+=90}})):n.setState({rotationDeg:90})},It(n,a)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){document.addEventListener("keydown",this.handleKeyDown,!1)},t.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this.handleKeyDown,!1)},t.prototype.render=function(){var e=this,t=this.props,a=t.medium,n=t.large,i=t.alt,r=t.onClose,l=t.hideDownload,c=t.hideZoom,o=t.showRotate,s=t.imageBackgroundColor,u=void 0===s?"black":s,d=this.state,p=d.move,h=d.zoomed,f=d.rotationDeg;return m.a.createElement("div",null,m.a.createElement(yt,{name:"__react_modal_image__lightbox",css:gt({imageBackgroundColor:u})}),m.a.createElement("div",{className:"__react_modal_image__modal_container"},m.a.createElement("div",{className:"__react_modal_image__modal_content",onMouseDown:this.handleMouseDownOrTouchStart,onMouseUp:this.handleMouseUpOrTouchEnd,onMouseMove:this.handleMouseMoveOrTouchMove,onTouchStart:this.handleMouseDownOrTouchStart,onTouchEnd:this.handleMouseUpOrTouchEnd,onTouchMove:this.handleMouseMoveOrTouchMove,ref:function(t){e.contentEl=t}},h&&m.a.createElement(St,{id:"react-modal-image-img",className:"__react_modal_image__large_img",src:n||a,style:{transform:"translate3d(-50%, -50%, 0) translate3d("+p.x+"px, "+p.y+"px, 0) rotate("+f+"deg)",WebkitTransform:"translate3d(-50%, -50%, 0) translate3d("+p.x+"px, "+p.y+"px, 0) rotate("+f+"deg)",MsTransform:"translate3d(-50%, -50%, 0) translate3d("+p.x+"px, "+p.y+"px, 0) rotate("+f+"deg)"},handleDoubleClick:this.toggleZoom}),!h&&m.a.createElement(St,{id:"react-modal-image-img",className:"__react_modal_image__medium_img",src:a||n,handleDoubleClick:this.toggleZoom,contextMenu:!a,style:{transform:"translate3d(-50%, -50%, 0) rotate("+f+"deg)",WebkitTransform:"translate3d(-50%, -50%, 0) rotate("+f+"deg)",MsTransform:"translate3d(-50%, -50%, 0) rotate("+f+"deg)"}})),m.a.createElement(jt,{image:n||a,alt:i,zoomed:h,toggleZoom:this.toggleZoom,toggleRotate:this.toggleRotate,onClose:r,enableDownload:!l,enableZoom:!c,enableRotate:!!o})))},t}(d.Component);function Dt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var wt=function(e){function t(){var a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),l=0;l<i;l++)r[l]=arguments[l];return a=n=Dt(this,e.call.apply(e,[this].concat(r))),n.state={modalOpen:!1},n.toggleModal=function(){n.setState((function(e){return{modalOpen:!e.modalOpen}}))},Dt(n,a)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=e.className,a=e.small,n=e.smallSrcSet,i=e.medium,r=e.large,l=e.alt,c=e.hideDownload,o=e.hideZoom,s=e.showRotate,u=e.imageBackgroundColor,d=this.state.modalOpen;return m.a.createElement("div",null,m.a.createElement("img",{className:t,style:{cursor:"pointer",maxWidth:"100%",maxHeight:"100%"},onClick:this.toggleModal,src:a,srcSet:n,alt:l}),d&&m.a.createElement(xt,{medium:i,large:r,alt:l,onClose:this.toggleModal,hideDownload:c,hideZoom:o,showRotate:s,imageBackgroundColor:u}))},t}(d.Component);function Mt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Tt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Mt(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Mt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Ft=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadMailedFiles=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(o.a)(a),n=function(e){t.setState((function(t){return 1==e.current?{files:Object(D.a)(e.results),total:e.count,loadMoreFiles:e.next,loading:!1}:{files:[].concat(Object(D.a)(t.files),Object(D.a)(e.results)),loadMoreFiles:e.next,loading:!1}}))},i=function(){},r={mailed:!0,page:e,practice:a.props.active_practiceId};a.props.currentPatient&&(r.patient=a.props.currentPatient.id),a.props.showAllClinic&&a.props.currentPatient&&delete r.practice,Object(F.c)(A.sc,n,i,r)},a.filterTags=function(e){var t=Object(o.a)(a);a.setState({filterSearchTag:e.target.value},(function(){t.loadData()}))},a.showModal=function(e){a.setState((function(){return{visible:!0,filesData:Tt({},e)}}))},a.handleCancel=function(){a.setState({visible:!1})},a.togglePDFModal=function(e){a.setState({showPDFFile:e})},a.updateFormValue=function(e,t){a.setState(Object(w.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendFiles=function(){a.mailModalOpen(),a.setState({mail_to:st.get(a.props.currentPatient,"user.email")})},a.handleVisibleChange=function(){console.log("sdad"),a.setState({visibleTag:!a.state.visibleTag})},a.state={files:[],tags:[],showAddModal:!1,loading:!0,selectedFiles:{},selectedTags:{},filterSearchTag:null,showAddMedicalModel:!1,medicalCertificate:[],visible:!1,filesData:{},mailedfiles:[],visibleTag:!1},a.loadData=a.loadData.bind(Object(o.a)(a)),a.loadMedicalCertificate=a.loadMedicalCertificate.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentWillMount",value:function(){this.loadData(),this.loadTags(),this.loadMedicalCertificate()}},{key:"loadData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;this.setState({loading:!0});var a=function(e){t.setState((function(t){var a=null;if(1==e.current)return{files:e.results.map((function(e){return G()(e.created_at).format("YYYYMMDD")!=G()(a).format("YYYYMMDD")?(a=G()(e.created_at),Tt({},e,{newDate:!0})):Tt({},e,{newDate:!1})})),total:e.count,loadMoreFiles:e.next,loading:!1};var n=e.results.map((function(e){return G()(e.created_at).format("YYYYMMDD")!=G()(a).format("YYYYMMDD")?(a=G()(e.created_at),Tt({},e,{newDate:!0})):Tt({},e,{newDate:!1})}));return{files:[].concat(Object(D.a)(t.files),Object(D.a)(n)),loadMoreFiles:e.next,loading:!1}}))},n=function(){t.setState({loading:!1})},i={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(i.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete i.practice,this.state.filterSearchTag?i.tag=this.state.filterSearchTag:""==this.state.filterSearchTag&&(i.notag=!0),Object(F.c)(A.pc,a,n,i)}},{key:"loadTags",value:function(){var e=this;Object(F.c)(Object(F.f)(A.fb,[this.props.active_practiceId]),(function(t){e.setState({tags:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"loadMedicalCertificate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;t.setState({loading:!0});var a=function(e){1==e.current?t.setState({total:e.count,medicalCertificate:e.results,loading:!1,loadMoreCertificate:e.next}):t.setState((function(t){return{total:e.count,medicalCertificate:[].concat(Object(D.a)(t.medicalCertificate),Object(D.a)(e.results)),loading:!1,loadMoreCertificate:e.next}}))},n=function(){t.setState({loading:!1})};this.props.currentPatient&&Object(F.c)(Object(F.f)(A.Sb,[this.props.active_practiceId,this.props.currentPatient.id,e]),a,n),this.props.showAllClinic&&this.props.currentPatient?Object(F.c)(Object(F.f)(A.i,[this.props.currentPatient.id,e]),a,n):Object(F.c)(Object(F.f)(A.i,[this.props.active_practiceId,e]),a,n)}},{key:"triggerAddModal",value:function(e){this.setState({showAddModal:!!e})}},{key:"triggerAddMedicalCertificateModal",value:function(e){this.setState({showAddMedicalModel:!!e})}},{key:"filesCompleteToggle",value:function(e,t){this.setState((function(a){var n=Tt({},a.selectedFiles);return t?n[e]=!!t:delete n[e],{selectedFiles:Tt({},n)}}))}},{key:"tagsCompleteToggle",value:function(e,t){this.setState((function(a){var n=Tt({},a.selectedTags);return t?n[e]=!!t:delete n[e],{selectedTags:Tt({},n)}}))}},{key:"filesWithTags",value:function(){var e=this,t={id:Object.keys(this.state.selectedFiles),file_tags:Object.keys(this.state.selectedTags),patient:this.props.match.params.id};Object(F.j)(Object(F.f)(A.pc,[this.props.match.params.id]),t,(function(){e.setState({selectedFiles:{},visibleTag:!1}),e.loadData()}),(function(){}))}},{key:"deleteMedicalCertificate",value:function(e){var t=this,a={is_active:!1,patient:e.patient,id:e.id};Object(F.j)(Object(F.f)(A.Sb,[t.props.active_practiceId]),a,(function(e){t.loadData(),t.loadMedicalCertificate()}),(function(){}))}},{key:"deleteFile",value:function(e){var t=this,a={id:e.id,patient:e.patient,is_active:!1};Object(F.j)(Object(F.f)(A.pc,[this.props.match.params.id]),a,(function(e){t.setState({showPDFFile:!1}),t.loadData()}),(function(){Object(F.a)(N.Q,"Please Select Patient.")}))}},{key:"loadPDF",value:function(e){Object(F.c)(Object(F.f)(A.Tb,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=ce.Form.create()(R.a),n=[{key:"file_type",label:"File",type:N.Pb,required:!0},{key:"file_tags",label:"Tags",type:N.mb,options:this.state.tags.map((function(e){return{label:e.name,value:e.id}}))}],i={method:"post",successFn:function(){t.triggerAddModal(!1),t.loadData()},errorFn:function(){},action:Object(F.f)(A.pc,[this.props.match.params.id])},r=m.a.createElement("div",{style:{boxShadow:"0 2px 4px #111",border:"1px solid #bbb",borderRadius:2,paddingBottom:"30px",backgroundColor:"white"}},m.a.createElement("ul",{style:{listStyle:"none",paddingInlineStart:0,paddingTop:10}},this.state.tags?m.a.createElement("div",null,this.state.tags.map((function(e){return m.a.createElement("li",{key:e.id},m.a.createElement(he.a,{value:e.id,onChange:function(a){return t.tagsCompleteToggle(e.id,a.target.checked)},checked:t.state.selectedTags[e.id]},e.name," "))}))):null),m.a.createElement("span",null,m.a.createElement(_.a,{type:"primary",onClick:function(){return e.filesWithTags()},style:{float:"right",borderStyle:"none"}},"Done"))),l=[{key:"is_active",value:!0},{key:"patient",value:this.props.currentPatient?this.props.currentPatient.id:null},{key:"practice",value:this.props.active_practiceId}];return m.a.createElement(j.a,{title:"Files",extra:this.props.match.params.id?m.a.createElement(_.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/create-medicalCertificate"},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"\xa0Add Medical Certificate")," "),m.a.createElement(ht.a,{overlay:r,trigger:["click"],placement:"bottomLeft",onVisibleChange:t.handleVisibleChange,visible:t.state.visibleTag},m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"plus"}),"Add/Remove File Tags")),m.a.createElement(_.a,{onClick:function(){return e.triggerAddModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"),m.a.createElement(_.a,{style:{marginRight:"10px"},onClick:function(){return t.sendFiles()}},m.a.createElement(k.a,{type:"mail"})," \xa0 Send to patient")):m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{type:"primary",style:{marginRight:"10px"},onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"\xa0 Add Medical Certificate"),m.a.createElement(ht.a,{overlay:r,trigger:["click"],placement:"bottomLeft",onVisibleChange:t.handleVisibleChange,visible:t.state.visibleTag},m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"plus"}),"Add/Remove File Tags")),m.a.createElement(_.a,{type:"primary",style:{marginRight:"10px"},onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"})," \xa0 Add"))},m.a.createElement(h.a,{gutter:8},m.a.createElement(g.a,{span:6,style:{height:"calc(100vh - 55px)",overflow:"auto",paddingRight:"10px",borderRight:"1px solid #ccc"}},m.a.createElement(S.a.Group,{buttonStyle:"solid",defaultValue:"all",onChange:this.filterTags},m.a.createElement("h2",null,"Uploaded Files"),m.a.createElement(S.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:null},"All Files"),this.state.tags.map((function(e){return m.a.createElement(S.a.Button,{key:e.id,style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:e.id},e.name)})),m.a.createElement(S.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:""},"Untagged Files"),m.a.createElement("p",null,m.a.createElement("br",null))),m.a.createElement(S.a.Group,{buttonStyle:"solid",defaultValue:""},m.a.createElement("h2",null,"Generated Files"),m.a.createElement(S.a.Button,{key:"0",style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:"a",onClick:function(){return e.loadMailedFiles()}},"Emailed Files"),m.a.createElement(S.a.Button,{key:"1",style:{width:"100%",backgroundColor:"transparent",border:"0px"},onClick:function(){return e.loadMedicalCertificate()}},"Medical Leave Certificate "))),m.a.createElement(g.a,{span:18},m.a.createElement(h.a,null,this.state.files.map((function(a){return m.a.createElement(m.a.Fragment,null,a.newDate?m.a.createElement(g.a,{span:24},m.a.createElement(Je.a,{top:20,offsetTop:30},m.a.createElement("h2",{style:{marginLeft:"10px",padding:"5px",backgroundImage:"linear-gradient(to right, #ddd , white)",borderRadius:"4px"}},G()(a.created_at).format("LL")))):null,m.a.createElement(g.a,{span:8},m.a.createElement("div",{style:{width:"100%",height:"150px",border:"1px solid #bbb",backgroundSize:"cover",padding:"auto",overflow:"hidden"}},m.a.createElement(he.a,{key:a.id,disabled:a.practice!=e.props.active_practiceId,style:{margin:10,position:"absolute",top:5,left:5,boxShadow:"0 0px 5px #000 "},onChange:function(e){return t.filesCompleteToggle(a.id,e.target.checked)},checked:t.state.selectedFiles[a.id]}),Object(F.b)(a.file_type)==Y.sb?m.a.createElement("div",{style:{textAlign:"center",paddingTop:30,height:"100%"},onClick:function(){return e.togglePDFModal(a)}},m.a.createElement(k.a,{type:"file-pdf",style:{fontSize:"56px",color:"#08c"}}),m.a.createElement("h4",null,"Preview Not Avaialable")):m.a.createElement(wt,{style:{border:"3px solid red"},large:Object(F.g)(a.file_type),small:Object(F.g)(a.file_type),alt:m.a.createElement(_.a,{type:"danger",onClick:function(){return e.deleteFile(a)}},m.a.createElement(k.a,{type:"delete"}))})),m.a.createElement(j.a,{bodyStyle:{padding:3},style:{marginBottom:15}},m.a.createElement(le.b,{to:"/patient/"+a.patient_data.id+"/emr/files/"},m.a.createElement("h4",null,m.a.createElement("b",null,a.patient_data.user.first_name,"\xa0(",a.patient_data.custom_id,")"))),m.a.createElement(y.a,null,m.a.createElement("b",null,a.practice_data?a.practice_data.name:"--")))))}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:24},m.a.createElement(L.a,{loaderFunction:function(){return e.loadData(t.state.loadMoreFiles)},loading:this.state.loading,hidden:!this.state.loadMoreFiles}))),m.a.createElement(j.a,{title:"Medical Certificate"},m.a.createElement(b.a,{loading:this.state.loading,grid:{gutter:16,column:3},dataSource:this.state.medicalCertificate,renderItem:function(t){return m.a.createElement(j.a,{style:{width:600},actions:[m.a.createElement("p",null,"Issued on : "+t.date),m.a.createElement("a",{onClick:function(){return e.loadPDF(t.id)}},m.a.createElement(k.a,{type:"printer"})),m.a.createElement(E.a,{title:"Are you sure delete this item?",onConfirm:function(){return e.deleteMedicalCertificate(t)},okText:"Yes",cancelText:"No"},m.a.createElement(k.a,{type:"delete"}))]},m.a.createElement(bt.a,{title:"Medical Leave #"+t.id,description:"Excused From :"+t.excused_duty_from+" till "+t.excused_duty_to}))}}),m.a.createElement(L.a,{loaderFunction:function(){return e.loadData(t.state.loadMoreCertificate)},loading:this.state.loading,hidden:!this.state.loadMoreCertificate})))),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Timeline To ",st.get(this.props.currentPatient,"user.first_name")," ?"),m.a.createElement(T.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),m.a.createElement(f.a,{visible:this.state.showAddModal,onCancel:function(){return e.triggerAddModal(!1)},footer:null},m.a.createElement(a,{title:"Add Files",fields:n,defaultValues:l,formProp:i})),m.a.createElement(f.a,{visible:this.state.showPDFFile,key:this.state.showPDFFile,centered:!0,width:1e3,onCancel:function(){return e.togglePDFModal(!1)},footer:null,style:{padding:0},title:m.a.createElement("h4",null,m.a.createElement("span",{style:{color:"red",textAlign:"right"},onClick:function(){return e.deleteFile(e.state.showPDFFile)}},"DELETE"))},this.state.showPDFFile?m.a.createElement("iframe",{src:Object(F.g)(this.state.showPDFFile.file_type),frameborder:"0",style:{width:"100%",minHeight:"80vh"}}):null))}}]),t}(m.a.Component),At=(m.a.Component,a(186),a(90));function Lt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Vt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Lt(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Lt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Nt=At.a.TabPane,Rt=["Complaints","Observations","Diagnoses","Investigations","Notes","Recent Medication"],Bt={Complaints:A.db,Observations:A.ib,Diagnoses:A.eb,Investigations:A.gb,Notes:A.kb,"Recent Medication":A.hb},zt=0,Yt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).setInitialData=function(){var e=Object(o.a)(a),t=a.state.editClinicNotes;t.chief_complaints&&t.chief_complaints.split(Y.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Complaints",t)}),500)})),t.investigations&&t.investigations.split(Y.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Investigations",t)}),500)})),t.diagnosis&&t.diagnosis.split(Y.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Diagnoses",t)}),500)})),t.notes&&t.notes.split(Y.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Notes",t)}),500)})),t.observations&&t.observations.split(Y.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Observations",t)}),500)})),t.medication&&t.medication.split(Y.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Recent Medication",t)}),500)}))},a.loadRequiredResources=function(e,t){var n=Object(o.a)(a);Object(F.c)(e,(function(e){n.setState((function(a){var n=Vt({},a.resourceList,Object(w.a)({},t,e));return{resourceList:n,filteredResourceList:n,filterStrings:{}}}))}),(function(){console.log(t+" fetching error")}))},a.add=function(e){var t=a.props.form,n=t.getFieldValue(e).concat(++zt);t.setFieldsValue(Object(w.a)({},e,n))},a.remove=function(e,t){var n=a.props.form,i=n.getFieldValue(e);1!==i.length&&n.setFieldsValue(Object(w.a)({},e,i.filter((function(e){return e!==t}))))},a.addValues=function(e,t){var n,i=a.props.form,r=i.getFieldValue(e),l=r.concat(++zt);i.setFieldsValue((n={},Object(w.a)(n,e,l),Object(w.a)(n,"field[".concat(r[r.length-1],"]"),t),n))},a.changeValues=function(e,t){var n=a.props.form.getFieldValue(e);n.indexOf(t)==n.length-1&&a.add(e)},a.toggleModal=function(e){var t=null,n=Object(o.a)(a);a.setState((function(a){return console.log(a.resourceAddModal),a.resourceAddModal&&(t=a.resourceAddModal),{resourceAddModal:e}}),(function(){t&&n.loadRequiredResources(Object(F.f)(Bt[t],[n.props.active_practiceId]),t)}))},a.searchValues=function(e,t){var n=Object(o.a)(a);a.setState((function(a){var n=Vt({},a.searchStrings);return n[e]=t,{searchStrings:n}}),(function(){n.filterValues(e)}))},a.filterValues=function(e){a.setState((function(t){var a=[];return t.resourceList[e]&&(t.searchStrings[e]?t.resourceList[e].forEach((function(n){n.name&&n.name.toString().toLowerCase().includes(t.searchStrings[e].toLowerCase())&&a.push(n)})):a=t.resourceList[e]),{filteredResourceList:Vt({},t.filteredResourceList,Object(w.a)({},e,a))}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFieldsAndScroll((function(e,n){if(!e){var i={};i.chief_complaints=n.Complaints.map((function(e){return n.field[e]})).join(Y.r),i.investigations=n.Investigations.map((function(e){return n.field[e]})).join(Y.r),i.diagnosis=n.Diagnoses.map((function(e){return n.field[e]})).join(Y.r),i.notes=n.Notes.map((function(e){return n.field[e]})).join(Y.r),i.observations=n.Observations.map((function(e){return n.field[e]})).join(Y.r),i.medication=n["Recent Medication"].map((function(e){return n.field[e]})).join(Y.r),i.patient=t.props.match.params.id,i.practice=t.props.active_practiceId,i.doctor=t.state.selectedDoctor&&t.state.selectedDoctor.id?t.state.selectedDoctor.id:t.state.selectedDoctor,i.date=t.state.selectedDate&&G()(t.state.selectedDate).isValid()?G()(t.state.selectedDate).format("YYYY-MM-DD"):null,t.state.editClinicNotes&&(i.id=t.state.editClinicNotes.id);Object(F.j)(Object(F.f)(A.nc,[a.props.match.params.id]),i,(function(e){t.props.loadData&&t.props.loadData(),t.props.history&&t.props.history.replace("/patient/"+t.props.match.params.id+"/emr/clinicnotes/")}),(function(){}))}}))},a.changeTab=function(e,t){},a.selectDoctor=function(e){a.setState({selectedDoctor:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.state={resourceList:{},filteredResourceList:{},filterStrings:{},practiceDoctors:[],selectedDoctor:{},selectedDate:G()(),resourceAddModal:null,selectedTab:"Complaints",editClinicNotes:a.props.editClinicNotes?a.props.editClinicNotes:null},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){Object(de.d)(this),this.loadRequiredResources(Object(F.f)(A.db,[this.props.active_practiceId]),"Complaints"),this.loadRequiredResources(Object(F.f)(A.ib,[this.props.active_practiceId]),"Observations"),this.loadRequiredResources(Object(F.f)(A.eb,[this.props.active_practiceId]),"Diagnoses"),this.loadRequiredResources(Object(F.f)(A.gb,[this.props.active_practiceId]),"Investigations"),this.loadRequiredResources(Object(F.f)(A.kb,[this.props.active_practiceId]),"Notes"),this.loadRequiredResources(Object(F.f)(A.hb,[this.props.active_practiceId]),"Recent Medication"),this.state.editClinicNotes&&this.setInitialData()}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,n=a.getFieldDecorator,i=a.getFieldValue,r={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},l={};Rt.forEach((function(e){n(e,{initialValue:[++zt]}),l[e]=i(e)}));var c=l,o=I.a.create()(R.a);return m.a.createElement(j.a,null,m.a.createElement(h.a,null,m.a.createElement(g.a,{span:18},m.a.createElement("h2",null,"Clinical Notes"),m.a.createElement(I.a,{onSubmit:this.handleSubmit},Rt.map((function(a){return m.a.createElement("div",null,m.a.createElement(v.a,{style:{margin:5}},a),m.a.createElement("div",{style:{backgroundColor:a==t.state.selectedTab?"#ddd":"initial",padding:10}},c[a].map((function(i,l){return m.a.createElement(I.a.Item,Object.assign({},r,{label:a+" "+(l+1),key:i}),n("field[".concat(i,"]"),{validateTrigger:["onChange","onBlur"],rules:[{whitespace:!0}]})(m.a.createElement(T.a,{placeholder:a,style:{width:"60%",marginRight:8},key:i,onFocus:function(e){return t.changeTab(e,a)},onChange:function(){return t.changeValues(a,i)}})),c[a].length-1!=l?m.a.createElement(_.a,{shape:"circle",type:"danger",size:"small",icon:"delete",onClick:function(){return e.remove(a,i)}}):null)}))))})),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement(h.a,null,m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(ht.a,{placement:"topCenter",overlay:m.a.createElement(Se.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Se.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(M.a,{value:this.state.selectedDate,allowClear:!1,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY"}),m.a.createElement(_.a,{type:"primary",htmlType:"submit",style:{float:"right",margin:5}},"Save"),t.props.history?m.a.createElement(_.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null),m.a.createElement(h.a,null,"Next Follow up"))))),m.a.createElement(g.a,{span:6},m.a.createElement(At.a,{type:"card"},Rt.map((function(a){return m.a.createElement(Nt,{tab:a,key:a},m.a.createElement("div",{style:{padding:5}},m.a.createElement(_.a,{type:"primary",block:!0,size:"small",onClick:function(){return t.toggleModal(a)}},m.a.createElement(k.a,{type:"plus"}),"Add\xa0",a),m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(T.a.Search,{placeholder:"Search in "+a+" ...",onChange:function(t){return e.searchValues(a,t.target.value)}})),m.a.createElement(b.a,{key:a,size:"small",dataSource:t.state.filteredResourceList[a],renderItem:function(t){return m.a.createElement(b.a.Item,{key:t.id,onClick:function(){return e.addValues(a,t.name)}},t.name)}})))})))),m.a.createElement(f.a,{visible:!!this.state.resourceAddModal,onCancel:function(){return t.toggleModal(null)},title:"Add "+this.state.resourceAddModal,footer:null},this.state.resourceAddModal?m.a.createElement(o,{fields:[{label:this.state.resourceAddModal,required:!0,type:N.W,key:"name"}],defaultValues:[{key:"practice",value:this.props.active_practiceId}],formProp:{method:"post",action:Object(F.f)(Bt[this.state.resourceAddModal],[this.props.active_practiceId]),successFn:function(){t.toggleModal(null),Object(F.a)(N.Sb,t.state.resourceAddModal+" added successfully!!")},errorFn:function(e){console.log(e)}}}):null)))}}]),t}(m.a.Component),qt=I.a.create()(Yt),Gt=ce.Modal.confirm,Wt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).updateFormValue=function(e,t){a.setState(Object(w.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:st.get(e,"patient.user.first_name"),clinicId:st.get(e,"id"),mail_to:st.get(e,"patient.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.clinicId,i={mail_to:t};Object(de.g)(Object(F.f)(A.R,[n]),i),a.mailModalClose()},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,clinicNotes:[],editClinicNotes:null,loading:!0,mail_to:null},a.loadClinicNotes=a.loadClinicNotes.bind(Object(o.a)(a)),a.editClinicNotesData=a.editClinicNotesData.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadClinicNotes()}},{key:"loadClinicNotes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=function(e){t.setState((function(t){return 1==e.current?{clinicNotes:Object(D.a)(e.results),next:e.next,loading:!1}:{clinicNotes:[].concat(Object(D.a)(t.clinicNotes),Object(D.a)(e.results)),next:e.next,loading:!1}}))},n=function(){t.setState({loading:!1})},i={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(i.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete i.practice,Object(F.c)(A.nc,a,n,i)}},{key:"editClinicNotesData",value:function(e){this.setState({editClinicNotes:e,loading:!1});var t=this.props.match.params.id;this.props.history.push("/patient/"+t+"/emr/clinicnotes/edit")}},{key:"deleteClinicNote",value:function(e){var t=this;Gt({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a={id:e.id,patient:e.patient,is_active:!1};Object(F.j)(Object(F.f)(A.nc,[t.props.match.params.id]),a,(function(e){t.loadClinicNotes()}),(function(){}))},onCancel:function(){console.log("Cancel")}})}},{key:"loadPDF",value:function(e){Object(F.c)(Object(F.f)(A.R,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this;return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/clinicnotes/add",render:function(t){return m.a.createElement(qt,Object.assign({},t,e.props,{loadData:e.loadClinicNotes}))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/clinicnotes/edit",render:function(a){return e.state.editClinicNotes?m.a.createElement(qt,Object.assign({},e.state,a,{loadData:e.loadClinicNotes})):m.a.createElement(p.a,{to:"/patient/"+t.props.match.params.id+"/emr/clinicnotes/"})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" ClinicNotes":"ClinicNotes",extra:m.a.createElement(_.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/clinicnotes/add"},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"Add")))}),this.state.clinicNotes.map((function(a){return m.a.createElement(j.a,{style:{marginTop:20},title:m.a.createElement("small",null,a.date?G()(a.date).format("ll"):null),extra:m.a.createElement(ht.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Se.a,null,m.a.createElement(Se.a.Item,{key:"1",onClick:function(){return t.editClinicNotesData(a)},disabled:a.practice&&a.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Se.a.Item,{key:"2",onClick:function(){return t.deleteClinicNote(a)},disabled:a.practice&&a.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+a.patient+"/emr/timeline"},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(a)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(a.id)}},m.a.createElement(k.a,{type:"printer"})))},m.a.createElement(ce.Modal,{title:null,visible:e.state.visibleMail,onOk:e.sendMailToPatient,onCancel:e.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:e.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:e.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Clinical Notes To ",st.get(a,"patient.user.first_name")," ?"),m.a.createElement(T.a,{value:e.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Complaints")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.chief_complaints?a.chief_complaints.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Observations")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.observations?a.observations.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Investigations")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.investigations?a.investigations.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Diagnoses")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.diagnosis?a.diagnosis.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Notes")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.notes?a.notes.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Recent Medications")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.medication?a.medication.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement("div",null,a.doctor?m.a.createElement(y.a,{color:a.doctor?a.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+a.doctor.user.first_name," ")):null,a.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,a.practice.name," "))):null))})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadClinicNotes(t.state.next)},loading:this.state.loading,hidden:!this.state.next}))))):m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Clinic Notes":"Clinic Notes",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))}),this.state.clinicNotes.map((function(a){return m.a.createElement(j.a,{style:{marginTop:10},key:a.id,extra:m.a.createElement(ht.a.Button,{size:"small",overlay:m.a.createElement(Se.a,null,m.a.createElement(Se.a.Item,{key:"1",onClick:function(){return t.editClinicNotesData(a)},disabled:a.practice&&a.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Se.a.Item,{key:"2",onClick:function(){return t.deleteClinicNote(a)},disabled:a.practice&&a.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+a.patient+"/emr/timeline"},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(a)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(a.id)}},m.a.createElement(k.a,{type:"printer"}))),title:m.a.createElement("div",null,m.a.createElement("small",null,a.date?G()(a.date).format("ll"):null,m.a.createElement(le.b,{to:"/patient/"+a.patient.id+"/emr/clinicnotes"},"\xa0\xa0 ",a.patient.user?a.patient.user.first_name:null," (ID: ",a.patient.custom_id?a.patient.custom_id:a.patient.id,")\xa0"),m.a.createElement("span",null,", ",a.patient.gender)))},m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Complaints")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.chief_complaints?a.chief_complaints.split(Y.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Observations")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.observations?a.observations.split(Y.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Investigations")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.investigations?a.investigations.split(Y.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Diagnoses")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.diagnosis?a.diagnosis.split(Y.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Notes")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.notes?a.notes.split(Y.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Recent Medications")),m.a.createElement(g.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.medication?a.medication.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement("div",null,a.doctor?m.a.createElement(y.a,{color:a.doctor?a.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+a.doctor.user.first_name," ")):null,a.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,a.practice.name," "))):null))})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadClinicNotes(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(ce.Modal,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Clinical Notes To ",t.state.patientName," ?"),m.a.createElement(T.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})))}}]),t}(m.a.Component),Ht=(a(689),a(691)),Ut=u.a.Header,Kt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.refreshWallet&&this.props.refreshWallet()}},{key:"render",value:function(){var e=this,t=this;return m.a.createElement(Ut,{className:"header",style:{background:"#e4e4e4",padding:"0px 20px"}},m.a.createElement("div",null,this.props.currentPatient?m.a.createElement("div",{style:{display:"inline"}},m.a.createElement("div",{style:{display:"inline",textSize:"15px"}},m.a.createElement(we.a,{title:"Switch Back to All Patients"},m.a.createElement(_.a,{onClick:function(){return e.props.setCurrentPatient(null)},type:"primary",ghost:!0},m.a.createElement(k.a,{type:"arrow-left"})))),m.a.createElement("a",{style:{padding:"8px",fontSize:"15px"},onClick:function(){return e.props.togglePatientListModal(!0)}},this.props.currentPatient.image?m.a.createElement(P.a,{src:Object(F.g)(this.props.currentPatient.image)}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"}},this.props.currentPatient.user.first_name?this.props.currentPatient.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),"\xa0\xa0",t.props.currentPatient.user.first_name.length<16?t.props.currentPatient.user.first_name:t.props.currentPatient.user.first_name.slice(0,12)+"...",m.a.createElement("small",null,m.a.createElement("i",null,m.a.createElement("b",null," [ID: ",t.props.currentPatient.custom_id?t.props.currentPatient.custom_id:t.props.currentPatient.id,"]")))),this.props.MedicalMembership?m.a.createElement(be.a,{placement:"rightTop",title:"Patient Membership",content:m.a.createElement("div",null,m.a.createElement("p",null,m.a.createElement("strong",null,"Membership Code : "),m.a.createElement("span",null,this.props.MedicalMembership.membership_code)),m.a.createElement("p",null,m.a.createElement("strong",null,"Start Date : "),m.a.createElement("span",null,this.props.MedicalMembership.medical_from)),m.a.createElement("p",null,m.a.createElement("strong",null,"Valid Till : "),m.a.createElement("span",null,this.props.MedicalMembership.medical_to)))},m.a.createElement("div",{style:{display:"inline",maxWidth:50,fontSize:30,lineHeight:"40px"}},m.a.createElement(k.a,{type:"crown",theme:"twoTone",twoToneColor:"#FFBA3A"}))):null,m.a.createElement(be.a,{placement:"topLeft",title:"Medical History",content:m.a.createElement("div",{style:{width:250}},t.props.currentPatient.medical_history_data?t.props.currentPatient.medical_history_data.map((function(e,t){return m.a.createElement(y.a,{color:"#"+Object(de.b)(Object(de.a)(e.name))},e.name)})):null)},t.props.currentPatient.medical_history_data?t.props.currentPatient.medical_history_data.map((function(e,a){return a>0?1==a&&m.a.createElement(y.a,null,"+",t.props.currentPatient.medical_history_data.length-1):m.a.createElement(y.a,{color:"#"+Object(de.b)(Object(de.a)(e.name))},e.name)})):null),m.a.createElement(Ht.a,{style:{marginLeft:20},checked:this.props.showAllClinic,onChange:function(t){return e.props.toggleShowAllClinic(t)},checkedChildren:"All Clinics",unCheckedChildren:"Current Clinic"}),this.props.pendingAmount?m.a.createElement(m.a.Fragment,null,m.a.createElement(_.a,{style:{marginLeft:"20px"},type:"primary",size:"small"},m.a.createElement(le.b,{to:"/patient/"+this.props.currentPatient.id+"/billing/payments/add"},"Pay!")),m.a.createElement(be.a,{placement:"rightTop",content:m.a.createElement(b.a,{size:"small",dataSource:this.props.pendingAmount.practice_data,renderItem:function(e){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:e.name,description:"Rs. "+(e.total<0?-1*e.total+" (Advance)":e.total)}))}}),title:"Pending Payments"},m.a.createElement("div",{style:{display:"inline",float:"left",maxWidth:200,position:"absolute",margin:"5px 15px",zIndex:5}},m.a.createElement(O.a,{title:"Amount Due",value:this.props.pendingAmount.grand_total,valueStyle:{color:this.props.pendingAmount.grand_total>0?"#cf1322":"initial",fontWeight:500,fontSize:20},precision:2})))):null,this.props.walletAmount&&this.props.walletAmount.length?m.a.createElement(be.a,{placement:"rightTop",title:"Agent Wallet Amount",content:m.a.createElement("p",null,"Non-Refundable : ",this.props.walletAmount[0].non_refundable)},m.a.createElement("div",{style:{display:"inline",float:"left",maxWidth:400,position:"absolute",paddingLeft:150,margin:"20px 15px"}},m.a.createElement(O.a,{tile:"wallet",value:this.props.walletAmount[0].refundable_amount+this.props.walletAmount[0].non_refundable,precision:2,valueStyle:{fontSize:20},prefix:m.a.createElement(k.a,{type:"wallet",twoToneColor:"#a2711c"})}))):null):m.a.createElement("a",{style:{padding:"8px",fontSize:"20px"},onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement("div",{style:{display:"inline"}},m.a.createElement(k.a,{type:"solution"})," \xa0 All Patient")),m.a.createElement(ht.a,{overlay:de.f},m.a.createElement(_.a,{style:{float:"right",margin:"15px"}},m.a.createElement(k.a,{type:"setting"})," Settings ",m.a.createElement(k.a,{type:"down"}))),t.props.activePracticePermissions.AddPatient||t.props.allowAllPermissions?m.a.createElement(le.b,{to:"/patients/profile/add"},m.a.createElement(_.a,{type:"primary",style:{float:"right",margin:"15px"}},m.a.createElement(k.a,{type:"plus"})," Add Patient")):null),m.a.createElement(f.a,{width:1300,maskClosable:!1,centered:!0,footer:null,closable:!1,visible:this.props.listModalVisible,style:{height:"calc(100vh - 120px)"}},m.a.createElement(_.a,{icon:"close",type:"danger",shape:"circle",style:{position:"absolute",top:"-50px",right:0},onClick:function(){return e.props.togglePatientListModal(!1)}}),m.a.createElement(ne,this.props)))}}]),t}(m.a.Component);function Xt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Qt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).onChanged=function(e,t){a.setState(Object(w.a)({},e,t))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var i=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Xt(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Xt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{medicine_till:G()(n.medicine_till).format("YYYY-MM-DD"),follow_up_date:G()(n.follow_up_date).format("YYYY-MM-DD")});t.setState({saving:!0});Object(F.l)(Object(F.f)(A.wc,[a.props.currentPatient.id]),i,(function(e){Object(F.a)(N.Sb,"Communication Settings Saved Successfully!!"),t.setState({saving:!1})}),(function(){t.setState({saving:!1})}))}}))},a.state={parient_communication_history:null,patientProfile:null,saving:!1},a.loadCommunication=a.loadCommunication.bind(Object(o.a)(a)),a.loadProfile=a.loadProfile.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.currentPatient&&(this.loadCommunication(),this.loadProfile())}},{key:"loadProfile",value:function(){var e=this;Object(F.c)(Object(F.f)(A.wc,[e.props.match.params.id]),(function(t){e.setState({patientProfile:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"loadCommunication",value:function(){var e=this;Object(F.c)(Object(F.f)(A.oc,[this.props.currentPatient.user.id]),(function(t){e.setState({parient_communication_history:t.user_sms,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a={labelCol:{xs:{span:8},sm:{span:8},md:{span:8},lg:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16},md:{span:16},lg:{span:16}}},n=[{title:"SENT TIME",dataIndex:"created_at",key:"created_at",render:function(e){return m.a.createElement("span",null,G()(e).format("LLL"))}},{title:"MESSAGE",dataIndex:"body",key:"body"},{title:"TYPE",dataIndex:"sms_type",key:"sms_type"},{title:"MESSAGE STATUS",dataIndex:"status",key:"status"}],i=Y.Eb.map((function(e){return m.a.createElement(S.a,{value:e.value},e.title)})),r=Y.B.map((function(e){return m.a.createElement(S.a,{value:e.value},e.title)})),l=Y.j.map((function(e){return m.a.createElement(S.a,{value:e.value},e.title)}));return m.a.createElement(I.a,{onSubmit:this.handleSubmit},m.a.createElement(j.a,{title:this.props.currentPatient?this.props.currentPatient.user.first_name+" Communication":"Patient Communication",extra:m.a.createElement(_.a,{type:"primary",htmlType:"submit",loading:this.state.saving},m.a.createElement(k.a,{type:"save"})," Save Communication Setting")},m.a.createElement(I.a.Item,Object.assign({},a,{key:"sms_enable"})," ",m.a.createElement("label",null,m.a.createElement("span",{className:"ant-form-text"},"Enable SMS the patient"," : "),t("sms_enable",{initialValue:!!this.state.patientProfile&&this.state.patientProfile.sms_enable})(m.a.createElement(S.a.Group,{onChange:function(t){return e.onChanged("sms_enable",t.target.value)}},i)))),m.a.createElement(I.a.Item,Object.assign({},a,{key:"email_enable"})," ",m.a.createElement("label",null," ",m.a.createElement("span",{className:"ant-form-text"},"Enable Email the patient"," : "),t("email_enable",{initialValue:!!this.state.patientProfile&&this.state.patientProfile.email_enable})(m.a.createElement(S.a.Group,{onChange:function(t){return e.onChanged("email_enable",t.target.value)}},r)))),m.a.createElement(I.a.Item,Object.assign({},a,{key:"birthday_sms_email"})," ",m.a.createElement("label",null," ",m.a.createElement("span",{className:"ant-form-text"}," ","Send Birthday wish SMS & Email"," : "),t("birthday_sms_email",{initialValue:!!this.state.patientProfile&&this.state.patientProfile.birthday_sms_email})(m.a.createElement(S.a.Group,{onChange:function(t){return e.onChanged("birthday_sms_email",t.target.value)}},l)))),m.a.createElement(I.a.Item,Object.assign({},a,{key:"medicine_till"})," ",m.a.createElement("label",null,m.a.createElement("span",{className:"ant-form-text"}," ","Medicine Till Date"," : "),t("medicine_till",{initialValue:this.state.patientProfile&&this.state.patientProfile.medicine_till?G()(this.state.patientProfile.medicine_till):G()()})(m.a.createElement(M.a,{allowClear:!1,format:"YYYY-MM-DD"})))),m.a.createElement(I.a.Item,Object.assign({},a,{key:"medicine_till"})," ",m.a.createElement("label",null,m.a.createElement("span",{className:"ant-form-text"}," ","Next follow-up To"," : "),t("follow_up_date",{initialValue:this.state.patientProfile&&this.state.patientProfile.follow_up_date?G()(this.state.patientProfile.follow_up_date):G()()})(m.a.createElement(M.a,{allowClear:!1,format:"YYYY-MM-DD"})))),m.a.createElement("div",null,m.a.createElement(v.a,{dashed:!0}),m.a.createElement("h2",null,"Past Communication"),m.a.createElement(V.a,{loading:this.state.loading,columns:n,dataSource:this.state.parient_communication_history}))))}}]),t}(m.a.Component),Zt=I.a.create()(Qt),Jt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return m.a.createElement(Zt,Object.assign({},this.state,this.props))}}]),t}(m.a.Component),$t=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={redirect:!1,vitalSign:null,editVitalSign:a.props.editVitalSign?a.props.editVitalSign:null},a.changeRedirect=a.changeRedirect.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"render",value:function(){var e,t=this,a=[{label:"Pulse",key:"pulse",initialValue:this.props.editVitalSign?this.props.editVitalSign.pulse:null,type:N.pb,follow:"BPM"},{label:"Temperature",key:"temperature",initialValue:this.props.editVitalSign?this.props.editVitalSign.temperature:null,type:N.pb,follow:"Fahrenheit"},{label:"Temperature Part",key:"temperature_part",type:N.Nb,initialValue:this.props.editVitalSign?this.props.editVitalSign.temperature_part:null,options:[{label:"forehead",value:"forehead"},{label:"armpit",value:"armpit"},{label:"oral ",value:"oral"}]},{label:"Blood Pressure Up",key:"blood_pressure_up",initialValue:this.props.editVitalSign?this.props.editVitalSign.blood_pressure_up:null,type:N.pb,follow:"mmhg"},{label:"Blood Pressure Down",key:"blood_pressure_down",initialValue:this.props.editVitalSign?this.props.editVitalSign.blood_pressure_down:null,type:N.pb,follow:"mmhg"},{label:"Position",key:"position",type:N.Nb,initialValue:this.props.editVitalSign?this.props.editVitalSign.position:null,options:[{label:"standing",value:"standing"},{label:"sitting",value:"sitting"}]},{label:"Weight",key:"weight",initialValue:this.props.editVitalSign?this.props.editVitalSign.weight:null,type:N.pb,follow:"kg."},{label:"Resp Rate",key:"resp_rate",initialValue:this.props.editVitalSign?this.props.editVitalSign.resp_rate:null,type:N.pb,follow:"breaths/min"},{label:"Creatinine Level",key:"creatinine",initialValue:this.props.editVitalSign?this.props.editVitalSign.creatinine:null,type:N.pb},{label:"Haemoglobin Level",key:"haemoglobin",initialValue:this.props.editVitalSign?this.props.editVitalSign.haemoglobin:null,type:N.pb},{label:"Urea Level",key:"urea",initialValue:this.props.editVitalSign?this.props.editVitalSign.urea:null,type:N.pb},{label:"Uric Acid Level",key:"uric_acid",initialValue:this.props.editVitalSign?this.props.editVitalSign.uric_acid:null,type:N.pb},{label:"Date",key:"date",initialValue:this.props.editVitalSign&&this.props.editVitalSign.date?this.props.editVitalSign.date:G()(),type:N.K,required:!0}],n=[{key:"patient",value:this.props.match.params.id},{key:"practice",value:this.props.active_practiceId}],i=this,r=I.a.create()(R.a);this.state.editVitalSign&&(e={successFn:function(e){Object(F.a)(N.Sb,"success"),i.props.loadData&&i.props.loadData(),i.props.history&&i.props.history.replace("/patient/"+i.props.match.params.id+"/emr/vitalsigns")},errorFn:function(){},action:Object(F.f)(A.Nd,[this.props.match.params.id]),method:"post"},n.push({key:"id",value:this.state.editVitalSign.id}));var l={successFn:function(e){Object(F.a)(N.Sb,"success"),i.props.loadData&&i.props.loadData(),i.props.history&&i.props.history.replace("/patient/"+i.props.match.params.id+"/emr/vitalsigns")},errorFn:function(){},action:Object(F.f)(A.Nd,[this.props.match.params.id]),method:"post"};return m.a.createElement(h.a,null,m.a.createElement(j.a,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/vitalsigns/edit",render:function(){return t.state.editVitalSign?m.a.createElement(r,{defaultValues:n,title:"Edit Report Manual",changeRedirect:t.changeRedirect,formProp:e,fields:a}):m.a.createElement(p.a,{to:"/patients/profile"})}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/vitalsigns/add",render:function(){return m.a.createElement(r,{title:"Add Report Manual",defaultValues:n,changeRedirect:t.changeRedirect,formProp:l,fields:a})}})),this.state.redirect&&m.a.createElement(p.a,{to:"/patient/"+this.props.match.params.id+"/emr/vitalsigns"}))}}]),t}(m.a.Component),ea=a(349);function ta(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var aa=f.a.confirm,na=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).deleteVitalSign=function(e){var t=Object(o.a)(a);aa({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ta(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ta(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{is_active:!1});Object(F.j)(Object(F.f)(A.Nd,[e.patient]),a,(function(e){t.loadVitalsigns(),Object(F.a)(N.Sb,"Deleted Successfully!!")}),(function(){}))},onCancel:function(){console.log("Cancel")}})},a.editObject=function(e){if(a.setState({editVitalSign:e,loading:!1}),a.props.match.params.id){var t=a.props.match.params.id;a.props.history.push("/patient/"+t+"/emr/vitalsigns/edit")}else a.props.history.push("/patient/"+e.patient+"/emr/vitalsigns")},a.updateFormValue=function(e,t){a.setState(Object(w.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:st.get(e,"patient_data.user.first_name"),reportManualId:st.get(e,"id"),mail_to:st.get(e,"patient_data.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.reportManualId,i={mail_to:t};Object(de.g)(Object(F.f)(A.Od,[n]),i),a.mailModalClose()},a.state={currentPatient:a.props.currentPatient,vitalsign:[],loading:!0},a.loadVitalsigns=a.loadVitalsigns.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadVitalsigns()}},{key:"loadVitalsigns",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=function(e){t.setState((function(t){return 1==e.current?{vitalsign:Object(D.a)(e.results),next:e.next,loading:!1}:{vitalsign:[].concat(Object(D.a)(t.vitalsign),Object(D.a)(e.results)),next:e.next,loading:!1}}))},n=function(){},i={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(i.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete i.practice,Object(F.c)(A.Nd,a,n,i)}},{key:"loadPDF",value:function(e){Object(F.c)(Object(F.f)(A.Od,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=(this.state.vitalsign,[{title:"Date",dataIndex:"date",key:"date",render:function(e,t){return m.a.createElement("span",null,t.date?G()(t.date).format("LL"):"")}},{title:"Temp(F)",key:"temperature",render:function(e,t){return m.a.createElement("span",null," ",t.temperature,m.a.createElement("br",null),",",t.temperature_part)}},{title:"Pulse (BPM)",dataIndex:"pulse",key:"pulse"},{title:"RR breaths/min",dataIndex:"resp_rate",key:"resp_rate"},{title:"SYS/DIA mmhg",key:"address",render:function(e,t){return m.a.createElement("span",null," ",t.blood_pressure_up,"/",t.blood_pressure_down,m.a.createElement("br",null),",",t.position)}},{title:"WEIGHT kg",dataIndex:"weight",key:"weight"},{title:"Creatinine Level",key:"creatinine",dataIndex:"creatinine"},{title:"Haemoglobin Level",key:"haemoglobin",dataIndex:"haemoglobin"},{title:"Urea Level",key:"urea",dataIndex:"urea"},{title:"Uric Acid Level",key:"uric_acid",dataIndex:"uric_acid"},{title:"Action",key:"action",render:function(a,n){return m.a.createElement("span",null,m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},"Print"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{onClick:function(){return e.editObject(n)},disabled:n.practice!=t.props.active_practiceId},"Edit"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{onClick:function(){return t.deleteVitalSign(n)},disabled:n.practice!=t.props.active_practiceId},"Delete"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{onClick:function(){return t.sendPatientMail(n)}},"Send to patient"))}}]);return this.props.match.params.id?m.a.createElement(p.d,null,m.a.createElement(p.b,{path:"/patient/:id/emr/vitalsigns/add",render:function(t){return m.a.createElement($t,Object.assign({},e.props,{key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t,{loadData:e.loadVitalsigns}))}}),m.a.createElement(p.b,{path:"/patient/:id/emr/vitalsigns/edit",render:function(t){return m.a.createElement($t,Object.assign({},e.props,{key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t,{loadData:e.loadVitalsigns}))}}),m.a.createElement(p.b,null,m.a.createElement(j.a,{title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Report Manual":"Patient Report Manual",extra:m.a.createElement(_.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/vitalsigns/add"},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"Add")))},m.a.createElement(At.a,null,m.a.createElement(At.a.TabPane,{tab:"Charts",key:1,style:{margin:"auto"}},m.a.createElement(v.a,null,"Pulse Chart (bpm)"),m.a.createElement("div",{style:{height:200}},m.a.createElement(ea.k,null,m.a.createElement(ea.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement(ea.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:t.state.vitalsign.length}),m.a.createElement(ea.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(ea.b,{strokeDasharray:"3 3"}),m.a.createElement(ea.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement(ea.g,{type:"monotone",dataKey:"pulse",stroke:"#8884d8",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Temperature (F)"),m.a.createElement("div",{style:{height:200}},m.a.createElement(ea.k,null,m.a.createElement(ea.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement(ea.f,{verticalAlign:"top",height:36}),m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(ea.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(ea.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(ea.b,{strokeDasharray:"3 3"}),m.a.createElement(ea.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement(ea.g,{type:"monotone",dataKey:"temperature",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Blood Pressure (mmhg)"),m.a.createElement("div",{style:{height:200}},m.a.createElement(ea.k,null,m.a.createElement(ea.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#ffc658",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#ffc658",stopOpacity:0}))),m.a.createElement(ea.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(ea.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(ea.b,{strokeDasharray:"3 3"}),m.a.createElement(ea.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement(ea.g,{type:"monotone",dataKey:"blood_pressure_up",stroke:"#ffc658",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"}),m.a.createElement(ea.g,{type:"monotone",dataKey:"blood_pressure_down",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Weight (kg)"),m.a.createElement("div",{style:{height:200}},m.a.createElement(ea.k,null,m.a.createElement(ea.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#8884d8",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#8884d8",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(ea.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(ea.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(ea.b,{strokeDasharray:"3 3"}),m.a.createElement(ea.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement(ea.g,{type:"monotone",dataKey:"weight",stroke:"#8884d8",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Respiratory Rate (breaths/min)"),m.a.createElement("div",{style:{height:200}},m.a.createElement(ea.k,null,m.a.createElement(ea.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(ea.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(ea.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(ea.b,{strokeDasharray:"3 3"}),m.a.createElement(ea.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement(ea.g,{type:"monotone",dataKey:"resp_rate",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Creatinine Level"),m.a.createElement("div",{style:{height:200}},m.a.createElement(ea.k,null,m.a.createElement(ea.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(ea.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(ea.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(ea.b,{strokeDasharray:"3 3"}),m.a.createElement(ea.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement(ea.g,{type:"monotone",dataKey:"creatinine",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Haemoglobin Level"),m.a.createElement("div",{style:{height:200}},m.a.createElement(ea.k,null,m.a.createElement(ea.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(ea.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(ea.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(ea.b,{strokeDasharray:"3 3"}),m.a.createElement(ea.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement(ea.g,{type:"monotone",dataKey:"haemoglobin",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Urea Level"),m.a.createElement("div",{style:{height:200}},m.a.createElement(ea.k,null,m.a.createElement(ea.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(ea.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(ea.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(ea.b,{strokeDasharray:"3 3"}),m.a.createElement(ea.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement(ea.g,{type:"monotone",dataKey:"urea",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Uric Acid Level"),m.a.createElement("div",{style:{height:200}},m.a.createElement(ea.k,null,m.a.createElement(ea.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement(ea.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement(ea.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement(ea.b,{strokeDasharray:"3 3"}),m.a.createElement(ea.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement(ea.g,{type:"monotone",dataKey:"uric_acid",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"}))))),m.a.createElement(At.a.TabPane,{tab:"Details",key:2},m.a.createElement(V.a,{columns:a,pagination:!1,dataSource:this.state.vitalsign}),m.a.createElement(L.a,{loaderFunction:function(){return e.loadInvoices(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Report Manual To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}}))))))):m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Report Manual":"Patients Report Manual",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{type:"primary",onClick:function(){return t.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))}),this.state.vitalsign.map((function(e){return m.a.createElement("div",null,m.a.createElement(j.a,{style:{marginTop:10},title:m.a.createElement("small",null,e.date?G()(e.date).format("ll"):null,m.a.createElement(le.b,{to:"/patient/"+e.patient_data.id+"/emr/vitalsigns"},"\xa0\xa0 ",e.patient_data.user?e.patient_data.user.first_name:null," (ID: ",e.patient_data.custom_id?e.patient_data.custom_id:e.patient_data.id,")\xa0"),m.a.createElement("span",null,", ",e.patient_data.gender)),bodyStyle:{padding:0}},m.a.createElement(je.a,{columns:a,pagination:!1,dataSource:[e],footer:function(){return function(e){if(e)return console.log(e),m.a.createElement("div",null,e.doctor?m.a.createElement(y.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+e.doctor.user.first_name," ")):null,e.practice_data?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null);return null}(e)}})))})),m.a.createElement(L.a,{loaderFunction:function(){return e.loadVitalsigns(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Report Manual  To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})))}}]),t}(m.a.Component);function ia(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ra(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ia(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ia(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var la=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).calculateItem=function(e){a.props.form.getFieldsValue;a.setState((function(e){Object(D.a)(e.tableFormValues).forEach((function(e){}))}))},a.addNotes=function(e,t){a.setState((function(a){return{addNotes:ra({},a.addNotes,Object(w.a)({},e,!!t))}}))},a.removeTreatment=function(e){a.setState((function(t){return{tableFormValues:Object(D.a)(Object(st.remove)(t.tableFormValues,(function(t){return t._id!=e})))}}))},a.add=function(e){Object(o.a)(a);a.setState((function(t){var a=Math.random().toFixed(7);return{addNotes:ra({},t.addNotes,Object(w.a)({},a,!!e.default_notes)),tableFormValues:[ra({},e,{_id:a})].concat(Object(D.a)(t.tableFormValues))}}),(function(){}))},a.selectDoctor=function(e){a.setState({selectedDoctor:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(!e){var n={treatment_plans:[],patient:t.props.match.params.id,doctor:t.state.selectedDoctor.id,date:t.state.selectedDate&&G()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null,practice:t.props.active_practiceId};t.props.editId&&(n.id=t.props.editTreatmentPlan.id),t.state.tableFormValues.forEach((function(e){e.quantity=a.quantity[e._id],e.cost=a.cost[e._id],e.discount=a.discount[e._id],a.notes&&(e.notes=a.notes[e._id]);var t={procedure:e.id,cost:e.cost,quantity:e.quantity,margin:e.margin,default_notes:e.notes,is_active:!0,is_completed:!0,discount:e.discount,discount_type:"%"};n.treatment_plans.push(t)}));Object(F.j)(Object(F.f)(A.Fd,[t.props.match.params.id]),n,(function(e){Object(F.a)("Inventory updated successfully"),t.props.loadData&&t.props.loadData();var a="/patient/"+t.props.match.params.id+"/emr/workdone";t.props.history.replace(a)}),(function(){}))}}))},a.searchValues=function(e){var t=Object(o.a)(a);return a.setState((function(t){return{searchString:e}}),(function(){t.loadProcedures()})),!1},a.state={loadingProcedures:!0,procedure_category:[],tableFormValues:[],addNotes:{},practiceDoctors:[],selectedDoctor:{},selectedDate:G()()},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.editId&&this.setState((function(e){var t=[];return this.props.editTreatmentPlan.treatment_plans.forEach((function(e){var a=Math.random().toFixed(7);t.push(ra({},e,{},e.procedure,{_id:a}))})),ra({},this.props.editTreatmentPlan,{tableFormValues:t,selectedDate:G()(this.props.editTreatmentPlan.date),selectedDoctor:this.props.editTreatmentPlan.doctor})})),this.loadProcedures(),Object(de.d)(this)}},{key:"loadProcedures",value:function(){var e=this,t={};this.state.searchString&&(t.name=this.state.searchString),e.setState({loadingProcedures:!0});Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),(function(a){t.name&&e.state.searchString!=t.name||e.setState({loadingProcedures:!1,filteredItems:a.results})}),(function(){e.setState({loadingProcedures:!1})}),t)}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,n=a.getFieldDecorator,i=(a.getFieldValue,a.getFieldsValue,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}}),r=[{title:"Treatments",dataIndex:"name",key:"name",render:function(t,a){return m.a.createElement("span",null,m.a.createElement("b",null,t),m.a.createElement("br",null),e.state.addNotes[a._id]||e.props.editId?m.a.createElement(I.a.Item,Object.assign({key:"default_notes[".concat(a._id,"]")},i),n("notes[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.default_notes})(m.a.createElement(T.a.TextArea,{min:0,placeholder:"Notes..."}))):m.a.createElement("a",{onClick:function(){return e.addNotes(a._id,!0)}},"+ Add Note"))}},{title:"Quantity",dataIndex:"quantity",key:"quantity",render:function(t,a){return m.a.createElement(I.a.Item,Object.assign({key:"quantity[".concat(a._id,"]")},i),n("quantity[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:a.quantity})(m.a.createElement(C.a,{min:0,placeholder:"Quantity",size:"small",onChange:function(){return e.calculateItem(a._id)}})))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(t,a){return m.a.createElement(I.a.Item,Object.assign({key:"cost[".concat(a._id,"]")},i),n("cost[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:a.cost})(m.a.createElement(C.a,{min:0,placeholder:"Cost",size:"small",onChange:function(){return e.calculateItem(a._id)}})))}},{title:"Discount",dataIndex:"discount",key:"discount",render:function(t,a){return m.a.createElement(I.a.Item,Object.assign({key:"discount[".concat(a._id,"]")},i),n("discount[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}]})(m.a.createElement(C.a,{min:0,placeholder:"Discount",size:"small",onChange:function(){return e.calculateItem(a._id)}}))," %")}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement(_.a,{icon:"close",onClick:function(){return e.removeTreatment(a._id)},type:"danger",shape:"circle",size:"small"}))}}];return m.a.createElement("div",null,m.a.createElement(j.a,{title:"Completed Procedures"},m.a.createElement(h.a,null,m.a.createElement(g.a,{span:17},m.a.createElement(I.a,{onSubmit:this.handleSubmit},m.a.createElement(je.a,{pagination:!1,bordered:!0,dataSource:this.state.tableFormValues,columns:r}),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(ht.a,{placement:"topCenter",overlay:m.a.createElement(Se.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Se.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(M.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement(I.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0,float:"right"}}),m.a.createElement(_.a,{type:"primary",htmlType:"submit",style:{margin:5}},"Save Treatment Plan"),t.props.history?m.a.createElement(_.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null))),m.a.createElement("div",{ref:function(e){t.bottomPoint=e}}))),m.a.createElement(g.a,{span:7},m.a.createElement(Je.a,{offsetTop:0},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(T.a.Search,{placeholder:"Search in plans ...",onChange:function(t){return e.searchValues(t.target.value)}})),m.a.createElement(b.a,{size:"small",loading:this.state.loadingProcedures,style:{maxHeight:"100vh",overflowX:"scroll"},itemLayout:"horizontal",dataSource:this.state.filteredItems,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.add(t)}},m.a.createElement(b.a.Item.Meta,{title:t.name}))}}))))))}}]),t}(m.a.Component),ca=I.a.create()(la),oa=f.a.confirm,sa=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).updateFormValue=function(e,t){a.setState(Object(w.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:st.get(e,"patient.user.first_name"),treatmentId:st.get(e,"id"),mail_to:st.get(e,"patient.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.treatmentId,i={mail_to:t};Object(de.g)(Object(F.f)(A.Hd,[n]),i),a.mailModalClose()},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,treatmentPlans:[],procedure_category:null,completedTreatmentPlans:[],incompletedTreatmentPlans:[],productMargin:[],loading:!0},a.loadTreatmentPlans=a.loadTreatmentPlans.bind(Object(o.a)(a)),a.editTreatmentPlanData=a.editTreatmentPlanData.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadTreatmentPlans(),this.loadProductMargin()}},{key:"loadProductMargin",value:function(){var e=this;Object(F.c)(A.Mc,(function(t){e.setState({productMargin:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"loadTreatmentPlans",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=[],a=this,n=function(e){a.setState((function(t){return 1==e.current?{treatmentPlans:Object(D.a)(e.results),next:e.next,loading:!1}:{treatmentPlans:[].concat(Object(D.a)(t.treatmentPlans),Object(D.a)(e.results)),next:e.next,loading:!1}})),e.results.forEach((function(e){e.is_completed||t.push(e)})),a.setState((function(e){return{incompletedTreatmentPlans:[].concat(Object(D.a)(e.incompletedTreatmentPlans),t),loading:!1}}))},i=function(){a.setState({loading:!1})},r={page:e,practice:this.props.active_practiceId,complete:!0};this.props.match.params.id&&(r.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete r.practice,Object(F.c)(A.Fd,n,i,r)}},{key:"editTreatmentPlanData",value:function(e){this.setState({editTreatmentPlan:e});var t=this.props.match.params.id;this.props.history.push("/patient/"+t+"/emr/workdone/edit")}},{key:"deleteTreatmentPlans",value:function(e){var t=this;oa({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a={id:e.id,patient:e.patient.id,is_active:!1};Object(F.j)(Object(F.f)(A.Fd,[t.props.match.params.id],null),a,(function(e){Object(F.a)(N.Sb,"Completed Procedure Deleted Successfully!"),t.loadTreatmentPlans()}),(function(){}))},onCancel:function(){console.log("Cancel")}})}},{key:"loadPDF",value:function(e){Object(F.c)(Object(F.f)(A.Hd,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=[{title:"",key:"is_completed",render:function(e,t){return t.is_completed?m.a.createElement(k.a,{type:"check-circle",theme:"twoTone",style:{marginLeft:"8px",fontSize:"20px"}}):null}},{title:"Procedure",key:"procedure.name",dataIndex:"procedure.name"},{title:"Quantity",dataIndex:"quantity",initialValue:this.state.editFields?this.state.editFields.quantity:null,key:"quantity"},{title:"Discount",dataIndex:"discount",key:"discount"},{title:"Cost per  Unit",dataIndex:"cost",key:"cost"},{title:"Notes",dataIndex:"default_notes",key:"default_notes"}];return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/workdone/add",render:function(a){return m.a.createElement(ca,Object.assign({},e.state,t.props,a,{loadData:e.loadTreatmentPlans}))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/workdone/edit",render:function(a){return e.state.editTreatmentPlan?m.a.createElement(ca,Object.assign({},e.state,a,t.props,{editId:e.state.editTreatmentPlan.id,loadData:e.loadTreatmentPlans})):m.a.createElement(p.a,{to:"/patient/"+e.props.match.params.id+"/emr/workdone"})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Completed Procedures":"Completed Procedures ",extra:m.a.createElement(_.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/workdone/add"},m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"plus"}),"Add")))}),this.state.treatmentPlans.map((function(n){return m.a.createElement(j.a,{bodyStyle:{padding:0},style:{marginTop:15}},m.a.createElement("div",{style:{padding:16}},m.a.createElement("h4",null,n.date?G()(n.date).format("ll"):null,m.a.createElement(ht.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Se.a,null,m.a.createElement(Se.a.Item,{key:"1",onClick:function(){return t.editTreatmentPlanData(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Se.a.Item,{key:"2",onClick:function(){return t.deleteTreatmentPlans(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+n.patient+"/emr/timeline"},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(n)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},m.a.createElement(k.a,{type:"printer"}))))),m.a.createElement(je.a,{loading:e.state.loading,columns:a,dataSource:n.treatment_plans,footer:function(){return ua(n)},pagination:!1,key:n.id}))})),m.a.createElement(L.a,{loaderFunction:function(){return e.loadTreatmentPlans(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send complete procedure To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})))))):m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Completed Procedures":"Completed Procedures ",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))}),this.state.treatmentPlans.map((function(n){return m.a.createElement(j.a,{bodyStyle:{padding:0},key:n.id,style:{marginTop:15}},m.a.createElement("div",{style:{padding:16}},m.a.createElement("h4",null,n.date?G()(n.date).format("ll"):null,m.a.createElement(le.b,{to:"/patient/"+n.patient.id+"/emr/workdone"},"\xa0\xa0 ",n.patient.user?n.patient.user.first_name:null," (ID: ",n.patient.custom_id?n.patient.custom_id:n.patient.id,")\xa0"),m.a.createElement("span",null,", ",n.patient.gender),m.a.createElement(ht.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Se.a,null,m.a.createElement(Se.a.Item,{key:"1",disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(le.b,{to:"/patient/"+n.patient.id+"/emr/workdone/edit"},m.a.createElement(k.a,{type:"edit"}),"\xa0 Edit")),m.a.createElement(Se.a.Item,{key:"2",onClick:function(){return t.deleteTreatmentPlans(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+n.patient.id+"/emr/timeline"},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(n)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},m.a.createElement(k.a,{type:"printer"}))))),m.a.createElement(je.a,{loading:e.state.loading,columns:a,dataSource:n.treatment_plans,footer:function(){return ua(n)},pagination:!1,key:n.id}))})),m.a.createElement(L.a,{loaderFunction:function(){return e.loadTreatmentPlans(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Treatment Notes To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})))}}]),t}(m.a.Component);function ua(e){return e?m.a.createElement("div",null,e.doctor?m.a.createElement(y.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"Completed by  "+e.doctor.user.first_name," ")):null,e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null):null}function da(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ma(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?da(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):da(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var pa=At.a.TabPane,ha=0,fa=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).addInstructions=function(e,t){a.setState((function(a){return{addInstructions:ma({},a.addInstructions,Object(w.a)({},e,!!t))}}))},a.changeDurationUnits=function(e,t){a.setState((function(a){return{changeDurationUnits:ma({},a.changeDurationUnits,Object(w.a)({},e,!!t))}}))},a.removeDrug=function(e){a.setState((function(t){return{formDrugList:Object(D.a)(Object(st.remove)(t.formDrugList,(function(t){return t._id!=e})))}}))},a.removeLabs=function(e,t){a.setState((function(a){return{addedLabs:ma({},a.addedLabs,Object(w.a)({},t.id,!1)),formLabList:Object(D.a)(Object(st.remove)(a.formLabList,(function(t){return t._id!=e})))}}))},a.addLabs=function(e){a.setState((function(t){var a=Math.random().toFixed(7);return console.log("LAb state",t),t.addedLabs[e.id]?(Object(F.a)(N.bc,"Item Already Added"),!1):{addedLabs:ma({},t.addedLabs,Object(w.a)({},e.id,!0)),formLabList:[].concat(Object(D.a)(t.formLabList),[ma({},e,{_id:a})])}}))},a.addTemplate=function(e){a.setState((function(t){Math.random().toFixed(7);if(t.addTemplate[e.id])return Object(F.a)(N.bc,"Item Already Added"),!1;var a=Object(D.a)(t.formLabList),n=ma({},t.addedLabs);e.labs&&e.labs.forEach((function(e){var t=Math.random().toFixed(7);a.push(ma({},e,{_id:t})),n=ma({},n,Object(w.a)({},e.id,!0))}));var i=Object(D.a)(t.formDrugList),r=ma({},t.addedDrugs);return e.drugs&&e.drugs.forEach((function(t){var a=Math.random().toFixed(7);i.push(ma({},t,{_id:a,advice_data:e.advice_data})),r=ma({},r,Object(w.a)({},t.id,!0))})),{addedLabs:n,formLabList:a,addedDrugs:r,formDrugList:i}}))},a.removeTemplates=function(e,t){a.setState((function(a){return{addTemplate:ma({},a.addTemplate,Object(w.a)({},t.id,!1)),formTemplateList:Object(D.a)(Object(st.remove)(a.formTemplateList,(function(t){return t._id!=e})))}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(console.log("value form",a),!e){var n=ma({},a,{drug:[],labs:[],advice_data:[],patient:t.props.match.params.id,practice:t.props.active_practiceId});t.state.formDrugList.forEach((function(e){console.log("advice search",e),e.dosage=a.does[e._id],e.duration_type=a.duration_unit[e._id],e.duration=a.duration[e._id],e.frequency=a.does_frequency[e._id],a.instruction&&(e.instruction=a.instruction[e._id]),a.food_time[e._id]?(e.after_food=!0,e.before_food=!1):(e.before_food=!0,e.after_food=!1),e.advice_data&&e.advice_data.map((function(e){n.advice_data.push(e.id)}));var i={inventory:e.id,name:e.name,dosage:e.dosage,frequency:e.frequency,duration:e.duration,duration_type:e.duration_type,instruction:e.instruction,before_food:e.before_food,after_food:e.after_food,advice_data:t.state.prescriptionTemplate.advice_data,is_active:!0};n.drug.push(i)})),t.state.formLabList.forEach((function(e){n.labs.push(e.id)}));console.log("final",n),Object(F.j)(Object(F.f)(A.Ic,[t.props.active_practiceId]),n,(function(e){t.props.history.goBack()}),(function(){}))}}))},a.handleAddFields=function(){var e=a.props.form,t=e.getFieldValue("keys").concat(ha++);e.setFieldsValue({keys:t})},a.remove=function(e){var t=a.props.form,n=t.getFieldValue("keys");1!==n.length&&t.setFieldsValue({keys:n.filter((function(t){return t!==e}))})},a.onChange=function(e){a.setState({})},a.searchValues=function(e,t){var n=Object(o.a)(a);a.setState((function(a){var n=ma({},a.searchStrings);return n[e]=t,{searchStrings:n}}),(function(){"Drugs"==e?n.loadDrugList():n.filterValues(e)}))},a.filterValues=function(e){a.setState((function(t){var a=[];return t.items[e]&&(t.searchStrings[e]?t.items[e].forEach((function(n){n.name&&n.name.toString().toLowerCase().includes(t.searchStrings[e].toLowerCase())&&a.push(n)})):a=t.items[e]),{filteredItems:ma({},t.filteredItems,Object(w.a)({},e,a))}}))},a.state={items:{},filteredItems:{},drugList:[],labList:[],formDrugList:[],formLabList:[],addInstructions:{},changeDurationUnits:{},addedDrugs:{},addedLabs:{},addTemplate:{},formTemplateList:[],searchStrings:{}},a.loadPrescriptionTemplate=a.loadPrescriptionTemplate.bind(Object(o.a)(a)),a.deletePrescriptionTemplate=a.deletePrescriptionTemplate.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadDrugList(),this.loadLabList(),this.loadPrescriptionTemplate()}},{key:"loadPrescriptionTemplate",value:function(){var e=this;console.log("template",e.state.prescriptionTemplate),Object(F.c)(Object(F.f)(A.Ic,[e.props.active_practiceId]),(function(t){e.setState({prescriptionTemplate:t.results})}),(function(){}))}},{key:"loadLabList",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Fb,[e.props.active_practiceId]),(function(t){e.setState({labList:t.results})}),(function(){}))}},{key:"loadDrugList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=function(e){t.setState((function(t){var a=ma({},t.items);return{items:ma({},a,{Drugs:e.results}),filteredItems:ma({},t.filteredItems,{Drugs:e.results})}}))},n=function(){},i={practice:this.props.active_practiceId,item_type:Y.z,page:e};t.state.searchStrings.Drugs&&(i.item_name=t.state.searchStrings.Drugs),Object(F.c)(A.xb,a,n,i)}},{key:"addDrug",value:function(e){this.setState((function(t){var a=Math.random().toFixed(7);return t.addedDrugs[e.id]?(Object(F.a)(N.bc,"Item Already Added"),!1):{addedDrugs:ma({},t.addedDrugs,Object(w.a)({},e.id,!0)),formDrugList:[].concat(Object(D.a)(t.formDrugList),[ma({},e,{_id:a})])}}))}},{key:"deletePrescriptionTemplate",value:function(e){var t=this,a={id:e,is_active:!1};Object(F.j)(Object(F.f)(A.Ic,[t.props.active_practiceId]),a,(function(e){t.loadPrescriptionTemplate()}),(function(){}))}},{key:"render",value:function(){var e=this,a=this,n={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:12}}},i={wrapperCol:{xs:{span:24,offset:0},sm:{span:12,offset:4}}},r=this.props.form,l=r.getFieldDecorator,c=r.getFieldValue;r.getFieldsValue;l("keys",{initialValue:[]});var o=c("keys"),s=o.map((function(t,a){return m.a.createElement(I.a.Item,Object.assign({},0===a?n:i,{label:0===a?"Advice":"",required:!1,key:t}),l("advice_data[".concat(t,"]"),{validateTrigger:["onChange","onBlur"]})(m.a.createElement(T.a,{style:{width:"60%",marginRight:8}})),o.length>1?m.a.createElement(k.a,{className:"dynamic-delete-button",type:"minus-circle-o",onClick:function(){return e.remove(t)}}):null)})),u=[{title:"Drug Name",dataIndex:"name",key:"name",render:function(e){return m.a.createElement("h2",null,e)}},{title:"Dosage & Frequency",dataIndex:"dosage",key:"dosage",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(I.a.Item,{extra:m.a.createElement("span",null,"does(s)"),key:"does[".concat(a._id,"]")},l("does[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"]},{rules:[{message:"This field is required."}]})(m.a.createElement(C.a,{min:0,size:"small"}))),m.a.createElement(I.a.Item,{key:"does_frequency[".concat(a._id,"]")},l("does_frequency[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:"twice daily"})(m.a.createElement(x.a,{size:"small",onChange:function(){return e.changeDurationUnits(a._id,!1)}},Y.y.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))))}},{title:"Duration",dataIndex:"duration",key:"duration",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(I.a.Item,{key:"duration[".concat(a._id,"]")},l("duration[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"]},{rules:[{message:"This field is required."}]})(m.a.createElement(C.a,{min:0,size:"small"}))),m.a.createElement(I.a.Item,{key:"duration_unit[".concat(a._id,"]")},l("duration_unit[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:"day(s)"})(m.a.createElement(x.a,{size:"small",onChange:function(){return e.changeDurationUnits(a._id,!1)}},Y.A.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))))}},{title:"Instructions",dataIndex:"instruction",key:"instruction",render:function(t,a){return m.a.createElement("div",null,e.state.addInstructions[a._id]?m.a.createElement(I.a.Item,{extra:m.a.createElement("a",{onClick:function(){return e.addInstructions(a._id,!1)}},"Remove Instructions"),key:"instruction[".concat(a._id,"]")},l("instruction[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}]})(m.a.createElement(T.a.TextArea,{min:0,placeholder:"Instructions...",size:"small"}))):m.a.createElement("a",{onClick:function(){return e.addInstructions(a._id,!0)}},"+ Add Instructions"))}},{title:"Timing",dataIndex:"food_time",key:"food_time",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(I.a.Item,{key:"food_time[".concat(a._id,"]")},l("food_time[".concat(a._id,"]"))(m.a.createElement(S.a.Group,{onChange:e.onChange},m.a.createElement(S.a,{value:1},"After Food"),m.a.createElement(S.a,{value:0},"Before Food")))))}},{title:"",dataIndex:"action",key:"action",render:function(t,a){return m.a.createElement(I.a.Item,null,m.a.createElement(_.a,{icon:"close",onClick:function(){return e.removeDrug(a._id)},type:"danger",shape:"circle",size:"small"}))}}],d=[{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return m.a.createElement("span",null,m.a.createElement("b",null,e))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(e,t){return m.a.createElement("span",null,t.cost)}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement(_.a,{icon:"close",onClick:function(){return e.removeLabs(a._id,a)},type:"danger",shape:"circle",size:"small"}))}}];return m.a.createElement(j.a,{title:"Prescriptions Template"},m.a.createElement(h.a,null,m.a.createElement(g.a,{span:18},m.a.createElement(I.a,{onSubmit:this.handleSubmit},m.a.createElement(I.a.Item,Object.assign({},n,{label:"Template Name"}),l("name",{})(m.a.createElement(T.a,null))),m.a.createElement(I.a.Item,Object.assign({},n,{label:"Schedule"}),l("schedule",{})(m.a.createElement(C.a,{min:1}))),m.a.createElement(je.a,{pagination:!1,bordered:!1,columns:u,dataSource:this.state.formDrugList}),m.a.createElement(v.a,null," Lab Test"),m.a.createElement(je.a,{pagination:!1,bordered:!1,columns:d,dataSource:this.state.formLabList}),m.a.createElement(v.a,null),s,m.a.createElement(I.a.Item,i,m.a.createElement(_.a,{type:"dashed",onClick:this.handleAddFields,style:{width:"60%"}},m.a.createElement(k.a,{type:"plus"})," Add advice field")),m.a.createElement(Je.a,{target:function(){return e.container}},m.a.createElement(_.a,{type:"primary",htmlType:"submit"},"Save")))),m.a.createElement(g.a,{span:6},m.a.createElement(At.a,{type:"card"},m.a.createElement(pa,{tab:"Drugs",key:"1"},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(T.a.Search,{key:"Drugs",placeholder:"Search in Medicine...",onChange:function(t){return e.searchValues("Drugs",t.target.value)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.filteredItems.Drugs,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.addDrug(t)},actions:t.maintain_inventory?null:[m.a.createElement(y.a,null,"Not Sold")]},m.a.createElement(b.a.Item.Meta,{title:t.name}))}})),m.a.createElement(pa,{tab:"Labs",key:"2"},m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.labList,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.addLabs(t)}},m.a.createElement(b.a.Item.Meta,{title:t.name}))}})),m.a.createElement(pa,{tab:"Template",key:"3"},m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.prescriptionTemplate,renderItem:function(t){return m.a.createElement(b.a.Item,{onConfirm:function(){return a.deletePrescriptionTemplate(t.id)}},m.a.createElement(b.a.Item.Meta,{onClick:function(){return e.addTemplate(t)},title:t.name}),m.a.createElement(E.a,{title:"Are you sure delete this item?",onConfirm:function(){return a.deletePrescriptionTemplate(t.id)},okText:"Yes",cancelText:"No"},m.a.createElement("a",null,"Delete")))}})))),m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/prescriptions/template/add",renderRoute:function(a){return m.a.createElement(t,Object.assign({},e.state,a))}}))))}}]),t}(m.a.Component),ba=I.a.create()(fa);function ya(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ga(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ya(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ya(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Ea=At.a.TabPane,va=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).selectDoctor=function(e){a.setState({selectedDoctor:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.addInstructions=function(e,t){a.setState((function(a){return{addInstructions:ga({},a.addInstructions,Object(w.a)({},e,!!t))}}))},a.changeDurationUnits=function(e,t){a.setState((function(a){return{changeDurationUnits:ga({},a.changeDurationUnits,Object(w.a)({},e,!!t))}}))},a.removeDrug=function(e){a.setState((function(t){return{formDrugList:Object(D.a)(Object(st.remove)(t.formDrugList,(function(t){return t._id!=e})))}}))},a.removeLabs=function(e,t){a.setState((function(a){return{addedLabs:ga({},a.addedLabs,Object(w.a)({},t.id,!1)),formLabList:Object(D.a)(Object(st.remove)(a.formLabList,(function(t){return t._id!=e})))}}))},a.addLabs=function(e){a.setState((function(t){var a=Math.random().toFixed(7);return t.addedLabs[e.id]?(Object(F.a)(N.bc,"Item Already Added"),!1):{addedLabs:ga({},t.addedLabs,Object(w.a)({},e.id,!0)),formLabList:[].concat(Object(D.a)(t.formLabList),[ga({},e,{_id:a})])}}))},a.addTemplate=function(e){a.setState((function(t){if(t.addTemplate[e.id])return Object(F.a)(N.bc,"Item Already Added"),!1;var a=Object(D.a)(t.formLabList),n=ga({},t.addedLabs);e.labs.forEach((function(e){var t=Math.random().toFixed(7);a.push(ga({},e,{_id:t})),n=ga({},n,Object(w.a)({},e.id,!0))}));var i=Object(D.a)(t.formDrugList),r=ga({},t.addedDrugs);return e.drugs.forEach((function(t){var a=Math.random().toFixed(7);i.push(ga({},t,{_id:a,advice_data:e.advice_data})),n=ga({},r,Object(w.a)({},t.id,!0))})),{addedLabs:n,formLabList:a,addedDrugs:r,formDrugList:i}}))},a.removeTemplates=function(e,t){a.setState((function(a){return{addTemplate:ga({},a.addTemplate,Object(w.a)({},t.id,!1)),formTemplateList:Object(D.a)(Object(st.remove)(a.formTemplateList,(function(t){return t._id!=e})))}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(!e){var n={drugs:[],labs:[],patient:parseInt(t.props.match.params.id),practice:t.props.active_practiceId,doctor:t.state.selectedDoctor?t.state.selectedDoctor.id:null,date:t.state.selectedDate?t.state.selectedDate.format("YYYY-MM-DD"):null,advice_data:[]};t.props.editId&&(n.id=t.props.editId),t.state.formDrugList.forEach((function(e){e.dosage=a.dosage[e._id],e.duration_type=a.duration_type[e._id],e.duration=a.duration[e._id],e.frequency=a.frequency[e._id],a.instruction&&(e.instruction=a.instruction[e._id]),a.food_time[e._id]?(e.after_food=!0,e.before_food=!1):(e.before_food=!0,e.after_food=!1);var t={inventory:e.id,name:e.name,dosage:e.dosage,frequency:e.frequency,duration_type:e.duration_type,duration:e.duration,instruction:e.instruction,before_food:e.before_food,after_food:e.after_food,is_active:!0};n.drugs.push(t)})),t.state.formLabList.forEach((function(e){n.labs.push(e.id)}));Object(F.j)(Object(F.f)(A.Gc,[t.props.match.params.id]),n,(function(e){t.props.loadData&&t.props.loadData();var a="/patient/"+t.props.match.params.id+"/emr/prescriptions";t.props.history.replace(a)}),(function(){}))}}))},a.onChange=function(e){a.setState({})},a.searchValues=function(e,t){var n=Object(o.a)(a);a.setState((function(a){var n=ga({},a.searchStrings);return n[e]=t,{searchStrings:n}}),(function(){"Drugs"==e?n.loadDrugList():n.filterValues(e)}))},a.filterValues=function(e){a.setState((function(t){var a=[];return t.items[e]&&(t.searchStrings[e]?t.items[e].forEach((function(n){n.name&&n.name.toString().toLowerCase().includes(t.searchStrings[e].toLowerCase())&&a.push(n)})):a=t.items[e]),{filteredItems:ga({},t.filteredItems,Object(w.a)({},e,a))}}))},a.state={items:{},filteredItems:{},formDrugList:[],formLabList:[],addInstructions:{},changeDurationUnits:{},addedDrugs:{},addedLabs:{},addTemplate:{},formTemplateList:[],practiceDoctors:[],selectedDoctor:{},selectedDate:G()(),searchStrings:{}},a.loadPrescriptionTemplate=a.loadPrescriptionTemplate.bind(Object(o.a)(a)),a.deletePrescriptionTemplate=a.deletePrescriptionTemplate.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.loadDrugList(),this.loadLabList(),this.loadPrescriptionTemplate(),Object(de.d)(this),this.props.editId&&this.setState((function(t){var a=[],n={},i={};e.props.editPrescription.drugs.forEach((function(e){var t=Math.random();a.push(ga({},e,{_id:t,food_time:e.after_food?1:0})),n[t]=!!e.instruction}));var r=[];return e.props.editPrescription.labs.forEach((function(e){r.push(ga({},e,{_id:Math.random()})),i[e.id]=!0})),ga({},e.props.editPrescription,{formDrugList:[].concat(a),formLabList:[].concat(r),addInstructions:ga({},n),addedLabs:ga({},i),selectedDoctor:e.props.editPrescription.doctor,selectedDate:G()(e.props.editPrescription.date).isValid()?G()(e.props.editPrescription.date):G()()})}))}},{key:"loadPrescriptionTemplate",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Ic,[e.props.active_practiceId]),(function(t){e.setState((function(e){var a=ga({},e.items);return{items:ga({},a,{Template:t.results}),filteredItems:ga({},e.filteredItems,{Template:t.results})}}))}),(function(){}))}},{key:"loadLabList",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Fb,[e.props.active_practiceId]),(function(t){e.setState((function(e){var a=ga({},e.items);return{items:ga({},a,{Labs:t.results}),filteredItems:ga({},e.filteredItems,{Labs:t.results})}}))}),(function(){}))}},{key:"loadDrugList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=t.state.searchStrings.Drugs,n=function(e){a==t.state.searchStrings.Drugs&&t.setState((function(t){var a=ga({},t.items);return{items:ga({},a,{Drugs:e.results}),filteredItems:ga({},t.filteredItems,{Drugs:e.results})}}))},i=function(){},r={practice:this.props.active_practiceId,item_type:Y.z,page:e};a&&(r.item_name=a),Object(F.c)(A.xb,n,i,r)}},{key:"addDrug",value:function(e){this.setState((function(t){var a=Math.random().toFixed(7);return{addedDrugs:ga({},t.addedDrugs,Object(w.a)({},e.id,!0)),formDrugList:[ga({},e,{_id:a})].concat(Object(D.a)(t.formDrugList))}}))}},{key:"deletePrescriptionTemplate",value:function(e){var t=this,a={id:e,is_active:!1};Object(F.j)(Object(F.f)(A.Ic,[t.props.active_practiceId]),a,(function(e){t.loadPrescriptionTemplate()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,n=a.getFieldDecorator,i=(a.getFieldValue,a.getFieldsValue,[{title:"Medicine Name",dataIndex:"name",key:"name",render:function(e){return m.a.createElement("h2",null,e)}},{title:"Dosage & Frequency",dataIndex:"dosage",key:"dosage",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(I.a.Item,{extra:m.a.createElement("span",null,"does(s)"),key:"dosage[".concat(a._id,"]")},n("dosage[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.dosage,min:0})(m.a.createElement(C.a,{size:"small"}))),m.a.createElement(I.a.Item,{key:"frequency[".concat(a._id,"]")},n("frequency[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.frequency||Y.y[0].value})(m.a.createElement(x.a,{size:"small",onChange:function(){return e.changeDurationUnits(a._id,!1)}},Y.y.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))))}},{title:"Duration",dataIndex:"duration",key:"duration",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(I.a.Item,{key:"duration[".concat(a._id,"]")},n("duration[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.duration,min:0})(m.a.createElement(C.a,{size:"small"}))),m.a.createElement(I.a.Item,{key:"duration_type[".concat(a._id,"]")},n("duration_type[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.duration_type||Y.A[0].value})(m.a.createElement(x.a,{size:"small",onChange:function(){return e.changeDurationUnits(a._id,!1)}},Y.A.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))))}},{title:"Instructions",dataIndex:"instruction",key:"instruction",render:function(t,a){return m.a.createElement("div",null,e.state.addInstructions[a._id]?m.a.createElement(I.a.Item,{extra:m.a.createElement("a",{onClick:function(){return e.addInstructions(a._id,!1)}},"Remove Instructions"),key:"instruction[".concat(a._id,"]")},n("instruction[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.instruction})(m.a.createElement(T.a.TextArea,{placeholder:"Instructions...",size:"small"}))):m.a.createElement("a",{onClick:function(){return e.addInstructions(a._id,!0)}},"+ Add Instructions"))}},{title:"Timing",dataIndex:"food_time",key:"food_time",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(I.a.Item,{key:"food_time[".concat(a._id,"]")},n("food_time[".concat(a._id,"]"),{initialValue:a.food_time||0})(m.a.createElement(S.a.Group,{onChange:e.onChange},m.a.createElement(S.a,{value:1},"after"),m.a.createElement(S.a,{value:0},"before")))))}},{title:"",dataIndex:"action",key:"action",render:function(t,a){return m.a.createElement(I.a.Item,null,m.a.createElement(_.a,{icon:"close",onClick:function(){return e.removeDrug(a._id)},type:"danger",shape:"circle",size:"small"}))}}]),r=[{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return m.a.createElement("span",null,m.a.createElement("b",null,e))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(e,t){return m.a.createElement("span",null,t.cost)}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement(_.a,{icon:"close",onClick:function(){return e.removeLabs(a._id,a)},type:"danger",shape:"circle",size:"small"}))}}];return m.a.createElement(j.a,{title:"Prescriptions"},m.a.createElement(h.a,null,m.a.createElement(g.a,{span:18},m.a.createElement(I.a,{onSubmit:this.handleSubmit},m.a.createElement(je.a,{pagination:!1,bordered:!1,columns:i,dataSource:this.state.formDrugList}),m.a.createElement(v.a,null," Lab Test"),m.a.createElement(je.a,{pagination:!1,bordered:!1,columns:r,dataSource:this.state.formLabList}),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(ht.a,{placement:"topCenter",overlay:m.a.createElement(Se.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Se.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(M.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement(_.a,{type:"primary",htmlType:"submit",style:{margin:5,float:"right"}},"Save"),t.props.history?m.a.createElement(_.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null)))),m.a.createElement(g.a,{span:6},m.a.createElement(At.a,{type:"card"},m.a.createElement(Ea,{tab:"Medicine",key:"1"},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(T.a.Search,{key:"Drugs",placeholder:"Search in Medicine...",onChange:function(t){return e.searchValues("Drugs",t.target.value)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.filteredItems.Drugs,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.addDrug(t)},actions:t.maintain_inventory?null:[m.a.createElement(y.a,null,"Not Sold")]},m.a.createElement(b.a.Item.Meta,{title:t.name}))}})),m.a.createElement(Ea,{tab:"Labs",key:"2"},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(T.a.Search,{key:"Labs",placeholder:"Search in Labs...",onChange:function(t){return e.searchValues("Labs",t.target.value)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.filteredItems.Labs,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.addLabs(t)}},m.a.createElement(b.a.Item.Meta,{title:t.name}))}})),m.a.createElement(Ea,{tab:"Template",key:"3"},m.a.createElement("div",null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/prescriptions/template/add"},m.a.createElement(_.a,{type:"primary",block:!0,size:"small"},m.a.createElement(k.a,{type:"plus"}),"\xa0Add Template"))),m.a.createElement(v.a,{style:{margin:0}}),m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(T.a.Search,{key:"Template",placeholder:"Search in Template...",onChange:function(t){return e.searchValues("Template",t.target.value)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.filteredItems.Template,renderItem:function(a){return m.a.createElement(b.a.Item,{onConfirm:function(){return t.deletePrescriptionTemplate(a.id)}},m.a.createElement(b.a.Item.Meta,{onClick:function(){return e.addTemplate(a)},title:a.name}),m.a.createElement(E.a,{title:"Are you sure delete this item?",onConfirm:function(){return t.deletePrescriptionTemplate(a.id)},okText:"Yes",cancelText:"No"},m.a.createElement("a",null,"Delete")))}})))),m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/prescriptions/template/add",render:function(t){return m.a.createElement(ba,Object.assign({},e.state,t))}}))))}}]),t}(m.a.Component),_a=I.a.create()(va),Oa=f.a.confirm,Pa=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).updateFormValue=function(e,t){a.setState(Object(w.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:st.get(e,"patient.user.first_name"),prescriptionId:st.get(e,"id"),mail_to:st.get(e,"patient.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.prescriptionId,i={mail_to:t};Object(de.g)(Object(F.f)(A.Hd,[n]),i),a.mailModalClose()},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,prescription:[],drug_catalog:null,editPrescription:null,loading:!0},a.loadPrescriptions=a.loadPrescriptions.bind(Object(o.a)(a)),a.loadDrugCatalog=a.loadDrugCatalog.bind(Object(o.a)(a)),a.editPrescriptionData=a.editPrescriptionData.bind(Object(o.a)(a)),a.deletePrescriptions=a.deletePrescriptions.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadPrescriptions(),this.loadDrugCatalog()}},{key:"loadPrescriptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;this.setState({loading:!0});var a=function(e){t.setState({prescription:e.results,nextPrescriptionPage:e.next,loading:!1})},n=function(){t.setState({loading:!1})},i={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(i.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete i.practice,Object(F.c)(A.Gc,a,n,i)}},{key:"loadPDF",value:function(e){Object(F.c)(Object(F.f)(A.Hc,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))}},{key:"loadDrugCatalog",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Z,[this.props.active_practiceId]),(function(t){e.setState({drug_catalog:t})}),(function(){e.setState({})}))}},{key:"editPrescriptionData",value:function(e){var t=this;this.setState({editPrescription:e},(function(){t.props.history.push("/patient/"+e.patient+"/emr/prescriptions/edit")}))}},{key:"deletePrescriptions",value:function(e){var t=this;Oa({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a={id:e.id,patient:e.patient,is_active:!1};Object(F.j)(Object(F.f)(A.Gc,[t.props.match.params.id]),a,(function(e){t.loadPrescriptions()}),(function(){}))},onCancel:function(){console.log("Cancel")}})}},{key:"render",value:function(){var e=this,t={};this.state.drug_catalog&&this.state.drug_catalog.forEach((function(e){t[e.id]=e.name+","+e.strength}));var a=this,i=[{title:"Drug",key:"name",dataIndex:"name"},{title:"Frequency",dataIndex:"frequency",key:"frequency",render:function(e,t){return m.a.createElement("span",null,t.dosage,"\xa0",t.frequency)}},{title:"Duration",dataIndex:"duration",key:"duration",render:function(e,t){return m.a.createElement("span",null,e,"\xa0",t.duration_type)}},{title:"Instruction",dataIndex:"instruction",key:"instruction",render:function(e,t){return m.a.createElement("span",null,t.before_food?m.a.createElement(y.a,null,"before food "):null,t.after_food?m.a.createElement(y.a,null,"after food"):null,e)}}];return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/prescriptions/add",render:function(t){return m.a.createElement(_a,Object.assign({},e.state,e.props,{loadData:e.loadPrescriptions},t))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/prescriptions/edit",render:function(t){return a.state.editPrescription?m.a.createElement(_a,Object.assign({},e.state,t,e.props,{loadData:e.loadPrescriptions,editId:a.state.editPrescription.id})):m.a.createElement(p.a,{to:"/patient/"+a.props.match.params.id+"/emr/prescriptions"})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Prescriptions":"Prescriptions",extra:m.a.createElement(_.a.Group,{style:{float:"right"}},m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/prescriptions/add"},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"Add")))}),this.state.prescription.map((function(t){return m.a.createElement("div",null,m.a.createElement(j.a,{style:{marginTop:10},bodyStyle:{padding:0},title:m.a.createElement("small",null,t.date?G()(t.date).format("ll"):null),extra:m.a.createElement(ht.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Se.a,null,m.a.createElement(Se.a.Item,{key:"1",onClick:function(){return a.editPrescriptionData(t)},disabled:t.practice&&t.practice.id!=a.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Se.a.Item,{key:"2",onClick:function(){return a.deletePrescriptions(t)},disabled:t.practice&&t.practice.id!=a.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+t.patient+"/emr/timeline"},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(t)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(t.id)}},m.a.createElement(k.a,{type:"printer"})))},m.a.createElement(f.a,{title:null,visible:e.state.visibleMail,onOk:e.sendMailToPatient,onCancel:e.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:e.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:e.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Prescription  To ",e.state.patientName," ?"),m.a.createElement(T.a,{value:e.state.mail_to,placeholder:"Email",onChange:function(e){return a.updateFormValue("mail_to",e.target.value)}})),m.a.createElement(je.a,{columns:i,dataSource:t.drugs,pagination:!1,footer:function(){return ka(t)},key:t.id})))})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,null)),m.a.createElement(L.a,{loading:this.state.loading,loaderFunction:function(){return e.loadPrescriptions(e.state.nextPrescriptionPage)},hidden:!this.state.nextPrescriptionPage}))))):m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Prescriptions":"Prescriptions",extra:m.a.createElement(_.a.Group,{style:{float:"right"}},m.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))}),this.state.prescription.map((function(t){return m.a.createElement("div",{key:t.id},m.a.createElement(j.a,{style:{marginTop:10},bodyStyle:{padding:0},title:m.a.createElement("small",null,t.date?G()(t.date).format("ll"):null,m.a.createElement(le.b,{to:"/patient/"+t.patient.id+"/emr/prescriptions"},"\xa0\xa0 ",t.patient.user?t.patient.user.first_name:null," (ID: ",t.patient.custom_id?t.patient.custom_id:t.patient.id,")\xa0"),m.a.createElement("span",null,", ",t.patient.gender)),extra:m.a.createElement(ht.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Se.a,null,m.a.createElement(Se.a.Item,{key:"1",onClick:function(){return a.editPrescriptionData(t)},disabled:t.practice&&t.practice.id!=a.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Se.a.Item,{key:"2",onClick:function(){return a.deletePrescriptions(t)},disabled:t.practice&&t.practice.id!=a.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+t.patient+"/emr/timeline"},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(t)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(t.id)}},m.a.createElement(k.a,{type:"printer"})))},m.a.createElement(je.a,{columns:i,dataSource:t.drugs,pagination:!1,footer:function(){return ka(t)},key:t.id})))})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,null)),m.a.createElement(L.a,{loading:this.state.loading,loaderFunction:function(){return e.loadPrescriptions(e.state.nextPrescriptionPage)},hidden:!this.state.nextPrescriptionPage}),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Prescription To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return a.updateFormValue("mail_to",e.target.value)}})))}}]),t}(m.a.Component);function ka(e){return e?m.a.createElement("div",null,e.doctor?m.a.createElement(we.a,{title:"Doctor"},m.a.createElement(y.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+e.doctor.user.first_name," "))):null,e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null,e.labs.length?m.a.createElement("div",null,"+",e.labs.length,"\xa0Lab Orders"):null):null}function ja(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ca(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ja(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ja(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Sa=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).calculateItem=function(e){a.props.form.getFieldsValue;a.setState((function(e){Object(D.a)(e.tableFormValues).forEach((function(e){}))}))},a.addNotes=function(e,t){a.setState((function(a){return{addNotes:Ca({},a.addNotes,Object(w.a)({},e,!!t))}}))},a.removeTreatment=function(e){a.setState((function(t){return{tableFormValues:Object(D.a)(Object(st.remove)(t.tableFormValues,(function(t){return t._id!=e})))}}))},a.add=function(e){Object(o.a)(a);a.setState((function(t){var a=Math.random().toFixed(7);return{addNotes:Ca({},t.addNotes,Object(w.a)({},a,!!e.default_notes)),tableFormValues:[Ca({},e,{_id:a})].concat(Object(D.a)(t.tableFormValues))}}),(function(){}))},a.selectDoctor=function(e){a.setState({selectedDoctor:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(!e){var n={treatment_plans:[],patient:t.props.match.params.id,doctor:t.state.selectedDoctor.id,date:t.state.selectedDate&&G()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null,practice:t.props.active_practiceId};t.props.editId&&(n.id=t.props.editTreatmentPlan.id),t.state.tableFormValues.forEach((function(e){e.quantity=a.quantity[e._id],e.cost=a.cost[e._id],e.discount=a.discount[e._id],a.notes&&(e.notes=a.notes[e._id]);var t={procedure:e.id,cost:e.cost,quantity:e.quantity,margin:e.margin,default_notes:e.default_notes,is_active:!0,is_completed:e.is_completed||!1,discount:e.discount,discount_type:"%"};n.treatment_plans.push(t)}));Object(F.j)(Object(F.f)(A.Fd,[t.props.match.params.id]),n,(function(e){Object(F.a)("Inventory updated successfully"),t.props.loadData&&t.props.loadData();var a="/patient/"+t.props.match.params.id+"/emr/plans";t.props.history.replace(a)}),(function(){}))}}))},a.searchValues=function(e){var t=Object(o.a)(a);return a.setState((function(t){return{searchString:e}}),(function(){t.loadProcedures()})),!1},a.state={loadingProcedures:!0,procedure_category:[],tableFormValues:[],addNotes:{},practiceDoctors:[],selectedDoctor:{},selectedDate:G()()},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.editId&&this.setState((function(e){var t=[];return this.props.editTreatmentPlan.treatment_plans.forEach((function(e){var a=Math.random().toFixed(7);t.push(Ca({},e,{},e.procedure,{_id:a}))})),Ca({},this.props.editTreatmentPlan,{tableFormValues:t,selectedDate:G()(this.props.editTreatmentPlan.date),selectedDoctor:this.props.editTreatmentPlan.doctor})})),this.loadProcedures(),Object(de.d)(this)}},{key:"loadProcedures",value:function(){var e=this,t={};this.state.searchString&&(t.name=this.state.searchString),e.setState({loadingProcedures:!0});Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),(function(a){t.name&&e.state.searchString!=t.name||e.setState({loadingProcedures:!1,filteredItems:a.results})}),(function(){e.setState({loadingProcedures:!1})}),t)}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,n=a.getFieldDecorator,i=(a.getFieldValue,a.getFieldsValue,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}}),r=[{title:"Treatments",dataIndex:"name",key:"name",render:function(t,a){return m.a.createElement("span",null,m.a.createElement("b",null,t),m.a.createElement("br",null),e.state.addNotes[a._id]?m.a.createElement(I.a.Item,Object.assign({key:"default_notes[".concat(a._id,"]")},i),n("default_notes[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.default_notes})(m.a.createElement(T.a.TextArea,{min:0,placeholder:"Notes..."}))):m.a.createElement("a",{onClick:function(){return e.addNotes(a._id,!0)}},"+ Add Note"))}},{title:"Quantity",dataIndex:"quantity",key:"quantity",render:function(t,a){return m.a.createElement(I.a.Item,Object.assign({key:"quantity[".concat(a._id,"]")},i),n("quantity[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:1})(m.a.createElement(C.a,{min:0,placeholder:"Quantity",size:"small",onChange:function(){return e.calculateItem(a._id)}})))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(t,a){return m.a.createElement(I.a.Item,Object.assign({key:"cost[".concat(a._id,"]")},i),n("cost[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:a.cost})(m.a.createElement(C.a,{min:0,placeholder:"Cost",size:"small",onChange:function(){return e.calculateItem(a._id)}})))}},{title:"Discount",dataIndex:"discount",key:"discount",render:function(t,a){return m.a.createElement(I.a.Item,Object.assign({key:"discount[".concat(a._id,"]")},i),n("discount[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}]})(m.a.createElement(C.a,{min:0,placeholder:"Discount",size:"small",onChange:function(){return e.calculateItem(a._id)}}))," %")}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement(_.a,{icon:"close",onClick:function(){return e.removeTreatment(a._id)},type:"danger",shape:"circle",size:"small"}))}}];return m.a.createElement("div",null,m.a.createElement(j.a,{title:"Treatment Plans"},m.a.createElement(h.a,null,m.a.createElement(g.a,{span:17},m.a.createElement(I.a,{onSubmit:this.handleSubmit},m.a.createElement(je.a,{pagination:!1,bordered:!0,dataSource:this.state.tableFormValues,columns:r}),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(ht.a,{placement:"topCenter",overlay:m.a.createElement(Se.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Se.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(M.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement(I.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0,float:"right"}}),m.a.createElement(_.a,{type:"primary",htmlType:"submit",style:{margin:5}},"Save Treatment Plan"),t.props.history?m.a.createElement(_.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null))),m.a.createElement("div",{ref:function(e){t.bottomPoint=e}}))),m.a.createElement(g.a,{span:7},m.a.createElement(Je.a,{offsetTop:0},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(T.a.Search,{placeholder:"Search in plans ...",onChange:function(t){return e.searchValues(t.target.value)}})),m.a.createElement(b.a,{size:"small",style:{maxHeight:"100vh",overflowX:"scroll"},itemLayout:"horizontal",dataSource:this.state.filteredItems,loading:this.state.loadingProcedures,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.add(t)}},m.a.createElement(b.a.Item.Meta,{title:t.name}))}}))))))}}]),t}(m.a.Component),Ia=I.a.create()(Sa);function xa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Da(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?xa(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):xa(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var wa=f.a.confirm,Ma=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).updateFormValue=function(e,t){a.setState(Object(w.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:st.get(e,"patient.user.first_name"),treatmentId:st.get(e,"id"),mail_to:st.get(e,"patient.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.treatmentId,i={mail_to:t};Object(de.g)(Object(F.f)(A.Hd,[n]),i),a.mailModalClose()},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,treatmentPlans:[],procedure_category:null,incompletedTreatmentPlans:[],loading:!0,selectedTreatments:{}},a.loadTreatmentPlans=a.loadTreatmentPlans.bind(Object(o.a)(a)),a.editTreatmentPlanData=a.editTreatmentPlanData.bind(Object(o.a)(a)),a.submitCompleteTreatment=a.submitCompleteTreatment.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadTreatmentPlans()}},{key:"loadTreatmentPlans",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=[],a=this;this.setState({loading:!0});var n=function(e){a.setState((function(t){return 1==e.current?{treatmentPlans:Object(D.a)(e.results),next:e.next,loading:!1}:{treatmentPlans:[].concat(Object(D.a)(t.treatmentPlans),Object(D.a)(e.results)),next:e.next,loading:!1}})),e.results.forEach((function(e){e.is_completed||t.push(e)})),a.setState((function(a){return 1==e.current?{incompletedTreatmentPlans:[].concat(t),loading:!1}:{incompletedTreatmentPlans:[].concat(Object(D.a)(a.incompletedTreatmentPlans),t),loading:!1}}))},i=function(){a.setState({loading:!1})},r={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(r.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete r.practice,Object(F.c)(A.Fd,n,i,r)}},{key:"editTreatmentPlanData",value:function(e){console.log("record",e.id),this.setState({editTreatmentPlan:e,loading:!1});e.patient;this.props.history.push("/patient/"+e.id+"/emr/plans/edit")}},{key:"deleteTreatmentPlans",value:function(e){var t=this;wa({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a={id:e.id,patient:e.patient.id,is_active:!1};Object(F.j)(Object(F.f)(A.Fd,[t.props.match.params.id],null),a,(function(e){t.loadTreatmentPlans(),Object(F.a)(N.Sb,"Treatment Plan Deleted Successfully!")}),(function(){}))},onCancel:function(){console.log("Cancel")}})}},{key:"treatmentCompleteToggle",value:function(e,t){this.setState((function(a){return{selectedTreatments:Da({},a.selectedTreatments,Object(w.a)({},e,!!t))}}))}},{key:"submitCompleteTreatment",value:function(){var e=this,t=this.state.selectedTreatments,a=Object.keys(t),n={treatment:[],patient:e.props.match.params.id};a.forEach((function(e){var a={id:e,is_completed:t[e]};n.treatment.push(a)}));Object(F.j)(Object(F.f)(A.Gd,[this.props.match.params.id]),n,(function(t){e.loadTreatmentPlans(),e.setState({selectedTreatments:{}})}),(function(){}))}},{key:"loadPDF",value:function(e){Object(F.c)(Object(F.f)(A.Hd,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=[{title:"",key:"is_completed",render:function(t,a){return a.is_completed?m.a.createElement(k.a,{type:"check-circle",theme:"twoTone",style:{marginLeft:"8px",fontSize:"20px"}}):m.a.createElement(he.a,{key:a.id,onChange:function(t){return e.treatmentCompleteToggle(a.id,t.target.checked)},value:e.state.selectedTreatments[a.id]})}},{title:"Procedure",dataIndex:"procedure",key:"procedure",render:function(e,t){return m.a.createElement("span",null," ",e.name)}},{title:"Quantity",dataIndex:"quantity",key:"quantity"},{title:"Discount",dataIndex:"discount",key:"discount"},{title:"Cost per  Unit",dataIndex:"cost",key:"cost"},{title:"Notes",dataIndex:"default_notes",key:"default_notes"}];return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/plans/add",render:function(a){return m.a.createElement(Ia,Object.assign({},e.state,a,t.props,{loadData:e.loadTreatmentPlans}))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/plans/edit",render:function(a){return e.state.editTreatmentPlan?m.a.createElement(Ia,Object.assign({},e.state,a,t.props,{loadData:e.loadTreatmentPlans,editId:e.state.editTreatmentPlan.id})):m.a.createElement(p.a,{to:"/patient/"+e.props.match.params.id+"/emr/plans"})}}),m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" TreatmentPlans":"TreatmentPlans",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{onClick:this.submitCompleteTreatment},m.a.createElement(k.a,{type:"save"}),"Save"),m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/plans/add"},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"Add")))}),m.a.createElement(n.a,{spinning:this.state.loading},this.state.treatmentPlans.map((function(n){return m.a.createElement(j.a,{bodyStyle:{padding:0},style:{marginTop:15}},m.a.createElement("div",{style:{padding:16}},m.a.createElement("h4",null,n.date?G()(n.date).format("ll"):null,m.a.createElement(ht.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Se.a,null,m.a.createElement(Se.a.Item,{key:"1",onClick:function(){return t.editTreatmentPlanData(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Se.a.Item,{key:"2",onClick:function(){return t.deleteTreatmentPlans(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+n.patient+"/emr/timeline"},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(n)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},m.a.createElement(k.a,{type:"printer"}))))),m.a.createElement(je.a,{loading:e.state.loading,columns:a,dataSource:n.treatment_plans,footer:function(){return Ta(n)},pagination:!1,key:n.id}))}))),m.a.createElement(L.a,{loaderFunction:function(){return e.loadTreatmentPlans(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Treatment  To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}}))))):m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" TreatmentPlans":"TreatmentPlans",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{onClick:this.submitCompleteTreatment},m.a.createElement(k.a,{type:"save"}),"Save"),m.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))}),m.a.createElement(n.a,{spinning:this.state.loading},this.state.treatmentPlans.map((function(n){return m.a.createElement(j.a,{bodyStyle:{padding:0},key:n.id,style:{marginTop:15}},m.a.createElement("div",{style:{padding:16}},m.a.createElement("h4",null,n.date?G()(n.date).format("ll"):null,m.a.createElement(le.b,{to:"/patient/"+n.patient.id+"/emr/plans"},"\xa0\xa0 ",n.patient.user?n.patient.user.first_name:null," (ID: ",n.patient.custom_id?n.patient.custom_id:n.patient.id,")\xa0"),m.a.createElement("span",null,", ",n.patient.gender),m.a.createElement(ht.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Se.a,null,m.a.createElement(Se.a.Item,{key:"1",disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(le.b,{to:"/patient/"+n.patient.id+"/emr/plans/edit"},m.a.createElement(k.a,{type:"edit"}),"\xa0 Edit")),m.a.createElement(Se.a.Item,{key:"2",onClick:function(){return t.deleteTreatmentPlans(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(k.a,{type:"delete"}),"Delete"),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+n.patient+"/emr/timeline"},m.a.createElement(k.a,{type:"clock-circle"}),"\xa0 Patient Timeline")),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return e.sendPatientMail(n)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},m.a.createElement(k.a,{type:"printer"}))))),m.a.createElement(je.a,{loading:e.state.loading,columns:a,dataSource:n.treatment_plans,footer:function(){return Ta(n)},pagination:!1,key:n.id}))}))),m.a.createElement(L.a,{loaderFunction:function(){return e.loadTreatmentPlans(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Treatment To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:this.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})))}}]),t}(m.a.Component);function Ta(e){return e?m.a.createElement("div",null,e.doctor?m.a.createElement(y.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+e.doctor.user.first_name," ")):null,e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null):null}function Fa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Aa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fa(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fa(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var La=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).calculateItem=function(e){var t=a.props.form.getFieldsValue;console.log(t()),a.setState((function(e){Object(D.a)(e.tableFormValues).forEach((function(e){}))}))},a.removeTests=function(e,t){a.setState((function(a){return{addedLabs:Aa({},a.addedLabs,Object(w.a)({},t.id,!1)),tableFormValues:Object(D.a)(Object(st.remove)(a.tableFormValues,(function(t){return t._id!=e})))}}))},a.add=function(e){console.log("item",e),a.setState((function(t){console.log("preview",t);var a=Math.random().toFixed(7);return t.addedLabs[e.id]?(Object(F.a)(N.bc,"Item Already Added"),!1):{addedLabs:Aa({},t.addedLabs,Object(w.a)({},e.id,!0)),tableFormValues:[].concat(Object(D.a)(t.tableFormValues),[Aa({},e,{_id:a})])}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(!e){var n={treatment:[],patient:t.props.match.params.id};t.state.tableFormValues.forEach((function(e){e.cost=a.cost[e._id];var t={name:e.id,cost:e.cost,instruction:e.instruction,is_active:!0,practice:e.practice,margin:e.margin};n.treatment.push(t)}));console.log("DataSet",n)}}))},a.state={lab_test:[],tableFormValues:[],addedLabs:{}},console.log("urgent",a.props.active_practiceId),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadLabs()}},{key:"loadLabs",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Fb,[e.props.active_practiceId]),(function(t){e.setState({lab_test:t})}),(function(){}))}},{key:"render",value:function(){var e=this,t=this.props.form,a=t.getFieldDecorator,n=(t.getFieldValue,t.getFieldsValue,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}}),i=[{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return m.a.createElement("span",null,m.a.createElement("b",null,e))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(e,t){return m.a.createElement("span",null,m.a.createElement(I.a.Item,Object.assign({key:"cost[".concat(t._id,"]")},n),a("cost[".concat(t._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:t.cost})))}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement("a",{onClick:function(){return e.removeTests(a._id,a)}},m.a.createElement(k.a,{type:"close-circle",theme:"twoTone",twoToneColor:"#f00"})))}}];return m.a.createElement("div",null,m.a.createElement(I.a,{onSubmit:this.handleSubmit},m.a.createElement(j.a,{title:"Patient Lab Orders",bodyStyle:{padding:0},extra:m.a.createElement(I.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0}}),m.a.createElement(_.a,{type:"primary",htmlType:"submit"},"Save Lab Orders"))},m.a.createElement(h.a,{gutter:16},m.a.createElement(g.a,{span:7},m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.lab_test,renderItem:function(t){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:t.name}),m.a.createElement(_.a,{type:"primary",size:"small",shape:"circle",onClick:function(){return e.add(t)},icon:"arrow-right"}))}})),m.a.createElement(g.a,{span:17},m.a.createElement(je.a,{pagination:!1,bordered:!0,dataSource:this.state.tableFormValues,columns:i}))))))}}]),t}(m.a.Component),Va=I.a.create()(La),Na=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,loading:!1},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"Time",dataIndex:"created_at",key:"name",render:function(e){return m.a.createElement("span",null,G()(e).format("LLL"))}},{title:"Drug",key:"drug"},{title:"Quantity",dataIndex:"qunatity",key:"quantity"},{title:"Cost Per  Unit",dataIndex:"cost",key:"cost"},{title:"Completed",key:"is_completed",render:function(e,t){return m.a.createElement(he.a,{checked:t.is_completed})}},{title:"Action",key:"action",render:function(t,a){return m.a.createElement("span",null,m.a.createElement("a",{onClick:function(){return e.editPrescriptionData(a)}},"Edit"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{href:"javascript:;"},"Delete"))}}];return m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/labtrackings/add",render:function(t){return m.a.createElement(Va,Object.assign({},e.state,t))}}),m.a.createElement(j.a,{title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Lab Order":"Patients Lab Order",extra:m.a.createElement(_.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/labtrackings/add"},m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"plus"}),"Add")))},m.a.createElement(je.a,{loading:this.state.loading,columns:t,dataSource:this.state.payments}))))}}]),t}(m.a.Component),Ra=(a(190),a(133)),Ba=(a(471),a(472));a(119);function za(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ya(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?za(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):za(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var qa=T.a.Search,Ga=At.a.TabPane,Wa=Ba.a.Text,Ha={_id:null,quantity:0,batch:null},Ua=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).selectedDefaultDate=function(e){a.setState({selectedDate:e})},a.loadEditInvoiceData=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.id,[a.props.editId]),(function(t){var a=t;e.setState((function(e){var t=[];a.procedure.forEach((function(e){t.push(Ya({},e.procedure_data,{},e,{selectedDoctor:e.doctor_data,selectedDate:G()(e.date).isValid()?G()(e.date):null,_id:Math.random().toFixed(7),item_type:Y.vb}))}));var n=Ya({},e.stocks),i=Ya({},e.itemBatches);return a.inventory.forEach((function(e){if(i[e.inventory]=e.inventory_item_data.item_type_stock.item_stock||[],n[e.inventory]){var a=n[e.inventory];e.inventory_item_data.item_type_stock&&e.inventory_item_data.item_type_stock.item_stock&&e.inventory_item_data.item_type_stock.item_stock.forEach((function(e){a[e.batch_number]?a[e.batch_number]+=e.quantity:a[e.batch_number]=e.quantity}))}else{var r={};e.inventory_item_data.item_type_stock&&e.inventory_item_data.item_type_stock.item_stock&&e.inventory_item_data.item_type_stock.item_stock.forEach((function(e){r[e.batch_number]=e.quantity})),n[e.inventory_item_data.id]=r}if(n[e.inventory]){var l=n[e.inventory];l[e.batch_number]?l[e.batch_number]+=e.unit:l[e.batch_number]=e.unit}else{var c={};c[e.batch_number]=e.unit,n[e.inventory]=c}i[e.inventory]&&i[e.inventory].forEach((function(t){t.batch_number==e.batch_number&&(e.selectedBatch=t)})),t.push(Ya({},e.inventory_item_data,{},e,{selectedDoctor:e.doctor_data,_id:Math.random().toFixed(7),item_type:Y.X}))})),{tableFormValues:t,selectedDate:G()(a.date).isValid()?G()(a.date):null,stocks:n,itemBatches:i}}))}),(function(){}))},a.remove=function(e){a.setState((function(t){var a=[];return t.tableFormValues.forEach((function(t){t._id!=e&&a.push(t)})),{tableFormValues:a}}))},a.add=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random().toFixed(7);a.setState((function(a){e.item_type==Y.vb?e=Ya({},e,{id:void 0,unit:1,unit_cost:e.cost,procedure:e.id,selectedDoctor:a.selectedDoctor?a.selectedDoctor:null,selectedDate:G()(),taxes:e.taxes.map((function(e){return e.id}))}):e.item_type==Y.X&&(e=Ya({},e,{id:void 0,inventory:e.id,unit_cost:e.retail_without_tax,selectedDoctor:a.selectedDoctor?a.selectedDoctor:null}));var n=0;return this.props.MedicalMembership&&(n=this.props.MedicalMembership.medical_membership.benefit),{tableFormValues:[Ya({},Ha,{},e,{id:void 0,_id:t,discount:n})].concat(Object(D.a)(a.tableFormValues))}}))},a.selectDoctor=function(e,t,n){a.setState((function(a){var i=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?i.push(Ya({},a,{selectedDoctor:e})):i.push(a)})),{tableFormValues:i}}))},a.selectedDate=function(e,t,n){a.setState((function(a){var i=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?i.push(Ya({},a,{selectedDate:e})):i.push(a)})),{tableFormValues:i}}))},a.selectBatch=function(e,t,n){a.setState((function(a){var i=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?i.push(Ya({},a,{selectedBatch:e})):i.push(a)})),{tableFormValues:i}}))},a.addPrescription=function(e){var t=Object(o.a)(a);e.drugs.forEach((function(a){a.inventory.maintain_inventory&&t.add(Ya({},a.inventory,{item_type:Y.X,inventory:e.inventory.id,id:void 0}))})),t.setState((function(t){return{selectedPrescriptions:[].concat(Object(D.a)(t.selectedPrescriptions),[e.id])}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);a.props.form.validateFields((function(a,n){if(!a){t.setState({});var i={promo_code:t.state.promoCode,practice:t.props.active_practiceId,patient:t.props.match.params.id,unit:null,cost:null,discount:null,taxes:0,total:null,procedure:[],inventory:[],prescription:t.state.selectedPrescriptions,notes:n.notes,date:t.state.selectedDate&&G()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null};t.state.tableFormValues.forEach((function(e){switch(e.unit=n.unit[e._id],e.taxes=n.taxes[e._id],e.item_type){case Y.vb:i.procedure.push({name:e.name,unit:e.unit,procedure:e.procedure,default_notes:null,is_active:!0,margin:e.margin,taxes:e.taxes,unit_cost:e.unit_cost,discount:e.discount,discount_type:e.discount_type,offers:e.offers,doctor:e.selectedDoctor?e.selectedDoctor.id:null,id:t.props.editId?e.id:void 0});break;case Y.X:i.inventory.push({inventory:e.inventory,name:e.name,unit:e.unit,taxes:e.taxes,unit_cost:e.unit_cost,discount:e.discount,discount_type:e.discount_type,offers:e.offers,doctor:e.selectedDoctor?e.selectedDoctor.id:null,instruction:e.instruction,is_active:!0,batch_number:e.selectedBatch?e.selectedBatch.batch_number:null,id:t.props.editId?e.id:void 0});break;default:return null}}));var r=function(a){if(t.setState({saveLoading:!1}),Object(F.a)("Inventory updated successfully"),t.props.loadData(),e)t.props.history.goBack();else{var n="/patient/"+t.props.match.params.id+"/billing/payments/add?invoices="+a.id;t.props.history.replace(n)}},l=function(){t.setState({saveLoading:!1})};t.props.editId?Object(F.l)(Object(F.f)(A.id,[t.props.editId]),i,r,l):Object(F.j)(A.V,i,r,l)}}))},a.addItemThroughQR=function(e){var t=Object(o.a)(a);t.setState({loadingQr:!0});var n=e.split("*");Object(F.c)(A.Wc,(function(e){var a=t.props.form,i=a.setFieldsValue,r=(a.getFieldsValue,a.getFieldValue),l=Math.random().toFixed(7),c=!0;if(t.state.tableFormValues.forEach((function(e){if(e.name==n[0]){var t=e._id,a=e.selectedBatch.batch_number,l=r("unit[".concat(t,"]"));a==n[1]&&(c=!1,i(Object(w.a)({},"unit[".concat(t,"]"),l+1)))}})),c){var o=null;e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(t){t.batch_number==n[1]&&(e.selectedBatch=t,o=t.unit_cost)})),t.add(Ya({},e,{item_type:Y.X}),l),i(Object(w.a)({},"unit_cost[".concat(l,"]"),o))}t.setState((function(e){return{loadingQr:!1,qrValue:""}}))}),(function(){}),{qr:e,form:"Invoice"})},a.setQrValue=function(e){var t=e.target.value;a.setState({qrValue:t})},a.searchValues=function(e,t){var n=Object(o.a)(a),i=e.target.value;a.setState({searchItem:i},(function(){t==Y.X?n.loadInventoryItemList():t==Y.tb?n.loadPrescriptions():t==Y.vb&&n.loadProcedures()}))},a.changeNetPrice=function(e,t){var n=Object(o.a)(a),i=a.props.form,r=i.getFieldsValue;i.setFields;setTimeout((function(){var a=r();a.unit_cost[e]||a.unit[e]||a.discount[e]||a.discount_type[e]?n.setState((function(n){var i=[];return n.tableFormValues.forEach((function(r){if(r._id==e){var l=0,c=0,o="%",s=null,u=!(!r.selectOption&&0!=r.selectOption)&&r.selectOption;a.taxes[e].forEach((function(e){n.taxes_list.forEach((function(t){t.id==e&&(l+=t.tax_value)}))})),t&&"0"==t&&(u=!1),a.discount_type&&a.discount_type[e]?(c=a.discount[e],o=a.discount_type[e],s=null):(c=a.discount[e]?a.discount[e].toString().split("#")[0]:"",o=a.discount[e]?a.discount[e].toString().split("#")[1]:"",s=a.discount[e]?a.discount[e].toString().split("#")[2]:null);var d=a.unit[e]*(a.unit_cost[e]?a.unit_cost[e]:0);"%"==o&&c?(c>100&&(c=100),d*=1-.01*c):"INR"==o&&c&&(d>c?d-=c:d=0);var m=(d*=1+.01*l)/a.unit[e];i.push(Ya({},r,{total_unit_cost:m,total:d,selectOption:u,discount:c,discount_type:o,offers:s}))}else i.push(r)})),{tableFormValues:i}})):n.setState({retail_price:0}),n.checkPromoCode()}),1e3)},a.applyPromoCodeDiscounts=function(e){var t=Object(o.a)(a),n=t.props.form,i=n.setFieldsValue,r=n.getFieldsValue,l=[],c=r(),s=e,u={};t.state.tableFormValues.forEach((function(e){var a=0,n=0,i=!(!e.selectOption&&0!=e.selectOption)&&e.selectOption;c.taxes[e._id].forEach((function(e){t.state.taxes_list.forEach((function(t){t.id==e&&(a+=t.tax_value)}))}));var r=c.unit[e._id]*(c.unit_cost[e._id]?c.unit_cost[e._id]:0),o=0;s&&(r>s?(r-=s,o=s,n=s,s=0):(s-=r,o=r,n=r,r=0));var d=(r*=1+.01*a)/c.unit[e._id];l.push(Ya({},e,{total_unit_cost:d,total:r,selectOption:i,discount:o,discount_type:"INR",offers:null})),u["discount[".concat(e._id,"]")]=n.toFixed(2),u["discount_type[".concat(e._id,"]")]="INR"})),t.setState({tableFormValues:l}),i(u)},a.loadLoyaltyDiscount=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.gc,[a.props.active_practiceId]),(function(t){e.setState({offers:t})}),(function(){e.setState({})}))},a.onChangeOption=function(e,t){Object(o.a)(a).setState((function(e){var a=[];return e.tableFormValues.forEach((function(e){e._id==t?a.push(Ya({},e,{selectOption:!0})):a.push(e)})),{tableFormValues:a}}))},a.onChangeOffer=function(e,t){Object(o.a)(a).setState((function(a){var n=[];return a.tableFormValues.forEach((function(i){i._id==t?("none"==e&&n.push(Ya({},i,{loyaltyDiscount:null})),"0"==e?n.push(Ya({},i,{selectOption:!1})):a.offers.forEach((function(t){t.id==e&&n.push(Ya({},i,{loyaltyDiscount:t.discount}))}))):n.push(i)})),{tableFormValues:n}}))},a.onchangeDiscountSimple=function(e,t){console.log(e,t),Object(o.a)(a).setState((function(a){var n=[];return a.tableFormValues.forEach((function(a){if(a._id==t){var i=a.unit_cost/(1+.01*e);console.log(i),n.push(Ya({},a,{loyaltyDiscount:e}))}else n.push(a)})),{tableFormValues:n}}))},a.enterPromoCode=function(e){a.setState({promoCode:e.target.value})},a.calculateGrandTotalWithoutDiscount=function(){var e=0,t=Object(o.a)(a),n=(0,a.props.form.getFieldsValue)();return a.state.tableFormValues.forEach((function(a){var i=0;n.taxes[a._id].forEach((function(e){t.state.taxes_list.forEach((function(t){t.id==e&&(i+=t.tax_value)}))}));var r=n.unit[a._id]*(n.unit_cost[a._id]?n.unit_cost[a._id]:0);e+=r*=1+.01*i})),e},a.checkPromoCode=function(e){var t=Object(o.a)(a);t.setState({promoCodeCheckLoading:!0});var n={promo_code:a.state.promoCode,practice:a.props.active_practiceId,patient:t.props.match.params.id,amount:a.calculateGrandTotalWithoutDiscount()};n.promo_code?Object(F.c)(A.O,(function(e){t.setState({appliedPromoCodeDiscount:e.discount,promoCodeCheckLoading:!1}),t.applyPromoCodeDiscounts(e.discount)}),(function(){t.setState({promoCodeCheckLoading:!1,appliedPromoCodeDiscount:null,promoCode:""})}),n):t.setState({promoCodeCheckLoading:!1})},a.removePromoCode=function(){a.setState({appliedPromoCodeDiscount:0,promoCodeCheckLoading:!1,promoCode:""}),a.applyPromoCodeDiscounts(0)},a.state={classType:e.type,tableFormValues:[],maxQuantityforConsume:{},items:{},practiceDoctors:[],selectedPrescriptions:[],selectedDate:G()(),stocks:{},itemBatches:{},saveLoading:!1,qrValue:"",searchItem:"",selectedDoctor:{},tempValues:{},offers:[],loading:!1,taxes_list:[],promoCode:"",appliedPromoCodeDiscount:null,promoCodeCheckLoading:!1},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(de.d)(this),this.loadInventoryItemList(),this.loadProcedures(),this.loadPrescriptions(),this.loadTaxes(),this.loadLoyaltyDiscount(),this.props.editId&&setTimeout(function(){e.setState({loading:!1}),e.loadEditInvoiceData()}.bind(this),2e3)}},{key:"loadInventoryItemList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=this.state.searchItem;t.setState({loadingInventory:!0});var n=function(e){var n=e.results,i=[];t.state.searchItem==a&&t.setState((function(t){var a=Ya({},t.stocks),r=Ya({},t.itemBatches);n.forEach((function(e){if(i.push(e),a[e.id]){var t=a[e.id];e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(e){t[e.batch_number]?t[e.batch_number]+=e.quantity:t[e.batch_number]=e.quantity}))}else{var n={};e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(e){n[e.batch_number]=e.quantity})),a[e.id]=n}e.item_type_stock.item_stock&&(console.log(r,r[e.id],e),r[e.id]?r[e.id]=[].concat(Object(D.a)(r[e.id]),Object(D.a)(e.item_type_stock.item_stock)):r[e.id]=Object(D.a)(e.item_type_stock.item_stock))}));var l=t.items;return l[Y.X]=Ya({},e,{results:i}),{items:l,stocks:Ya({},t.stocks,{},a),itemBatches:Ya({},t.itemBatches,{},r),loadingInventory:!1}}),(function(){t.props.editId&&t.loadEditInvoiceData()}))},i=function(){t.setState({loadingInventory:!1})},r={practice:this.props.active_practiceId,maintain_inventory:!0,page:e};this.state.searchItem&&(r.item_name=a),Object(F.c)(A.xb,n,i,r)}},{key:"loadProcedures",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=this.state.searchItem,n=function(e){var n=t.state.items;n[Y.vb]=e,t.state.searchItem==a&&t.setState({items:n})},i=function(){},r={practice:this.props.active_practiceId,page:e};this.state.searchItem&&(r.name=a),Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),n,i,r)}},{key:"loadPrescriptions",value:function(){var e=this,t=this.state.searchItem,a={practice:this.props.active_practiceId};this.state.searchItem&&(a.item_name=t),Object(F.c)(Object(F.f)(A.Id,[e.props.match.params.id]),(function(a){e.state.searchItem==t&&e.setState((function(e){return{items:Ya({},e.items,Object(w.a)({},Y.tb,a))}}))}),(function(){}),a)}},{key:"loadTaxes",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Ed,[this.props.active_practiceId]),(function(t){e.setState({taxes_list:t})}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=this.props.form.getFieldDecorator,i={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:24},md:{span:24},lg:{span:24},xl:{span:24}}};a("keys",{initialValue:[]});var r=[{title:"Item Name",key:"item_name",dataIndex:"name",width:180,render:function(e,n){switch(n.item_type){case Y.vb:return m.a.createElement(I.a.Item,Object.assign({key:"name[".concat(n._id,"]")},i),a("name[".concat(n._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:e,rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(T.a,{min:0,placeholder:"Item name",size:"small"})),m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(ht.a,{placement:"topCenter",overlay:m.a.createElement(Se.a,null,t.state.practiceDoctors.map((function(e){return m.a.createElement(Se.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return t.selectDoctor(e,n._id,Y.vb)}},e.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,n.selectedDoctor.user?n.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(M.a,{value:n.selectedDate,size:"small",onChange:function(e){return t.selectedDate(e,n._id,Y.vb)},format:"DD-MM-YYYY"}));case Y.tb:return m.a.createElement("b",null,n.name);case Y.X:return m.a.createElement("div",null,m.a.createElement("span",null,n.name),m.a.createElement("span",null,m.a.createElement("br",null),"by \xa0\xa0"),m.a.createElement(ht.a,{placement:"topCenter",overlay:m.a.createElement(Se.a,null,t.state.practiceDoctors.map((function(e){return m.a.createElement(Se.a.Item,{key:e.id},m.a.createElement("a",{onClick:function(){return t.selectDoctor(e,n._id,Y.X)}},e.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,n.selectedDoctor.user?n.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null,m.a.createElement("br",null),"from batch \xa0\xa0"),m.a.createElement(ht.a,{placement:"topCenter",overlay:m.a.createElement(Se.a,null,t.state.itemBatches[n.inventory]&&t.state.itemBatches[n.inventory].map((function(e,a){return G()()>=G()(e.expiry_date)?m.a.createElement(Se.a.Item,{key:a,disabled:!0},e.batch_number,"\xa0(",e.quantity,") \xa0\xa0",e.expiry_date):m.a.createElement(Se.a.Item,{key:a},m.a.createElement("a",{onClick:function(){return t.selectBatch(e,n._id,Y.X)}},e.batch_number,"\xa0(",e.quantity,") \xa0\xa0",e.expiry_date))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,n.selectedBatch?n.selectedBatch.batch_number:"Select Batch"))));default:return null}}}];return r=(r=r.concat([{title:"Unit",key:"unit",width:100,dataIndex:"unit",render:function(n,r){return r.item_type==Y.X?m.a.createElement(I.a.Item,Object.assign({key:"unit[".concat(r._id,"]")},i),a("unit[".concat(r._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:r.unit||0,rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(C.a,{min:1,max:r.selectedBatch&&t.state.stocks[r.inventory]&&t.state.stocks[r.inventory][r.selectedBatch.batch_number]?t.state.stocks[r.inventory][r.selectedBatch.batch_number]:0,placeholder:"units",size:"small",onChange:function(t){return e.changeNetPrice(r._id,r.discount)},disabled:!(r.selectedBatch&&t.state.stocks[r.inventory]&&t.state.stocks[r.inventory][r.selectedBatch.batch_number])}))):m.a.createElement(I.a.Item,Object.assign({key:"unit[".concat(r._id,"]")},i),a("unit[".concat(r._id,"]"),{initialValue:r.unit||0,validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(C.a,{min:1,max:100,placeholder:"unit",size:"small",onChange:function(t){return e.changeNetPrice(r._id,r.discount)}})))}},{title:"Unit Cost",key:"unit_cost",width:100,dataIndex:"unit_cost",render:function(e,n){return m.a.createElement(I.a.Item,Object.assign({key:"unit_cost[".concat(n._id,"]")},i),a("unit_cost[".concat(n._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:n.item_type==Y.X?n.retail_without_tax:n.cost,rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(C.a,{min:1,placeholder:"Unit Cost",size:"small",onChange:function(){return t.changeNetPrice(n._id,n.discount)}})))}},{title:"Discount",key:"discount",dataIndex:"discount",render:function(n,r){return r.selectOption?m.a.createElement(I.a.Item,{key:"discount[".concat(r._id,"]"),extra:m.a.createElement("span",null,r&&r.discount?r.discount+" "+r.discount_type+" Discount":null," ")},a("discount[".concat(r._id,"]"),{initialValue:r.offers,validateTrigger:["onChange","onBlur"]})(m.a.createElement(x.a,{style:{width:150},onChange:function(e){return t.changeNetPrice(r._id,e)},size:"small",disabled:e.state.appliedPromoCodeDiscount},m.a.createElement(x.a.Option,{value:"0"},"Custom Offer"),t.state.offers.map((function(e){return m.a.createElement(x.a.Option,{value:e.discount+"#"+e.unit+"#"+e.id},e.code)}))))):m.a.createElement(I.a.Item,Object.assign({extra:m.a.createElement("a",{onClick:function(){return t.onChangeOption("selectOption",r._id)},disabled:e.state.appliedPromoCodeDiscount},"Choose Offer"),key:"discount[".concat(r._id,"]")},i),a("discount[".concat(r._id,"]"),{initialValue:r.discount?r.discount:0,validateTrigger:["onChange","onBlur"]})(m.a.createElement(T.a,{placeholder:"discount",disabled:e.state.appliedPromoCodeDiscount,addonAfter:a("discount_type[".concat(r._id,"]"),{initialValue:r.discount_type||"%"})(m.a.createElement(x.a,{onChange:function(e){return t.changeNetPrice(r._id,e)},disabled:e.state.appliedPromoCodeDiscount},Y.p.map((function(e){return m.a.createElement(x.a.Option,{value:e.value}," ",e.value)})))),size:"small",style:{width:150},onChange:function(t){return e.changeNetPrice(r._id,t.target.value)}})))}},{title:"Taxes",key:"taxes",dataIndex:"taxes",render:function(n,r){return m.a.createElement(I.a.Item,Object.assign({key:"taxes[".concat(r._id,"]")},i),a("taxes[".concat(r._id,"]"),{initialValue:r.taxes||[],validateTrigger:["onChange","onBlur"]})(m.a.createElement(x.a,{placeholder:"Taxes",size:"small",mode:"multiple",style:{width:150},onChange:function(){return t.changeNetPrice(r._id,r.discount)}},e.state.taxes_list&&e.state.taxes_list.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name,"@",e.tax_value,"%")})))))}},{title:"Total Unit Cost",key:"total_unit_cost",width:80,align:"right",dataIndex:"total_unit_cost",render:function(e,t){return m.a.createElement("span",null,e?e.toFixed(2):"0.00")}},{title:"Total",key:"total",width:80,align:"right",dataIndex:"total",render:function(e,t){return e?e.toFixed(2):"0.00"}}])).concat([{key:"_id",dataIndex:"_id",render:function(e,a){return m.a.createElement(_.a,{icon:"close",onClick:function(){return t.remove(a._id)},type:"danger",shape:"circle",size:"small"})}}]),m.a.createElement("div",null,m.a.createElement(n.a,{spinning:this.state.saveLoading,tip:"Saving Invoice..."},m.a.createElement(n.a,{spinning:this.state.promoCodeCheckLoading,tip:"Checking Promo Code and Discounts..."},m.a.createElement(j.a,{title:this.props.editId?"Edit Invoice (INV "+this.props.editId+")":"Add Invoice",extra:m.a.createElement(qa,{loading:this.state.loadingQr,value:this.state.qrValue,onChange:this.setQrValue,placeholder:"Search QR Code",onSearch:this.addItemThroughQR,style:{width:200}}),bodyStyle:{padding:0}},m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement(At.a,{size:"small",type:"card"},m.a.createElement(Ga,{tab:Y.X,key:Y.X},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(T.a.Search,{placeholder:"Search in "+Y.X,onChange:function(t){return e.searchValues(t,Y.X)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",loading:this.state.loadingInventory,dataSource:this.state.items&&this.state.items[Y.X]?this.state.items[Y.X].results:[],renderItem:function(t){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:t.name+" ("+t.total_quantity+")"}),m.a.createElement(_.a,{type:"primary",size:"small",shape:"circle",onClick:function(){return e.add(Ya({},t,{item_type:Y.X}))},icon:"arrow-right"}))}}),this.state.items&&this.state.items[Y.X]?m.a.createElement("div",{style:{textAlign:"center"}},m.a.createElement("a",{style:{margin:5},disabled:!this.state.items[Y.X].previous,onClick:function(){return e.loadInventoryItemList(e.state.items[Y.X].previous)}},m.a.createElement(k.a,{type:"left"}),"Previous"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{style:{margin:5},disabled:!this.state.items[Y.X].next,onClick:function(){return e.loadInventoryItemList(e.state.items[Y.X].next)}},"Next",m.a.createElement(k.a,{type:"right"}))):null),m.a.createElement(Ga,{tab:Y.tb,key:Y.tb},m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.items?this.state.items[Y.tb]:[],renderItem:function(t){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:t.drugs.map((function(e){return m.a.createElement("div",null,m.a.createElement("span",null,e.name)," ",e.inventory.maintain_inventory?null:m.a.createElement(y.a,{color:"red",style:{float:"right",lineHeight:"18px"}},"Not Sold"),m.a.createElement("br",null))})),description:t.doctor?m.a.createElement(y.a,{color:t.doctor?t.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+t.doctor.user.first_name," ")):null}),m.a.createElement(_.a,{type:"primary",size:"small",shape:"circle",onClick:function(){return e.addPrescription(Ya({},t))},icon:"arrow-right"}))}})),m.a.createElement(Ga,{tab:Y.vb,key:Y.vb},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(T.a.Search,{placeholder:"Search in "+Y.vb,onChange:function(t){return e.searchValues(t,Y.vb)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.items&&this.state.items[Y.vb]?this.state.items[Y.vb].results:[],renderItem:function(t){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:t.name}),m.a.createElement(_.a,{type:"primary",size:"small",shape:"circle",onClick:function(){return e.add(Ya({},t,{item_type:Y.vb}))},icon:"arrow-right"}))}}),this.state.items&&this.state.items[Y.vb]?m.a.createElement("div",{style:{textAlign:"center"}},m.a.createElement("a",{style:{margin:5},disabled:!this.state.items[Y.vb].previous,onClick:function(){return e.loadProcedures(e.state.items[Y.vb].previous)}},m.a.createElement(k.a,{type:"left"}),"Previous"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{style:{margin:5},disabled:!this.state.items[Y.vb].next,onClick:function(){return e.loadProcedures(e.state.items[Y.vb].next)}},"Next",m.a.createElement(k.a,{type:"right"}))):null))),m.a.createElement(g.a,{span:18},m.a.createElement(I.a,null,m.a.createElement(je.a,{pagination:!1,loading:t.state.loading,bordered:!0,dataSource:this.state.tableFormValues,columns:r}),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement(g.a,{span:8},m.a.createElement(I.a.Item,Object.assign({label:"Notes",key:"notes"},i),a("notes",{initialValue:this.state.notes,validateTrigger:["onChange","onBlur"]})(m.a.createElement(T.a.TextArea,{row:2,placeholder:"Notes...",size:"small"}))),m.a.createElement("h3",null,"Grand Total: ",m.a.createElement("b",null,this.state.tableFormValues.reduce((function(e,t){return(parseFloat(e)+(t&&t.total?t.total:0)).toFixed(2)}),0)))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(M.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDefaultDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement(I.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0,float:"right"}}),m.a.createElement(_.a,{type:"primary",htmlType:"submit",onClick:function(){return e.handleSubmit(!0)},style:{margin:5}},"Save Invoice"),m.a.createElement(_.a,{type:"primary",htmlType:"submit",onClick:function(){return e.handleSubmit(!1)},style:{margin:5}},"Save & Create Payment"),t.props.history?m.a.createElement(_.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null)))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:12,style:{padding:10}},m.a.createElement("div",null,this.state.appliedPromoCodeDiscount?m.a.createElement("div",null,m.a.createElement(y.a,null,"'",this.state.promoCode,"' Applied ",m.a.createElement(k.a,{onClick:function(){return e.removePromoCode()},theme:"twoTone",twoToneColor:"#f00",type:"close-circle"})),m.a.createElement(Wa,{type:"success"},m.a.createElement("br",null),"Discount INR ",this.state.appliedPromoCodeDiscount)):m.a.createElement("div",null,m.a.createElement(qa,{enterButton:"Apply",value:this.state.promoCode,placeholder:"Promo Code",onChange:this.enterPromoCode,onSearch:this.checkPromoCode,style:{width:200}})))))))))))}}]),t}(m.a.Component),Ka=I.a.create()(Ua);function Xa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Qa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Xa(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Xa(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}T.a.Search,M.a.MonthPicker,At.a.TabPane;var Za={_id:null,quantity:0,batch:null},Ja=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).selectedDefaultDate=function(e){a.setState({selectedDate:e})},a.loadEditInvoiceData=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.id,[a.props.editId]),(function(t){var a=t;e.setState((function(e){var t=[];a.procedure.forEach((function(e){t.push(Qa({},e.procedure_data,{},e,{selectedDoctor:e.doctor_data,selectedDate:G()(e.date).isValid()?G()(e.date):null,_id:Math.random().toFixed(7),item_type:Y.vb}))}));var n=Qa({},e.stocks),i=Qa({},e.itemBatches);return a.inventory.forEach((function(e){if(i[e.inventory]||(i[e.inventory]=e.inventory_item_data.item_type_stock.item_stock),n[e.inventory]){var a=n[e.inventory];e.inventory_item_data.item_type_stock&&e.inventory_item_data.item_type_stock.item_stock&&e.inventory_item_data.item_type_stock.item_stock.forEach((function(e){a[e.batch_number]?a[e.batch_number]+=e.quantity:a[e.batch_number]=e.quantity}))}else{var r={};e.inventory_item_data.item_type_stock&&e.inventory_item_data.item_type_stock.item_stock&&e.inventory_item_data.item_type_stock.item_stock.forEach((function(e){r[e.batch_number]=e.quantity})),n[e.inventory_item_data.id]=r}if(n[e.inventory]){var l=n[e.inventory];l[e.batch_number]?l[e.batch_number]+=e.unit:l[e.batch_number]=e.unit}else{var c={};c[e.batch_number]=e.unit,n[e.inventory]=c}i[e.inventory]&&i[e.inventory].forEach((function(t){t.batch_number==e.batch_number&&(e.selectedBatch=t)})),t.push(Qa({},e.inventory_item_data,{},e,{selectedDoctor:e.doctor_data,_id:Math.random().toFixed(7),item_type:Y.X}))})),{tableFormValues:t,selectedDate:G()(a.date).isValid()?G()(a.date):null,stocks:n,itemBatches:i}}))}),(function(){}))},a.remove=function(e){a.setState((function(t){var a=[];return t.tableFormValues.forEach((function(t){t._id!=e&&a.push(t)})),{tableFormValues:a}}))},a.add=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random().toFixed(7);a.setState((function(a){return e.item_type==Y.vb?e=Qa({},e,{id:void 0,unit_cost:e.cost,procedure:e.id,selectedDoctor:a.selectedDoctor?a.selectedDoctor:null,selectedDate:G()(),taxes:e.taxes.map((function(e){return e.id}))}):e.item_type==Y.X&&(e=Qa({},e,{id:void 0,inventory:e.id,unit_cost:e.retail_without_tax,selectedDoctor:a.selectedDoctor?a.selectedDoctor:null})),{tableFormValues:[].concat(Object(D.a)(a.tableFormValues),[Qa({},Za,{},e,{id:void 0,_id:t})])}}))},a.selectDoctor=function(e,t,n){a.setState((function(a){var i=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?i.push(Qa({},a,{selectedDoctor:e})):i.push(a)})),{tableFormValues:i}}))},a.selectedDate=function(e,t,n){a.setState((function(a){var i=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?i.push(Qa({},a,{selectedDate:e})):i.push(a)})),{tableFormValues:i}}))},a.selectBatch=function(e,t,n){a.setState((function(a){var i=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?i.push(Qa({},a,{selectedBatch:e})):i.push(a)})),{tableFormValues:i}}))},a.addPrescription=function(e){var t=Object(o.a)(a);e.drugs.forEach((function(a){a.inventory.maintain_inventory&&t.add(Qa({},a.inventory,{item_type:Y.X,inventory:e.inventory.id,id:void 0}))})),t.setState((function(t){return{selectedPrescriptions:[].concat(Object(D.a)(t.selectedPrescriptions),[e.id])}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){t.setState({saveLoading:!0});var i={bank:"",number:"",practice:t.props.active_practiceId,return_mode:null,invoice:a.props.editInvoice.id,procedure:[],inventory:[],notes:n.notes,patient:t.props.match.params.id,staff:a.props.editInvoice.staff_data?a.props.editInvoice.staff_data.id:null,prescription:t.state.selectedPrescriptions,date:t.state.selectedDate&&G()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null,with_tax:!!a.state.return_with_tax,cash_return:n.cash_return,advance_value:a.state.returnCashAvailable-n.cash_return||0};t.state.tableFormValues.forEach((function(e){e.unit=n.unit[e._id];var t=e.id;if(delete e.id,e.unit)switch(e.item_type){case Y.vb:i.procedure.push(Qa({},e,{unit:e.unit,procedure_inv:t}));break;case Y.X:i.inventory.push(Qa({},e,{unit:e.unit,inventory_inv:t}));break;default:return null}}));Object(F.j)(A.Db,i,(function(e){t.setState({saveLoading:!1}),Object(F.a)("Inventory updated successfully"),t.props.loadData();var a="/patient/"+t.props.match.params.id+"/billing/invoices";t.props.history.replace(a)}),(function(){t.setState({saveLoading:!1})}))}}))},a.addItemThroughQR=function(e){var t=Object(o.a)(a);t.setState({loadingQr:!0});var n=e.split("*");Object(F.c)(A.Wc,(function(e){var a=t.props.form,i=a.setFieldsValue,r=(a.getFieldsValue,a.getFieldValue),l=Math.random().toFixed(7),c=!0;if(t.state.tableFormValues.forEach((function(e){if(e.name==n[0]){var t=e._id,a=e.selectedBatch.batch_number,l=r("unit[".concat(t,"]"));a==n[1]&&(c=!1,i(Object(w.a)({},"unit[".concat(t,"]"),l+1)))}})),c){var o=null;e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(t){t.batch_number==n[1]&&(e.selectedBatch=t,o=t.unit_cost)})),t.add(Qa({},e,{item_type:Y.X}),l),i(Object(w.a)({},"unit_cost[".concat(l,"]"),o))}t.setState((function(e){return{loadingQr:!1,qrValue:""}}))}),(function(){}),{qr:e,form:"Invoice"})},a.setQrValue=function(e){var t=e.target.value;a.setState({qrValue:t})},a.searchValues=function(e){var t=e.target.value;a.setState({searchItem:t},(function(){this.loadInventoryItemList()}))},a.changeNetPrice=function(e){var t=Object(o.a)(a),n=a.props.form,i=n.getFieldsValue;n.setFields;setTimeout((function(){var a=i();a.total_unit_cost[e]?t.setState((function(t){var n=[];return t.tableFormValues.forEach((function(i){if(i._id==e){var r=0;a.taxes[e].forEach((function(e){t.taxes_list.forEach((function(t){t.id==e&&(r+=t.tax_value)}))}));var l=a.total_unit_cost[e]/(1+.01*r);n.push(Qa({},i,{unit_cost:l}))}else n.push(i)})),{tableFormValues:n}})):t.setState({retail_price:0})}),1e3)},a.onChangeHandle=function(e){var t=Object(o.a)(a);a.setState({return_with_tax:e.target.checked},(function(){t.calculateReturnCashAvailable()}))},a.calculateReturnCashAvailable=function(){var e=Object(o.a)(a),t=a.state.editInvoice.payments.reduce((function(e,t){return e+t.pay_amount}),0),n=a.state.editInvoice.total-t,i=0,r=a.props.form.getFieldsValue;setTimeout((function(){var t=r(),a=e.state.return_with_tax;e.state.tableFormValues.forEach((function(e){var n=t.unit[e._id];e.item_type==Y.X?(i+=n*e.unit_cost,i+=a?e.tax_value/e.unit*n:null):e.item_type==Y.tb?(i+=n*e.unit_cost,i+=a?e.tax_value/e.unit*n:null):e.item_type==Y.vb&&(i+=n*e.unit_cost,i+=a?e.tax_value/e.unit*n:null)})),e.setState({returnCashAvailable:(i>n?i-n:0).toFixed(2)})}),500)},a.state={editInvoice:a.props.editInvoice,classType:e.type,tableFormValues:[],maxQuantityforConsume:{},items:{},practiceDoctors:[],selectedPrescriptions:[],selectedDate:G()(),stocks:{},itemBatches:{},saveLoading:!1,qrValue:"",searchItem:"",return_with_tax:!1,returnCashAvailable:0},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){Object(de.d)(this),this.loadProcedures(),this.loadPrescriptions(),this.loadTaxes(),this.props.editId&&this.loadEditInvoiceData()}},{key:"loadInventoryItemList",value:function(){var e=this,t={page_size:1e3,practice:this.props.active_practiceId,maintain_inventory:!0};this.state.searchItem&&(t.item_name=this.state.searchItem),Object(F.c)(A.xb,(function(t){var a=t.results,n=[];e.setState((function(t){var i=Qa({},t.stocks),r={};a.forEach((function(e){if(e.item_type==Y.z){if(n.push(e),i[e.id]){var t=i[e.id];e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(e){t[e.batch_number],t[e.batch_number]+=e.quantity}))}else{var a={};e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(e){a[e.batch_number]=e.quantity})),i[e.id]=a}r[e.id]=e.item_type_stock.item_stock}}));var l=e.state.items;return l[Y.X]=n,{items:l,stocks:Qa({},t.stocks,{},i),itemBatches:Qa({},t.itemBatches,{},r)}}),(function(){e.props.editId&&e.loadEditInvoiceData()}))}),(function(){}),t)}},{key:"loadProcedures",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),(function(t){var a=e.state.items;a[Y.vb]=t,e.setState({items:a})}),(function(){}))}},{key:"loadPrescriptions",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Id,[e.props.match.params.id]),(function(t){e.setState((function(e){return{items:Qa({},e.items,Object(w.a)({},Y.tb,t))}}))}),(function(){}))}},{key:"loadTaxes",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Ed,[this.props.active_practiceId]),(function(t){e.setState({taxes_list:t})}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,i=a.getFieldDecorator,r=(a.getFieldValue,a.getFieldsValue,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:24},md:{span:24},lg:{span:24},xl:{span:24}}});i("keys",{initialValue:[]});var l=[{title:"Item Name",key:"item_name",dataIndex:"name",render:function(e,a){switch(a.item_type){case Y.vb:return m.a.createElement(I.a.Item,Object.assign({key:"name[".concat(a._id,"]")},r),i("name[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:e,rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(T.a,{min:0,placeholder:"Item name",size:"small",disabled:!0})),m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(ht.a,{placement:"topCenter",disabled:!0,overlay:m.a.createElement(Se.a,null,t.state.practiceDoctors.map((function(e){return m.a.createElement(Se.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return t.selectDoctor(e,a._id,Y.vb)}},e.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,a.selectedDoctor.user?a.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(M.a,{value:a.selectedDate,disabled:!0,size:"small",onChange:function(e){return t.selectedDate(e,a._id,Y.vb)},format:"DD-MM-YYYY"}));case Y.tb:return m.a.createElement("b",null,a.name);case Y.X:return m.a.createElement("div",null,a.name,m.a.createElement("span",null,m.a.createElement("br",null),"by \xa0\xa0"),m.a.createElement(ht.a,{placement:"topCenter",disabled:!0,overlay:m.a.createElement(Se.a,null,t.state.practiceDoctors.map((function(e){return m.a.createElement(Se.a.Item,{key:e.id},m.a.createElement("a",{onClick:function(){return t.selectDoctor(e,a._id,Y.vb)}},e.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,a.selectedDoctor&&a.selectedDoctor.user?a.selectedDoctor.user.first_name:"+Add Doctor"))),m.a.createElement("span",null,m.a.createElement("br",null),"from batch \xa0\xa0"),m.a.createElement(ht.a,{placement:"topCenter",disabled:!0,overlay:m.a.createElement(Se.a,null,t.state.itemBatches[a.inventory]&&t.state.itemBatches[a.inventory].map((function(e,n){return G()()>=G()(e.expiry_date)?m.a.createElement(Se.a.Item,{key:n,disabled:!0},e.batch_number,"\xa0(",e.quantity,") \xa0\xa0",e.expiry_date):m.a.createElement(Se.a.Item,{key:n},m.a.createElement("a",{onClick:function(){return t.selectBatch(e,a._id,Y.X)}},e.batch_number,"\xa0(",e.quantity,") \xa0\xa0",e.expiry_date))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,a.selectedBatch?a.selectedBatch.batch_number:"Select Batch"))),a.selectedBatch&&a.selectedBatch.expiry_date&&G()(a.selectedBatch.expiry_date)<G()()?m.a.createElement(y.a,{color:"#f50"},"Expired"):null);default:return null}}}];return l=l.concat([{title:"Returning Unit",key:"unit",width:100,dataIndex:"unit",render:function(a,n){return n.item_type==Y.X?m.a.createElement(I.a.Item,Object.assign({key:"unit[".concat(n._id,"]")},r),i("unit[".concat(n._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:0})(m.a.createElement(C.a,{max:n.unit,onChange:e.calculateReturnCashAvailable,min:0,placeholder:"units",size:"small",disabled:!(n.selectedBatch&&t.state.stocks[n.inventory]&&t.state.stocks[n.inventory][n.selectedBatch.batch_number])})),m.a.createElement("span",{className:"ant-form-text"},"Items: ",n.unit)):m.a.createElement(I.a.Item,Object.assign({key:"unit[".concat(n._id,"]")},r),i("unit[".concat(n._id,"]"),{initialValue:0,validateTrigger:["onChange","onBlur"]})(m.a.createElement(C.a,{min:0,max:n.unit,placeholder:"unit",size:"small",onChange:e.calculateReturnCashAvailable})),m.a.createElement("span",{className:"ant-form-text"},"Items: ",n.unit))}},{title:"Unit Cost",key:"unit_cost",width:100,dataIndex:"unit_cost",render:function(e,t){return e?e.toFixed(2):null}},{title:"discount %",key:"discount",width:100,dataIndex:"discount",render:function(e,t){return m.a.createElement(I.a.Item,Object.assign({key:"discount[".concat(t._id,"]")},r),i("discount[".concat(t._id,"]"),{initialValue:t.discount,validateTrigger:["onChange","onBlur"]})(m.a.createElement(C.a,{min:0,max:100,placeholder:"discount",size:"small",disabled:!0})))}},{title:"Taxes",key:"taxes",dataIndex:"taxes",render:function(a,n){return m.a.createElement(I.a.Item,Object.assign({key:"taxes[".concat(n._id,"]")},r),i("taxes[".concat(n._id,"]"),{initialValue:n.taxes||[],validateTrigger:["onChange","onBlur"]})(m.a.createElement(x.a,{placeholder:"Taxes",size:"small",mode:"multiple",disabled:!0,style:{width:150},onChange:function(){return t.changeNetPrice(n._id)}},e.state.taxes_list&&e.state.taxes_list.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name,"@",e.tax_value,"%")})))))}},{title:"Total Unit Cost",key:"total",width:100,dataIndex:"total",render:function(e,t){return t.unit?(t.total/t.unit).toFixed(2):t.total.toFixed(2)}}]),m.a.createElement("div",null,m.a.createElement(n.a,{spinning:this.state.saveLoading,tip:"Saving Invoice..."},m.a.createElement(h.a,{gutter:16},m.a.createElement(g.a,{span:20},m.a.createElement(j.a,{title:this.props.editId?"Return Invoice (INV "+this.props.editId+")":"Add Invoice",bodyStyle:{padding:0}},m.a.createElement(h.a,{gutter:16},m.a.createElement(g.a,{span:24},m.a.createElement(I.a,{onSubmit:this.handleSubmit,layout:"inline"},m.a.createElement(je.a,{pagination:!1,bordered:!0,dataSource:this.state.tableFormValues,columns:l}),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement(h.a,{gutter:16},m.a.createElement(g.a,{span:6},m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(M.a,{value:this.state.selectedDate,disabled:!0,onChange:function(t){return e.selectedDefaultDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement("br",null),m.a.createElement("br",null),m.a.createElement(he.a,{onChange:this.onChangeHandle,defaultChecked:this.state.return_with_tax},"Return With Tax")),m.a.createElement(g.a,{span:8},m.a.createElement(I.a.Item,{label:"Returned Cash "},i("cash_return")(m.a.createElement(C.a,{min:0,max:this.state.returnCashAvailable,placeholder:"Cash Returned"})),m.a.createElement("span",null,m.a.createElement("br",null),"Max Cash Return Allowed (INR) ",this.state.returnCashAvailable))),m.a.createElement(g.a,{span:10},m.a.createElement(I.a.Item,{label:"Notes",key:"notes"},i("notes",{initialValue:this.state.tableFormValues.notes,validateTrigger:["onChange","onBlur"]})(m.a.createElement(T.a.TextArea,{row:2,placeholder:"Notes...",size:"small",style:{width:"100%"}}))),m.a.createElement(I.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0,float:"right"}}),m.a.createElement(_.a,{type:"primary",htmlType:"submit",style:{margin:5}},"Save Return Invoice"),t.props.history?m.a.createElement(_.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null)))))))))),m.a.createElement(g.a,{span:4},m.a.createElement(v.a,null,"Payments Done"),m.a.createElement(b.a,{dataSource:this.state.editInvoice.payments,renderItem:function(e){return m.a.createElement(j.a,{title:e.payment_id,style:{marginBottom:10},bodyStyle:{padding:5}},m.a.createElement("p",null,"Paid (INR)",m.a.createElement("span",{style:{float:"right",fontWeight:600}}," ",e.pay_amount.toFixed(2))))}})))))}}]),t}(m.a.Component),$a=I.a.create()(Ja);function en(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var tn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitReturnInvoice=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var i=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?en(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):en(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{practice:a.props.active_practiceId});Object(F.j)(A.M,i,(function(e){t.setState({returnIncoiceVisible:!1}),t.returnInvoiceData(t.props.editInvoice),t.props.returnInvoiceClose()}),(function(){}))}}))},a.returnInvoiceData=function(e){var t=Object(o.a)(a);a.setState({editInvoice:e},(function(){t.props.history.push("/patient/"+e.patient_data.id+"/billing/invoices/return/")}))},a.state={returnIncoiceVisible:a.props.returnIncoiceVisible,otpSent:a.props.otpSent},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"sendOTP",value:function(){Object(F.c)(A.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return m.a.createElement(f.a,{visible:this.state.returnIncoiceVisible&&this.props.editInvoice&&this.props.editInvoice.id==this.props.invoice.id,title:"Return Invoice",footer:null,onOk:this.props.handleSubmitReturnInvoice,onCancel:this.props.returnInvoiceClose},m.a.createElement(I.a,null,m.a.createElement(I.a.Item,null,e("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(T.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(I.a.Item,null,this.props.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitReturnInvoice},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:this.props.returnInvoiceClose},"Close"))))}}]),t}(m.a.Component),an=I.a.create()(tn);function nn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var rn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitEditInvoice=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var i=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?nn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):nn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{practice:a.props.active_practiceId});Object(F.j)(A.M,i,(function(e){t.setState({editIncoiceVisible:!1}),t.editInvoiceData(t.props.editInvoice),t.props.editInvoiceClose()}),(function(){}))}}))},a.editInvoiceData=function(e){var t=Object(o.a)(a);a.setState({editInvoice:e},(function(){t.props.history.push("/patient/"+e.patient_data.id+"/billing/invoices/edit/")}))},a.state={otpSent:a.props.otpSent,returnIncoiceVisible:a.props.returnIncoiceVisible,editIncoiceVisible:a.props.editIncoiceVisible},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"sendOTP",value:function(){Object(F.c)(A.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return m.a.createElement(f.a,{visible:this.state.editIncoiceVisible&&this.props.editInvoice&&this.props.editInvoice.id==this.props.invoice.id,title:"Edit Invoice",footer:null,onOk:this.handleSubmitEditInvoice,onCancel:this.props.editInvoiceClose},m.a.createElement(I.a,null,m.a.createElement(I.a.Item,null,e("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(T.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(I.a.Item,null,this.props.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitEditInvoice},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:this.props.editInvoiceClose},"Close"))))}}]),t}(m.a.Component),ln=I.a.create()(rn),cn=a(38);function on(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var sn=T.a.TextArea,un=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitCancelInvoice=function(e){var t=Object(o.a)(a),n=t.state.otpField;e.preventDefault(),a.props.form.validateFields((function(e,i){if(!e){var r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?on(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):on(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},i,{practice:a.props.active_practiceId});n?Object(F.j)(A.M,r,(function(e){t.setState({cancelIncoiceVisible:!1}),t.deleteInvoice(t.props.editInvoice.patient,t.props.editInvoice.id,i.cancel_note)}),(function(){})):t.deleteInvoice(t.props.editInvoice.patient,t.props.editInvoice.id,i.cancel_note)}}))},a.state={cancelIncoiceVisible:a.props.cancelIncoiceVisible,otpSent:a.props.otpSent,otpField:!1},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){G()().diff(this.props.editInvoice.created_at,"minutes")>N.qb&&this.setState({otpField:!0})}},{key:"deleteInvoice",value:function(e,t,a){var n=this,i={patient:e,is_cancelled:!0,cancel_note:a};Object(F.l)(Object(F.f)(A.hd,[t]),i,(function(e){n.props.cancelInvoiceClose(),Object(F.a)(N.Sb,"Invoice cancelled successfully"),n.props.loadInvoices()}),(function(){}))}},{key:"sendOTP",value:function(){Object(F.c)(A.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.state.otpField,t=this.props.form.getFieldDecorator;return m.a.createElement(f.a,{visible:this.state.cancelIncoiceVisible,title:"Cancel Invoice",footer:null,onOk:this.handleSubmitCancelInvoice,onCancel:this.props.cancelInvoiceClose},m.a.createElement(I.a,null,m.a.createElement(I.a.Item,{key:"cancel_notes"},t("cancel_note",{rules:[{required:!0,message:cn.j}]})(m.a.createElement(sn,{placeholder:"cancel notes"}))),e&&m.a.createElement(I.a.Item,{key:"cancelOtp"},t("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(T.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(I.a.Item,null,this.props.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitCancelInvoice},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:this.cancelInvoiceClose},"Close"))))}}]),t}(m.a.Component),dn=I.a.create()(un);function mn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function pn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?mn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):mn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}f.a.confirm;var hn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPDF=function(e){Object(o.a)(a);Object(F.c)(Object(F.f)(A.Cb,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))},a.returnModelOpen=function(e){var t=Object(o.a)(a);t.setState({returnIncoiceVisible:!0,editIncoiceVisible:!1,cancelIncoiceVisible:!1,editInvoice:e});var n={practice:a.props.active_practiceId,type:"Invoice:"+e.invoice_id+" Return"};Object(F.j)(A.K,n,(function(a){t.setState({otpSent:!0,patientId:e.patient,invoiceId:e.id})}),(function(){}))},a.cancelModalOpen=function(e){var t=Object(o.a)(a),n=G()().diff(e.created_at,"minutes");t.setState({cancelIncoiceVisible:!0,editIncoiceVisible:!1,returnIncoiceVisible:!1,editInvoice:e});var i={practice:a.props.active_practiceId,type:"Invoice:"+e.invoice_id+"  Cancellation"};n>N.qb&&Object(F.j)(A.K,i,(function(a){t.setState({otpSent:!0,patientId:e.patient,invoiceId:e.id})}),(function(){}))},a.editInvoiceClose=function(){a.setState({editIncoiceVisible:!1})},a.returnInvoiceClose=function(){a.setState({returnIncoiceVisible:!1})},a.cancelInvoiceClose=function(){a.setState({cancelIncoiceVisible:!1})},a.updateFormValue=function(e,t){a.setState(Object(w.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:st.get(e,"patient_data.user.first_name"),paymentId:st.get(e,"id"),mail_to:st.get(e,"patient_data.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.paymentId,i={mail_to:t};Object(de.g)(Object(F.f)(A.Cb,[n]),i),a.mailModalClose()},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,invoices:[],drug_catalog:null,procedure_category:null,taxes_list:null,editInvoice:null,loading:!0,returnIncoiceVisible:!1,editIncoiceVisible:!1,cancelIncoiceVisible:!1},a.loadInvoices=a.loadInvoices.bind(Object(o.a)(a)),a.loadDrugCatalog=a.loadDrugCatalog.bind(Object(o.a)(a)),a.loadProcedureCategory=a.loadProcedureCategory.bind(Object(o.a)(a)),a.loadTaxes=a.loadTaxes.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadInvoices()}},{key:"loadInvoices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;t.props.refreshWallet&&1==e&&t.props.refreshWallet(),t.setState({loading:!0});var a=function(e){1==e.current?t.setState({total:e.count,invoices:e.results,loading:!1,loadMoreInvoice:e.next}):t.setState((function(t){return{total:e.count,invoices:[].concat(Object(D.a)(t.invoices),Object(D.a)(e.results)),loading:!1,loadMoreInvoice:e.next}}))},n=function(){t.setState({loading:!1})},i={page:e,practice:this.props.active_practiceId,summary:!0};this.props.match.params.id&&(i.patient=this.props.match.params.id),Object(F.c)(A.Bb,a,n,i)}},{key:"loadDrugCatalog",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Z,[this.props.active_practiceId]),(function(t){e.setState({drug_catalog:t})}),(function(){}))}},{key:"loadProcedureCategory",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),(function(t){e.setState({procedure_category:t})}),(function(){}))}},{key:"loadTaxes",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Ed,[this.props.active_practiceId]),(function(t){e.setState({taxes_list:t})}),(function(){}))}},{key:"editModelOpen",value:function(e){var t=this,a=G()().diff(e.created_at,"minutes");t.setState({editIncoiceVisible:!0,cancelIncoiceVisible:!1,returnIncoiceVisible:!1,editInvoice:e});var n={practice:this.props.active_practiceId,type:"Invoice:"+e.invoice_id+" Edit"};a>N.qb&&Object(F.j)(A.K,n,(function(a){t.setState({otpSent:!0,patientId:e.patient,invoiceId:e.id})}),(function(){}))}},{key:"deleteInvoice",value:function(e,t){var a=this,n={patient:e,is_cancelled:!0};Object(F.l)(Object(F.f)(A.hd,[t]),n,(function(e){Object(F.a)(N.Sb,"Invoice cancelled successfully"),a.loadInvoices()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a={};this.state.drug_catalog&&this.state.drug_catalog.forEach((function(e){a[e.id]=e.name+","+e.strength}));var i={};this.state.procedure_category&&this.state.procedure_category.forEach((function(e){i[e.id]=e.name}));var r={};return this.state.taxes_list&&this.state.taxes_list.forEach((function(e){r[e.id]=e.name})),this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{path:"/patient/:id/billing/invoices/add",render:function(t){return m.a.createElement(Ka,Object.assign({},t,e.props,{loadData:e.loadInvoices}))}}),m.a.createElement(p.b,{path:"/patient/:id/billing/invoices/edit",render:function(t){return e.state.editInvoice?m.a.createElement(Ka,Object.assign({},e.state,t,e.props,{editId:e.state.editInvoice.id,loadData:e.loadInvoices})):m.a.createElement(p.a,{to:"/patient/"+e.props.match.params.id+"/billing/invoices"})}}),m.a.createElement(p.b,{path:"/patient/:id/billing/invoices/return",render:function(t){return e.state.editInvoice?m.a.createElement($a,Object.assign({},e.state,t,{editId:e.state.editInvoice.id,loadData:e.loadInvoices})):m.a.createElement(p.a,{to:"/patient/"+e.props.match.params.id+"/billing/invoices"})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(Ra.a,{banner:!0,showIcon:!0,type:"info",message:"The invoices shown are only for the current selected practice!"}),m.a.createElement(Je.a,{offsetTop:0},m.a.createElement(j.a,{bodyStyle:{padding:0},style:{boxShadow:"0 5px 8px rgba(0, 0, 0, 0.09)"},title:(this.state.currentPatient?this.state.currentPatient.user.first_name+" Invoice ":"Invoices ")+(this.state.total?"(Total:".concat(this.state.total,")"):""),extra:m.a.createElement(_.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/billing/invoices/add"},m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"Add")))})),this.state.invoices.map((function(e){return yn(e,t)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadInvoices(e.state.loadMoreInvoice)},loading:this.state.loading,hidden:!this.state.loadMoreInvoice})))),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Invoice To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:t.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),t.state.cancelIncoiceVisible?m.a.createElement(dn,Object.assign({key:"cancelInvoice1"},t.state,{cancelInvoiceClose:t.cancelInvoiceClose,loadInvoices:t.loadInvoices})):null):m.a.createElement("div",null,m.a.createElement(Je.a,{offsetTop:0},m.a.createElement(j.a,{bodyStyle:{padding:0},style:{boxShadow:"0 5px 8px rgba(0, 0, 0, 0.09)"},title:(this.state.currentPatient?this.state.currentPatient.user.first_name+" Invoice ":"Invoice ")+(this.state.total?"(Total:".concat(this.state.total,")"):""),extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))})),this.state.invoices.map((function(e){return yn(e,t)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadInvoices(e.state.loadMoreInvoice)},loading:this.state.loading,hidden:!this.state.loadMoreInvoice}),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send invoice To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:t.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),t.state.cancelIncoiceVisible?m.a.createElement(dn,Object.assign({key:"cancelInvoice2"},t.state,{cancelInvoiceClose:t.cancelInvoiceClose,loadInvoices:t.loadInvoices})):null)}}]),t}(m.a.Component),fn=I.a.create()(hn);function bn(e){return e?m.a.createElement("p",null,e.doctor?m.a.createElement(we.a,{title:"Doctor"},m.a.createElement(y.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+e.doctor.user.first_name," "))):null,e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null,e.notes?m.a.createElement("p",null,"Notes: ",e.notes):null,e.cancel_note?m.a.createElement("p",null,"Cancel Notes: ",e.cancel_note):null):null}function yn(e,t){var a=[];t.props.form.getFieldDecorator;if(e.reservation){var n=e.reservation_data.medicines.map((function(e){return Object.create(pn({},e,{unit:1,total:e.final_price,unit_cost:e.price,discount:0}))})),i={NORMAL:{total:"final_normal_price",tax:"normal_tax_value",unit_cost:"normal_price"},TATKAL:{total:"final_tatkal_price",tax:"tatkal_tax_value",unit_cost:"tatkal_price"}};a=[].concat(Object(D.a)(a),[pn({},e.reservation_data.bed_package,{unit:1,total:e.reservation_data.bed_package?e.reservation_data.bed_package[i[e.reservation_data.seat_type].total]:null,tax_value:e.reservation_data.bed_package?e.reservation_data.bed_package[i[e.reservation_data.seat_type].tax]:null,unit_cost:e.reservation_data.bed_package?e.reservation_data.bed_package[i[e.reservation_data.seat_type].unit_cost]:null})],Object(D.a)(n))}return m.a.createElement(j.a,{key:e.id,style:{marginTop:10},bodyStyle:{padding:0},title:m.a.createElement("small",null,e.date?G()(e.date).format("ll"):null,t.state.currentPatient?null:m.a.createElement("span",null,m.a.createElement(le.b,{to:"/patient/"+(e.patient_data?e.patient_data.id:null)+"/billing/invoices"},"\xa0\xa0 ",e.patient_data?e.patient_data.user.first_name:null," (ID: ",e.patient_data&&e.patient_data.custom_id?e.patient_data.custom_id:e.patient_data.id,")\xa0"),", ",e.patient_data?e.patient_data.gender:null)),extra:m.a.createElement(ht.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Se.a,null,m.a.createElement(Se.a.Item,{key:"1"},m.a.createElement(le.b,{to:"/patient/"+(e.patient_data?e.patient_data.id:null)+"/billing/payments/add?invoices="+e.id},m.a.createElement(k.a,{type:"dollar"}),"\xa0 Pay")),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"2",onClick:function(){return t.editModelOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.payments_data||e.is_cancelled},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Se.a.Item,{key:"5",onClick:function(){return t.returnModelOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.is_cancelled},m.a.createElement(k.a,{type:"redo"}),"Return"),m.a.createElement(Se.a.Item,{key:"3",onClick:function(){return t.cancelModalOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.payments_data||e.is_cancelled},m.a.createElement(k.a,{type:"delete"}),"Cancel"),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"4"},m.a.createElement(le.b,{to:"/patient/"+e.patient+"/emr/timeline"},m.a.createElement(k.a,{type:"clock-circle"}),"Patient Timeline")),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"5"},m.a.createElement("a",{onClick:function(){return t.sendPatientMail(e)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return t.loadPDF(e.id)}},m.a.createElement(k.a,{type:"printer"})))},m.a.createElement(h.a,{gutter:8},m.a.createElement(g.a,{xs:24,sm:24,md:6,lg:4,xl:4,xxl:4,style:{padding:10}},e.is_cancelled?m.a.createElement(Ra.a,{message:"Cancelled",type:"error",showIcon:!0}):null,m.a.createElement(v.a,{style:{marginBottom:0}},e.invoice_id),m.a.createElement(O.a,{title:"Paid / Total ",value:e.payments_data?e.payments_data.toFixed(2):0,suffix:"/ "+e.total.toFixed(2)})),m.a.createElement(g.a,{xs:24,sm:24,md:18,lg:20,xl:20,xxl:20},"Membership Amount."==e.type?m.a.createElement(je.a,{bordered:!0,pagination:!1,columns:gn,dataSource:[{inventory:!0,name:"Membership",unit_cost:e.total,unit:1,discount_value:0,tax_value:0,total:e.total}],footer:function(){return bn({practice:e.practice_data,notes:e.notes,cancel_note:e.cancel_note})}}):m.a.createElement(je.a,{bordered:!0,pagination:!1,columns:gn,dataSource:[].concat(Object(D.a)(a),Object(D.a)(e.inventory),Object(D.a)(e.procedure)),footer:function(){return bn({practice:e.practice_data,notes:e.notes,cancel_note:e.cancel_note})}}))),t.state.editIncoiceVisible&&t.state.otpSent&&m.a.createElement(ln,Object.assign({key:"editInvoice"},t.state,{invoice:e,editInvoiceClose:t.editInvoiceClose},t.props)),t.state.returnIncoiceVisible&&t.state.otpSent&&m.a.createElement(an,Object.assign({key:"returnInvoice"},t.state,{invoice:e,returnInvoiceClose:t.returnInvoiceClose},t.props)))}var gn=[{title:"Treatment & Products",dataIndex:"drug",key:"drug",render:function(e,t){return m.a.createElement("span",null," ",m.a.createElement("b",null,t.name?t.name:null),m.a.createElement("br",null)," ",t.doctor_data?m.a.createElement(y.a,{color:t.doctor_data?t.doctor_data.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+t.doctor_data.user.first_name," ")):null)}},{title:"Cost",dataIndex:"unit_cost",key:"unit_cost",render:function(e,t){return m.a.createElement("span",null,t.unit_cost?t.unit_cost.toFixed(2):null)}},{title:"Unit",dataIndex:"unit",key:"unit"},{title:"Discount",dataIndex:"discount_value",key:"discount_value",render:function(e,t){return m.a.createElement("span",null,t.discount_value?t.discount_value.toFixed(2):null)}},{title:"Tax",dataIndex:"tax_value",key:"tax_value",render:function(e,t){return m.a.createElement("span",null,t.tax_value?t.tax_value.toFixed(2):null)}},{title:"Total",dataIndex:"total",key:"total",render:function(e){return e?e.toFixed(2):null}}];function En(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function vn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?En(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):En(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _n=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadEditPyament=function(e){var t=Object(o.a)(a),n={},i=[],r=0;a.setState((function(a){return e.forEach((function(e){n[e.invoice]=!0,i.push(vn({},e,{},e.invoice_data)),r+=e.pay_amount+e.pay_amount_wallet}),(function(){t.calculateInvoicePayments(),t.setPaymentAmount(r)})),{addedInvoice:i,addedInvoiceId:n}}))},a.loadAvailableAdvance=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.t,[e.props.match.params.id]),(function(t){e.setState({availableAdvance:t})}),(function(){}),{practice_id:a.props.active_practiceId})},a.loadPaymentModes=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.zc,[a.props.active_practiceId]),(function(t){t.length&&(t[0].mode==Y.ob&&e.setState({paymentModeOffline:!0}),e.setState({paymentModes:t,selectedPaymentMode:t[0].id}))}),(function(){}))},a.loadInvoices=function(e){var t=Object(o.a)(a);t.setState({invoiceLoading:!0});Object(F.c)(A.Bb,(function(a){t.setState((function(e){return{invoicesList:[].concat(Object(D.a)(a.results),Object(D.a)(e.addedInvoice)),invoiceLoading:!1,loadMoreInvoice:a.next}}),(function(){e&&e.forEach((function(e){t.addInvoiceToPayments(e)})),t.calculateInvoicePayments()}))}),(function(){t.setState({invoiceLoading:!1})}),{page:t.state.loadMoreInvoice||1,is_cancelled:!1,is_pending:!0,patient:a.props.match.params.id,practice:a.props.active_practiceId})},a.addInvoiceToPayments=function(e){var t=Object(o.a)(a);a.setState((function(t){var a=null;return t.invoicesList.forEach((function(t){t.id==e&&(a=t)})),a?{addedInvoice:[].concat(Object(D.a)(t.addedInvoice),[a]),addedInvoiceId:vn({},t.addedInvoiceId,Object(w.a)({},e,!0)),invoicePayments:vn({},t.addedInvoiceId,Object(w.a)({},e,0))}:null}),(function(){t.calculateInvoicePayments()}))},a.removeInvoiceToPayments=function(e){var t=Object(o.a)(a);a.setState((function(t){var a=[];return t.addedInvoice.forEach((function(t){t.id!=e&&a.push(t)})),a?{addedInvoice:a,addedInvoiceId:vn({},t.addedInvoiceId,Object(w.a)({},e,!1))}:null}),(function(){t.calculateInvoicePayments()}))},a.calculateInvoicePayments=function(){a.setState((function(e){var t=0,a=e.totalPayingAmount+e.totalPayingFromAdvanceAmount,n={};return e.addedInvoice.forEach((function(e){var i=e.total-e.payments_data;e.pay_amount&&(i+=e.pay_amount),e.pay_amount_wallet&&(i+=e.pay_amount_wallet),t+=i,a>=i?(a-=i,n[e.id]=i):(n[e.id]=a,a=0)})),{advanceToBeSent:a,totalPayableAmount:t.toFixed(2),invoicePayments:n}}))},a.setPaymentAmount=function(e){var t=Object(o.a)(a);a.setState({totalPayingAmount:e},(function(){t.calculateInvoicePayments()}))},a.setPaymentFromAdvanceAmount=function(e){var t=Object(o.a)(a);a.setState({totalPayingFromAdvanceAmount:e},(function(){t.calculateInvoicePayments()}))},a.changeSelectedPaymentMode=function(e){a.state.paymentModes.forEach((function(t){t.id==e&&(t.mode==Y.ob?a.setState({paymentModeOffline:!0}):a.setState({paymentModeOffline:!1}))})),a.setState({selectedPaymentMode:e})},a.changeNotes=function(e){a.setState({notes:e})},a.selectedDate=function(e){Object(o.a)(a).setState({selectDate:e})},a.handleSubmit=function(e){if(!a.state.totalPayingAmount)return Object(F.a)(N.bc,"Payment Amount of O INR is not allowed."),!1;a.setState({loading:!0});var t=Object(o.a)(a),n={invoices:[],bank:"",number:0,is_active:!0,notes:t.state.notes,is_cancelled:!1,practice:t.props.active_practiceId,patient:t.props.match.params.id,payment_mode:t.state.selectedPaymentMode,advance_value:t.state.advanceToBeSent,is_advance:!!t.state.advanceToBeSent,date:G()(t.state.selectDate).format("YYYY-MM-DD")},i=[];t.state.totalPayingAmount-t.state.totalPayableAmount>1&&(i.advance_value=t.state.totalPayingAmount-t.state.totalPayableAmount,i.is_advance=!0);var r=Object.keys(t.state.invoicePayments),l=vn({},t.state.invoicePayments),c=t.state.totalPayingFromAdvanceAmount,s=0;for(c&&t.state.availableAdvance.data.forEach((function(e){var t=c;e.advance_value<t&&(t=e.advance_value),t<0&&(t=0);for(var a=0;c&&r.length>s;)l[r[s]]&&t>l[r[s]]?(e.advance_value-=l[r[s]],e.invoices.push({pay_amount_advance:l[r[s]],pay_amount:l[r[s]],is_active:!0,invoice:r[s]}),c-=l[r[++s]],l[r[s]]-=l[r[s]]):l[r[s]]&&(e.invoices.push({pay_amount_advance:t,pay_amount:t,is_active:!0,invoice:r[s]}),l[r[s]]-=t,c-=t,e.advance_value-=t),e.advance_value||(e.is_advance=!1),console.log(a++);i.push(e)}));r.length>s;s++)n.invoices.push({pay_amount:l[r[s]],type:"Invoice",is_active:!0,invoice:r[s]});a.props.editPayment&&a.props.editPayment.id&&(n.id=a.props.editPayment.id),(n.invoices.length||n.id||n.is_advance)&&i.push(n),t.state.receivedPayIdFromRazorPay&&(n.bank="RazorPay",n.number=t.state.receivedPayIdFromRazorPay),console.log(i);Object(F.j)(A.H,i,(function(e){t.setState({loading:!1}),t.props.loadData(),t.props.history.replace("/patient/"+t.props.match.params.id+"/billing/payments")}),(function(){t.setState({loading:!1})}))},a.state={invoicesList:[],invoiceLoading:!0,addedInvoiceId:{},addedInvoice:[],paymentModes:[],totalPayableAmount:0,invoicePayments:{},totalPayingAmount:0,totalPayingFromAdvanceAmount:0,selectedPaymentMode:null,availableAdvance:null,advanceToBeSent:0,selectDate:G()(),loading:!1,paymentModeOffline:!1},a.loadEditPyament=a.loadEditPyament.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentWillMount",value:function(){this.props.editPayment&&this.props.editPayment.invoices&&this.loadEditPyament(this.props.editPayment.invoices);var e=[];if(this.props.history&&this.props.history.location.search){var t=this.props.history.location.search.substr(1).split("&");t.length&&t.forEach((function(t){"invoices"==t.split("=")[0]&&(e=t.split("=")[1].split(","))}))}this.loadInvoices(e),this.loadPaymentModes(),this.loadAvailableAdvance()}},{key:"paymentHandler",value:function(e,t,a){if(!a)return Object(F.a)(N.bc,"Payment Amount of O INR is not allowed."),!1;var n=this,i={key:ot.c,amount:100*a.toFixed(2),name:t.custom_id,description:"Payment for "+e,prefill:{name:t.user.first_name,email:t.user.email,contact:t.user.mobile},handler:function(e){var t=e.razorpay_payment_id,i={payment_id:t,amount:a};n.setState({loading:!0});Object(F.j)(A.a,i,(function(e){Object(F.a)(N.Sb,e.detail),n.setState({loading:!1,receivedPayIdFromRazorPay:t},(function(){n.handleSubmit()}))}),(function(){n.setState({loading:!1}),console.log("Request failed")}))}};new window.Razorpay(i).open()}},{key:"render",value:function(){var e=this,t=this;return m.a.createElement("div",null,m.a.createElement(n.a,{spinning:this.state.loading,size:"large"},m.a.createElement(h.a,{gutter:8},m.a.createElement(g.a,{xs:24,sm:24,md:16,lg:16,xl:18,xxl:18},m.a.createElement(j.a,null,m.a.createElement(h.a,null,m.a.createElement(g.a,{span:24},m.a.createElement("table",{style:{width:"100%"}},m.a.createElement("tbody",null,m.a.createElement("tr",{style:{borderBottom:"2px solid #ccc"}},m.a.createElement("td",{style:{width:"20%"}},m.a.createElement("small",null,"INVOICE NO")),m.a.createElement("td",{style:{width:"20%"}},m.a.createElement("small",null,"PROCEDURE")),m.a.createElement("td",{style:{width:"20%",textAlign:"right"}},m.a.createElement("small",null,"DUE(INR)")),m.a.createElement("td",{style:{width:"20%",textAlign:"right"}},m.a.createElement("small",null,"PAY NOW(INR)")),m.a.createElement("td",{style:{width:"20%",textAlign:"right"}},m.a.createElement("small",null,"DUE AFTER PAYMENT(INR)"))),this.state.addedInvoice.map((function(a){return m.a.createElement("tr",{style:{borderBottom:"2px solid #ccc"}},m.a.createElement("td",null,m.a.createElement(_.a,{size:"small",type:"danger",shape:"circle",icon:"close",style:{position:"absolute",right:"-35px"},onClick:function(){return e.removeInvoiceToPayments(a.id)}}),m.a.createElement("h3",null,a.invoice_id),a.date),m.a.createElement("td",null,a.procedure.map((function(e){return e.procedure_data.name+", "})),a.inventory.map((function(e){return e.inventory_item_data.name+", "})),a.reservation?a.type+",":null,a.reservation_data&&a.reservation_data.medicines?a.reservation_data.medicines.map((function(e){return e.name+","})):null),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(a.total-a.payments_data+(a.pay_amount||0)+(a.pay_amount_wallet||0)).toFixed(2))),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,t.state.invoicePayments[a.id])),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(a.total-a.payments_data+(a.pay_amount||0)+(a.pay_amount_wallet||0)-t.state.invoicePayments[a.id]).toFixed(2))))})))))),m.a.createElement(h.a,{style:{borderBottom:"2px dashed #ccc",marginTop:"20px"}},m.a.createElement(g.a,{span:6},m.a.createElement("h3",null,"Total Payable :")),m.a.createElement(g.a,{span:6},m.a.createElement("h2",null,this.state.totalPayableAmount))),m.a.createElement(h.a,{gutter:16,style:{marginTop:"20px"}},m.a.createElement(g.a,{span:12},m.a.createElement(h.a,null,m.a.createElement(g.a,{span:12},m.a.createElement("h3",null,"Amount From Advance :",m.a.createElement("br",null),m.a.createElement("small",null,"Available: ",this.state.availableAdvance?this.state.availableAdvance.max_allowed:0," INR"))),m.a.createElement(g.a,{span:12},m.a.createElement(C.a,{min:0,step:1,max:this.state.availableAdvance?this.state.availableAdvance.max_allowed:0,disabled:!this.state.availableAdvance||!this.state.availableAdvance.max_allowed,value:this.state.totalPayingFromAdvanceAmount,onChange:this.setPaymentFromAdvanceAmount}))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:12},m.a.createElement("h3",null,"Pay Now:")),m.a.createElement(g.a,{span:12},m.a.createElement(C.a,{min:0,step:1,value:this.state.totalPayingAmount,onChange:this.setPaymentAmount})))),m.a.createElement(g.a,{span:12},m.a.createElement(h.a,null,m.a.createElement(g.a,{span:10},m.a.createElement("h3",null,"Payment Mode :")),m.a.createElement(g.a,{span:12},m.a.createElement(x.a,{style:{width:"100%"},value:this.state.selectedPaymentMode,onChange:this.changeSelectedPaymentMode},this.state.paymentModes.map((function(e){return m.a.createElement(x.a.Option,{value:e.id,key:e.id},e.mode)}))),m.a.createElement("br",null),m.a.createElement("br",null))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:24},m.a.createElement(T.a.TextArea,{row:2,placeholder:"Notes...",size:"small",onChange:function(t){return e.changeNotes(t.target.value)}},this.state.notes))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6},m.a.createElement("br",null),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(M.a,{style:{width:150},defaultValue:G()(),onChange:function(e){return t.selectedDate(e)},allowClear:!1}))))),m.a.createElement(h.a,null,m.a.createElement(g.a,{span:24,style:{align:"center"}},m.a.createElement(E.a,{title:"Are you sure to take payment of INR "+this.state.totalPayingAmount+"?",onConfirm:function(){return e.paymentHandler(e.state.addedInvoice.map((function(e){return e.invoice_id})).join(", "),e.props.currentPatient,e.state.totalPayingAmount)}},m.a.createElement(_.a,{type:"primary",style:{margin:5},disabled:t.props.editPayment&&t.props.editPayment.invoices||t.state.paymentModeOffline},"Pay Online & Save Payments")),m.a.createElement(E.a,{title:"Are you sure to take payment of INR "+this.state.totalPayingAmount+"?",onConfirm:this.handleSubmit},m.a.createElement(_.a,{type:"primary",style:{margin:5}},"Only Save Payments")))))),m.a.createElement(g.a,{xs:24,sm:24,md:6,lg:8,xl:6,xxl:6},m.a.createElement(b.a,{loading:this.state.invoiceLoading,dataSource:this.state.invoicesList,renderItem:function(a){return t.state.addedInvoiceId[a.id]?m.a.createElement("div",null):m.a.createElement(j.a,{hoverable:!0,onClick:function(){return e.addInvoiceToPayments(a.id)},style:{marginBottom:"10px"}},m.a.createElement("table",{style:{width:"100%"}},m.a.createElement("tbody",null,m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},m.a.createElement("h4",null,a.invoice_id)),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,a.date))))),m.a.createElement(v.a,{style:{margin:0}}),m.a.createElement("table",{style:{width:"100%"}},m.a.createElement("tbody",null,a.procedure.map((function(e){return m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},e.procedure_data.name),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(e.unit*e.unit_cost).toFixed(2))))})),a.inventory.map((function(e){return m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},e.inventory_item_data.name),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(e.unit*e.unit_cost).toFixed(2))))})),a.reservation?m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},a.type),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,a.reservation_data.bed_package_price?a.reservation_data.bed_package_price.toFixed(2):null))):null,a.reservation_data&&a.reservation_data.medicines?m.a.createElement(m.a.Fragment,null,a.reservation_data.medicines.map((function(e){return m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},e.name),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,e.final_price.toFixed(2))))}))):null)),m.a.createElement(v.a,{style:{margin:0}}),m.a.createElement("table",{style:{width:"100%"}},m.a.createElement("tbody",null,m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},"Invoice Amount"),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,a.total.toFixed(2)))),m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},"Paid Amount"),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,a.payments_data?a.payments_data.toFixed(2):0))),m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},m.a.createElement("b",null,"Amount Due")),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(a.total-a.payments_data).toFixed(2)))))))}})))))}}]),t}(m.a.Component);function On(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Pn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitEditPayment=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var i=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?On(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):On(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{practice:a.props.active_practiceId});Object(F.j)(A.M,i,(function(e){t.setState({editPaymentVisible:!1}),t.editPaymentData(t.props.editPayment),t.props.editPaymentClose()}),(function(){}))}}))},a.editPaymentData=function(e){Object(o.a)(a).props.history.push("/patient/"+e.patient+"/billing/payments/edit/")},a.state={otpSent:a.props.otpSent,editPaymentVisible:a.props.editPaymentVisible,cancelPaymentVisible:a.props.cancelPaymentVisible},a.editPaymentData=a.editPaymentData.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"sendOTP",value:function(){Object(F.c)(A.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return m.a.createElement(f.a,{visible:this.state.editPaymentVisible&&this.props.editPayment&&this.props.editPayment.id==this.props.payment.id,title:"Edit Invoice",footer:null,onOk:this.handleSubmitEditPayment,onCancel:this.props.editPaymentClose},m.a.createElement(I.a,null,m.a.createElement(I.a.Item,null,e("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(T.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(I.a.Item,null,this.props.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitEditPayment},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:this.props.editPaymentClose},"Close"))))}}]),t}(m.a.Component),kn=I.a.create()(Pn);function jn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Cn=T.a,Sn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitCancelPayment=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var i=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?jn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):jn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{practice:a.props.active_practiceId});t.state.otpField?Object(F.j)(A.M,i,(function(e){t.setState({cancelPaymentVisible:!1}),t.deletePayment(t.props.editPayment.patient_data,t.props.editPayment.id,n.cancel_note)}),(function(){})):t.deletePayment(t.props.editPayment.patient_data,t.props.editPayment.id,n.cancel_note)}}))},a.state={cancelPaymentVisible:a.props.cancelPaymentVisible,otpSent:a.props.otpSent,otpField:!1},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){G()().diff(this.props.editPayment.created_at,"minutes")>N.qb&&this.setState({otpField:!0})}},{key:"deletePayment",value:function(e,t,a){var n=this;console.log("log",e,t,a);var i={patient:e.id,is_cancelled:!0,cancel_note:a};Object(F.l)(Object(F.f)(A.pd,[t]),i,(function(e){n.props.cancelPaymentClose(),Object(F.a)(N.Sb,"Payment cancelled successfully"),n.props.loadPayments()}),(function(){}))}},{key:"sendOTP",value:function(){Object(F.c)(A.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.state.otpField,t=this.props.form.getFieldDecorator;return m.a.createElement(f.a,{visible:this.state.cancelPaymentVisible,title:"Cancel Payment",footer:null,onOk:this.handleSubmitCancelPayment,onCancel:this.props.cancelPaymentClose},m.a.createElement(I.a,null,m.a.createElement(I.a.Item,{key:"text-area-note"},t("cancel_note",{rules:[{required:!0,message:cn.j}]})(m.a.createElement(Cn,{placeholder:"cancel notes"}))),e?m.a.createElement(I.a.Item,{key:"otp"},t("otp",{rules:[{required:e,message:"Please input Otp!"}]})(m.a.createElement(T.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))):null,m.a.createElement(I.a.Item,{key:"btn"},this.state.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitCancelPayment},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:this.props.cancelPaymentClose},"Close"))))}}]),t}(m.a.Component),In=I.a.create()(Sn),xn=(ce.Modal.confirm,function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPayments=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(o.a)(a);t.props.refreshWallet&&1==e&&t.props.refreshWallet(),a.setState({loading:!0});var n=function(e){t.setState((function(t){return 1==e.current?{payments:Object(D.a)(e.results),next:e.next,loading:!1}:{payments:[].concat(Object(D.a)(t.payments),Object(D.a)(e.results)),next:e.next,loading:!1}}))},i=function(){t.setState({loading:!1})},r={page:e,practice:a.props.active_practiceId};a.props.match.params.id&&(r.patient=a.props.match.params.id),Object(F.c)(A.uc,n,i,r)},a.loadPDF=function(e){Object(o.a)(a);Object(F.c)(Object(F.f)(A.Ac,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))},a.updateFormValue=function(e,t){a.setState(Object(w.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:st.get(e,"patient_data.user.first_name"),paymentId:st.get(e,"id"),mail_to:st.get(e,"patient_data.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.paymentId,i={mail_to:t};Object(de.g)(Object(F.f)(A.Ac,[n]),i),a.mailModalClose()},a.editModelOpen=function(e){var t=Object(o.a)(a),n=G()().diff(e.created_at,"minutes");if(console.log("otp",n),n>N.qb){t.setState({editPaymentVisible:!0,cancelPaymentVisible:!1,editPayment:e});var i={practice:a.props.active_practiceId,type:"Payment:"+e.payment_id+" Edit"};Object(F.j)(A.K,i,(function(a){t.setState({otpSent:!0,patientId:e.patient,paymentId:e.payment_id})}),(function(){}))}else t.setState({editPayment:e},(function(){t.props.history.push("/patient/"+e.patient+"/billing/payments/edit")}))},a.editPaymentData=function(e){var t=Object(o.a)(a);t.setState({editPayment:e},(function(){t.props.history.push("/patient/"+e.patient+"/billing/payments/edit/")}))},a.cancelModalOpen=function(e){var t=Object(o.a)(a),n=G()().diff(e.created_at,"minutes");console.log("otp",n,N.qb,e),console.log(n>N.qb),t.setState({editPaymentVisible:!1,cancelPaymentVisible:!0,editPayment:e});var i={practice:a.props.active_practiceId,type:"Payment:"+e.payment_id+"  Cancellation"};n>N.qb&&Object(F.j)(A.K,i,(function(a){t.setState({otpSent:!0,patientId:e.patient,paymentId:e.id})}),(function(){}))},a.editPaymentClose=function(){a.setState({editPaymentVisible:!1})},a.cancelPaymentClose=function(){a.setState({cancelPaymentVisible:!1})},a.state={payments:[],active_practiceId:a.props.active_practiceId,loading:!0,otpSent:!1,editPaymentVisible:!1,editPayment:null},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadPayments()}},{key:"deletePayment",value:function(e,t){var a=this,n={patient:e,is_cancelled:!0};Object(F.l)(Object(F.f)(A.pd,[t]),n,(function(e){Object(F.a)(N.Sb,"Payment cancelled successfully"),a.loadPayments()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a={};return this.state.paymentModes&&this.state.paymentModes.forEach((function(e){a[e.id]=e.mode})),this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/payments/add",render:function(t){return m.a.createElement(_n,Object.assign({},e.state,t,e.props,{loadData:e.loadPayments}))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/payments/edit",render:function(a){return t.state.editPayment?m.a.createElement(_n,Object.assign({},e.state,a,e.props,{paymentId:e.state.paymentId,loadData:e.loadPayments})):m.a.createElement(p.a,{to:"/patient/"+a.match.params.id+"/billing/payments"})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(Ra.a,{banner:!0,showIcon:!0,type:"info",message:"The payments shown are only for the current selected practice!"}),m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.name+" Payments":"Payments",extra:m.a.createElement(_.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/billing/payments/add"},m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"plus"}),"Add")))}),this.state.payments.map((function(t){return Mn(t,e)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadPayments(t.state.next)},loading:this.state.loading,hidden:!this.state.next})))),m.a.createElement(ce.Modal,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Payment To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:t.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),t.state.cancelPaymentVisible?m.a.createElement(In,Object.assign({},t.state,{key:"cancel_payment",cancelPaymentClose:t.cancelPaymentClose,loadPayments:t.loadPayments})):null):m.a.createElement("div",null,m.a.createElement(j.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.name+" Payments":"Payments",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"plus"}),"Add"))}),this.state.payments.map((function(t){return Mn(t,e)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadPayments(t.state.next)},loading:this.state.loading,hidden:!this.state.next}),m.a.createElement(ce.Modal,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send Payment To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:t.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),t.state.cancelPaymentVisible?m.a.createElement(In,Object.assign({},t.state,{key:"cancel_payment",cancelPaymentClose:t.cancelPaymentClose,loadPayments:t.loadPayments})):null)}}]),t}(m.a.Component)),Dn=I.a.create()(xn),wn=[{title:"INVOICE",dataIndex:"invoice_id",key:"invoice",render:function(e){return m.a.createElement("span",null,e)}},{title:"Amount Paid",key:"pay_amount",dataIndex:"pay_amount",render:function(e){return e?e.toFixed(2):0}}];function Mn(e,t){t.props.form.getFieldDecorator;var a=[];return e.is_advance&&a.push({invoice_id:"Advance Payment",pay_amount:e.advance_value}),m.a.createElement(j.a,{style:{marginTop:10},key:e.id,bodyStyle:{padding:0},title:e.patient_data&&!t.props.currentPatient?m.a.createElement("small",null,e.date?G()(e.date).format("lll"):null,m.a.createElement(le.b,{to:"/patient/"+e.patient_data.id+"/billing/payments"},"\xa0\xa0 ",e.patient_data.user.first_name," (ID: ",e.patient_data.custom_id?e.patient_data.custom_id:e.patient_data.id,")\xa0"),m.a.createElement("span",null,", ",e.patient_data.gender)):m.a.createElement("small",null,e.created_at?G()(e.created_at).format("lll"):null),extra:m.a.createElement(ht.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Se.a,null,m.a.createElement(Se.a.Item,{key:"2",onClick:function(){return t.editModelOpen(e)},disabled:e.practice!=t.props.active_practiceId},m.a.createElement(k.a,{type:"edit"}),"Edit"),m.a.createElement(Se.a.Item,{key:"3",onClick:function(){return t.cancelModalOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.is_cancelled},m.a.createElement(k.a,{type:"delete"}),"Cancel"),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"4"},m.a.createElement(le.b,{to:"/patient/"+e.patient+"/emr/timeline"},m.a.createElement(k.a,{type:"clock-circle"}),"Patient Timeline")),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"4"},m.a.createElement("a",{onClick:function(){return t.sendPatientMail(e)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return t.loadPDF(e.id)}},m.a.createElement(k.a,{type:"printer"})))},m.a.createElement(h.a,{gutter:8},m.a.createElement(g.a,{xs:24,sm:24,md:6,lg:4,xl:4,xxl:4,style:{padding:10}},e.is_cancelled?m.a.createElement(Ra.a,{message:"Cancelled",type:"error",showIcon:!0}):null,m.a.createElement(v.a,{style:{marginBottom:0}},e.payment_id)),m.a.createElement(g.a,{xs:24,sm:24,md:18,lg:20,xl:20,xxl:20},m.a.createElement(je.a,{columns:wn,pagination:!1,footer:function(){return function(e){if(e)return m.a.createElement("p",null,e.doctor?m.a.createElement(we.a,{title:"Doctor"},m.a.createElement(y.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+e.doctor.user.first_name," "))):null,e.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null,e.notes?m.a.createElement("p",null,"Notes: ",e.notes):null,e.cancel_note?m.a.createElement("p",null,"Cancel Notes: ",e.cancel_note):null);return null}({practice:e.practice_data,notes:e.notes,cancel_note:e.cancel_note})},dataSource:[].concat(Object(D.a)(e.invoices),a),rowKey:e.id}))),t.state.editPaymentVisible&&t.state.otpSent&&m.a.createElement(kn,Object.assign({},t.state,{payment:e,editPaymentClose:t.editPaymentClose,key:e.id,editPaymentData:t.editPaymentData},t.props)))}function Tn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Fn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Tn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Tn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var An=T.a.TextArea,Ln=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPDF=function(e){Object(o.a)(a);Object(F.c)(Object(F.f)(A.Qc,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))},a.updateFormValue=function(e,t){a.setState(Object(w.a)({},e,t))},a.mailModalOpen=function(){a.setState({visibleMail:!0})},a.mailModalClose=function(){a.setState({visibleMail:!1})},a.sendPatientMail=function(e){a.mailModalOpen(),a.setState({patientName:st.get(e,"patient_data.user.first_name"),paymentId:st.get(e,"id"),mail_to:st.get(e,"patient_data.user.email")})},a.sendMailToPatient=function(){var e=a.state,t=e.mail_to,n=e.paymentId,i={mail_to:t};Object(de.g)(Object(F.f)(A.Qc,[n]),i),a.mailModalClose()},a.cancelModalOpen=function(e){var t=Object(o.a)(a),n=G()().diff(e.created_at,"minutes");n>N.qb&&t.setState({otpField:!0}),t.setState({cancelReturnIncoiceVisible:!0,editReturnInvoice:e,patientId:e.patient});var i={practice:a.props.active_practiceId,type:"Return Invoice:"+e.return_id+"  Cancellation"};n>N.qb&&Object(F.j)(A.K,i,(function(a){t.setState({otpSent:!0,patientId:e.patient,returnInvoiceId:e.id})}),(function(){}))},a.cancelReturnInvoiceClose=function(){a.setState({cancelReturnIncoiceVisible:!1})},a.handleSubmitCancelReturnInvoice=function(e){var t=Object(o.a)(a),n=G()().diff(t.state.editReturnInvoice.created_at,"minutes");e.preventDefault(),a.props.form.validateFields((function(e,i){if(!e){var r=Fn({},i,{practice:a.props.active_practiceId});n>N.qb?Object(F.j)(A.M,r,(function(e){t.setState({cancelReturnIncoiceVisible:!1,otpField:!1}),t.deleteReturnInvoice(t.state.patientId,t.state.returnInvoiceId,i.cancel_note)}),(function(){})):t.deleteReturnInvoice(t.state.patientId,t.state.editReturnInvoice.id,i.cancel_note)}}))},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,returnInvoices:[],drug_catalog:null,procedure_category:null,taxes_list:null,loading:!0,cancelReturnIncoiceVisible:!1,otpField:!1},a.loadReturnInvoices=a.loadReturnInvoices.bind(Object(o.a)(a)),a.loadDrugCatalog=a.loadDrugCatalog.bind(Object(o.a)(a)),a.loadProcedureCategory=a.loadProcedureCategory.bind(Object(o.a)(a)),a.loadTaxes=a.loadTaxes.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadReturnInvoices()}},{key:"loadReturnInvoices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;t.props.refreshWallet&&1==e&&t.props.refreshWallet(),t.setState({loading:!0});var a=function(e){1==e.current?t.setState({total:e.count,returnInvoices:e.results,loading:!1,loadMoreReturnInvoice:e.next}):t.setState((function(t){return{total:e.count,returnInvoices:[].concat(Object(D.a)(t.returnInvoices),Object(D.a)(e.results)),loading:!1,loadMoreReturnInvoice:e.next}}))},n=function(){t.setState({loading:!1})},i={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(i.patient=this.props.match.params.id),Object(F.c)(A.Db,a,n,i)}},{key:"loadDrugCatalog",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Z,[this.props.active_practiceId]),(function(t){e.setState({drug_catalog:t})}),(function(){}))}},{key:"loadProcedureCategory",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),(function(t){e.setState({procedure_category:t})}),(function(){}))}},{key:"loadTaxes",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Ed,[this.props.active_practiceId]),(function(t){e.setState({taxes_list:t})}),(function(){}))}},{key:"sendOTP",value:function(){Object(F.c)(A.L,(function(e){}),(function(){}))}},{key:"deleteReturnInvoice",value:function(e,t,a){var n=this,i={patient:e,is_cancelled:!0,cancel_note:a};Object(F.l)(Object(F.f)(A.ud,[t]),i,(function(e){Object(F.a)(N.Sb,"Return Invoice cancelled successfully"),n.loadReturnInvoices(),n.cancelReturnInvoiceClose()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a={};this.state.drug_catalog&&this.state.drug_catalog.forEach((function(e){a[e.id]=e.name+","+e.strength}));var i={};this.state.procedure_category&&this.state.procedure_category.forEach((function(e){i[e.id]=e.name}));var r={};this.state.taxes_list&&this.state.taxes_list.forEach((function(e){r[e.id]=e.name}));var l=t.props.form.getFieldDecorator;return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(Ra.a,{banner:!0,showIcon:!0,type:"info",message:"The invoices return shown are only for the current selected practice!"}),m.a.createElement(Je.a,{offsetTop:0},m.a.createElement(j.a,{bodyStyle:{padding:0},style:{boxShadow:"0 5px 8px rgba(0, 0, 0, 0.09)"},title:(this.state.currentPatient?this.state.currentPatient.user.first_name+" Invoice Return":"Invoices Return ")+(this.state.total?"(Total:".concat(this.state.total,")"):"")})),this.state.returnInvoices.map((function(e){return Nn(e,t)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadInvoices(e.state.loadMoreInvoice)},loading:this.state.loading,hidden:!this.state.loadMoreInvoice})))),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send invoice To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:t.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),m.a.createElement(f.a,{visible:t.state.cancelReturnIncoiceVisible,title:"Cancel Return Invoice",footer:null,onOk:t.handleSubmitCancelReturnInvoice,onCancel:t.cancelReturnInvoiceClose},m.a.createElement(I.a,null,m.a.createElement(I.a.Item,{key:"cancel_notes"},l("cancel_note",{rules:[{required:!0,message:cn.j}]})(m.a.createElement(An,{placeholder:"cancel notes"}))),t.state.otpField&&m.a.createElement(I.a.Item,null,l("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(T.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(I.a.Item,null,t.state.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:t.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:t.handleSubmitCancelReturnInvoice},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:t.cancelReturnInvoiceClose},"Close"))))):m.a.createElement("div",null,m.a.createElement(Je.a,{offsetTop:0},m.a.createElement(j.a,{bodyStyle:{padding:0},style:{boxShadow:"0 5px 8px rgba(0, 0, 0, 0.09)"},title:(this.state.currentPatient?this.state.currentPatient.user.first_name+" Invoice Return":"Invoice Return ")+(this.state.total?"(Total:".concat(this.state.total,")"):"")})),this.state.returnInvoices.map((function(e){return Nn(e,t)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadInvoices(e.state.loadMoreInvoice)},loading:this.state.loading,hidden:!this.state.loadMoreInvoice}),m.a.createElement(f.a,{title:null,visible:this.state.visibleMail,onOk:this.sendMailToPatient,onCancel:this.mailModalClose,footer:[m.a.createElement(_.a,{key:"back",onClick:this.mailModalClose},"Cancel"),m.a.createElement(_.a,{key:"submit",type:"primary",onClick:this.sendMailToPatient},"Send")]},m.a.createElement("p",null,"Send invoice To ",this.state.patientName," ?"),m.a.createElement(T.a,{value:t.state.mail_to,placeholder:"Email",onChange:function(e){return t.updateFormValue("mail_to",e.target.value)}})),m.a.createElement(f.a,{visible:t.state.cancelReturnIncoiceVisible,title:"Cancel Return Invoice",footer:null,onOk:t.handleSubmitCancelReturnInvoice,onCancel:t.cancelReturnInvoiceClose},m.a.createElement(I.a,null,m.a.createElement(I.a.Item,{key:"cancel_notes"},l("cancel_note",{rules:[{required:!0,message:cn.j}]})(m.a.createElement(An,{placeholder:"cancel notes"}))),t.state.otpField&&m.a.createElement(I.a.Item,null,l("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(T.a,{prefix:m.a.createElement(k.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(I.a.Item,null,t.state.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:t.sendOTP},"Resend Otp ?"):null,m.a.createElement(_.a,{size:"small",type:"primary",htmlType:"submit",onClick:t.handleSubmitCancelReturnInvoice},"Submit"),"\xa0",m.a.createElement(_.a,{size:"small",onClick:t.cancelReturnInvoiceClose},"Close")))))}}]),t}(m.a.Component),Vn=I.a.create()(Ln);function Nn(e,t){return m.a.createElement(j.a,{key:e.id,style:{marginTop:10},bodyStyle:{padding:0},title:m.a.createElement("small",null,e.date?G()(e.date).format("ll"):null,t.state.currentPatient?null:m.a.createElement("span",null,m.a.createElement(le.b,{to:"/patient/"+(e.patient_data?e.patient_data.id:null)+"/billing/return/invoices"},"\xa0\xa0 ",e.patient_data?e.patient_data.user.first_name:null," (ID: ",e.patient_data.custom_id?e.patient_data.custom_id:e.patient_data.id,")\xa0"),", ",e.patient_data?e.patient_data.gender:null)),extra:m.a.createElement(ht.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Se.a,null,m.a.createElement(Se.a.Item,{key:"1",onClick:function(){return t.cancelModalOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.payments_data||e.is_cancelled},m.a.createElement(k.a,{type:"delete"}),"Cancel"),m.a.createElement(Se.a.Divider,null),m.a.createElement(Se.a.Item,{key:"2"},m.a.createElement("a",{onClick:function(){return t.sendPatientMail(e)}},m.a.createElement(k.a,{type:"mail"})," Send mail to patient")))},m.a.createElement("a",{onClick:function(){return t.loadPDF(e.id)}},m.a.createElement(k.a,{type:"printer"})))},m.a.createElement(h.a,{gutter:8},m.a.createElement(g.a,{xs:24,sm:24,md:6,lg:4,xl:4,xxl:4,style:{padding:10}},e.is_cancelled?m.a.createElement(Ra.a,{message:"Cancelled",type:"error",showIcon:!0}):null,m.a.createElement(v.a,{style:{marginBottom:0}},e.return_id),m.a.createElement(O.a,{title:"Cash / Return ",value:e.cash_return?e.cash_return.toFixed(2):0,suffix:"/ "+(e.return_value?e.return_value.toFixed(2):0)})),m.a.createElement(g.a,{xs:24,sm:24,md:18,lg:20,xl:20,xxl:20},m.a.createElement(je.a,{bordered:!0,pagination:!1,columns:Rn,dataSource:[].concat(Object(D.a)(e.inventory),Object(D.a)(e.procedure)),footer:function(){return(t=Fn({},e))?m.a.createElement("p",null,t.staff?m.a.createElement(we.a,{title:"Staff"},m.a.createElement(y.a,{color:t.staff?t.staff_data.calendar_colour:null},m.a.createElement("b",null,"Return by  "+t.staff_data.user.first_name," "))):null,t.practice?m.a.createElement(y.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,t.practice_data.name," "))):null,t.notes?m.a.createElement("p",null,"Notes: ",t.notes):null,t.cancel_note?m.a.createElement("p",null,"Cancel Notes: ",t.cancel_note):null):null;var t}}))))}var Rn=[{title:"Treatment & Products",dataIndex:"drug",key:"drug",render:function(e,t){return m.a.createElement("span",null," ",m.a.createElement("b",null,t.name?t.name:null))}},{title:"Cost",dataIndex:"unit_cost",key:"unit_cost",render:function(e,t){return m.a.createElement("span",null,t.unit_cost?t.unit_cost.toFixed(2):null)}},{title:"Unit",dataIndex:"unit",key:"unit"},{title:"Discount",dataIndex:"discount_value",key:"discount_value",render:function(e,t){return m.a.createElement("span",null,t.discount_value?t.discount_value.toFixed(2):null)}},{title:"Tax",dataIndex:"tax_value",key:"tax_value",render:function(e,t){return m.a.createElement("span",null,t.tax_value?t.tax_value.toFixed(2):null)}},{title:"Total",dataIndex:"total",key:"total",render:function(e){return e?e.toFixed(2):null}}],Bn=function(e){var t="";return"Invoice"!=e.type&&(t+=e.type+", "),e.procedure&&e.procedure.forEach((function(e){e.procedure_data&&(t+=e.procedure_data.name+", ")})),e.inventory&&e.inventory.forEach((function(e){e.inventory_item_data&&(t+=e.inventory_item_data.name+", ")})),e.reservation&&(t+=e.type+","),e.reservation_data&&e.reservation_data.medicines&&e.reservation_data.medicines.forEach((function(e){t+=e.name+","})),t.trim(",")},zn=function(e){var t="";return e.invoices&&e.invoices.forEach((function(e){e.invoice&&(t+=e.invoice.invoice_id+", ")})),t},Yn=function(e){var t="";return e.procedure&&e.procedure.forEach((function(e){e.procedure_data&&(t+=e.procedure_data.name+", ")})),e.inventory&&e.inventory.forEach((function(e){t+=e.name+", "})),e.reservation&&(t+=e.type+","),e.reservation_data&&e.reservation_data.medicines&&e.reservation_data.medicines.forEach((function(e){t+=e.name+","})),t.trim(",")};function qn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Gn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?qn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):qn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Wn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPatientLedger=function(){var e=Object(o.a)(a);e.props.refreshWallet&&e.props.refreshWallet(),a.setState({loadingLedger:!0});var t={practice_id:a.props.active_practiceId};a.props.showAllClinic&&a.props.match.params.id&&delete t.practice,Object(F.c)(Object(F.f)(A.rc,[e.props.currentPatient.id]),(function(t){var a=[],n=0,i=0,r=0;t.forEach((function(e){var t={date:e.date,type:e.ledger_type};"Invoice"==e.ledger_type?(t.type_id=e.invoice_id,t.details=Bn(e),t.credit=e.total,t.debit=0,t.return=0,t.cash_return=0):"Payment"==e.ledger_type?(t.type_id=e.payment_id,t.details=zn(e),e.return_pay?(t.credit=0,t.debit=0,t.return=-1*(e.total+e.advance_value)):(t.credit=0,t.debit=e.total+e.advance_value,t.return=0),t.cash_return=0):"Return"==e.ledger_type&&(t.type_id=e.return_id,t.details=Yn(e),t.credit=e.cash_return,t.debit=0,t.return=e.return_value,0==e.with_tax&&(t.credit+=e.taxes),t.cash_return=e.cash_return),n+=t.credit,n-=t.debit,r+=t.debit,i+=t.credit,t.balance=n,a.push(t)})),e.setState({loadingLedger:!1,credit:i,debit:r,balance:n,ledger:a})}),(function(){e.setState({loadingLedger:!1})}),t)},a.loadPDF=function(e){Object(o.a)(a)},a.state={loading:!1,ledger:[],loadingLedger:!1,selectedList:{},credit:0,debit:0,balance:0},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadPatientLedger()}},{key:"ledgerCompleteToggle",value:function(e,t){this.setState((function(a){return{selectedList:Gn({},a.selectedList,Object(w.a)({},e,!!t))}}))}},{key:"render",value:function(){return m.a.createElement(h.a,null,m.a.createElement(j.a,{title:this.state.currentPatient?this.state.currentPatient.name+" Payment Ledger":"Patient Ledgers",extra:m.a.createElement(_.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/billing/payments"}," ",m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"\xa0Add Payment")),m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/billing/invoices"}," ",m.a.createElement(_.a,{type:"primary"},m.a.createElement(k.a,{type:"plus"}),"\xa0Add Invoice")),"\xa0")},m.a.createElement(je.a,{loading:this.state.loadingLedger,columns:[{title:"Date",key:"date",dataIndex:"date",width:120},{title:"Invoice/ Receipt/ Return No",key:"type_id",dataIndex:"type_id"},{title:"Details",key:"details",dataIndex:"details"},{title:"Type",key:"type",dataIndex:"type"},{title:"Return(INR)",key:"return",dataIndex:"return",align:"right",render:function(e){return e.toFixed(2)}},{title:"Cash Return(INR)",key:"cash_return",dataIndex:"cash_return",align:"right",render:function(e){return e.toFixed(2)}},{title:"Credit(INR)",key:"credit",dataIndex:"credit",align:"right",render:function(e){return e.toFixed(2)}},{title:"Debit(INR)",key:"debit",dataIndex:"debit",align:"right",render:function(e){return e.toFixed(2)}},{title:"Balance(INR)",key:"balance",dataIndex:"balance",align:"right",render:function(e){return e.toFixed(2)}}],dataSource:this.state.ledger,pagination:!1}),m.a.createElement(h.a,{style:{marginTop:20,textAlign:"center"}},m.a.createElement(g.a,{span:8},m.a.createElement("h3",null,"Total Credit: ",this.state.credit.toFixed(2))),m.a.createElement(g.a,{span:8},m.a.createElement("h3",null,"Total Debit: ",this.state.debit.toFixed(2))),m.a.createElement(g.a,{span:8},m.a.createElement("h3",null,"Total Balance: ",this.state.balance<0?(-1*this.state.balance).toFixed(2)+" (Advance)":this.state.balance.toFixed(2))))))}}]),t}(m.a.Component),Hn=(a(458),a(474)),Un=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).searchPatient=function(e){a.setState({searchPatientString:e});var t=Object(o.a)(a);e&&Object(F.c)(Object(F.f)(A.Vc,[e]),(function(e){e&&t.setState({patientListData:e.results})}),(function(){}))},a.removePatient=function(e){a.setState(Object(w.a)({},e,null))},a.handlePatientSelect=function(e,t){if(console.log(e),e){var n=Object(o.a)(a);Object(F.c)(Object(F.f)(A.wc,[e]),(function(e){n.setState(Object(w.a)({},t,e))}),(function(){}))}},a.mergePatient=function(){a.setState({loading:!0});var e=Object(o.a)(a),t={patient_from:a.state.patient_from.id,patient_to:a.state.patient_to.id};Object(F.j)(A.cc,t,(function(t){Object(F.a)(N.Sb,"Patients Merged Successfully!!"),e.setState({loading:!1,patient_from:null,patient_to:null})}),(function(){Object(F.a)(N.Q,"Patients Merging Failed!!"),e.setState({loading:!1})}))},a.state={patient_from:null,patient_to:null,loading:!1,patientListData:[]},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return m.a.createElement("div",null,m.a.createElement("h2",null,"Merge Patients"),m.a.createElement(j.a,null,m.a.createElement(Ra.a,{message:"Profile details and records of Patient 1 will be moved to Patient 2. You cannot undo this action once done.",type:"warning"}),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(h.a,{gutter:16,style:{marginTop:10}},m.a.createElement(g.a,{span:12,style:{textAlign:"center"}},m.a.createElement("h3",null,"Patient 1"),this.state.patient_from?m.a.createElement(j.a,{bordered:!1,style:{background:"#ECECEC",textAlign:"left"}},m.a.createElement(j.a.Meta,{avatar:this.state.patient_from.image?m.a.createElement(P.a,{src:Object(F.g)(this.state.patient_from.image)}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"}},this.state.patient_from.user.first_name?this.state.patient_from.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),title:this.state.patient_from.user.first_name,description:this.state.patient_from.user.mobile}),m.a.createElement(_.a,{type:"primary",style:{float:"right"},onClick:function(){return e.removePatient("patient_from")}},"Select Different Patient")):m.a.createElement(Hn.a,{placeholder:"Patient Name",showSearch:!0,onSearch:this.searchPatient,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onChange:this.handleChange,onSelect:function(t){return e.handlePatientSelect(t,"patient_from")}},this.state.patientListData.map((function(e){return m.a.createElement(Hn.a.Option,{value:e.id.toString()},m.a.createElement(b.a.Item,{style:{padding:0}},m.a.createElement(b.a.Item.Meta,{avatar:e.image?m.a.createElement(P.a,{src:Object(F.g)(e.image)}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"}},e.user.first_name?e.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),title:e.user.first_name+" ("+e.user.id+")",description:m.a.createElement("small",null,e.user.mobile)})))})))),m.a.createElement(g.a,{span:12,style:{textAlign:"center"}},m.a.createElement("h3",null,"Patient 2"),this.state.patient_to?m.a.createElement(j.a,{bordered:!1,style:{background:"#ECECEC",textAlign:"left"}},m.a.createElement(j.a.Meta,{avatar:this.state.patient_to.image?m.a.createElement(P.a,{src:Object(F.g)(this.state.patient_to.image)}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"}},this.state.patient_to.user.first_name?this.state.patient_to.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),title:this.state.patient_to.user.first_name,description:this.state.patient_to.user.mobile}),m.a.createElement(_.a,{type:"primary",style:{float:"right"},onClick:function(){return e.removePatient("patient_to")}},"Select Different Patient")):m.a.createElement(Hn.a,{placeholder:"Patient Name",showSearch:!0,onSearch:this.searchPatient,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onChange:this.handleChange,onSelect:function(t){return e.handlePatientSelect(t,"patient_to")}},this.state.patientListData.map((function(e){return m.a.createElement(Hn.a.Option,{value:e.id.toString()},m.a.createElement(b.a.Item,{style:{padding:0}},m.a.createElement(b.a.Item.Meta,{avatar:e.image?m.a.createElement(P.a,{src:Object(F.g)(e.image)}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"}},e.user.first_name?e.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),title:e.user.first_name+" ("+e.user.id+")",description:m.a.createElement("small",null,e.user.mobile)})))})))),m.a.createElement(g.a,{span:24,style:{textAlign:"center",marginTop:30}},m.a.createElement(_.a,{disabled:this.state.loading||!this.state.patient_from||!this.state.patient_to,type:"primary",onClick:this.mergePatient},m.a.createElement(k.a,{type:"plus"}),"Merge Patients"))))))}}]),t}(m.a.Component),Kn=function(e){function t(e){return Object(i.a)(this,t),Object(l.a)(this,Object(c.a)(t).call(this,e))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return m.a.createElement(j.a,{style:{textAlign:"center"}},m.a.createElement("h2",null," Please select patient to further continue !!"),this.props.togglePatientListModal?m.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(k.a,{type:"user"})," Select Patient"):null)}}]),t}(m.a.Component),Xn=(a(456),a(473));function Qn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Zn=T.a.TextArea,Jn=x.a.Option,$n=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleCheck=function(e){a.setState({excused_duty_checked:!a.state.excused_duty_checked})},a.handleLighDutyCheck=function(e){a.setState({fit_light_duty_checked:!a.state.fit_light_duty_checked})},a.onChangeHandle=function(e){a.setState({value:e.target.value})},a.handleAttendanceCheck=function(e){a.setState({attendance_checked:!a.state.attendance_checked})},a.handleChangeStart=function(e){a.setState({startDate:e})},a.onChange=function(e){a.setState({proof_attendance_from:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.selectDoctor=function(e){a.setState({selectedDoctor:e})},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(n.excused_duty||n.fit_light_duty||n.proof_attendance){if(!e){var i=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Qn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{doctor:t.state.selectedDoctor.id,practice:t.props.active_practiceId,date:t.state.selectedDate&&G()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null,excused_duty_from:G()(n.excused_duty_from).format("YYYY-MM-DD"),excused_duty_to:G()(n.excused_duty_to).format("YYYY-MM-DD"),fit_light_duty_from:G()(n.fit_light_duty_from).format("YYYY-MM-DD"),fit_light_duty_to:G()(n.fit_light_duty_to).format("YYYY-MM-DD"),proof_attendance_date:G()(n.proof_attendance_date).format("YYYY-MM-DD"),proof_attendance_from:G()(n.proof_attendance_from).format("LT"),proof_attendance_to:G()(n.proof_attendance_to).format("LT"),patient:t.props.match.params.id,is_active:!0,valid_court:!1,invalid_court:!1,no_mention:!1});n.group&&(i[n.group]=!0),delete i.group;Object(F.j)(Object(F.f)(A.Sb,[a.props.currentPatient.id]),i,(function(e){Object(F.a)(N.Sb,"Medical Certificate Generated."),t.props.history.replace("/patient/"+t.props.match.params.id+"/emr/files")}),(function(){t.setState({})}))}}else Object(F.a)(N.Q,"Please select at least one of the above options")}))},a.state={redirect:!1,excused_duty_checked:!1,fit_light_duty_checked:!1,attendance_checked:!1,startDate:a.props.value,endDate:new Date,proof_attendance_from:null,days:0,practiceDoctors:[],selectedDoctor:{},selectedDate:G()(),value:""},a.handleChangeStart=a.handleChangeStart.bind(Object(o.a)(a)),a.handleChangeEnd=a.handleChangeEnd.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){Object(de.d)(this)}},{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"handleChangeEnd",value:function(e){this.setState({endDate:e})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=Y.fb.map((function(e){return m.a.createElement(S.a,{value:e.value},e.label)}));return m.a.createElement(I.a,Object.assign({onSubmit:this.handleSubmit},{labelCol:{xs:{span:24},sm:{span:8},md:{span:8},lg:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16},md:{span:16},lg:{span:16}}}),m.a.createElement(j.a,{title:"ADD MEDICAL LEAVE CERTIFICATE",extra:m.a.createElement(_.a.Group,null,m.a.createElement(_.a,{type:"primary",htmlType:"submit"},"Save Certificate"))},m.a.createElement(I.a.Item,null,t("excused_duty",{})(m.a.createElement(he.a,{onClick:this.handleCheck,defaultChecked:this.state.excused_duty_checked},"Excused from duty"))),this.state.excused_duty_checked?m.a.createElement(h.a,null,m.a.createElement(g.a,{span:6,offset:6},m.a.createElement(I.a.Item,{label:"From"},t("excused_duty_from",{})(m.a.createElement(M.a,null))),m.a.createElement(I.a.Item,{label:"till"},t("excused_duty_to",{})(m.a.createElement(M.a,null)))),m.a.createElement(g.a,{span:6},m.a.createElement(I.a.Item,null,t("excused_duty_from_session",{initialValue:"Morning"})(m.a.createElement(x.a,null,m.a.createElement(Jn,{value:"Morning"},"Morning Session"),m.a.createElement(Jn,{value:"Morning"},"Evening Session")))),m.a.createElement(I.a.Item,null,t("excused_duty_to_session",{initialValue:"Morning"})(m.a.createElement(x.a,null,m.a.createElement(Jn,{value:"Morning"},"Morning Session"),m.a.createElement(Jn,{value:"Morning"},"Evening Session")))))):null,m.a.createElement(I.a.Item,null,t("fit_light_duty",{})(m.a.createElement(he.a,{onClick:this.handleLighDutyCheck,defaultChecked:this.state.fit_light_duty_checked},"Fit for light duty"))),this.state.fit_light_duty_checked?m.a.createElement(h.a,null,m.a.createElement(g.a,null,m.a.createElement(I.a.Item,{label:"From"},t("fit_light_duty_from",{})(m.a.createElement(M.a,null))),m.a.createElement(I.a.Item,{label:"till"},t("fit_light_duty_to",{})(m.a.createElement(M.a,null))))):null,m.a.createElement(I.a.Item,null,t("proof_attendance",{})(m.a.createElement(he.a,{onClick:this.handleAttendanceCheck,defaultChecked:this.state.attendance_checked},"Proof of attendance at practice"))),this.state.attendance_checked?m.a.createElement(h.a,null,m.a.createElement(I.a.Item,{label:"on"},t("proof_attendance_date",{})(m.a.createElement(M.a,null))),m.a.createElement(g.a,{span:6,offset:6},m.a.createElement(I.a.Item,{label:"From"},t("proof_attendance_from",{})(m.a.createElement(Xn.a,{use12Hours:!0,format:"h:mm A"}))),m.a.createElement(I.a.Item,{label:"till"},t("proof_attendance_to",{})(m.a.createElement(Xn.a,{use12Hours:!0,format:"h:mm A"}))))):null,m.a.createElement(I.a.Item,{label:"Notes"},t("notes",{})(m.a.createElement(Zn,null))),m.a.createElement(I.a.Item,null,t("group",{initialValue:"no_mention"})(m.a.createElement(S.a.Group,null,a))),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(j.a,null,m.a.createElement("span",null,"Issued by \xa0\xa0"),m.a.createElement(ht.a,{placement:"topCenter",overlay:m.a.createElement(Se.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Se.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(M.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY",allowClear:!1})))))}}]),t}(m.a.Component),ei=I.a.create()($n);function ti(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ai(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ti(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ti(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ni=j.a.Meta,ii=(T.a.Group,1),ri=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPackages=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.v,[a.props.active_practiceId]),(function(t){e.setState({packages:t})}),(function(){}))},a.loadDiseases=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.X,[a.props.active_practiceId]),(function(t){e.setState({diseases:t})}),(function(){}))},a.searchPatient=function(e){var t=Object(o.a)(a);Object(F.c)(Object(F.f)(A.Vc,[e]),(function(e){e&&t.setState({patientList:e,ptr:e})}),(function(){}))},a.handlePatientSelect=function(e){if(e){var t=Object(o.a)(a);Object(F.c)(Object(F.f)(A.wc,[e]),(function(e){t.setState({patientDetails:e})}),(function(){}))}},a.checkBedStatus=function(e,t){var n=Object(o.a)(a);n.handleRoomType(),a.setState(Object(w.a)({},e,t),(function(){n.calculateTotalAmount();var e=n.state,t=e.from_date,a=e.bed_package;if(t&&a){var i=null;if(n.state.packages.forEach((function(e){a==e.id&&(i=G()(t).add(e.no_of_days-1,"day"))})),t&&i&&a)(0,n.props.form.setFieldsValue)({to_date:i}),Object(F.c)(Object(F.f)(A.P,[n.props.active_practiceId]),(function(e){n.setState({availabilitySeatTatkal:e.TATKAL,availabilitySeatNormal:e.NORMAL}),e[n.props.form.getFieldValue("seat_type")]||(n.props.form.setFieldsValue({seat_type:null}),n.calculateTotalAmount())}),(function(){}),{start:G()(t).format("YYYY-MM-DD"),end:G()(i).format("YYYY-MM-DD"),bed_package:a})}}))},a.handleSubmit=function(e){a.setState({loading:!0});var t=Object(o.a)(a),n=[];e.preventDefault(),a.props.form.validateFields((function(e,i){if(!e){var r=i.label,l=i.value;r.map((function(e,t){return n.push({key:e,value:l[t]})}));var c=ai({},i,{to_date:G()(i.to_date).format("YYYY-MM-DD"),from_date:G()(i.from_date).format("YYYY-MM-DD"),paid:!1,total_price:a.state.totalPayableAmount,date:G()().format("YYYY-MM-DD"),total_tax:a.state.tax,patient:a.state.patientDetails.id,rest_diseases:i.rest_diseases?i.rest_diseases.join(","):null,report_upload:i.file&&i.file.file.response?i.file.file.response.image_path:null,details:n});delete c.label,delete c.value,delete c.keys;Object(F.j)(Object(F.f)(A.G,[a.props.active_practiceId]),c,(function(e){Object(F.a)(N.Sb,"Saved Successfully!!"),t.props.history&&(t.props.history.goBack(),t.props.history.replace("/patient/"+t.props.match.params.id+"/booking")),t.props.loadData&&t.props.loadData()}),(function(){}))}}))},a.handleClick=function(e){a.setState({patientDetails:null})},a.handleRoomType=function(e,t){var n=Object(o.a)(a);a.setState(Object(w.a)({},e,t),(function(){n.calculateTotalAmount()}))},a.calculateTotalAmount=function(){Object(o.a)(a).setState((function(e){var t=0,a=0,n={},i=[],r=0;return e.packages.forEach((function(r){e.bed_package==r.id&&("NORMAL"==e.seat_type&&(t=r.normal_price+r.normal_tax_value,a+=r.normal_tax_value,n=ai({},r,{type:"BED",price_with_tax:t,tax:r.normal_tax_value,price:r.normal_price,_id:Math.random().toFixed(7)}),i=[n]),"TATKAL"==e.seat_type&&(t=r.tatkal_price+r.tatkal_tax_value,a+=r.tatkal_tax_value,n=ai({},r,{type:"BED",price_with_tax:t,tax:r.tatkal_tax_value,price:r.tatkal_price,_id:Math.random().toFixed(7)}),i=[n]))})),e.medicinePackage.forEach((function(t){e.medicineItem.forEach((function(e){t.id==e&&(r+=t.final_price,a+=t.tax_value,i=[].concat(Object(D.a)(i),[ai({},t,{type:"MEDICINE",price_with_tax:t.final_price,tax:t.tax_value,_id:Math.random().toFixed(7)})]))}))})),{totalPayableAmount:t+r,tax:a,choosePkg:Object(D.a)(i)}}))},a.setPaymentAmount=function(e){var t=Object(o.a)(a);a.setState({totalPayingAmount:e},(function(){t.calculateTotalAmount()}))},a.handleMedicineSelect=function(e){var t=e;a.setState({medicineItem:t},(function(){this.calculateTotalAmount()}))},a.changeDiscount=function(e,t){Object(o.a)(a).setState((function(a){var n=[];return a.choosePkg.forEach((function(a){a._id==e?n.push(ai({},a,{discount:t})):n.push(a)})),{choosePkg:n}}))},a.addNewFields=function(){var e=a.props.form,t=e.getFieldValue("keys").concat(ii++);e.setFieldsValue({keys:t})},a.removeNewOptionField=function(e){var t=a.props.form,n=t.getFieldValue("keys");1!==n.length&&t.setFieldsValue({keys:n.filter((function(t){return t!==e}))})},a.state={packages:[],totalPayableAmount:0,totalPayingAmount:0,patientList:[],paymentModes:[],medicinePackage:[],medicineItem:[],diseases:[]},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.currentPatient&&this.handlePatientSelect(this.props.currentPatient.id),this.loadPackages(),this.loadPaymentModes(),this.loadMedicinePackages(),this.loadDiseases()}},{key:"loadMedicinePackages",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Wb,[this.props.active_practiceId]),(function(t){e.setState({medicinePackage:t})}),(function(){}))}},{key:"loadPaymentModes",value:function(){var e=this;Object(F.c)(Object(F.f)(A.zc,[this.props.active_practiceId]),(function(t){e.setState({paymentModes:t})}),(function(){}))}},{key:"render",value:function(){var e=this,t=[{value:"NORMAL",is_or_not:!(!this.state.availabilitySeatNormal||!this.state.availabilitySeatNormal.available)},{value:"TATKAL",is_or_not:!(!this.state.availabilitySeatTatkal||!this.state.availabilitySeatTatkal.available)}],a=this,n=this.props.form,i=n.getFieldDecorator,r=n.getFieldValue,l={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:14}}},c=[{title:"Item",key:"name",dataIndex:"name"},{title:"Normal Price",key:"normal_price",dataIndex:"normal_price"},{title:"Tatkal Price",key:"tatkal_price",dataIndex:"tatkal_price"},{title:"discount %",key:"discount",width:100,dataIndex:"discount",render:function(e,t){return m.a.createElement(I.a.Item,Object.assign({key:"discount[".concat(t._id,"]")},l),i("discount[".concat(t._id,"]"),{initialValue:t.discount,validateTrigger:["onChange","onBlur"]})(m.a.createElement(C.a,{min:0,max:100,placeholder:"discount",size:"small",value:t.discount,onChange:function(e){return a.changeDiscount(t._id,e)}})))}},{title:"Price",key:"price",dataIndex:"price",render:function(e,t){return m.a.createElement("p",null,e?e.toFixed(2):null)}},{title:"Tax",key:"tax",dataIndex:"tax",render:function(e,t){return m.a.createElement("p",null,e?e.toFixed(2):null)}},{title:"Total Amount",key:"price_with_tax",dataIndex:"price_with_tax",render:function(e,t){return m.a.createElement("p",null,e?e.toFixed(2):null)}}],o={name:"image",data:{name:"hello"},action:Object(F.h)(A.sb),headers:{authorization:"authorization-text"},onChange:function(e){e.file.status,"done"===e.file.status?ye.a.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&ye.a.error("".concat(e.file.name," file upload failed."))}};i("keys",{initialValue:[0]});var s=r("keys"),u=s.map((function(t,a){return m.a.createElement(h.a,{key:t},m.a.createElement(g.a,{span:8},m.a.createElement(I.a.Item,{label:""},i("label[".concat(t,"]"))(m.a.createElement(T.a,{placeholder:"name"})))),m.a.createElement(g.a,{span:8},m.a.createElement(I.a.Item,{label:""},i("value[".concat(t,"]"))(m.a.createElement(T.a,{placeholder:"value"})))),m.a.createElement(g.a,{span:8},a?m.a.createElement(_.a,{onClick:function(){return e.removeNewOptionField(t)},size:"small",type:"danger",style:{margin:5},icon:"close",shape:"circle"}):null,a==s.length-1?m.a.createElement(_.a,{type:"dashed",style:{marginTop:"3px"},onClick:e.addNewFields},m.a.createElement(k.a,{type:"plus"})," Add field"):null))}));return m.a.createElement("div",null,m.a.createElement(j.a,{title:"Book a Seat/Bed"},m.a.createElement(I.a,null,m.a.createElement(h.a,null,m.a.createElement(g.a,{xs:24,sm:24,md:12,lg:12,xl:12},m.a.createElement("div",{style:{paddingRight:"10px"}},this.state.patientDetails?m.a.createElement(I.a.Item,Object.assign({key:"id",value:this.state.patientDetails?this.state.patientDetails.id:""},{wrapperCol:{xs:{offset:6,span:24},sm:{offset:6,span:14}}}),m.a.createElement(j.a,{bordered:!1,style:{background:"#ECECEC"}},m.a.createElement(ni,{avatar:this.state.patientDetails.image?m.a.createElement(P.a,{src:Object(F.g)(this.state.patientDetails.image)}):m.a.createElement(P.a,{style:{backgroundColor:"#87d068"}},this.state.patientDetails.user.first_name?this.state.patientDetails.user.first_name.charAt(0):m.a.createElement(k.a,{type:"user"})),title:this.state.patientDetails.user.first_name,description:this.state.patientDetails.user.mobile}))):m.a.createElement("div",null,m.a.createElement(I.a.Item,Object.assign({label:"Patient"},l),i("patient",{rules:[{required:!0,message:"this field required"}]})(m.a.createElement(Hn.a,{placeholder:"Patient Name",showSearch:!0,onSearch:this.searchPatient,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onSelect:this.handlePatientSelect},this.state.patientList.map((function(e){return m.a.createElement(Hn.a.Option,{value:e?e.id.toString():""},m.a.createElement(b.a.Item,{style:{padding:0}},m.a.createElement(b.a.Item.Meta,{avatar:e.image?m.a.createElement(P.a,{style:{backgroundColor:"#ffff"},src:Object(F.g)(e.image)}):m.a.createElement(k.a,{type:"user"}),title:e.user.first_name+" ("+e.user.id+")",description:m.a.createElement("small",null,e.user.mobile)})))})))),this.state.ptr?m.a.createElement(Ra.a,{message:"Patient Not Found !!",description:"Please Search another patient or create new patient.",type:"error"}):null)),m.a.createElement(I.a.Item,Object.assign({label:"Bed Package"},l),i("bed_package",{rules:[{required:!0,message:"this field required!"}]})(m.a.createElement(x.a,{onChange:function(e){return a.checkBedStatus("bed_package",e)}},a.state.packages.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)}))))),m.a.createElement(I.a.Item,Object.assign({label:"Book From"},l),i("from_date",{rules:[{required:!0,message:"Input From Date!"}]})(m.a.createElement(M.a,{onChange:function(e){return a.checkBedStatus("from_date",e)},format:"DD-MM-YYYY",allowClear:!1}))),m.a.createElement(I.a.Item,Object.assign({label:"Book To"},l),i("to_date",{rules:[{required:!0,message:"Input To Date!"}]})(m.a.createElement(M.a,{disabled:!0,format:"DD-MM-YYYY"}))),m.a.createElement(I.a.Item,Object.assign({label:"Booking Type"},l),i("seat_type",{rules:[{required:!0,message:"this field required"}]})(m.a.createElement(S.a.Group,{onChange:function(t){return e.handleRoomType("seat_type",t.target.value)}},t.map((function(e){return m.a.createElement(S.a,{value:e.is_or_not?e.value:"",disabled:!e.is_or_not},e.value)}))))),m.a.createElement(I.a.Item,Object.assign({label:"Medicine  Package"},l),i("medicines",{})(m.a.createElement(x.a,{mode:"multiple",onChange:this.handleMedicineSelect},a.state.medicinePackage.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)}))))),m.a.createElement(I.a.Item,Object.assign({label:"Pay Now : "},l),i("pay_value",{rules:[{required:!0,message:"this field is required"}],initialValue:this.state.totalPayingAmount?this.state.totalPayingAmount:null})(m.a.createElement(C.a,{min:0,step:1,max:this.state.totalPayableAmount,onChange:this.setPaymentAmount}))),m.a.createElement(I.a.Item,Object.assign({label:"Payment Mode"},l),i("payment_mode",{rules:[{required:!0,message:"this field required"}]})(m.a.createElement(x.a,{showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.paymentModes.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.mode)}))))),m.a.createElement(v.a,null,"Patient Details"),m.a.createElement(I.a.Item,Object.assign({label:"Creatinine Level"},l),i("creatinine",{})(m.a.createElement(T.a,null))),m.a.createElement(I.a.Item,Object.assign({label:"Urea Level"},l),i("urea_level",{})(m.a.createElement(T.a,null))),m.a.createElement(I.a.Item,Object.assign({label:"Currently on Dialysis?"},l),i("dialysis",{})(m.a.createElement(x.a,{showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},m.a.createElement(x.a.Option,{value:!0},"YES"),m.a.createElement(x.a.Option,{value:!1},"NO")))),m.a.createElement(I.a.Item,Object.assign({label:"Diseases"},l),i("other_diseases",{})(m.a.createElement(x.a,{showSearch:!0,mode:"multiple",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.diseases.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)}))))),m.a.createElement(I.a.Item,Object.assign({label:"Other Diseases"},l),i("rest_diseases",{})(m.a.createElement(x.a,{mode:"tags"}))),m.a.createElement(I.a.Item,Object.assign({label:"Upload Report"},l),i("file",{})(m.a.createElement(fe.a,o,m.a.createElement(_.a,null,m.a.createElement(k.a,{type:"upload"})," Select File")))))),m.a.createElement(g.a,{xs:24,sm:24,md:12,lg:12,xl:12},m.a.createElement(v.a,null,"Item Details"),m.a.createElement(je.a,{pagination:!1,columns:c,size:"small",dataSource:this.state.choosePkg}),m.a.createElement(v.a,null,"Extra Details"),m.a.createElement(j.a,null,u)),m.a.createElement(g.a,{span:24},m.a.createElement("h3",null,"Grand Total: ",m.a.createElement("b",null,this.state.totalPayableAmount.toFixed(2))),m.a.createElement(I.a.Item,null,m.a.createElement(E.a,{title:"Are you sure to take payment of INR "+this.state.totalPayingAmount+"?",onConfirm:this.handleSubmit},m.a.createElement(_.a,{type:"primary"},"Submit")),a.props.history?m.a.createElement(_.a,{style:{margin:5},onClick:function(){return a.props.history.goBack()}},"Cancel"):null))))))}}]),t}(m.a.Component),li=I.a.create()(ri),ci=u.a.Content,oi=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadBedBookingReport=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(o.a)(a);a.setState({loading:!0});var n=function(e){1==e.current?t.setState({bedBookingReports:e.results,loading:!1,nextReport:e.next}):t.setState((function(t){return{bedBookingReports:[].concat(Object(D.a)(t.bedBookingReports),Object(D.a)(e.results)),loading:!1,nextReport:e.next}}))},i=function(){t.setState({loading:!1})};Object(F.c)(Object(F.f)(A.u,[a.props.active_practiceId]),n,i,{patients:a.state.patient.id,page:e})},a.state={loading:!0,bedBookingReports:[],patient:a.props.currentPatient||{}},a.loadBedBookingReport=a.loadBedBookingReport.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadBedBookingReport()}},{key:"render",value:function(){var e=this,t=this,a=[{title:"Bed Package",key:"name",dataIndex:"bed_package.name"},{title:"Medicine Package",key:"medicine",dataIndex:"medicines",render:function(e,t){return m.a.createElement("span",null,e.map((function(e){return m.a.createElement(y.a,null,e.name)})))}},{title:"From ",key:"from_date",render:function(e,t){return m.a.createElement("span",null,G()(t.from_date).format("LL"))}},{title:"To ",key:"to_date",render:function(e,t){return m.a.createElement("span",null,G()(t.to_date).format("LL"))}},{title:"Seat/Bed Type",key:"seat_type",dataIndex:"seat_type"},{title:"Seat Number",key:"seat_no",dataIndex:"seat_no"},{title:"Total price",key:"total_price",dataIndex:"total_price",render:function(e){return m.a.createElement("p",null,e.toFixed(2))}},{title:"Payment Status",key:"payment_status",dataIndex:"payment_status"}];return m.a.createElement(ci,{className:"main-container",style:{minHeight:280}},m.a.createElement(u.a,null,m.a.createElement(p.d,null,m.a.createElement(p.b,{path:"/patient/:patient/booking/bed-booking",render:function(){return t.props.activePracticePermissions.PatientBookings||t.props.allowAllPermissions?m.a.createElement(li,Object.assign({},e.props,{bedBooking:!0,loadData:e.loadBedBookingReport})):m.a.createElement(X.a,null)}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement("h2",null,"Bed Booking Management",m.a.createElement(le.b,{to:"/patient/"+this.state.patient.id+"/booking/bed-booking"},m.a.createElement(_.a,{type:"primary",style:{float:"right"}},m.a.createElement(k.a,{type:"plus"}),"\xa0Book A Seat"))),m.a.createElement(j.a,null,m.a.createElement(V.a,{pagination:!1,hideReport:!0,loading:this.state.loading,columns:a,size:"small",dataSource:this.state.bedBookingReports}),m.a.createElement(L.a,{loaderFunction:function(){return e.loadBedBookingReport(e.state.nextReport)},loading:this.state.loading,hidden:!this.state.nextReport})))))))}}]),t}(m.a.Component),si=a(692),ui=u.a.Content,di=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPatientPendingAmount=function(){var e=Object(o.a)(a);if(a.state.currentPatient&&a.state.currentPatient.id){Object(F.c)(Object(F.f)(A.vc,[a.state.currentPatient.id]),(function(t){e.setState({pendingAmount:t})}),(function(){}))}else a.setState({pendingAmount:null})},a.loadPatientWallet=function(){var e=Object(o.a)(a);if(a.state.currentPatient&&a.state.currentPatient.id){Object(F.c)(Object(F.f)(A.g,[a.state.currentPatient.id]),(function(t){e.setState({walletAmount:t})}),(function(){}))}else a.setState({pendingAmount:null})},a.loadMembership=function(){var e=Object(o.a)(a);if(a.state.currentPatient&&a.state.currentPatient.id){Object(F.c)(Object(F.f)(A.jc,[e.state.currentPatient.id]),(function(t){e.setState({MedicalMembership:t.length?t[t.length-1]:null})}),(function(){}))}},a.refreshWallet=function(){a.loadPatientWallet(),a.loadPatientPendingAmount(),a.loadMembership()},a.state={currentPatient:null,active_practiceId:a.props.active_practiceId,medicalHistory:[],listModalVisible:!1,loading:!1,showAllClinic:Object(F.d)("showAllClinic"),pendingAmount:null,walletAmount:null,hideSidePanel:!1},a.setCurrentPatient=a.setCurrentPatient.bind(Object(o.a)(a)),a.togglePatientListModal=a.togglePatientListModal.bind(Object(o.a)(a)),a.toggleShowAllClinic=a.toggleShowAllClinic.bind(Object(o.a)(a)),a.loadPatientPendingAmount=a.loadPatientPendingAmount.bind(Object(o.a)(a)),a.loadPatientWallet=a.loadPatientWallet.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){!this.props.match.params.id||this.state.currentPatient&&this.props.match.params.id==this.state.currentPatient.id||this.getPatientListData(this.props.match.params.id),this.loadPatientPendingAmount(),this.loadPatientWallet(),this.loadMembership()}},{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.state.currentPathLocation!=e.location&&this.setState({currentPathLocation:e.location},(function(){for(var e=!1,t=0;t<Y.Ab.length;t++)Object(p.f)(a.state.currentPathLocation.pathname,{path:Y.Ab[t],exact:!1,strict:!1})&&(e=!0,a.setState({hideSidePanel:!0}));e||a.setState({hideSidePanel:!1})}))}},{key:"getPatientListData",value:function(e){var t=this;t.setState({loading:!0});Object(F.c)(Object(F.f)(A.wc,[e]),(function(e){t.setCurrentPatient(e)}),(function(){Object(F.a)(N.Q,"Patient Loading Failed"),t.setState({loading:!1})}))}},{key:"setCurrentPatient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this,n=this.props.location.pathname.split("/");isNaN(parseInt(n[2]))?e&&(n[1]="patient",n.splice(2,0,e.id)):e?(n[1]="patient",n[2]=e.id):(n[1]="patients",n.splice(2,1)),this.props.history.push(n.join("/")),this.setState({currentPatient:e,loading:!1,listModalVisible:!1},(function(){t&&a.props.history.push(Object(F.f)(t,[e.id]))}))}},{key:"togglePatientListModal",value:function(e){this.setState({listModalVisible:!!e})}},{key:"toggleShowAllClinic",value:function(e){this.setState({showAllClinic:!!e},(function(){Object(F.n)("showAllClinic",!!e)}))}},{key:"render",value:function(){var e=this,t=this;return m.a.createElement(ui,null,m.a.createElement(n.a,{spinning:this.state.loading,size:"large"},m.a.createElement(Kt,Object.assign({},this.state,this.props,{togglePatientListModal:this.togglePatientListModal,key:this.state.currentPatient,setCurrentPatient:this.setCurrentPatient,toggleShowAllClinic:this.toggleShowAllClinic,refreshWallet:this.refreshWallet})),m.a.createElement(u.a,null,m.a.createElement(De,Object.assign({},this.state,this.props)),m.a.createElement(u.a,null,m.a.createElement(ui,{className:"main-container",key:this.state.showAllClinic.toString(),style:{padding:"0px 5px",minHeight:280}},m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patients/merge",render:function(a){return t.props.activePracticePermissions.MergePatients||t.props.allowAllPermissions?m.a.createElement(Un,e.state):m.a.createElement(X.a,null)}}),t.props.activePracticePermissions.WebAdmin||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/profile",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/profile"}):m.a.createElement(me,Object.assign({},e.state,{key:e.state.currentPatient,setCurrentPatient:e.setCurrentPatient,refreshWallet:e.refreshWallet},e.props))}}):null,m.a.createElement(p.b,{exact:!0,path:"/patients/profile/add",render:function(a){return t.props.activePracticePermissions.AddPatient||t.props.allowAllPermissions?m.a.createElement(Pe,Object.assign({key:e.state.currentPatient},e.props,a)):m.a.createElement(X.a,null)}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/profile",render:function(a){return t.props.activePracticePermissions.ViewPatient||t.props.allowAllPermissions?m.a.createElement(me,Object.assign({},e.state,{key:e.state.currentPatient,refreshWallet:e.refreshWallet,setCurrentPatient:e.setCurrentPatient},e.props,a)):m.a.createElement(X.a,null)}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/profile/edit",render:function(a){return t.props.activePracticePermissions.EditPatient||t.props.allowAllPermissions?m.a.createElement(Pe,Object.assign({key:e.state.currentPatient},e.state,e.props,a)):m.a.createElement(X.a,null)}}),t.props.activePracticePermissions.PatientAppointments||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/appointments",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/appointments"}):m.a.createElement(Ce,Object.assign({key:e.state.currentPatient},e.state,t,e.props))}}):null,t.props.activePracticePermissions.PatientAppointments||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patient/:id/appointments",render:function(t){return m.a.createElement(Ce,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t,e.props))}}):null,t.props.activePracticePermissions.PatientAppointments||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/appointments/:appointmentid",render:function(t){return m.a.createElement(Ce,Object.assign({key:e.state.currentPatient},e.state,t,e.props))}}):null,t.props.activePracticePermissions.PatientCommunications||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/communications",render:function(){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/communications"}):m.a.createElement(Kn,{togglePatientListModal:e.togglePatientListModal})}}):null,t.props.activePracticePermissions.PatientCommunications||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patient/:id/communications",render:function(t){return m.a.createElement(Jt,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t))}}):null,t.props.activePracticePermissions.PatientVitalSigns||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/vitalsigns",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/emr/vitalsigns"}):m.a.createElement(na,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t))}}):null,m.a.createElement(p.b,{path:"/patient/:id/emr/vitalsigns",render:function(a){return t.props.activePracticePermissions.PatientVitalSigns||t.allowAllPermissions?m.a.createElement(na,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/vitalsigns/edit",render:function(a){return t.props.activePracticePermissions.PatientVitalSigns||t.allowAllPermissions?m.a.createElement($t,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),m.a.createElement(p.b,{path:"/patients/emr/clinicnotes",render:function(t){return m.a.createElement(Wt,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}),"}/>",m.a.createElement(p.b,{path:"/patient/:id/emr/clinicnotes",render:function(t){return m.a.createElement(Wt,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}),t.props.activePracticePermissions.PatientCompletedProcedure||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/workdone",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/emr/workdone"}):m.a.createElement(sa,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}):null,t.props.activePracticePermissions.PatientCompletedProcedure||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/workdone",render:function(a){return m.a.createElement(sa,Object.assign({},t.props,{key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a))}}):null,t.props.activePracticePermissions.PatientFiles||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/files",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/emr/files"}):m.a.createElement(Ft,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},t,e.state))}}):null,t.props.activePracticePermissions.PatientFiles||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/files",render:function(t){return m.a.createElement(Ft,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,t,e.state))}}):null,t.props.activePracticePermissions.PatientFiles||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/create-medicalCertificate",render:function(t){return m.a.createElement(ei,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,t,e.state))}}):null,t.props.activePracticePermissions.PatientPrescriptions||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/prescriptions",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/emr/prescriptions"}):m.a.createElement(Pa,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}):null,t.props.activePracticePermissions.PatientPrescriptions||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/prescriptions",render:function(t){return m.a.createElement(Pa,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}):null,t.props.activePracticePermissions.PatientTreatmentPlans||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/plans",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/emr/plans"}):m.a.createElement(Ma,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,e.props,t))}}):null,t.props.activePracticePermissions.PatientTreatmentPlans||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/plans",render:function(a){return m.a.createElement(Ma,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t.props,a))}}):null,m.a.createElement(p.b,{path:"/patient/:id/emr/timeline",render:function(a){return t.props.activePracticePermissions.PatientTimeline||t.allowAllPermissions?m.a.createElement(pt,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),t.props.activePracticePermissions.PatientLabOrders||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patient/emr/labtrackings",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/emr/labtrackings"}):m.a.createElement(Na,Object.assign({key:e.state.currentPatient},e.state,t))}}):null,m.a.createElement(p.b,{path:"/patient/:id/emr/labtrackings",render:function(a){return t.props.activePracticePermissions.PatientLabOrders||t.allowAllPermissions?m.a.createElement(Na,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),t.props.activePracticePermissions.PatientInvoices||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/billing/invoices",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/billing/invoices"}):m.a.createElement(fn,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}):null,m.a.createElement(p.b,{path:"/patient/:id/billing/invoices",render:function(a){return t.props.activePracticePermissions.PatientInvoices||t.allowAllPermissions?m.a.createElement(fn,Object.assign({},t.state,{refreshWallet:e.refreshWallet,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,a)):m.a.createElement(X.a,null)}}),t.props.activePracticePermissions.PatientReturns||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/billing/return/invoices",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/billing/return/invoices"}):m.a.createElement(Vn,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t))}}):null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/return/invoices",render:function(a){return t.props.activePracticePermissions.PatientReturns||t.allowAllPermissions?m.a.createElement(Vn,Object.assign({refreshWallet:e.refreshWallet,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),t.props.activePracticePermissions.PatientPayments||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patients/billing/payments",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/billing/payments"}):m.a.createElement(Dn,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,e.props,t))}}):null,m.a.createElement(p.b,{path:"/patient/:id/billing/payments",render:function(a){return t.props.activePracticePermissions.PatientPayments||t.allowAllPermissions?m.a.createElement(Dn,Object.assign({refreshWallet:e.refreshWallet,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),this.state.currentPatient?m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/ledger",render:function(a){return t.props.activePracticePermissions.PatientLedger||t.allowAllPermissions?m.a.createElement(Wn,Object.assign({refreshWallet:e.refreshWallet,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}):null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/prescriptions/template/add",render:function(a){return t.props.activePracticePermissions.PatientPrescriptions||t.allowAllPermissions?m.a.createElement(ba,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),m.a.createElement(p.b,{path:"/patient/:id/booking",render:function(a){return t.props.activePracticePermissions.PatientBookings||t.props.allowAllPermissions?m.a.createElement(oi,Object.assign({},e.state,e.props,a,{key:e.state.currentPatient?e.state.currentPatient.id:null})):m.a.createElement(X.a,null)}}),this.state.currentPatient&&this.state.currentPatient.is_agent?m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/wallet",render:function(a){return t.props.activePracticePermissions.PatientBookings||t.props.allowAllPermissions?m.a.createElement(si.a,Object.assign({},e.state,e.props,a,{key:e.state.currentPatient?e.state.currentPatient.id:null})):m.a.createElement(X.a,null)}}):null,m.a.createElement(p.b,{render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/profile"}):m.a.createElement(me,Object.assign({},e.state,{key:e.state.currentPatient,setCurrentPatient:e.setCurrentPatient},e.props))}})))))))}}]),t}(m.a.Component);t.default=di},330:function(e,t,a){"use strict";a(337);var n=a(338),i=(a(353),a(354)),r=(a(123),a(33)),l=(a(125),a(17)),c=a(34),o=(a(327),a(14)),s=(a(185),a(124)),u=(a(341),a(344)),d=a(63),m=a(64),p=a(67),h=a(65),f=a(30),b=a(66),y=a(0),g=a.n(y),E=a(564),v=a.n(E),_=(a(687),a(86)),O=a.n(_),P=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n="",i=[];return a&&(e.forEach((function(e){i.push(e)})),n+=i.join(","),n+="\r\n"),t.forEach((function(t){i=[],e.forEach((function(e){t[e]?i.push(t[e]):i.push("--")})),n+=i.join(","),n+="\r\n"})),n},k=function(e,t){var a,n=t+".csv",i=[];i.push(255,254);for(var r=0;r<e.length;++r)a=e.charCodeAt(r),i.push(255&a),i.push(a/256>>>0);var l=new Blob([new Uint8Array(i)],{type:"text/csv;charset=UTF-16LE;"});if(navigator.msSaveBlob)navigator.msSaveBlob(l,n);else{var c=document.createElement("a");if(void 0!==c.download){var o=window.URL.createObjectURL(l);c.setAttribute("href",o),c.setAttribute("download",n),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(o)}}};function j(e){e.line(10,20,200,20)}function C(e){e.line(10,270,200,270),e.setFontSize(8),e.text(10,275,"This is a computer generated report.")}var S=a(688),I=a.n(S);a(369),a(18),a(35),a(324);function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(a,!0).forEach((function(t){Object(c.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}a.d(t,"a",(function(){return w}));var w=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).getColumnSearchProps=function(e){return{filterDropdown:function(t){var n=t.setSelectedKeys,i=t.selectedKeys,r=t.confirm,l=t.clearFilters;return g.a.createElement("div",{style:{padding:8}},g.a.createElement(u.a,{ref:function(e){a.searchInput=e},placeholder:"Search ".concat(e),value:i[0],onChange:function(e){return n(e.target.value?[e.target.value]:[])},onPressEnter:function(){return a.handleSearch(i,r)},style:{width:188,marginBottom:8,display:"block"}}),g.a.createElement(s.a,{type:"primary",onClick:function(){return a.handleSearch(i,r)},icon:"search",size:"small",style:{width:90,marginRight:8}},"Search"),g.a.createElement(s.a,{onClick:function(){return a.handleReset(l)},size:"small",style:{width:90}},"Reset"))},filterIcon:function(e){return g.a.createElement(o.a,{type:"search",style:{color:e?"#1890ff":void 0}})},onFilter:function(t,a){return null!=a[e]?a[e].toString().toLowerCase().includes(t.toLowerCase()):""},onFilterDropdownVisibleChange:function(e){e&&setTimeout((function(){return a.searchInput.select()}))},render:function(e){return g.a.createElement(I.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[a.state.searchText],autoEscape:!0,textToHighlight:e?e.toString():""})}}},a.handleSearch=function(e,t){t(),a.setState({searchText:e[0]})},a.handleReset=function(e){e(),a.setState({searchText:""})},a.state=D({},e,{searchText:""}),a.excelExport=a.excelExport.bind(Object(f.a)(a)),a.pdfExport=a.pdfExport.bind(Object(f.a)(a)),a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.columns==this.state.columns&&e.dataSource==this.state.dataSource&&e.loading==this.state.loading||this.setState(D({},e))}},{key:"pdfExport",value:function(){var e=this,t=[];e.state.columns.forEach((function(e){e.hideExport||t.push({title:e.title,dataKey:e.title})}));var a=[];e.state.dataSource.forEach((function(t,n){var i={};e.state.columns.forEach((function(e){e.export?i[e.title]=e.export(t[e.dataIndex],t,n):i[e.title]=t[e.dataIndex]})),a.push(i)})),function(e,t,a){!(arguments.length>3&&void 0!==arguments[3])||arguments[3];var n=new v.a("p","mm","a4");j(n);var i=Object.create(t);n.autoTable(e,i,{margin:{top:35},startY:n.autoTableEndPosY()+20,headerStyle:{overflow:"linebreak"},bodyStyles:{overflow:"linebreak"}}),C(n),n.save(a+".pdf")}(t,a,"Export"+O()(),!0)}},{key:"excelExport",value:function(){var e=this,t=[];e.state.columns.forEach((function(e){e.hideExport||t.push(e.title)}));var a=[];e.state.dataSource.forEach((function(t,n){var i={};e.state.columns.forEach((function(e){e.export?i[e.title]=e.export(t[e.dataIndex],t,n):i[e.title]=t[e.dataIndex]})),a.push(i)})),function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"download",n=P(e,t);k(n,a)}(t,a,"Export"+O()())}},{key:"render",value:function(){var e=this,t=this.state.columns.map((function(t){return t.render?D({},t):D({},t,{},e.getColumnSearchProps(t.dataIndex))}));return g.a.createElement("div",null,this.props.hideReport?null:g.a.createElement(r.a,null,g.a.createElement(l.a,null,g.a.createElement(s.a.Group,{size:"small"},g.a.createElement(s.a,{disabled:this.state.loading,type:"primary",onClick:this.excelExport},g.a.createElement(o.a,{type:"file-excel"})," Excel"),g.a.createElement(s.a,{disabled:this.state.loading,type:"primary",onClick:this.pdfExport},g.a.createElement(o.a,{type:"file-pdf"})," PDF")))),g.a.createElement(r.a,null,g.a.createElement(n.a,Object.assign({pagination:{position:"both",pageSizeOptions:["10","20","30","40","50","100"],showSizeChanger:!0,showQuickJumper:!0,size:"small",showTotal:function(e,t){return g.a.createElement(i.a,null,"Showing ",g.a.createElement("b",null,t[0])," to ",g.a.createElement("b",null,t[1])," of ",g.a.createElement("b",null,e)," items")}}},this.state,{columns:t}))))}}]),t}(g.a.Component)},352:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));a(185);var n=a(124),i=(a(332),a(333)),r=(a(123),a(33)),l=a(63),c=a(64),o=a(67),s=a(65),u=a(30),d=a(66),m=a(0),p=a.n(m),h=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(s.a)(t).call(this,e))).startLoading=function(){a.props.loaderFunction&&(a.props.loaderFunction(),a.startMakingExtraLabels())},a.startMakingExtraLabels=function(){var e=Object(u.a)(a);a.setState((function(e){return e.extraLoadingLabel.length>2?{extraLoadingLabel:""}:{extraLoadingLabel:e.extraLoadingLabel+"."}}),(function(){e.props.loading&&setTimeout((function(){e.startMakingExtraLabels()}),500)}))},a.state={extraLoadingLabel:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.props.loading?p.a.createElement(i.a,{spinning:this.props.loading},p.a.createElement(r.a,{style:{minHeight:200}})):this.props.hidden?p.a.createElement(r.a,null,p.a.createElement("div",{style:{textAlign:"center",margin:"15px 0px"}},p.a.createElement("small",null,"No More Data Found"))):p.a.createElement(r.a,null,p.a.createElement("div",{style:{textAlign:"center",margin:"15px 0px"}},p.a.createElement(n.a,{type:"primary",onClick:this.startLoading,loading:this.props.loading},this.props.loading?"Loading"+this.state.extraLoadingLabel:"Load More")))}}]),t}(p.a.Component)},689:function(e,t,a){"use strict";a(31),a(690)},690:function(e,t,a){},691:function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a(0),i=a(1),r=a(635),l=a.n(r),c=a(2),o=a.n(c),s=a(25),u=a(137),d=a(14),m=a(11),p=a(13);function h(e){return(h="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function b(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function y(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t){return!t||"object"!==h(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=g(this,E(t).call(this,e))).saveSwitch=function(e){a.rcSwitch=e},a.renderSwitch=function(e){var t,i=e.getPrefixCls,r=a.props,c=r.prefixCls,m=r.size,p=r.loading,h=r.className,y=void 0===h?"":h,g=r.disabled,E=i("switch",c),v=o()(y,(b(t={},"".concat(E,"-small"),"small"===m),b(t,"".concat(E,"-loading"),p),t)),_=p?n.createElement(d.a,{type:"loading",className:"".concat(E,"-loading-icon")}):null;return n.createElement(u.a,{insertExtraNode:!0},n.createElement(l.a,f({},Object(s.default)(a.props,["loading"]),{prefixCls:E,className:v,disabled:g||p,ref:a.saveSwitch,loadingIcon:_})))},Object(p.a)("checked"in e||!("value"in e),"Switch","`value` is not validate prop, do you mean `checked`?"),a}var a,i,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),a=t,(i=[{key:"focus",value:function(){this.rcSwitch.focus()}},{key:"blur",value:function(){this.rcSwitch.blur()}},{key:"render",value:function(){return n.createElement(m.a,null,this.renderSwitch)}}])&&y(a.prototype,i),r&&y(a,r),t}(n.Component);_.__ANT_SWITCH=!0,_.propTypes={prefixCls:i.string,size:i.oneOf(["small","default","large"]),className:i.string}},692:function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));a(184);var n=a(58),i=(a(342),a(343)),r=(a(327),a(14)),l=(a(123),a(33)),c=(a(372),a(373)),o=(a(323),a(322)),s=(a(125),a(17)),u=a(34),d=a(339),m=a(63),p=a(64),h=a(67),f=a(65),b=a(30),y=a(66),g=(a(471),a(472)),E=a(0),v=a.n(E),_=a(330),O=a(18),P=a(35),k=a(86),j=a.n(k),C=a(352),S=g.a.Text,I=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).loadPatientWallet=function(){var e=Object(b.a)(a);if(a.props.currentPatient&&a.props.currentPatient.id){Object(O.c)(Object(O.f)(P.g,[a.props.currentPatient.id]),(function(t){t.length&&e.setState({walletAmount:t[0]})}),(function(){}))}else a.setState({pendingAmount:null})},a.loadData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(b.a)(a);a.setState({loading:!0});var n=function(e){1==e.current?t.setState({ledger:e.results,loading:!1,nextPage:e.next}):t.setState((function(t){return{ledger:[].concat(Object(d.a)(t.ledger),Object(d.a)(e.results)),loading:!1,nextPage:e.next}}))},i=function(){t.setState({loading:!1})},r={page:e,start:a.state.selectedStartDate.startOf("day").format(),end:a.state.selectedEndDate.endOf("day").format(),agents:a.state.selectedAgents.join(",")};a.state.selectedAgents&&(r.agents=a.state.selectedAgents.join(",")),Object(O.c)(Object(O.f)(P.Pd,[a.props.currentPatient.id]),n,i,r)},a.loadSumData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(b.a)(a),n=function(e){t.setState({ledgerDetails:e,nextPage:e.next})},i=function(){},r={page:e,start:a.state.selectedStartDate.format(),end:a.state.selectedEndDate.format(),agents:a.state.selectedAgents.join(",")};a.state.selectedAgents&&(r.agents=a.state.selectedAgents.join(",")),Object(O.c)(Object(O.f)(P.Qd,[a.props.currentPatient.id]),n,i,r)},a.changeExpenseFilters=function(e,t){var n=Object(b.a)(a);a.setState(Object(u.a)({},e,t),(function(){n.loadData(1)}))},a.state={ledger:[],ledgerDetails:{},loading:!1,walletAmount:null,selectedStartDate:j()().subtract(1,"month"),selectedEndDate:j()(),agents:[],selectedAgents:[]},a}return Object(y.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.loadData(),this.loadPatientWallet(),this.loadAgents(),this.loadSumData()}},{key:"loadAgents",value:function(){var e=this;Object(O.c)(Object(O.f)(P.fc,[this.props.currentPatient.id]),(function(t){e.setState({agents:t})}),(function(){}),{agent:!0,pagination:!1})}},{key:"render",value:function(){var e=this,t=[{title:"Date",dataIndex:"created_at",key:"created_at",render:function(e){return j()(e).format("LLL")}},{title:"Patient",dataIndex:"received_from",key:"received_from",render:function(e,t){return e?v.a.createElement(S,null,e.user.first_name," (",e.custom_id,")"):"--"}},,{title:"Refered By",dataIndex:"received_from.user.referer_data",key:"received_from.user.referer_data",render:function(e,t){return e&&e.referer?v.a.createElement(S,null,e.referer.first_name," (",e.custom_id,")"):"--"}},{title:"Ledger Comment",dataIndex:"comments",key:"comments",render:function(e,t){return t.is_cancelled?v.a.createElement(S,{delete:!0},e):e}},{title:"Cr/Dr",dataIndex:"ledger_type",key:"ledger_type",render:function(e,t){return t.is_cancelled?v.a.createElement(S,{delete:!0},e):e}},{title:"Amount",dataIndex:"amount",key:"amount",render:function(e,t){return t.is_cancelled?v.a.createElement(S,{delete:!0},e.toFixed(2)):e.toFixed(2)}}];return v.a.createElement("div",null,v.a.createElement(n.a,{title:"Wallet Ledger"},v.a.createElement(l.a,{gutter:16,style:{marginBottom:10}},v.a.createElement(s.a,{span:2,style:{textAlign:"right"}},v.a.createElement("b",null," Agents")),v.a.createElement(s.a,{span:4},v.a.createElement(o.a,{style:{width:"100%"},value:this.state.selectedAgents,mode:"multiple",disabled:this.state.loading,onChange:function(t){return e.changeExpenseFilters("selectedAgents",t)}},this.state.agents.map((function(e){return v.a.createElement(o.a.Option,{value:e.id},e.user.first_name)})))),v.a.createElement(s.a,{span:2,style:{textAlign:"right"}},v.a.createElement("b",null," From")),v.a.createElement(s.a,{span:4},v.a.createElement(c.a,{value:this.state.selectedStartDate,disabled:this.state.loading,allowClear:!1,onChange:function(t){return e.changeExpenseFilters("selectedStartDate",t)}})),v.a.createElement(s.a,{span:2,style:{textAlign:"right"}},v.a.createElement("b",null," To")),v.a.createElement(s.a,{span:4},v.a.createElement(c.a,{value:this.state.selectedEndDate,disabled:this.state.loading,allowClear:!1,onChange:function(t){return e.changeExpenseFilters("selectedEndDate",t)}}))),this.state.walletAmount?v.a.createElement(l.a,{style:{textAlign:"center",marginBottom:10}},v.a.createElement(s.a,{span:24},v.a.createElement(i.a,{title:"Wallet Total",prefix:v.a.createElement(r.a,{type:"wallet"}),value:this.state.walletAmount.non_refundable,precision:2}))):null,v.a.createElement(_.a,{dataSource:this.state.ledger,loading:this.state.loading,columns:t,hideReport:!0,pagination:!1}),v.a.createElement(C.a,{loading:this.state.loading,hidden:!this.state.nextPage,loaderFunction:function(){return e.loadData(e.state.nextPage)}}),v.a.createElement(l.a,{style:{textAlign:"center",marginBottom:10}},v.a.createElement(s.a,{span:8},v.a.createElement(i.a,{title:"Credit",value:this.state.ledgerDetails.credit,precision:2})),v.a.createElement(s.a,{span:8},v.a.createElement(i.a,{title:"Debit",value:this.state.ledgerDetails.debit,precision:2})),v.a.createElement(s.a,{span:8},v.a.createElement(i.a,{title:"Profit",value:this.state.ledgerDetails.credit-this.state.ledgerDetails.debit,precision:2})))))}}]),t}(v.a.Component)}}]);
//# sourceMappingURL=12.c1207f1d.chunk.js.map