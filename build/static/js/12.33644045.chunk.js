(window["webpackJsonpbk-erp-front"]=window["webpackJsonpbk-erp-front"]||[]).push([[12,6],{1728:function(e,t,a){var n=a(398),r=a(433),i=a(313);e.exports=function(e,t){var a={};return t=i(t,3),r(e,(function(e,r,i){n(a,t(e,r,i),e)})),a}},1729:function(e,t,a){},1730:function(e,t,a){},1743:function(e,t,a){"use strict";a.r(t);a(241);var n=a(242),r=a(96),i=a(97),l=a(100),c=a(98),o=a(44),s=a(99),u=(a(138),a(101)),d=a(0),m=a.n(d),p=a(24),f=(a(223),a(224)),h=(a(259),a(260)),b=(a(267),a(270)),g=(a(262),a(263)),y=(a(231),a(232)),E=(a(250),a(251)),v=(a(233),a(234)),_=(a(252),a(253)),O=(a(296),a(298)),P=(a(228),a(227)),j=(a(237),a(18)),k=(a(225),a(226)),C=(a(283),a(285)),I=(a(272),a(269)),S=(a(238),a(239)),x=(a(230),a(229)),D=a(255),w=a(33),T=(a(280),a(281)),M=(a(254),a(257)),F=a(23),A=a(32),L=a(278),V=a(236),N=a(2),R=a(243),B=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).getPatientGroup=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.qc,[a.props.active_practiceId]),(function(t){e.setState({patientGroup:t,loading:!1})}),(function(){e.setState({loading:!1})}))},a.state={patientGroup:[],loading:!0},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getPatientGroup()}},{key:"deleteObject",value:function(e){var t=this,a=e;a.is_active=!1;Object(F.j)(Object(F.f)(A.qc,[this.props.active_practiceId]),a,(function(e){t.getPatientGroup()}),(function(){}))}},{key:"render",value:function(){var e=this,t=[{title:"Group Name",dataIndex:"name",key:"name"},{title:"Patient Count",dataIndex:"patient_count",key:"patient_count"},{title:"Action",key:"action",render:function(t,a){return m.a.createElement(E.a,{title:"Are you sure delete this prescription?",onConfirm:function(){return e.deleteObject(a)},okText:"Yes",cancelText:"No"},m.a.createElement("a",null,"Delete"))}}],a=[{label:"Group Name",key:"name",required:!0,type:N.Y}],n={successFn:function(t){console.log(t),Object(F.a)(N.Wb,"success"),e.getPatientGroup()},errorFn:function(){},action:Object(F.f)(A.qc,[this.props.active_practiceId]),method:"post",beforeSubmit:function(e){console.log(e)}},r=S.a.create()(R.a);return m.a.createElement(f.a,null,m.a.createElement(r,Object.assign({formProp:n,title:"Patient Groups",fields:a},this.props)),m.a.createElement(v.a,null),m.a.createElement(V.a,{dataSource:this.state.patientGroup,loading:this.state.loading,columns:t}))}}]),t}(m.a.Component),z=a(297),Y=a(245),q=a(64),G=a.n(q),W=a(890),H=a.n(W),U=a(1728),K=a.n(U),X=a(309);function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var J=k.a.Meta,$=M.a.Search,ee=T.a.MonthPicker,te=1,ae=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).togglePatientGroupEditing=function(e){a.setState({showPatientGroupModal:!!e}),e||a.getPatientGroup()},a.changeSelectedPatientGroup=function(e){var t=Object(o.a)(a);a.setState({selectedPatientGroup:e.target.value,currentPage:null},(function(){t.getMorePatient()}))},a.addNewOptionField=function(){var e=a.props.form,t=e.getFieldValue("keys").concat(te++);e.setFieldsValue({keys:t})},a.removeNewOptionField=function(e){var t=a.props.form,n=t.getFieldValue("keys");1!==n.length&&t.setFieldsValue({keys:n.filter((function(t){return t!==e}))})},a.handleChangeOption=function(e,t,n){Object(o.a)(a).setState((function(t){return{selectedOption:Z({},t.selectedOption,Object(w.a)({},e,n)),custm_col:n?12:8}}))},a.AdvanceSearchPatient=function(e){var t=Object(o.a)(a);e.preventDefault();var n={};a.props.form.validateFields((function(e,t){e||(n=Z({},t,{dob:t.dob?G()(t.dob).format("YYYY-MM-DD"):null,dob_gte:t.dob_gte?G()(t.dob_gte).format("YYYY-MM-DD"):null,dob_lte:t.dob_lte?G()(t.dob_lte).format("YYYY-MM-DD"):null,dob_month:t.dob_month?G()(t.dob_month).format("MM"):null}))})),delete n.keys,t.setState({patientData:n},(function(){t.loadAdvanceSearchPatient()}))},a.loadAdvanceSearchPatient=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(o.a)(a),n=t.state.patientData;t.setState({advancedSearch:!0,advanceLoading:!0});var r=function(e){t.setState((function(t){return e.current>1?{patientListData:[].concat(Object(D.a)(t.patientListData),Object(D.a)(e.results)),morePatientList:e.next,currentPage:e.current,advanceLoading:!1}:{patientListData:Object(D.a)(e.results),morePatientList:e.next,currentPage:e.current,advanceLoading:!1}}))},i=function(){t.setState({advanceLoading:!1})};n.page=e,Object(F.c)(A.d,r,i,n)},a.state={patientListData:[],patientGroup:[],morePatients:null,loading:!0,selectedPatientGroup:"all",advanced_option:Y.b,selectedOption:{},sourceList:[],custm_col:8,advanceLoading:!1},a.getPatientListData=a.getPatientListData.bind(Object(o.a)(a)),a.searchPatient=a.searchPatient.bind(Object(o.a)(a)),a.getMorePatient=a.getMorePatient.bind(Object(o.a)(a)),a.getSources=a.getSources.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getPatientListData(),this.getPatientGroup(),this.getSources()}},{key:"getSources",value:function(){var e=this;Object(F.c)(A.xd,(function(t){e.setState({sourceList:t})}),(function(){}))}},{key:"getPatientGroup",value:function(){var e=this;Object(F.c)(Object(F.f)(A.qc,[this.props.active_practiceId]),(function(t){var a=t.sort((function(e,t){return t.patient_count-e.patient_count}));e.setState({patientGroup:a})}),(function(){e.setState({})}))}},{key:"getPatientListData",value:function(){var e=this;Object(F.c)(A.ic,(function(t){e.setState({patientListData:t.results,morePatients:t.next,currentPage:t.current,totalPatients:t.count,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"searchPatient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=this;a.setState({searchvalue:!0,searchString:e});var n=function(t){a.setState((function(a){if(a.searchString==e)return t.current>1?{patientListData:[].concat(Object(D.a)(a.patientListData),Object(D.a)(t.results)),morePatients:t.next,currentPage:t.current}:{patientListData:Object(D.a)(t.results),morePatients:t.next,currentPage:t.current,loading:!1}}))},r=function(){},i={page:t,page_size:20};e?Object(F.c)(Object(F.f)(A.Vc,[e]),n,r,i):this.getPatientListData()}},{key:"getMorePatient",value:function(){var e=this,t=this.state.currentPage,a={};t?a.page=parseInt(t)+1:this.setState({loading:!0});var n=this.state.selectedPatientGroup;if("all"!=n)if("smart_a"==n||"smart_b"==n||"smart_c"==n||"smart_d"==n||"smart_e"==n||"smart_f"==n)switch(n){case"smart_a":a.gender="male";break;case"smart_b":a.gender="female";break;case"smart_c":a.gender="female",a.age=30,a.type="gt";break;case"smart_d":a.gender="female",a.age=30,a.type="lt";break;case"smart_e":a.gender="male",a.age=30,a.type="gt";break;case"smart_f":a.gender="male",a.age=30,a.type="lt"}else a.group=this.state.selectedPatientGroup;Object(F.c)(A.ic,(function(a){a.current==t+1&&e.setState((function(e){return a.current>1?{patientListData:[].concat(Object(D.a)(e.patientListData),Object(D.a)(a.results)),morePatients:a.next,currentPage:a.current}:{patientListData:Object(D.a)(a.results),morePatients:a.next,currentPage:a.current,loading:!1}}))}),(function(){}),Z({},a))}},{key:"advancedOption",value:function(e){this.getPatientListData(),this.setState({advancedOptionShow:!e,selectedOption:""}),e&&this.props.form.setFieldsValue({keys:[0]})}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,r=a.getFieldDecorator,i=a.getFieldValue;r("keys",{initialValue:[0]});var l=i("keys"),c=Z({},K()(this.state.selectedOption,(function(e){return e}))),o=l.map((function(a,n){return m.a.createElement(f.a,{gutter:12,key:a},m.a.createElement(y.a,{span:10},m.a.createElement(x.a,{style:{width:"200px"},defaultValue:N.y,key:a,size:"small",onChange:function(t){return e.handleChangeOption(a,"type",t)}},m.a.createElement(x.a.Option,{value:""},N.y),H()(e.state.advanced_option,(function(e){return t.state.selectedOption[a]==e.value||!c[e.value]})).map((function(e){return m.a.createElement(x.a.Option,{value:e.value,key:a},e.label)})))),e.state.selectedOption?m.a.createElement(m.a.Fragment,null,m.a.createElement(y.a,{span:8},m.a.createElement(ie,{k:a,selectedOption:e.state.selectedOption,form:e.props.form,sourceList:e.state.sourceList})),m.a.createElement(y.a,{span:4},n?m.a.createElement(P.a,{onClick:function(){return e.removeNewOptionField(a)},size:"small",style:{margin:5}},m.a.createElement(j.a,{className:"dynamic-delete-button",type:"minus-circle-o",style:{color:"red"}})):null,n==l.length-1&&t.state.selectedOption[a]?m.a.createElement(P.a,{onClick:e.addNewOptionField,size:"small",style:{margin:5}},m.a.createElement(j.a,{className:"dynamic-delete-button",type:"plus-circle-o"})):null)):null)}));return t.props.activePracticePermissions.ViewPatient?m.a.createElement("div",null,m.a.createElement(f.a,{gutter:16},this.state.advancedOptionShow?m.a.createElement(S.a,{onSubmit:this.AdvanceSearchPatient,layout:"inline"},m.a.createElement(f.a,{gutter:16},m.a.createElement(y.a,{span:16},o),m.a.createElement(y.a,{span:4,style:{display:"flex"}},m.a.createElement(S.a.Item,null,m.a.createElement(P.a,{icon:"search",htmlType:"submit",onSubmit:this.AdvanceSearchPatient,type:"primary",style:{margin:5}},"Search")),m.a.createElement(S.a.Item,null,m.a.createElement(P.a,{style:{margin:5},onClick:function(t){return e.advancedOption(!0)},size:"small"},"Basic Search"))))):m.a.createElement(m.a.Fragment,null,m.a.createElement(y.a,{span:12},m.a.createElement($,{style:{margin:5},placeholder:"Search Patient By Name / ID / Mobile No / Aadhar No",size:"small",onChange:function(t){return e.searchPatient(t.target.value)},enterButton:!0})),m.a.createElement(y.a,{span:12,style:{textAlign:"center"}},m.a.createElement(P.a,{style:{margin:5},onClick:function(t){return e.advancedOption(!1)},size:"small"},"Advance Search"))),m.a.createElement(v.a,{style:{margin:0}})),m.a.createElement(f.a,{gutter:16},m.a.createElement(y.a,{span:5,style:{height:"calc(100% - 55px)",overflow:"auto",padding:"10px"}},m.a.createElement(I.a.Group,{buttonStyle:"solid",defaultValue:this.state.selectedPatientGroup,onChange:this.changeSelectedPatientGroup},m.a.createElement("h2",null,"Patients"),m.a.createElement(I.a.Button,{key:"all",style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:"all"},"All Patients",m.a.createElement(g.a,{color:"#87d068",style:{float:"right",margin:4}},this.state.totalPatients?this.state.totalPatients:0)),m.a.createElement("p",null,m.a.createElement("br",null)),m.a.createElement("h2",null,"Groups"),m.a.createElement("p",null,m.a.createElement("b",null,"My Groups"),m.a.createElement("a",{style:{float:"right"},onClick:function(){return e.togglePatientGroupEditing(!0)}},"Manage")),this.state.patientGroup.map((function(e){return m.a.createElement(I.a.Button,{key:e.id,style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:e.id},e.name,m.a.createElement(g.a,{color:"#87d068",style:{float:"right",margin:4}},e.patient_count))})),m.a.createElement("p",null,m.a.createElement("br",null)),m.a.createElement("p",null,m.a.createElement("b",null,"Smart Groups")),m.a.createElement(I.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_a",value:"smart_a"},"All Male"),m.a.createElement(I.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_b",value:"smart_b"},"All Female"),m.a.createElement(I.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_e",value:"smart_e"},"Male Over 30"),m.a.createElement(I.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_c",value:"smart_c"},"Female Over 30"),m.a.createElement(I.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_f",value:"smart_f"},"Male Under 30"),m.a.createElement(I.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},key:"smart_d",value:"smart_d"},"Female Under 30"),m.a.createElement("p",null,m.a.createElement("br",null)))),m.a.createElement(y.a,{span:19,style:{overflow:"scroll",borderLeft:"1px solid #ccc"}},m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null,this.state.patientListData.length?this.state.patientListData.map((function(e){return m.a.createElement(re,Object.assign({},e,{key:e.id,showMobile:t.props.activePracticePermissions.PatientPhoneNumber,showEmail:t.props.activePracticePermissions.PatientEmailId,setCurrentPatient:t.props.setCurrentPatient}))})):m.a.createElement("p",{style:{textAlign:"center"}},"No Data Found"))),this.state.searchvalue?m.a.createElement(L.a,{loaderFunction:this.searchPatient,loading:this.state.loading,hidden:!this.state.morePatients}):this.state.advancedSearch?m.a.createElement(L.a,{loading:this.state.advanceLoading,loaderFunction:function(){return e.loadAdvanceSearchPatient(t.state.morePatientList)},hidden:!this.state.morePatientList}):m.a.createElement(L.a,{loaderFunction:this.getMorePatient,loading:this.state.loading,hidden:!this.state.morePatients})),m.a.createElement(h.a,{visible:this.state.showPatientGroupModal,footer:null,onCancel:function(){return e.togglePatientGroupEditing(!1)}},m.a.createElement(B,this.props)))):m.a.createElement(X.a,null)}}]),t}(m.a.Component),ne=S.a.create()(ae);function re(e){return m.a.createElement(y.a,{xs:24,sm:24,md:12,lg:8,xl:8,xxl:6},m.a.createElement(k.a,{onClick:function(){return e.setCurrentPatient(e)},style:{margin:"3px",paddingBottom:"8px"}},m.a.createElement(J,{avatar:e.image?m.a.createElement(O.a,{src:Object(F.g)(e.image),size:50}):m.a.createElement(O.a,{style:{backgroundColor:"#87d068"},size:50},e.user.first_name?e.user.first_name.charAt(0):m.a.createElement(j.a,{type:"user"})),title:e.user.first_name,description:m.a.createElement("span",null,e.showMobile?e.user.mobile:Object(z.b)(e.user.mobile),m.a.createElement("br",null),e.showEmail?e.user.email:Object(z.a)(e.user.email),m.a.createElement("br",null),m.a.createElement("span",{className:"patientIdHighlight"},"#",e.custom_id?e.custom_id:e.id,e.gender?","+e.gender.charAt(0).toUpperCase():null))})))}function ie(e){return m.a.createElement(m.a.Fragment,null,"name"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("name")(m.a.createElement(M.a,{placeholder:"patient Name",size:"small"}))):null,"phone"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("phone")(m.a.createElement(M.a,{placeholder:"Contact Number",size:"small"}))):null,"age"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key},e.form.getFieldDecorator("age")(m.a.createElement(C.a,{placeholder:"Patient Age",size:"small"}))):null,"age_gte"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key},e.form.getFieldDecorator("age_gte")(m.a.createElement(C.a,{placeholder:"Age more than",size:"small"}))):null,"age_lte"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key},e.form.getFieldDecorator("age_lte")(m.a.createElement(C.a,{placeholder:"Age Less than",size:"small"}))):null,"has_age"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,null,e.form.getFieldDecorator("has_age")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.N.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"dob"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key,label:"is"},e.form.getFieldDecorator("dob")(m.a.createElement(T.a,{placeholder:"Date of Birth",size:"small"}))):null,"dob_gte"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key},e.form.getFieldDecorator("dob_gte")(m.a.createElement(T.a,{size:"small"}))):null,"dob_lte"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key},e.form.getFieldDecorator("dob_lte")(m.a.createElement(T.a,{size:"small"}))):null,"dob_month"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key},e.form.getFieldDecorator("dob_month")(m.a.createElement(ee,{size:"small"}))):null,"has_dob"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,null,e.form.getFieldDecorator("has_dob")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.O.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"patient_id"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("patient_id")(m.a.createElement(M.a,{placeholder:"Patient Id",size:"small"}))):null,"has_aadhar"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,null,e.form.getFieldDecorator("has_aadhar")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.M.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"aadhar"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("aadhar")(m.a.createElement(M.a,{placeholder:"Aadhar Id",size:"small"}))):null,"email"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("email")(m.a.createElement(M.a,{placeholder:"Email Id",size:"small"}))):null,"has_email"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,null,e.form.getFieldDecorator("has_email")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.P.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"gender"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key,label:"is"},e.form.getFieldDecorator("gender")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.L.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"has_gender"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,null,e.form.getFieldDecorator("has_gender")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.Q.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"pincode"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("pincode")(m.a.createElement(M.a,{placeholder:"PINCODE",size:"small"}))):null,"has_pincode"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,null,e.form.getFieldDecorator("has_pincode")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.R.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"has_street"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,null,e.form.getFieldDecorator("has_street")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.S.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null,"street"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key,label:"contains"},e.form.getFieldDecorator("street")(m.a.createElement(M.a,{placeholder:"Street Address",size:"small"}))):null,"blood_group"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,{key:e.key,label:"is"},e.form.getFieldDecorator("blood_group")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.k.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.name," ")}))))):null,"source"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,null,e.form.getFieldDecorator("source")(m.a.createElement(x.a,{style:{width:100},size:"small"},e.sourceList.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name," ")}))))):null,"agent_referal"==e.selectedOption[e.k]?m.a.createElement(S.a.Item,null,e.form.getFieldDecorator("agent_referal")(m.a.createElement(x.a,{style:{width:100},size:"small"},Y.wb.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label," ")}))))):null)}var le=a(65),ce=a(339),oe=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPatientCallNotes=function(){var e=Object(o.a)(a);e.setState({callNotesLoading:!0});var t={patient:a.props.patientId};Object(F.c)(A.mc,(function(t){e.setState({callNotes:t,callNotesLoading:!1})}),(function(t){e.setState({callNotesLoading:!1})}),t)},a.state={notes:[],callNotesLoading:!1,loading:!0},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadPatientNotes(),this.loadPatientCallNotes()}},{key:"loadPatientNotes",value:function(){var e=this;e.setState({loading:!0});Object(F.c)(Object(F.f)(A.tc,[this.props.patientId,this.props.active_practiceId]),(function(t){e.setState({notes:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this,t=[{key:"name",required:!0,type:N.Y}],a={successFn:function(t){Object(F.a)(N.Wb,"Patient Note Added"),e.loadPatientNotes()},errorFn:function(){},action:Object(F.f)(A.tc,[this.props.patientId,this.props.active_practiceId]),method:"post",beforeSubmit:function(e){}},n=[{key:"patient",value:this.props.patientId},{key:"practice",value:this.props.active_practiceId}],r=ce.Form.create()(R.a);return m.a.createElement("div",null,m.a.createElement(v.a,null,"Patient Notes"),m.a.createElement(r,{formProp:a,defaultValues:n,fields:t}),m.a.createElement(ce.List,{size:"small",loading:this.state.loading,dataSource:this.state.notes,renderItem:function(e){return m.a.createElement(ce.List.Item,null,m.a.createElement(ce.List.Item.Meta,{title:e.name,description:"by "+(e.staff?e.staff.user.first_name:"--")+" on "+G()(e.created_at).format("lll")}))}}),m.a.createElement(v.a,null,"Voice Call Notes"),m.a.createElement(ce.List,{size:"small",loading:this.state.callNotesLoading,dataSource:this.state.callNotes,renderItem:function(e){return m.a.createElement(ce.List.Item,null,m.a.createElement(ce.List.Item.Meta,{title:e.remarks?e.remarks:"--",description:"Created on "+G()(e.timestamp).format("lll")}))}}))}}]),t}(m.a.Component),se=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={redirect:!1,currentPatient:a.props.currentPatient,Membership:[]},a.loadMembership=a.loadMembership.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadMembership()}},{key:"loadMembership",value:function(){var e=this;e.state.currentPatient&&Object(F.c)(Object(F.f)(A.ac,[e.props.active_practiceId]),(function(t){e.setState({Membership:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this;console.log("form state",this.state);var t=[{label:"Type",key:"medical_membership",type:N.Rb,options:this.state.Membership.map((function(e){return{label:e.name,value:e.id}}))},{label:"Start Date",key:"medical_from",initilValue:G()(),type:N.M,format:"YYYY-MM-DD"}],a={successFn:function(t){Object(F.a)(N.Wb,"Medical Membership added"),e.props.loadProfile(),e.props.loadMedicalMembership(),e.props.formChange()},errorFn:function(){},action:Object(F.f)(A.jc,[this.props.patientId]),method:"post"},n=S.a.create()(R.a),r=[{key:"patient",value:this.props.patientId},{key:"practice",value:this.props.active_practiceId}];return m.a.createElement(n,{formProp:a,defaultValues:r,fields:t})}}]),t}(m.a.Component),ue=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={redirect:!1,currentPatient:a.props.currentPatient,agentRoles:[]},a.loadAgentRoles=a.loadAgentRoles.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadAgentRoles()}},{key:"loadAgentRoles",value:function(){var e=this;Object(F.c)(A.e,(function(t){e.setState({agentRoles:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this,t=[{label:"Role Type",key:"role",type:N.Rb,options:this.state.agentRoles.map((function(e){return{label:e.name,value:e.id}}))},{label:"Document Upload",key:"aadhar_upload",type:N.Tb,required:!0}],a={successFn:function(t){Object(F.a)(N.Wb,"Agent Role added"),e.props.loadProfile()},errorFn:function(){},action:Object(F.f)(A.wc,[this.props.patientId]),method:"put"},n=S.a.create()(R.a);return m.a.createElement(n,{formProp:a,defaultValues:[{key:"is_agent",value:!0}],fields:t})}}]),t}(m.a.Component),de=a(235),me=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).formChange=function(e){a.setState({add:e})},a.addAgent=function(){Object(o.a)(a).setState({agentModalVisible:!0})},a.addAgentModalClosed=function(){a.setState({agentModalVisible:!1})},a.state={patientProfile:null,currentPatient:a.props.currentPatient,medicalHistory:{},loading:!0,add:"",MedicalMembership:null,hide:!1,agentModalVisible:!1},a.loadProfile=a.loadProfile.bind(Object(o.a)(a)),a.loadMedicalMembership=a.loadMedicalMembership.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.state.currentPatient&&(this.loadProfile(),this.loadMedicalMembership())}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.currentPatient&&e.currentPatient!=this.state.currentPatient&&this.setState({currentPatient:e.currentPatient},(function(){t.loadProfile()}))}},{key:"loadProfile",value:function(){var e=this;e.state.currentPatient&&Object(F.c)(Object(F.f)(A.wc,[e.state.currentPatient.id]),(function(t){e.setState({patientProfile:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"loadMedicalMembership",value:function(){var e=this;Object(F.c)(Object(F.f)(A.jc,[e.props.currentPatient.id]),(function(t){e.setState({MedicalMembership:t[t.length-1],loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"onClickHandler",value:function(e){this.state.MedicalMembership?(Object(F.a)(N.S,"Membership !!"),this.setState({add:!1})):this.setState({add:e})}},{key:"deleteMembership",value:function(e){var t=this,a={id:e,is_active:!1};Object(F.j)(Object(F.f)(A.Vb,[t.props.currentPatient.id]),a,(function(e){t.loadProfile(),t.loadMedicalMembership()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this;if(this.props.currentPatient){var a=this.state.patientProfile;return a?m.a.createElement(k.a,{loading:this.state.loading,title:"Patient Profile",extra:m.a.createElement(m.a.Fragment,null,t.props.activePracticePermissions.EditPatient?m.a.createElement(le.b,{to:"/patient/"+this.state.currentPatient.id+"/profile/edit"},m.a.createElement(P.a,{type:"primary"},m.a.createElement(j.a,{type:"edit"}),"\xa0Edit Patient Profile")):null)},m.a.createElement(f.a,{gutter:16},m.a.createElement(y.a,{span:6,style:{textAlign:"center"}},a.image?m.a.createElement("img",{src:Object(F.g)(a.image),style:{width:"100%"}}):m.a.createElement(O.a,{size:200,shape:"square",style:{backgroundColor:"#87d068"}},a.user.first_name?a.user.first_name:m.a.createElement(j.a,{type:"user"})),a.is_agent&&a.is_approved?m.a.createElement(_.a,{title:"Referral Code",value:a.user.referer_code}):null,m.a.createElement(y.a,null,m.a.createElement(v.a,null),this.state.add?m.a.createElement("div",null,m.a.createElement("h1",{style:{fontSize:"18px"}},"Medical Membership ",m.a.createElement("a",{href:"#",onClick:function(){return e.onClickHandler(!1)}},"Cancel")),m.a.createElement(se,Object.assign({},this.props,this.state,{patientId:a.id,loadMedicalMembership:t.loadMedicalMembership,formChange:t.formChange,loadProfile:t.loadProfile}))):m.a.createElement("div",{style:{padding:"0px"}},m.a.createElement("h1",{style:{fontSize:"18px",textAlign:"center"}},"Medical Membership ",m.a.createElement("a",{href:"#",onClick:function(){return e.onClickHandler(!0)}},this.state.MedicalMembership?"Renew":"Add")),this.state.MedicalMembership?m.a.createElement(k.a,{size:"small",title:"Membership",extra:m.a.createElement(E.a,{title:"Are you sure delete this Membership?",onConfirm:function(){return t.deleteMembership(e.state.MedicalMembership.id)},okText:"Yes",cancelText:"No"},m.a.createElement(P.a,{icon:"close",type:"danger",shape:"circle",size:"small"})),style:{textAlign:"center"}},m.a.createElement("div",{style:{textAlign:"left"}},m.a.createElement("p",null,m.a.createElement("strong",null,"Membership Code : "),m.a.createElement("span",null,this.state.MedicalMembership.membership_code)),m.a.createElement("p",null,m.a.createElement("strong",null,"Start Date : "),m.a.createElement("span",null,this.state.MedicalMembership.medical_from)),m.a.createElement("p",null,m.a.createElement("strong",null,"Valid Till : "),m.a.createElement("span",null,this.state.MedicalMembership.medical_to)))):null))),m.a.createElement(y.a,{span:12},m.a.createElement(pe,{label:"Patient Name",value:a.user.first_name}),m.a.createElement(pe,{label:"Patient ID",value:a.custom_id?a.custom_id:a.id}),a&&a.role?m.a.createElement(pe,{label:"Advisor Role",value:a.role_data.name}):null,m.a.createElement(pe,{label:"Gender",value:a.gender}),a.is_age?m.a.createElement(pe,{label:"Age",value:a.dob?G()().diff(this.props.currentPatient.dob,"years"):null}):m.a.createElement(pe,{label:"Date of Birth",value:a.dob}),m.a.createElement(pe,{label:"Referer",value:a.user.referer_data.referer?m.a.createElement(le.b,{to:"/patient/"+a.user.referer_data.patient+"/profile"},a.user.referer_data.referer.first_name):"--"}),m.a.createElement(v.a,null,"Contact Details"),m.a.createElement(pe,{label:"Email",value:t.props.activePracticePermissions.PatientEmailId?a.user.email:Object(z.a)(a.user.email)}),m.a.createElement(pe,{label:"Primary Mobile",value:t.props.activePracticePermissions.PatientPhoneNumber?a.user.mobile:Object(z.b)(a.user.mobile)}),m.a.createElement(pe,{label:"Secondary Mobile",value:t.props.activePracticePermissions.PatientPhoneNumber?a.secondary_mobile_no:Object(z.b)(a.secondary_mobile_no)}),m.a.createElement(pe,{label:"Landline No",value:a.landline_no}),m.a.createElement(pe,{label:"Address",value:a.address}),m.a.createElement(pe,{label:"Locality",value:a.locality}),m.a.createElement(pe,{label:"City",value:a.city_data?a.city_data.name:null}),m.a.createElement(pe,{label:"State",value:a.state_data?a.state_data.name:null}),m.a.createElement(pe,{label:"Country",value:a.country_data?a.country_data.name:null}),m.a.createElement(pe,{label:"Pincode",value:a.pincode})),m.a.createElement(y.a,{span:6,style:{borderLeft:"1 px solid #ccc"}},m.a.createElement(oe,Object.assign({},this.props,{patientId:a.id})),m.a.createElement(v.a,null,"Medical History"),a.medical_history_data?a.medical_history_data.map((function(e,t){return m.a.createElement(g.a,{color:"#"+Object(de.b)(Object(de.a)(e.name))},e.name)})):null,m.a.createElement(v.a,null,"Groups"),m.a.createElement(b.a,{dataSource:a.patient_group_data,renderItem:function(e){return m.a.createElement(b.a.Item,null,e.name)}})),m.a.createElement(h.a,{title:"Add Agent",visible:this.state.agentModalVisible,onOk:null,footer:null,onCancel:this.addAgentModalClosed},m.a.createElement(ue,Object.assign({patientId:a.id},this.state))))):m.a.createElement(k.a,{loading:this.state.loading})}return m.a.createElement(ne,this.props)}}]),t}(m.a.Component);function pe(e){return m.a.createElement(f.a,{gutter:16,style:{marginBottom:"5px"}},m.a.createElement(y.a,{span:8,style:{textAlign:"right"}},e.label,":"),m.a.createElement(y.a,{span:16},m.a.createElement("strong",null,e.value)))}a(277);var fe=a(275),he=(a(374),a(373)),be=(a(343),a(357)),ge=(a(141),a(15)),ye=a(442);function Ee(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ve(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ee(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ee(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _e=h.a.confirm,Oe=function(e){function t(e){var a,n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadMedicalHistory=function(){var e=Object(o.a)(n);Object(F.c)(Object(F.f)(A.Ub,[n.props.active_practiceId]),(function(t){e.setState({history:t})}),(function(){}))},n.setFormParams=function(e,t){n.setState(Object(w.a)({},e,t))},n.getPatientGroup=function(){var e=Object(o.a)(n);Object(F.c)(Object(F.f)(A.qc,[n.props.active_practiceId]),(function(t){e.setState({patientGroup:t,loading:!1})}),(function(){e.setState({loading:!1})}))},n.handleSubmit=function(e){var t=Object(o.a)(n);e.preventDefault(),n.props.form.validateFields((function(e,a){if(!e){var r=ve({},a,{file_enable:!!a.file_enable,file_count:a.file_count?a.file_count:n.state.file_count,on_dialysis:!!t.state.on_dialysis,medical_history:a.medical_history,patient_group:a.patient_group,user:{first_name:a.first_name?a.first_name:"",mobile:a.mobile,email:a.email}});a.anniversary&&(r.anniversary=G()(a.anniversary).format("YYYY-MM-DD")),a.dob&&(r.dob=G()(a.dob).format("YYYY-MM-DD")),a.age&&(r.is_age=!0,r.dob=G()().subtract(a.age,"years").format("YYYY-MM-DD")),a.custom_id?r.custom_id=a.custom_id_pre+a.custom_id:r.custom_id=null;var i="image";r[i]&&r[i].file&&r[i].file.response&&(r[i]=r[i].file.response.image_path),delete r.first_name,delete r.email,delete r.referer_code,delete r.mobile,delete r.age,delete r.custom_id_pre,t.setState({loading:!0});var l=function(e){Object(F.a)("Patient Saved Successfully!!"),t.setState({loading:!1}),t.props.history.push("/patient/"+e.id+"/profile")},c=function(){t.setState({loading:!1})};r=Object(F.m)(r),t.props.currentPatient?Object(F.l)(Object(F.f)(A.wc,[t.props.currentPatient.id]),r,l,c):Object(F.j)(Object(F.f)(A.ic,[t.props.match.params.id]),r,l,c)}}))},n.toggleWebCam=function(e,t){n.setState((function(a){return{webCamState:ve({},a.webCamState,Object(w.a)({},e,t))}}))},n.getImageandUpload=function(e,t){var a=Object(o.a)(n),r=new FormData;r.append("image",t),r.append("name","file");Object(F.j)(A.tb,r,(function(t){a.props.form.setFieldsValue(Object(w.a)({},e,{file:{response:t}})),Object(F.a)(N.Wb,"Image Captured and processed."),a.setState((function(t){return{webCamState:ve({},t.webCamState,Object(w.a)({},e,!1))}}))}),(function(){}),{"content-type":"multipart/form-data"})},n.onChangeValue=function(e,t){var a=Object(o.a)(n);a.setState(Object(w.a)({},e,t),(function(){"country"==e&&a.getState(),"state"==e&&a.getCity()}))},n.setFormParams=function(e,t){n.setState(Object(w.a)({},e,t))},n.onChangeCheckbox=function(e){n.setState({on_dialysis:!n.state.on_dialysis})},n.changeFormType=function(e){n.setState({selectedFormType:e.target.value})},n.handleRelation=function(e){e?n.setState({relation_text:!1}):n.setState({relation_text:!0})},n.handleNumberChange=function(e){n.setState({number:ve({},je(e),{value:e})})},n.state=(a={redirect:!1,history:[],patientGroup:[],membership:[],webCamState:{},countrylist:[],stateList:[],cityList:[],sourceList:[],country:n.props.currentPatient&&n.props.currentPatient.country_data?n.props.currentPatient.country:null,state:n.props.currentPatient&&n.props.currentPatient.state_data?n.props.currentPatient.state:null,selectedFormType:"DOB",file_count:10,file_enable:!0,relation_text:!0,loading:!1},Object(w.a)(a,Y.l,[]),Object(w.a)(a,Y.nb,[]),Object(w.a)(a,Y.Db,[]),Object(w.a)(a,Y.J,[]),Object(w.a)(a,Y.K,[]),Object(w.a)(a,"number",{}),a),n.changeRedirect=n.changeRedirect.bind(Object(o.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(o.a)(n)),n.getCountry=n.getCountry.bind(Object(o.a)(n)),n.getState=n.getState.bind(Object(o.a)(n)),n.getCity=n.getCity.bind(Object(o.a)(n)),n.getSources=n.getSources.bind(Object(o.a)(n)),n.loadPatientData=n.loadPatientData.bind(Object(o.a)(n)),n}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadMedicalHistory(),this.getPatientGroup(),this.getPatientMembership(),this.getSources(),this.getCountry(),this.state.country&&this.getState(),this.state.state&&this.getCity(),this.props.currentPatient&&this.loadPatientData(this.props.currentPatient.id),Object(de.c)(this,[Y.l,Y.nb,Y.Db,Y.J,Y.K])}},{key:"getCountry",value:function(){var e=this;Object(F.c)(A.U,(function(t){e.setState({countrylist:t})}),(function(){}))}},{key:"getSources",value:function(){var e=this;Object(F.c)(A.xd,(function(t){e.setState({sourceList:t})}),(function(){}))}},{key:"getState",value:function(){var e=this;Object(F.c)(A.zd,(function(t){e.setState({stateList:t})}),(function(){}),{country:this.state.country})}},{key:"getCity",value:function(){var e=this;Object(F.c)(A.Q,(function(t){e.setState({cityList:t})}),(function(){}),{state:this.state.state})}},{key:"getPatientMembership",value:function(){var e=this;Object(F.c)(Object(F.f)(A.ac,[this.props.active_practiceId]),(function(t){e.setState({membership:t})}),(function(){}))}},{key:"loadPatientData",value:function(e){var t=this;Object(F.c)(Object(F.f)(A.wc,[e]),(function(e){t.setState({patientDetails:e,loading:!1})}),(function(){t.setState({loading:!1})}))}},{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"onDeletePatient",value:function(){var e=this;_e({title:"Are you sure delete this patient?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){e.patientDelete()}})}},{key:"patientDelete",value:function(){var e=this,t=e.state.patientDetails.id,a={id:t,is_active:!1};Object(F.l)(Object(F.f)(A.wc,[t]),a,(function(t){e.setState({loading:!1}),Object(F.a)("Patient Deleted!!"),e.props.history.push("/patients/profile")}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=this.props.form.getFieldDecorator,n={labelCol:{span:6},wrapperCol:{span:14}},r=[];this.state.history&&this.state.history.forEach((function(e){r.push({label:e.name,value:e.id})}));var i=[];this.state.patientGroup&&this.state.patientGroup.forEach((function(e){i.push({label:e.name,value:e.id})}));var l=[];this.state.membership&&this.state.membership.forEach((function(e){l.push({label:e.name,value:e.id})}));var c={name:"image",data:{name:"hello"},action:Object(F.h)(A.sb),headers:{authorization:"authorization-text"},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?ge.a.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&ge.a.error("".concat(e.file.name," file upload failed."))}};return m.a.createElement(S.a,{onSubmit:t.handleSubmit},m.a.createElement(k.a,{title:m.a.createElement("span",null,t.props.currentPatient?"Edit Profile":"Add Patient","\xa0\xa0",m.a.createElement(le.b,{to:"/patients/patientprintform"},"Print Patient Form")),extra:m.a.createElement("div",null,m.a.createElement(P.a,{style:{margin:5},type:"primary",htmlType:"submit"},"Save"),t.props.history?m.a.createElement(P.a,{style:{margin:5},onClick:function(){return t.props.history.goBack()}},"Cancel"):null,t.props.currentPatient?m.a.createElement(m.a.Fragment,null,this.state.patientDetails&&this.state.patientDetails.is_approved?m.a.createElement(be.a,{placement:"leftBottom",trigger:"hover",content:"An Agent is associated. Patient can not be deleted."},m.a.createElement(P.a,{style:{margin:5},type:"danger",disabled:!0},"Delete")):m.a.createElement(P.a,{style:{margin:5},onClick:function(){return t.onDeletePatient()},type:"danger"},"Delete")):null)},m.a.createElement(S.a.Item,Object.assign({key:"image"},n,{label:"Patient Image"}),a("image",{valuePropName:"image"})(m.a.createElement(he.a,c,m.a.createElement(P.a,null,m.a.createElement(j.a,{type:"upload"})," Select File"),this.state.patientDetails&&this.state.patientDetails.image?m.a.createElement("img",{src:Object(F.g)(this.state.patientDetails?this.state.patientDetails.image:null),style:{maxWidth:"100%"}}):null)),m.a.createElement("span",{className:"ant-form-text"},m.a.createElement("a",{onClick:function(){return t.toggleWebCam("image",Math.random())}},"Open Webcam")),m.a.createElement(h.a,{footer:null,onCancel:function(){return t.toggleWebCam("image",!1)},visible:!!t.state.webCamState.image,width:680,key:t.state.webCamState.image},m.a.createElement(ye.a,{getScreenShot:function(e){return t.getImageandUpload("image",e)}}))),m.a.createElement(S.a.Item,Object.assign({label:"Patient Name"},n),a("first_name",{rules:[{required:!0,message:"Input Patient Name!"}],initialValue:this.state.patientDetails?this.state.patientDetails.user.first_name:""})(m.a.createElement(M.a,{placeholder:"Patient Name"}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:8},m.a.createElement(S.a.Item,{label:"Patient Id",labelCol:{span:18},wrapperCol:{span:6}},a("custom_id_pre",{initialValue:this.state.patientDetails&&this.state.patientDetails.is_agent?"AD":"BK"})(m.a.createElement(x.a,null,m.a.createElement(x.a.Option,{value:"BK"},"BK"),m.a.createElement(x.a.Option,{value:"AD"},"AD"))))),m.a.createElement(y.a,{span:16},m.a.createElement(S.a.Item,{labelCol:{span:0},wrapperCol:{span:18},validateStatus:this.state.number.validateStatus,help:this.state.number.errorMsg||"Only numbers are allowed."},a("custom_id",{initialValue:this.state.patientDetails?this.state.patientDetails.custom_id.replace(/\D/g,""):""})(m.a.createElement(C.a,{style:{width:"100%"},placeholder:"Patient Id",onChange:this.handleNumberChange}))))),this.state.source&&this.state.source==N.Y?m.a.createElement(S.a.Item,Object.assign({key:"source_extra",label:"Source"},n),a("source_extra",{initialValue:""})(m.a.createElement(M.a,{placeholder:"Source"})),m.a.createElement("a",{onClick:function(){return t.setFormParams("source",N.Rb)}},"Choose Source")):m.a.createElement(S.a.Item,Object.assign({label:"Source"},n),a("source",{initialValue:this.state.patientDetails?this.state.patientDetails.source:null})(m.a.createElement(x.a,{placeholder:"Select Source",showSearch:!0,optionFilterProp:"children"},this.state.sourceList.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)})))),m.a.createElement("a",{onClick:function(){return t.setFormParams("source",N.Y)}},"Enter New Source")),this.state.patientDetails?null:m.a.createElement(S.a.Item,Object.assign({label:"Referral Code"},n),a("referal",{initialValue:this.state.patientDetails?this.state.patientDetails.user.referer_code:""})(m.a.createElement(M.a,{placeholder:"Referral Code"}))),m.a.createElement(S.a.Item,Object.assign({label:"SMS Language"},n),a("language",{initialValue:this.state.patientDetails&&this.state.patientDetails.language?this.state.patientDetails.language:this.props.activePracticeData.language})(m.a.createElement(x.a,null,this.state[Y.Db].map((function(e){return m.a.createElement(x.a.Option,{value:e},e)}))))),m.a.createElement(S.a.Item,Object.assign({label:"Aadhar ID"},n),a("aadhar_id",{initialValue:this.state.patientDetails?this.state.patientDetails.aadhar_id:""})(m.a.createElement(M.a,{placeholder:"Patient Aadhar Number"}))),m.a.createElement(S.a.Item,Object.assign({label:"Gender"},n),a("gender",{initialValue:this.state.patientDetails?this.state.patientDetails.gender:null})(m.a.createElement(x.a,{placeholder:"Select Gender"},this.state[Y.K].map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))),m.a.createElement(S.a.Item,Object.assign({label:" "},n,{colon:!1}),m.a.createElement(I.a.Group,{buttonStyle:"solid",size:"small",onChange:this.changeFormType,defaultValue:this.state.selectedFormType},Y.lb.map((function(e){return m.a.createElement(I.a,{value:e.value},e.label)})))),"DOB"==this.state.selectedFormType?m.a.createElement(S.a.Item,Object.assign({label:"DOB"},n),a("dob",{initialValue:this.state.patientDetails&&this.state.patientDetails.dob?G()(this.state.patientDetails.dob):""})(m.a.createElement(T.a,null))):m.a.createElement(S.a.Item,Object.assign({label:"Age"},n),a("age",{initialValue:this.state.patientDetails&&this.state.patientDetails.dob?G()().diff(this.state.patientDetails.dob,"years"):null})(m.a.createElement(C.a,{min:0,max:120,placeholder:"Patient Age"}))),m.a.createElement(S.a.Item,Object.assign({label:"Anniversary"},n),a("anniversary",{initialValue:this.state.patientDetails&&this.state.patientDetails.anniversary?G()(this.state.patientDetails.anniversary):null})(m.a.createElement(T.a,null))),m.a.createElement(S.a.Item,Object.assign({label:"Blood Group"},n),a("blood_group",{initialValue:this.state.patientDetails?this.state.patientDetails.blood_group:""})(m.a.createElement(x.a,{placeholder:"Blood Group"},this.state[Y.l].map((function(e){return m.a.createElement(x.a.Option,{value:e},e)}))))),m.a.createElement(S.a.Item,Object.assign({label:"Family"},n),m.a.createElement(S.a.Item,{style:{display:"inline-block",width:"calc(30% - 12px)"}},a("family_relation",{initialValue:this.state.patientDetails&&null!=this.state.patientDetails.family_relation?this.state.patientDetails.family_relation:N.Kb})(m.a.createElement(x.a,{onChange:function(t){return e.handleRelation(t)}},m.a.createElement(x.a.Option,{value:""},N.Kb),this.state[Y.J].map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.name)}))))),m.a.createElement("span",{style:{display:"inline-block",width:"14px",textAlign:"center"}}),m.a.createElement(S.a.Item,{style:{display:"inline-block",width:"calc(50% - 12px)"}},a("attendee",{initialValue:this.state.patientDetails?this.state.patientDetails.attendee:""})(m.a.createElement(M.a,{disabled:(!this.state.patientDetails||!this.state.patientDetails.attendee)&&this.state.relation_text})))),m.a.createElement(S.a.Item,Object.assign({label:"Mobile (Primary)"},n),a("mobile",{initialValue:this.state.patientDetails?this.state.patientDetails.user.mobile:null,rules:[{required:!0,message:"Input Mobile Number"}]})(m.a.createElement(M.a,{placeholder:"Patient Mobile Number (Primary)"}))),m.a.createElement(S.a.Item,Object.assign({label:"Mobile (Secondary)"},n),a("secondary_mobile_no",{initialValue:this.state.patientDetails?this.state.patientDetails.secondary_mobile_no:""})(m.a.createElement(M.a,{placeholder:"Patient Mobile Number (Secondary)"}))),m.a.createElement(S.a.Item,Object.assign({label:"Landline"},n),a("landline_no",{initialValue:this.state.patientDetails?this.state.patientDetails.landline_no:""})(m.a.createElement(M.a,{placeholder:"Patient Landline Number"}))),m.a.createElement(S.a.Item,Object.assign({label:"Address"},n),a("address",{initialValue:this.state.patientDetails?this.state.patientDetails.address:""})(m.a.createElement(M.a,{placeholder:"Patient Address"}))),m.a.createElement(S.a.Item,Object.assign({label:"Locality"},n),a("locality",{initialValue:this.state.patientDetails?this.state.patientDetails.locality:""})(m.a.createElement(M.a,{placeholder:"Patient Locality"}))),this.state.country&&this.state.country==N.Y?m.a.createElement(S.a.Item,Object.assign({key:"country_extra",label:"Country"},n),a("country_extra",{initialValue:""})(m.a.createElement(M.a,{placeholder:"Country"})),m.a.createElement("a",{onClick:function(){return t.setFormParams("country",N.Rb)}},"Choose Country")):m.a.createElement(S.a.Item,Object.assign({key:"country"},n,{label:"Country"}),a("country",{initialValue:this.state.patientDetails&&this.state.patientDetails.country_data?this.state.patientDetails.country_data.id:""})(m.a.createElement(x.a,{placeholder:"Select Country",onChange:function(t){return e.onChangeValue("country",t)},showSearch:!0,optionFilterProp:"children"},this.state.countrylist.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)})))),m.a.createElement("a",{onClick:function(){return t.setFormParams("country",N.Y)}},"Add New Country")),this.state.country==N.Y||this.state.state&&this.state.state==N.Y?m.a.createElement(S.a.Item,Object.assign({key:"state_extra",label:"State"},n),a("state_extra",{initialValue:""})(m.a.createElement(M.a,{placeholder:"State"})),m.a.createElement("a",{onClick:function(){return t.setFormParams("state",N.Rb)}},"Choose State")):m.a.createElement(S.a.Item,Object.assign({key:"state"},n,{label:"State"}),a("state",{initialValue:this.state.patientDetails&&this.state.patientDetails.state_data?this.state.patientDetails.state_data.id:""})(m.a.createElement(x.a,{placeholder:"Select State",onChange:function(t){return e.onChangeValue("state",t)},showSearch:!0,optionFilterProp:"children"},this.state.stateList.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)})))),m.a.createElement("a",{onClick:function(){return t.setFormParams("state",N.Y)}},"Add New state")),this.state.country==N.Y||this.state.state==N.Y||this.state.city&&this.state.city==N.Y?m.a.createElement(S.a.Item,Object.assign({key:"city_extra",label:"City"},n),a("city_extra",{initialValue:""})(m.a.createElement(M.a,{placeholder:"City"})),m.a.createElement("a",{onClick:function(){return t.setFormParams("city",N.Rb)}},"Choose City")):m.a.createElement(S.a.Item,Object.assign({key:"City"},n,{label:"City"}),a("city",{initialValue:this.state.patientDetails&&this.state.patientDetails.city_data?this.state.patientDetails.city_data.id:""})(m.a.createElement(x.a,{showSearch:!0,optionFilterProp:"children",placeholder:"Select City"},this.state.cityList.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)})))),m.a.createElement("a",{onClick:function(){return t.setFormParams("city",N.Y)}},"Add New City")),m.a.createElement(S.a.Item,Object.assign({label:"Pincode"},n),a("pincode",{initialValue:this.state.patientDetails?this.state.patientDetails.pincode:""})(m.a.createElement(M.a,{placeholder:"Patient PINCODE"}))),m.a.createElement(S.a.Item,Object.assign({label:"Email"},n),a("email",{initialValue:this.state.patientDetails?this.state.patientDetails.user.email:null})(m.a.createElement(M.a,{placeholder:"Patient Email"}))),m.a.createElement(S.a.Item,Object.assign({label:"Medical History"},n),a("medical_history",{initialValue:this.state.patientDetails?this.state.patientDetails.medical_history:[]})(m.a.createElement(x.a,{placeholder:"Medical History",mode:"multiple"},r.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))),m.a.createElement(S.a.Item,Object.assign({label:"Patient Group"},n),a("patient_group",{initialValue:this.state.patientDetails?this.state.patientDetails.patient_group:[]})(m.a.createElement(x.a,{placeholder:"Patient Group",mode:"multiple"},i.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))),m.a.createElement(S.a.Item,Object.assign({label:"On Dialysis"},n),a("on_dialysis",{initialValue:!!this.state.patientDetails&&this.state.patientDetails.on_dialysis})(m.a.createElement(fe.a,{onChange:function(t){return e.onChangeCheckbox(t)},style:{paddingTop:"4px"}}))),m.a.createElement(S.a.Item,Object.assign({label:"Allow File Upload"},n),a("file_enable",{initialValue:!this.state.patientDetails||this.state.patientDetails.file_enable})(m.a.createElement(fe.a,{style:{paddingTop:"4px"},defaultChecked:!0}))),m.a.createElement(S.a.Item,Object.assign({label:"Max Uploads Allowed"},n),a("file_count",{initialValue:this.state.patientDetails?this.state.patientDetails.file_count:10})(m.a.createElement(C.a,{min:0}))),m.a.createElement(S.a.Item,null,t.props.history?m.a.createElement(P.a,{style:{margin:5},onClick:function(){return t.props.history.goBack()}},"Cancel"):null,m.a.createElement(P.a,{style:{margin:5},type:"primary",htmlType:"submit",loading:this.state.loading},"Save"))))}}]),t}(m.a.Component),Pe=S.a.create()(Oe);function je(e){return isNaN(e)?{validateStatus:"error",errorMsg:"Patient ID can only be numerical value."}:{validateStatus:"success",errorMsg:null}}a(247);var ke=a(248),Ce=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={redirect:!1,appointments:null,practice_doctors:[],procedure_category:null,treatmentNotes:null,practice_staff:[],loading:!1},a.changeRedirect=a.changeRedirect.bind(Object(o.a)(a)),a.editAppointment=a.editAppointment.bind(Object(o.a)(a)),a.deleteAppointment=a.deleteAppointment.bind(Object(o.a)(a)),a.loadProcedureCategory=a.loadProcedureCategory.bind(Object(o.a)(a)),a.loadDoctors=a.loadDoctors.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadDoctors(),this.loadTreatmentNotes(),this.props.match.params.appointmentid?this.loadAppointment(this.props.match.params.appointmentid):this.loadAllAppointments()}},{key:"loadAppointment",value:function(e){var t=this;this.setState({loading:!0});Object(F.c)(Object(F.f)(A.o,[e]),(function(e){t.setState({appointments:[e],loading:!1})}),(function(){t.setState({loading:!1})}))}},{key:"loadAllAppointments",value:function(){var e=this;this.setState({loading:!0});Object(F.c)(Object(F.f)(A.h,[this.props.active_practiceId]),(function(t){e.setState({appointments:t,loading:!1})}),(function(){e.setState({loading:!1})}),this.props.match.params.id?{patient:this.props.match.params.id,practice:this.props.active_practiceId}:{practice:this.props.active_practiceId})}},{key:"loadProcedureCategory",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),(function(t){e.setState({procedure_category:t})}),(function(){}))}},{key:"loadDoctors",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Dc,[this.props.active_practiceId]),(function(t){t.staff.forEach((function(t){if(t.role==N.P){var a=e.state.practice_doctors;a.push(t),e.setState({practice_doctors:a})}else{var n=e.state.practice_staff;n.push(t),e.setState({practice_staff:n})}}))}),(function(){}))}},{key:"loadTreatmentNotes",value:function(){var e=this;Object(F.c)(Object(F.f)(A.kb,[this.props.active_practiceId]),(function(t){e.setState({treatmentNotes:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"editAppointment",value:function(e){var t=e.id;this.props.history.push("/calendar/"+t+"/edit-appointment")}},{key:"deleteAppointment",value:function(e){var t=this;t.setState({loading:!0});Object(F.l)(Object(F.f)(A.o,[e.id]),{is_active:!1,status:"Cancelled"},(function(e){t.loadAllAppointments(),t.setState({loading:!1})}),(function(){t.setState({loading:!1})}))}},{key:"render",value:function(){var e=this,t=this,a=[];this.state.practice_doctors.length&&this.state.practice_doctors.forEach((function(e){a[e.id]=e.user.first_name}));var n=[];this.state.treatmentNotes&&this.state.treatmentNotes.forEach((function(e){n[e.id]=e.name}));var r=[{title:"Schedule Time",key:"name",render:function(e,t){return m.a.createElement("span",null,G()(t.schedule_at).format("LLL"),",",t.slot,"mins")}},{title:"Patient ID",key:"id",render:function(e,t){return m.a.createElement("span",null,t.patient.custom_id?t.patient.custom_id:t.patient.id)},exports:function(e,t){return t.patient.custom_id?t.patient.custom_id:t.patient.id}},{title:"Patient Name",dataIndex:"patient.user.first_name",key:"patient_name"},{title:"Patient Mobile",dataIndex:"patient.user.mobile",key:"patient_mobile",render:function(e){return t.props.activePracticePermissions.PatientPhoneNumber?e:Object(z.b)(e)}},{title:"Email",dataIndex:"patient.user.email",key:"email",render:function(e){return t.props.activePracticePermissions.PatientEmailId?e:Object(z.a)(e)}},{title:"Doctor",key:"doctor",render:function(e,t){return m.a.createElement("span",null," ",a[t.doctor])}},{title:"Procedure",key:"procedure"},{title:"Treatment Notes",key:"notes",render:function(e,t){return m.a.createElement("span",null," ",n[t.notes])}},{title:"Category",key:"category",render:function(e,t){return m.a.createElement("span",null," ",t.category?t.category_data.name:"--")}},{title:"NotifyByEmail",key:"notify_via_email",render:function(e,t){return m.a.createElement(fe.a,{disabled:!0,checked:t.notify_via_email})}},{title:"NotifyBySMS",key:"notify_via_sms",render:function(e,t){return m.a.createElement(fe.a,{disabled:!0,checked:t.notify_via_sms})}},{title:"Action",key:"action",render:function(a,n){return m.a.createElement("span",null,m.a.createElement("a",{onClick:function(){return e.editAppointment(n)},disabled:!t.props.activePracticePermissions.EditAppointment},"Edit"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement(E.a,{title:"Are you sure delete this item?",onConfirm:function(){return e.deleteAppointment(n)},okText:"Yes",cancelText:"No"},m.a.createElement("a",{disabled:!t.props.activePracticePermissions.EditAppointment},"Delete")))}}];S.a.create()(R.a);return this.props.match.params.id?m.a.createElement(k.a,{extra:t.props.activePracticePermissions.AddAppointment||t.props.allowAllPermissions?m.a.createElement(le.b,{to:"/calendar/create-appointment?patient="+this.props.match.params.id},m.a.createElement(P.a,{type:"primary"},m.a.createElement(j.a,{type:"plus"}),"\xa0Add Appointment")):null},m.a.createElement(ke.a,{loading:this.state.loading,columns:r,scroll:{x:1300},pagination:!1,dataSource:this.state.appointments})):m.a.createElement(k.a,{extra:t.props.activePracticePermissions.AddAppointment||t.props.allowAllPermissions?m.a.createElement(le.b,{to:"/calendar/create-appointment"},m.a.createElement(P.a,{type:"primary"},m.a.createElement(j.a,{type:"plus"}),"\xa0Add Appointment")):null},m.a.createElement(ke.a,{loading:this.state.loading,columns:r,scroll:{x:1300},pagination:!1,dataSource:this.state.appointments}))}}]),t}(m.a.Component),Ie=(a(286),a(282)),Se=a(904),xe=u.a.Sider,De=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},a.onHotKeyInner=a.onHotKeyInner.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"onHotKeyInner",value:function(e){switch(e){case"alt+f":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/profile"):this.props.history.push("/patients/profile");case"alt+a":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/appointments"):this.props.history.push("/patients/appointments");case"alt+o":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/communications"):this.props.history.push("/patients/communications");case"alt+k":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/booking"):this.props.history.push("/patients/profile");case"alt+m":case"alt+n":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/emr/vitalsigns"):this.props.history.push("/patients/emr/vitalsigns");case"alt+t":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/emr/plans"):this.props.history.push("/patients/emr/plans");case"alt+l":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/emr/files"):this.props.history.push("/patients/emr/files");case"alt+i":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/billing/invoices"):this.props.history.push("/patients/billing/invoices");case"alt+e":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/billing/return/invoices"):this.props.history.push("/patients/billing/return/invoices");case"alt+y":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/billing/payments"):this.props.history.push("/patients/billing/payments");case"alt+u":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/emr/workdone"):this.props.history.push("/patients/emr/workdone");case"alt+s":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/emr/prescriptions"):this.props.history.push("/patients/emr/prescriptions");case"alt+g":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/billing/ledger"):this.props.history.push("/patients/profile");case"alt+w":return this.props.currentPatient?this.props.history.push("/patient/"+this.props.currentPatient.id+"/emr/timeline"):this.props.history.push("/patients/profile")}}},{key:"render",value:function(){var e=this;return m.a.createElement(Se.a,{keyName:Y.W,onKeyDown:function(t){return e.onHotKeyInner(t)}},m.a.createElement(xe,{trigger:null,collapsible:!0,collapsed:this.props.hideSidePanel,style:{overflow:"auto",minHeight:"calc(100vh - 64px)",background:"#fff"}},m.a.createElement(Ie.a,{mode:"inline"},m.a.createElement(Ie.a.ItemGroup,{key:"g1",title:m.a.createElement(v.a,{style:{margin:"0px"}},"Patient")},m.a.createElement(Ie.a.Item,{key:"17"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/profile":"/patients/profile"},m.a.createElement(j.a,{type:"user"}),m.a.createElement("span",{className:"nav-text"},"Pro",m.a.createElement("span",{className:"shortcutLetterHighlight"},"f"),"ile"))),this.props.activePracticePermissions.PatientAppointments||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"18"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/appointments":"/patients/appointments"},m.a.createElement(j.a,{type:"calendar"}),m.a.createElement("span",{className:"nav-text"},m.a.createElement("span",{className:"shortcutLetterHighlight"},"A"),"ppointments"))):null,this.props.activePracticePermissions.PatientCommunications||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"19"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/communications":"/patients/communications"},m.a.createElement(j.a,{type:"message"}),m.a.createElement("span",{className:"nav-text"},"C",m.a.createElement("span",{className:"shortcutLetterHighlight"},"o"),"mmunications"))):null,this.props.activePracticePermissions.PatientBookings||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"booking",disabled:!this.props.currentPatient},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/booking":"/patients/communications"},m.a.createElement(j.a,{type:"book"}),m.a.createElement("span",{className:"nav-text"},"Boo",m.a.createElement("span",{className:"shortcutLetterHighlight"},"k"),"ing"))):null),m.a.createElement(Ie.a.ItemGroup,{key:"g2",title:m.a.createElement(v.a,{style:{margin:"0px"}},"EMR")},this.props.activePracticePermissions.PatientVitalSigns||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"20"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/vitalsigns":"/patients/emr/vitalsigns"},m.a.createElement(j.a,{type:"heart"}),m.a.createElement("span",{className:"nav-text"},"Report ",m.a.createElement("span",{className:"shortcutLetterHighlight"},"M"),"anual"))):null,this.props.activePracticePermissions.PatientClinicalNotes||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"21"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/clinicnotes":"/patients/emr/clinicnotes"},m.a.createElement(j.a,{type:"solution"}),m.a.createElement("span",{className:"nav-text"},"Clinical ",m.a.createElement("span",{className:"shortcutLetterHighlight"},"N"),"otes"))):null,this.props.activePracticePermissions.PatientTreatmentPlans||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"30"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/plans":"/patients/emr/plans"},m.a.createElement(j.a,{type:"read"}),m.a.createElement("span",{className:"nav-text"},m.a.createElement("span",{className:"shortcutLetterHighlight"},"T"),"reatment Plans"))):null,this.props.activePracticePermissions.PatientCompletedProcedure||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"22"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/workdone":"/patients/emr/workdone"},m.a.createElement(j.a,{type:"check-circle"}),m.a.createElement("span",{className:"nav-text"},"Completed Proced",m.a.createElement("span",{className:"shortcutLetterHighlight"},"u"),"re"))):null,this.props.activePracticePermissions.PatientFiles||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"23"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/files":"/patients/emr/files"},m.a.createElement(j.a,{type:"picture"}),m.a.createElement("span",{className:"nav-text"},"Fi",m.a.createElement("span",{className:"shortcutLetterHighlight"},"l"),"es"))):null,this.props.activePracticePermissions.PatientPrescriptions||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"24"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/prescriptions":"/patients/emr/prescriptions"},m.a.createElement(j.a,{type:"solution"}),m.a.createElement("span",{className:"nav-text"},"Pre",m.a.createElement("span",{className:"shortcutLetterHighlight"},"s"),"criptions"))):null,this.props.activePracticePermissions.PatientTimeline||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"25",disabled:!this.props.currentPatient},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/timeline":"/patients/profile"},m.a.createElement(j.a,{type:"clock-circle"}),m.a.createElement("span",{className:"nav-text"},"Timeline ",m.a.createElement("span",{className:"shortcutLetterHighlight"},"w")))):null,this.props.activePracticePermissions.PatientLabOrders||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"26",disabled:!this.props.currentPatient||!0},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/emr/labtrackings":"/patients/profile"},m.a.createElement(j.a,{type:"solution"}),m.a.createElement("span",{className:"nav-text"},"Lab Orders"))):null),m.a.createElement(Ie.a.ItemGroup,{key:"g3",title:m.a.createElement(v.a,{style:{margin:"0px"}},"Billing")},this.props.activePracticePermissions.PatientInvoices||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"27"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/billing/invoices":"/patients/billing/invoices"},m.a.createElement(j.a,{type:"audit"}),m.a.createElement("span",{className:"nav-text"},m.a.createElement("span",{className:"shortcutLetterHighlight"},"I"),"nvoices"))):null,this.props.activePracticePermissions.PatientReturns||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"31"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/billing/return/invoices":"/patients/billing/return/invoices"},m.a.createElement(j.a,{type:"redo"}),m.a.createElement("span",{className:"nav-text"},"Invoices R",m.a.createElement("span",{className:"shortcutLetterHighlight"},"e"),"turn"))):null,this.props.activePracticePermissions.PatientPayments||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"28"},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/billing/payments":"/patients/billing/payments"},m.a.createElement(j.a,{type:"dollar"}),m.a.createElement("span",{className:"nav-text"},"Pa",m.a.createElement("span",{className:"shortcutLetterHighlight"},"y"),"ments"))):null,this.props.activePracticePermissions.PatientLedger||this.props.allowAllPermissions?m.a.createElement(Ie.a.Item,{key:"29",disabled:!this.props.currentPatient},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/billing/ledger":"/patients/profile"},m.a.createElement(j.a,{type:"book"}),m.a.createElement("span",{className:"nav-text"},"Led",m.a.createElement("span",{className:"shortcutLetterHighlight"},"g"),"er"))):null,this.props.currentPatient&&this.props.currentPatient.is_agent&&(this.props.activePracticePermissions.PatientLedger||this.props.allowAllPermissions)?m.a.createElement(Ie.a.Item,{key:"32",disabled:!this.props.currentPatient},m.a.createElement(le.b,{to:this.props.currentPatient?"/patient/"+this.props.currentPatient.id+"/billing/wallet":"/patients/profile"},m.a.createElement(j.a,{type:"wallet"}),m.a.createElement("span",{className:"nav-text"},"Wallet Ledger"))):null))))}}]),t}(m.a.Component),we=(a(312),a(301)),Te=(a(51),a(1729),a(4)),Me=a.n(Te),Fe=a(50),Ae=a(22);function Le(){return(Le=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Ve(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ne=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]])}return a},Re=function(e){return d.createElement(Ae.a,null,(function(t){var a,n,r=t.getPrefixCls,i=e.prefixCls,l=e.className,c=e.color,o=void 0===c?"":c,s=e.children,u=e.pending,m=e.dot,p=Ne(e,["prefixCls","className","color","children","pending","dot"]),f=r("timeline",i),h=Me()((Ve(a={},"".concat(f,"-item"),!0),Ve(a,"".concat(f,"-item-pending"),u),a),l),b=Me()((Ve(n={},"".concat(f,"-item-head"),!0),Ve(n,"".concat(f,"-item-head-custom"),m),Ve(n,"".concat(f,"-item-head-").concat(o),!0),n));return d.createElement("li",Le({},Object(Fe.default)(p,["position"]),{className:h}),d.createElement("div",{className:"".concat(f,"-item-tail")}),d.createElement("div",{className:b,style:{borderColor:/blue|red|green|gray/.test(o)?void 0:o}},m),d.createElement("div",{className:"".concat(f,"-item-content")},s))}))};Re.defaultProps={color:"blue",pending:!1,position:""};var Be=Re;function ze(e){return(ze="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ye(){return(Ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function qe(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ge(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function We(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function He(e,t){return!t||"object"!==ze(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ke(e,t){return(Ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xe=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]])}return a},Qe=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=He(this,Ue(t).apply(this,arguments))).renderTimeline=function(t){var a,n=t.getPrefixCls,r=e.props,i=r.prefixCls,l=r.pending,c=void 0===l?null:l,o=r.pendingDot,s=r.children,u=r.className,m=r.reverse,p=r.mode,f=Xe(r,["prefixCls","pending","pendingDot","children","className","reverse","mode"]),h=n("timeline",i),b="boolean"===typeof c?null:c,g=Me()(h,(Ge(a={},"".concat(h,"-pending"),!!c),Ge(a,"".concat(h,"-reverse"),!!m),Ge(a,"".concat(h,"-").concat(p),!!p),a),u),y=c?d.createElement(Be,{pending:!!c,dot:o||d.createElement(j.a,{type:"loading"})},b):null,E=m?[y].concat(qe(d.Children.toArray(s).reverse())):[].concat(qe(d.Children.toArray(s)),[y]),v=function(e,t){return"alternate"===p?"right"===e.props.position?"".concat(h,"-item-right"):"left"===e.props.position?"".concat(h,"-item-left"):"".concat(h,t%2===0?"-item-left":"-item-right"):"left"===p?"".concat(h,"-item-left"):"right"===p?"".concat(h,"-item-right"):"right"===e.props.position?"".concat(h,"-item-right"):""},_=E.filter((function(e){return!!e})),O=d.Children.count(_),P="".concat(h,"-item-last"),k=d.Children.map(_,(function(e,t){var a=t===O-2?P:"",n=t===O-1?P:"";return d.cloneElement(e,{className:Me()([e.props.className,!m&&c?a:n,v(e,t)])})}));return d.createElement("ul",Ye({},f,{className:g}),k)},e}var a,n,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ke(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){return d.createElement(Ae.a,null,this.renderTimeline)}}])&&We(a.prototype,n),r&&We(a,r),t}(d.Component);Qe.Item=Be,Qe.defaultProps={reverse:!1,mode:""};var Ze=Qe,Je=(a(139),a(102)),$e=(a(1730),a(1)),et=a(912);function tt(e){return(tt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(){return(at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function nt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function rt(e,t){return!t||"object"!==tt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function it(e){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e,t){return(lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ct=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=rt(this,it(t).apply(this,arguments))).renderSteps=function(t){var a=t.getPrefixCls,n=a("steps",e.props.prefixCls),r=a("",e.props.iconPrefix),i={finish:d.createElement(j.a,{type:"check",className:"".concat(n,"-finish-icon")}),error:d.createElement(j.a,{type:"close",className:"".concat(n,"-error-icon")})};return d.createElement(et.default,at({icons:i},e.props,{prefixCls:n,iconPrefix:r}))},e}var a,n,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lt(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){return d.createElement(Ae.a,null,this.renderSteps)}}])&&nt(a.prototype,n),r&&nt(a,r),t}(d.Component);ct.Step=et.default.Step,ct.defaultProps={current:0},ct.propTypes={prefixCls:$e.string,iconPrefix:$e.string,current:$e.number};var ot=a(53);function st(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ut(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?st(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):st(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}ct.Step;var dt=[{label:m.a.createElement("span",{style:{width:"100%"}},"Appointment"),value:"appointments"},{label:m.a.createElement("span",{style:{width:"100%"}},"Report Manual"),value:"vital_signs"},{label:m.a.createElement("span",{style:{width:"100%"}},"Clinic Notes"),value:"clinic_notes"},{label:m.a.createElement("span",{style:{width:"100%"}},"Treatment Plans"),value:"treatment_plans"},{label:m.a.createElement("span",{style:{width:"100%"}},"Procedures"),value:"procedures"},{label:m.a.createElement("span",{style:{width:"100%"}},"Files"),value:"files"},{label:m.a.createElement("span",{style:{width:"100%"}},"Prescriptions"),value:"prescriptions"},{label:m.a.createElement("span",{style:{width:"100%"}},"Invoices"),value:"invoices"},{label:m.a.createElement("span",{style:{width:"100%"}},"Payments"),value:"payments"}],mt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).changeFilters=function(e){var t=Object(o.a)(a);a.setState({filterParams:e,selectedFiltersIntermediate:!!e.length&&e.length<dt.length,checkAllFilters:e.length===dt.length},(function(){t.loadTimeline()}))},a.onCheckAllFiltersChange=function(e){var t=Object(o.a)(a);a.setState({filterParams:e.target.checked?dt.map((function(e){return e.value})):[],selectedFiltersIntermediate:!1,checkAllFilters:e.target.checked},(function(){t.loadTimeline()}))},a.loadTimeline=function(){var e=Object(o.a)(a),t={practice_id:a.props.active_practiceId};e.setState({loading:!0}),a.state.filterParams.forEach((function(e){t[e]=1}));a.props.showAllClinic&&a.props.match.params.id&&delete t.practice_id,Object(F.c)(Object(F.f)(A.xc,[a.props.match.params.id]),(function(t){var a=G()().add(5,"year");e.setState((function(){var e=[],n={};return t.forEach((function(t){a.format("YMD")!=G()(t.sort_date).format("YMD")&&(a=G()(t.sort_date),e.push({type:"Time",date:t.sort_date})),e.push(t),"Appointments"!=t.type&&(n[t.type]?n[t.type][t.id]=!0:n[t.type]=Object(w.a)({},t.id,!0))})),{timelineData:e,loading:!1,allCheckList:n}}))}),(function(){e.setState({loading:!1})}),t)},a.onCheckAllTimelineCard=function(e){a.setState((function(t){return{checkedTimelineCards:e.target.checked?ut({},t.allCheckList):{},indeterminate:!1,checkAll:e.target.checked}}))},a.toggleTimelineCheckbox=function(e,t,n){a.setState((function(a){var r={},i=a.checkedTimelineCards;if(i[e]?i[e][t]=!!n:i[e]=Object(w.a)({},t,!!n),n){if(r.indeterminate=!0,Object.keys(a.allCheckList).length==Object.keys(i).length){for(var l=Object.keys(a.allCheckList),c=!1,o=0;o<l.length;o++)if(Object.keys(a.allCheckList[l[o]]).length!=Object.keys(i[l[o]]).length){c=!0,r.checkAll=!1;break}c||(r.indeterminate=!1,r.checkAll=!0)}}else r.checkAll=!1,r.indeterminate=!0,delete i[e][t],Object.keys(i[e]).length||(delete i[e],Object.keys(i).length||(r.indeterminate=!1));return r.checkedTimelineCards=i,r}))},a.printCaseSheet=function(){var e=Object(o.a)(a),t=Object(F.o)("Starting print case sheet..."),n={practice:e.props.active_practiceId,timeline:[]};Object.keys(a.state.checkedTimelineCards).forEach((function(t){n.timeline.push({type:t,id:Object.keys(e.state.checkedTimelineCards[t])})}));Object(F.j)(Object(F.f)(A.yc,[a.props.match.params.id]),n,(function(e){Object(F.p)(t,N.Wb,"Fetched report successfully!!"),window.open(ot.a+e.report)}),(function(){Object(F.p)(t,N.S,"Case sheet printing failed!!")}))},a.state={filterParams:["appointments","vital_signs","clinic_notes","treatment_plans","procedures","files","prescriptions","invoices","payments"],checkAllFilters:!0,selectedFiltersIntermediate:!1,timelineData:[],checkedTimelineCards:[]},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadTimeline()}},{key:"render",value:function(){var e=this;console.log("timeline",this.state.timelineData);var t=this;return m.a.createElement(k.a,{title:"Timeline",extra:m.a.createElement(P.a.Group,null,m.a.createElement(P.a,null,"Email Case Sheet"),m.a.createElement(P.a,{type:"primary",onClick:function(){return e.printCaseSheet()}},"Print Case Sheet"))},m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null,m.a.createElement(y.a,{span:4},m.a.createElement(fe.a,{indeterminate:this.state.selectedFiltersIntermediate,onChange:this.onCheckAllFiltersChange,checked:this.state.checkAllFilters},m.a.createElement("b",null,"Select all")),m.a.createElement("br",null),m.a.createElement(fe.a.Group,{size:"large",value:this.state.filterParams,options:dt,onChange:this.changeFilters})),m.a.createElement(y.a,{span:20},m.a.createElement(Je.a,{top:10},m.a.createElement("h4",{style:{textAlign:"right",padding:"5px",backgroundImage:"linear-gradient(to left, white , transparent)"}},m.a.createElement(fe.a,{indeterminate:this.state.indeterminate,onChange:this.onCheckAllTimelineCard,checked:this.state.checkAll},"Select All"))),m.a.createElement(Ze,{progressDot:!0,current:1,direction:"vertical"},this.state.timelineData.map((function(e){return m.a.createElement(Ze.Item,{dot:"Time"==e.type?m.a.createElement(j.a,{type:"clock-circle-o",style:{fontSize:"25px"}}):null},function(e){switch(e.type){case"Clinical Notes":return function(e){return m.a.createElement(k.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(j.a,{type:"solution"})," Clinical Note Added",m.a.createElement(fe.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null),e.chief_complaints?m.a.createElement("p",null,"Chief Complaints",m.a.createElement("ul",null,e.chief_complaints.split(Y.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null,e.observations?m.a.createElement("p",null,"Observations",m.a.createElement("ul",null,e.observations.split(Y.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null,e.investigations?m.a.createElement("p",null,"Investigations",m.a.createElement("ul",null,e.investigations.split(Y.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null,e.diagnosis?m.a.createElement("p",null,"Diagnosis",m.a.createElement("ul",null,e.diagnosis.split(Y.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null,e.notes?m.a.createElement("p",null,"Notes",m.a.createElement("ul",null,e.notes.split(Y.r).map((function(e){return e?m.a.createElement("li",null,e):null})))):null)}(e);case"Appointments":return function(e){return m.a.createElement(k.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(j.a,{type:"calendar"})," Appointment",e.practice_data?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),e.doctor_data?m.a.createElement("p",{style:{borderLeft:"5px solid "+e.doctor_data.calendar_colour,paddingLeft:"5px"}},e.doctor_data.user.first_name):null,G()(e.schedule_at).format("hh:mm A")," to ",G()(e.schedule_at).add(e.slot,"mins").format("HH:mm A"))}(e);case"Files":return function(e){return m.a.createElement(k.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(j.a,{type:"picture"})," File",m.a.createElement(fe.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice_data?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),m.a.createElement("img",{src:Object(F.g)(e.file_type),alt:"",style:{height:100}}))}(e);case"Invoices":return function(e){return m.a.createElement(k.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(j.a,{type:"audit"})," Invoice",m.a.createElement(fe.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice_data?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),e.procedure.map((function(e){return m.a.createElement(g.a,null,e.name)})),e.inventory.map((function(e){return m.a.createElement(g.a,null,e.name)})),m.a.createElement("br",null),m.a.createElement("b",null,e.invoice_id),m.a.createElement("br",null),m.a.createElement("b",null,"Invoice Amount: INR ",e.total),m.a.createElement("br",null),m.a.createElement("b",null,"Paid Amount: INR ",e.payments_data),m.a.createElement("br",null),m.a.createElement("b",null,"Due Amount: INR ",e.total-e.payments_data))}(e);case"Vital Signs":return function(e){var t=[{title:"Time",dataIndex:"created_at",key:"name",render:function(e){return m.a.createElement("span",null,G()(e).format("hh:mm A"))}},{title:"Temp(F)",key:"temperature",render:function(e,t){return m.a.createElement("span",null," ",t.temperature,m.a.createElement("br",null),",",t.temperature_part)}},{title:"Pulse (BPM)",dataIndex:"pulse",key:"pulse"},{title:"RR breaths/min",dataIndex:"resp_rate",key:"resp_rate"},{title:"SYS/DIA mmhg",key:"address",render:function(e,t){return m.a.createElement(m.a.Fragment,null,t.blood_pressure_up?m.a.createElement("span",null," ",t.blood_pressure_up,"/",t.blood_pressure_down,m.a.createElement("br",null),",",t.position):null)}},{title:"WEIGHT kg",dataIndex:"weight",key:"weight"},{title:"Creatinine Level",key:"creatinine",dataIndex:"creatinine"},{title:"Haemoglobin Level",key:"haemoglobin",dataIndex:"haemoglobin"},{title:"Urea Level",key:"urea",dataIndex:"urea"},{title:"Uric Acid Level",key:"uric_acid",dataIndex:"uric_acid"}];return m.a.createElement(k.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(j.a,{type:"heart"})," Report Manual Recorded",m.a.createElement(fe.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice_data?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),e.doctor_data?m.a.createElement("p",{style:{borderLeft:"5px solid "+e.doctor_data.calendar_colour,paddingLeft:"5px"}},e.doctor_data.user.first_name):null,m.a.createElement(ke.a,{columns:t,size:"small",pagination:!1,dataSource:[e]}))}(e);case"Prescriptions":return function(e){return m.a.createElement(k.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(j.a,{type:"solution"})," Prescription Added",m.a.createElement(fe.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null),e.doctor?m.a.createElement("p",{style:{borderLeft:"5px solid "+e.doctor.calendar_colour,paddingLeft:"5px"}},e.doctor.user.first_name):null,e.drugs.map((function(e){return m.a.createElement(g.a,null,e.name)})))}(e);case"Payments":return function(e){return m.a.createElement(k.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,m.a.createElement(j.a,{type:"dollar"})," Payment",m.a.createElement(fe.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice_data?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null),m.a.createElement("b",null,e.payment_id),m.a.createElement("br",null),m.a.createElement("b",null,"Amount Paid: INR ",e.total))}(e);case"Time":return function(e){return m.a.createElement("span",null,m.a.createElement(Je.a,{top:20,offsetTop:30},m.a.createElement("h2",{style:{marginLeft:"10px",padding:"5px",backgroundImage:"linear-gradient(to right, #ddd , white)",borderRadius:"4px"}},G()(e.date).format("LL"))))}(e);case"Procedures":return function(e){return m.a.createElement(k.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,"Procedure Performed",m.a.createElement(fe.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null),e.doctor?m.a.createElement("p",{style:{borderLeft:"5px solid "+e.doctor.calendar_colour,paddingLeft:"5px"}},e.doctor.user.first_name):null,e.treatment_plans.map((function(e){return m.a.createElement(g.a,null,e.procedure.name)})))}(e);case"Treatment Plans":return function(e){return m.a.createElement(k.a,{hoverable:!0,bodyStyle:{backgroundColor:e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id]?"#B5EEFF":"initial"}},m.a.createElement("h2",null,"Treatment Plan ",m.a.createElement(fe.a,{size:"large",style:{float:"right"},checked:!!e.checkedTimelineCards[e.type]&&e.checkedTimelineCards[e.type][e.id],onChange:function(t){return e.toggleTimelineCheckbox(e.type,e.id,t.target.checked)}}),e.practice?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null),e.doctor?m.a.createElement("p",{style:{borderLeft:"5px solid "+e.doctor.calendar_colour,paddingLeft:"5px"}},e.doctor.user.first_name):null,e.treatment_plans.map((function(e){return m.a.createElement(g.a,null,e.procedure.name)})))}(e);default:return e.type}}(ut({},e,{checkedTimelineCards:t.state.checkedTimelineCards,toggleTimelineCheckbox:t.toggleTimelineCheckbox})))})))))))}}]),t}(m.a.Component);a(289);var pt=a(288),ft=a(742),ht=a.n(ft);var bt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){!function(e,t){if(!document.head.querySelector("#"+e)){var a=document.createElement("style");a.textContent=t,a.type="text/css",a.id=e,document.head.appendChild(a)}}(this.props.name,this.props.css)},t.prototype.componentWillUnmount=function(){var e=document.getElementById(this.props.name);e.parentNode.removeChild(e)},t.prototype.render=function(){return null},t}(d.Component),gt=function(e){var t=e.imageBackgroundColor;return"\n  body {\n    overflow: hidden;\n  }\n\n  .__react_modal_image__modal_container {\n    position: fixed;\n    z-index: 1000;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.8);\n    touch-action: none;\n    overflow: hidden;\n  }\n\n  .__react_modal_image__modal_content {\n    position: relative;\n    height: 100%;\n    width: 100%;\n  }\n\n  .__react_modal_image__modal_content img, \n  .__react_modal_image__modal_content svg {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate3d(-50%, -50%, 0);\n    -webkit-transform: translate3d(-50%, -50%, 0);\n    -ms-transform: translate3d(-50%, -50%, 0);\n    overflow: hidden;\n  }\n\n  .__react_modal_image__medium_img {\n    max-width: 98%;\n    max-height: 98%;\n    background-color: "+t+";\n  }\n\n  .__react_modal_image__large_img {\n    cursor: move;\n    background-color: "+t+"\n  }\n\n  .__react_modal_image__icon_menu a {\n    display: inline-block;\n    font-size: 40px;\n    cursor: pointer;\n    line-height: 40px;\n    box-sizing: border-box;\n    border: none;\n    padding: 0px 5px 0px 5px;\n    margin-left: 10px;\n    color: white;\n    background-color: rgba(0, 0, 0, 0);\n  }\n\n  .__react_modal_image__icon_menu {\n    display: inline-block;\n    float: right;\n  }\n\n  .__react_modal_image__caption {\n    display: inline-block;\n    color: white;\n    font-size: 120%;\n    padding: 10px;\n    margin: 0;\n  }\n\n  .__react_modal_image__header {\n    position: absolute;\n    top: 0;\n    width: 100%;\n    background-color: rgba(0, 0, 0, 0.7);\n    overflow: hidden;\n  }\n"},yt=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),m.a.createElement("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"}))},Et=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),m.a.createElement("path",{d:"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"}))},vt=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),m.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))},_t=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),m.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))},Ot=function(){return m.a.createElement("svg",{fill:"#ffffff",height:"48",viewBox:"0 0 24 24",width:"48",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5l-4-4V4h8v3.5l-4 4z"}),m.a.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}))},Pt=function(){return m.a.createElement("svg",{fill:"#ffffff",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0zm0 0h24v24H0V0z"}),m.a.createElement("path",{d:"M7.47 21.49C4.2 19.93 1.86 16.76 1.5 13H0c.51 6.16 5.66 11 11.95 11 .23 0 .44-.02.66-.03L8.8 20.15l-1.33 1.34zM12.05 0c-.23 0-.44.02-.66.04l3.81 3.81 1.33-1.33C19.8 4.07 22.14 7.24 22.5 11H24c-.51-6.16-5.66-11-11.95-11zM16 14h2V8c0-1.11-.9-2-2-2h-6v2h6v6zm-8 2V4H6v2H4v2h2v8c0 1.1.89 2 2 2h8v2h2v-2h2v-2H8z"}))},jt=function(e){var t=e.image,a=e.alt,n=e.zoomed,r=e.toggleZoom,i=e.toggleRotate,l=e.onClose,c=e.enableDownload,o=e.enableZoom,s=e.enableRotate;return m.a.createElement("div",{className:"__react_modal_image__header"},m.a.createElement("span",{className:"__react_modal_image__icon_menu"},c&&m.a.createElement("a",{href:t,download:!0},m.a.createElement(vt,null)),o&&m.a.createElement("a",{onClick:r},n?m.a.createElement(Et,null):m.a.createElement(yt,null)),s&&m.a.createElement("a",{onClick:i},m.a.createElement(Pt,null)),m.a.createElement("a",{onClick:l},m.a.createElement(_t,null))),a&&m.a.createElement("span",{className:"__react_modal_image__caption"},a))};function kt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var Ct=function(e){function t(){var a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,i=Array(r),l=0;l<r;l++)i[l]=arguments[l];return a=n=kt(this,e.call.apply(e,[this].concat(i))),n.state={loading:!0},n.handleOnLoad=function(){n.setState({loading:!1})},n.handleOnContextMenu=function(e){!n.props.contextMenu&&e.preventDefault()},kt(n,a)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=e.id,a=e.className,n=e.src,r=e.style,i=e.handleDoubleClick;return m.a.createElement("div",null,this.state.loading&&m.a.createElement(Ot,null),m.a.createElement("img",{id:t,className:a,src:n,style:r,onLoad:this.handleOnLoad,onDoubleClick:i,onContextMenu:this.handleOnContextMenu}))},t}(d.Component);function It(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var St=function(e){function t(){var a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,i=Array(r),l=0;l<r;l++)i[l]=arguments[l];return a=n=It(this,e.call.apply(e,[this].concat(i))),n.state={move:{x:0,y:0},moveStart:void 0,zoomed:!1,rotationDeg:0},n.handleKeyDown=function(e){27!==e.keyCode&&13!==e.keyCode||n.props.onClose()},n.getCoordinatesIfOverImg=function(e){var t=e.changedTouches?e.changedTouches[0]:e;if("react-modal-image-img"===t.target.id){var a=n.contentEl.getBoundingClientRect();return{x:t.clientX-a.left,y:t.clientY-a.top}}},n.handleMouseDownOrTouchStart=function(e){if(e.preventDefault(),!(e.touches&&e.touches.length>1)){var t=n.getCoordinatesIfOverImg(e);t||n.props.onClose(),n.state.zoomed&&n.setState((function(e){return{moveStart:{x:t.x-e.move.x,y:t.y-e.move.y}}}))}},n.handleMouseMoveOrTouchMove=function(e){if(e.preventDefault(),n.state.zoomed&&n.state.moveStart&&!(e.touches&&e.touches.length>1)){var t=n.getCoordinatesIfOverImg(e);t&&n.setState((function(e){return{move:{x:t.x-e.moveStart.x,y:t.y-e.moveStart.y}}}))}},n.handleMouseUpOrTouchEnd=function(e){n.setState({moveStart:void 0})},n.toggleZoom=function(e){e.preventDefault(),n.setState((function(e){return{zoomed:!e.zoomed,move:e.zoomed?{x:0,y:0}:e.move}}))},n.toggleRotate=function(e){e.preventDefault(),360!==n.state.rotationDeg?n.setState((function(e){return{rotationDeg:e.rotationDeg+=90}})):n.setState({rotationDeg:90})},It(n,a)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){document.addEventListener("keydown",this.handleKeyDown,!1)},t.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this.handleKeyDown,!1)},t.prototype.render=function(){var e=this,t=this.props,a=t.medium,n=t.large,r=t.alt,i=t.onClose,l=t.hideDownload,c=t.hideZoom,o=t.showRotate,s=t.imageBackgroundColor,u=void 0===s?"black":s,d=this.state,p=d.move,f=d.zoomed,h=d.rotationDeg;return m.a.createElement("div",null,m.a.createElement(bt,{name:"__react_modal_image__lightbox",css:gt({imageBackgroundColor:u})}),m.a.createElement("div",{className:"__react_modal_image__modal_container"},m.a.createElement("div",{className:"__react_modal_image__modal_content",onMouseDown:this.handleMouseDownOrTouchStart,onMouseUp:this.handleMouseUpOrTouchEnd,onMouseMove:this.handleMouseMoveOrTouchMove,onTouchStart:this.handleMouseDownOrTouchStart,onTouchEnd:this.handleMouseUpOrTouchEnd,onTouchMove:this.handleMouseMoveOrTouchMove,ref:function(t){e.contentEl=t}},f&&m.a.createElement(Ct,{id:"react-modal-image-img",className:"__react_modal_image__large_img",src:n||a,style:{transform:"translate3d(-50%, -50%, 0) translate3d("+p.x+"px, "+p.y+"px, 0) rotate("+h+"deg)",WebkitTransform:"translate3d(-50%, -50%, 0) translate3d("+p.x+"px, "+p.y+"px, 0) rotate("+h+"deg)",MsTransform:"translate3d(-50%, -50%, 0) translate3d("+p.x+"px, "+p.y+"px, 0) rotate("+h+"deg)"},handleDoubleClick:this.toggleZoom}),!f&&m.a.createElement(Ct,{id:"react-modal-image-img",className:"__react_modal_image__medium_img",src:a||n,handleDoubleClick:this.toggleZoom,contextMenu:!a,style:{transform:"translate3d(-50%, -50%, 0) rotate("+h+"deg)",WebkitTransform:"translate3d(-50%, -50%, 0) rotate("+h+"deg)",MsTransform:"translate3d(-50%, -50%, 0) rotate("+h+"deg)"}})),m.a.createElement(jt,{image:n||a,alt:r,zoomed:f,toggleZoom:this.toggleZoom,toggleRotate:this.toggleRotate,onClose:i,enableDownload:!l,enableZoom:!c,enableRotate:!!o})))},t}(d.Component);function xt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var Dt=function(e){function t(){var a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,i=Array(r),l=0;l<r;l++)i[l]=arguments[l];return a=n=xt(this,e.call.apply(e,[this].concat(i))),n.state={modalOpen:!1},n.toggleModal=function(){n.setState((function(e){return{modalOpen:!e.modalOpen}}))},xt(n,a)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=e.className,a=e.small,n=e.smallSrcSet,r=e.medium,i=e.large,l=e.alt,c=e.hideDownload,o=e.hideZoom,s=e.showRotate,u=e.imageBackgroundColor,d=this.state.modalOpen;return m.a.createElement("div",null,m.a.createElement("img",{className:t,style:{cursor:"pointer",maxWidth:"100%",maxHeight:"100%"},onClick:this.toggleModal,src:a,srcSet:n,alt:l}),d&&m.a.createElement(St,{medium:r,large:i,alt:l,onClose:this.toggleModal,hideDownload:c,hideZoom:o,showRotate:s,imageBackgroundColor:u}))},t}(d.Component);function wt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Tt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?wt(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):wt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Mt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadMailedFiles=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(o.a)(a),n=function(e){t.setState((function(t){return 1==e.current?{files:Object(D.a)(e.results),total:e.count,loadMoreFiles:e.next,loading:!1}:{files:[].concat(Object(D.a)(t.files),Object(D.a)(e.results)),loadMoreFiles:e.next,loading:!1}}))},r=function(){},i={mailed:!0,page:e,practice:a.props.active_practiceId};a.props.currentPatient&&(i.patient=a.props.currentPatient.id),a.props.showAllClinic&&a.props.currentPatient&&delete i.practice,Object(F.c)(A.sc,n,r,i)},a.filterTags=function(e){var t=Object(o.a)(a);a.setState({filterSearchTag:e.target.value},(function(){t.loadData()}))},a.showModal=function(e){a.setState((function(){return{visible:!0,filesData:Tt({},e)}}))},a.handleCancel=function(){a.setState({visible:!1})},a.togglePDFModal=function(e){a.setState({showPDFFile:e})},a.state={files:[],tags:[],showAddModal:!1,loading:!0,selectedFiles:{},selectedTags:{},filterSearchTag:null,showAddMedicalModel:!1,medicalCertificate:[],visible:!1,filesData:{},mailedfiles:[]},a.loadData=a.loadData.bind(Object(o.a)(a)),a.loadMedicalCertificate=a.loadMedicalCertificate.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){this.loadData(),this.loadMedicalCertificate()}},{key:"loadData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;this.setState({loading:!0});var a=function(e){t.setState((function(t){var a=null;if(1==e.current)return{files:e.results.map((function(e){return G()(e.created_at).format("YYYYMMDD")!=G()(a).format("YYYYMMDD")?(a=G()(e.created_at),Tt({},e,{newDate:!0})):Tt({},e,{newDate:!1})})),total:e.count,loadMoreFiles:e.next,loading:!1};var n=e.results.map((function(e){return G()(e.created_at).format("YYYYMMDD")!=G()(a).format("YYYYMMDD")?(a=G()(e.created_at),Tt({},e,{newDate:!0})):Tt({},e,{newDate:!1})}));return{files:[].concat(Object(D.a)(t.files),Object(D.a)(n)),loadMoreFiles:e.next,loading:!1}}))},n=function(){t.setState({loading:!1})},r={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(r.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete r.practice,this.state.filterSearchTag?r.tag=this.state.filterSearchTag:""==this.state.filterSearchTag&&(r.notag=!0),Object(F.c)(A.pc,a,n,r)}},{key:"loadTags",value:function(){var e=this;Object(F.c)(Object(F.f)(A.fb,[this.props.active_practiceId]),(function(t){e.setState({tags:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"loadMedicalCertificate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;t.setState({loading:!0});var a=function(e){1==e.current?t.setState({total:e.count,medicalCertificate:e.results,loading:!1,loadMoreCertificate:e.next}):t.setState((function(t){return{total:e.count,medicalCertificate:[].concat(Object(D.a)(t.medicalCertificate),Object(D.a)(e.results)),loading:!1,loadMoreCertificate:e.next}}))},n=function(){t.setState({loading:!1})};this.props.currentPatient&&Object(F.c)(Object(F.f)(A.Sb,[this.props.active_practiceId,this.props.currentPatient.id,e]),a,n),this.props.showAllClinic&&this.props.currentPatient?Object(F.c)(Object(F.f)(A.i,[this.props.currentPatient.id,e]),a,n):Object(F.c)(Object(F.f)(A.i,[this.props.active_practiceId,e]),a,n)}},{key:"triggerAddModal",value:function(e){this.setState({showAddModal:!!e})}},{key:"triggerAddMedicalCertificateModal",value:function(e){this.setState({showAddMedicalModel:!!e})}},{key:"filesCompleteToggle",value:function(e,t){this.setState((function(a){var n=Tt({},a.selectedFiles);return t?n[e]=!!t:delete n[e],{selectedFiles:Tt({},n)}}))}},{key:"tagsCompleteToggle",value:function(e,t){this.setState((function(a){var n=Tt({},a.selectedTags);return t?n[e]=!!t:delete n[e],{selectedTags:Tt({},n)}}))}},{key:"filesWithTags",value:function(){var e=this,t={id:Object.keys(this.state.selectedFiles),file_tags:Object.keys(this.state.selectedTags),patient:this.props.match.params.id};Object(F.j)(Object(F.f)(A.pc,[this.props.match.params.id]),t,(function(){e.setState({selectedFiles:{}}),e.loadData()}),(function(){}))}},{key:"deleteMedicalCertificate",value:function(e){var t=this,a={is_active:!1,patient:e.patient,id:e.id};Object(F.j)(Object(F.f)(A.Sb,[t.props.active_practiceId]),a,(function(e){t.loadData(),t.loadMedicalCertificate()}),(function(){}))}},{key:"deleteFile",value:function(e){var t=this,a={id:e.id,patient:e.patient,is_active:!1};Object(F.j)(Object(F.f)(A.pc,[this.props.match.params.id]),a,(function(e){t.setState({showPDFFile:!1}),t.loadData()}),(function(){Object(F.a)(N.S,"Please Select Patient.")}))}},{key:"loadPDF",value:function(e){Object(F.c)(Object(F.f)(A.Tb,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=ce.Form.create()(R.a),n=[{key:"file_type",label:"File",type:N.Tb,required:!0},{key:"file_tags",label:"Tags",type:N.ob,options:this.state.tags.map((function(e){return{label:e.name,value:e.id}}))}],r={method:"post",successFn:function(){t.triggerAddModal(!1),t.loadData()},errorFn:function(){},action:Object(F.f)(A.pc,[this.props.match.params.id])},i=m.a.createElement("div",{style:{boxShadow:"0 2px 4px #111",border:"1px solid #bbb",borderRadius:2,paddingBottom:"30px",backgroundColor:"white"}},m.a.createElement("ul",{style:{listStyle:"none",paddingInlineStart:0,paddingTop:10}},this.state.tags?m.a.createElement("div",null,this.state.tags.map((function(e){return m.a.createElement("li",{key:e.id},m.a.createElement(fe.a,{value:e.id,onChange:function(a){return t.tagsCompleteToggle(e.id,a.target.checked)},checked:t.state.selectedTags[e.id]},e.name," "))}))):null),m.a.createElement("span",null,m.a.createElement(P.a,{type:"primary",onClick:function(){return e.filesWithTags()},style:{float:"right",borderStyle:"none"}},"Done"))),l=[{key:"is_active",value:!0},{key:"patient",value:this.props.currentPatient?this.props.currentPatient.id:null},{key:"practice",value:this.props.active_practiceId}];return m.a.createElement(k.a,{title:"Files",extra:this.props.match.params.id?m.a.createElement(P.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/create-medicalCertificate"},m.a.createElement(P.a,{type:"primary"},m.a.createElement(j.a,{type:"plus"}),"\xa0Add Medical Certificate")," "),m.a.createElement(pt.a,{overlay:i,trigger:["click"],placement:"bottomLeft"},m.a.createElement(P.a,null,m.a.createElement(j.a,{type:"plus"}),"AddFile/remove")),m.a.createElement(P.a,{onClick:function(){return e.triggerAddModal(!0)}},m.a.createElement(j.a,{type:"plus"}),"Add")):m.a.createElement(P.a.Group,null,m.a.createElement(P.a,{type:"primary",style:{marginRight:"10px"},onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(j.a,{type:"plus"}),"\xa0 Add Medical Certificate"),m.a.createElement(P.a,{type:"primary",style:{marginRight:"10px"},onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(j.a,{type:"plus"})," \xa0 AddFile/remove"),m.a.createElement(P.a,{type:"primary",style:{marginRight:"10px"},onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(j.a,{type:"plus"})," \xa0 Add"))},m.a.createElement(f.a,{gutter:8},m.a.createElement(y.a,{span:6,style:{height:"calc(100vh - 55px)",overflow:"auto",paddingRight:"10px",borderRight:"1px solid #ccc"}},m.a.createElement(I.a.Group,{buttonStyle:"solid",defaultValue:"all",onChange:this.filterTags},m.a.createElement("h2",null,"Uploaded Files"),m.a.createElement(I.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:null},"All Files"),this.state.tags.map((function(e){return m.a.createElement(I.a.Button,{key:e.id,style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:e.id},e.name)})),m.a.createElement(I.a.Button,{style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:""},"Untagged Files"),m.a.createElement("p",null,m.a.createElement("br",null))),m.a.createElement(I.a.Group,{buttonStyle:"solid",defaultValue:""},m.a.createElement("h2",null,"Generated Files"),m.a.createElement(I.a.Button,{key:"0",style:{width:"100%",backgroundColor:"transparent",border:"0px"},value:"a",onClick:function(){return e.loadMailedFiles()}},"Emailed Files"),m.a.createElement(I.a.Button,{key:"1",style:{width:"100%",backgroundColor:"transparent",border:"0px"},onClick:function(){return e.loadMedicalCertificate()}},"Medical Leave Certificate "))),m.a.createElement(y.a,{span:18},m.a.createElement(f.a,null,this.state.files.map((function(a){return m.a.createElement(m.a.Fragment,null,a.newDate?m.a.createElement(y.a,{span:24},m.a.createElement(Je.a,{top:20,offsetTop:30},m.a.createElement("h2",{style:{marginLeft:"10px",padding:"5px",backgroundImage:"linear-gradient(to right, #ddd , white)",borderRadius:"4px"}},G()(a.created_at).format("LL")))):null,m.a.createElement(y.a,{span:8},m.a.createElement("div",{style:{width:"100%",height:"150px",border:"1px solid #bbb",backgroundSize:"cover",padding:"auto",overflow:"hidden"}},m.a.createElement(fe.a,{key:a.id,disabled:a.practice!=e.props.active_practiceId,style:{margin:10,position:"absolute",top:5,left:5,boxShadow:"0 0px 5px #000 "},onChange:function(e){return t.filesCompleteToggle(a.id,e.target.checked)},checked:t.state.selectedFiles[a.id]}),Object(F.b)(a.file_type)==Y.rb?m.a.createElement("div",{style:{textAlign:"center",paddingTop:30,height:"100%"},onClick:function(){return e.togglePDFModal(a)}},m.a.createElement(j.a,{type:"file-pdf",style:{fontSize:"56px",color:"#08c"}}),m.a.createElement("h4",null,"Preview Not Avaialable")):m.a.createElement(Dt,{style:{border:"3px solid red"},large:Object(F.g)(a.file_type),small:Object(F.g)(a.file_type),alt:m.a.createElement(P.a,{type:"danger",onClick:function(){return e.deleteFile(a)}},m.a.createElement(j.a,{type:"delete"}))})),m.a.createElement(k.a,{bodyStyle:{padding:3},style:{marginBottom:15}},m.a.createElement(le.b,{to:"/patient/"+a.patient_data.id+"/emr/files/"},m.a.createElement("h4",null,m.a.createElement("b",null,a.patient_data.user.first_name,"\xa0(",a.patient_data.custom_id,")"))),m.a.createElement(g.a,null,m.a.createElement("b",null,a.practice_data?a.practice_data.name:"--")))))}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:24},m.a.createElement(L.a,{loaderFunction:function(){return e.loadData(t.state.loadMoreFiles)},loading:this.state.loading,hidden:!this.state.loadMoreFiles}))),m.a.createElement(k.a,{title:"Medical Certificate"},m.a.createElement(b.a,{loading:this.state.loading,grid:{gutter:16,column:3},dataSource:this.state.medicalCertificate,renderItem:function(t){return m.a.createElement(k.a,{style:{width:600},actions:[m.a.createElement("p",null,"Issued on : "+t.date),m.a.createElement("a",{onClick:function(){return e.loadPDF(t.id)}},m.a.createElement(j.a,{type:"printer"})),m.a.createElement(E.a,{title:"Are you sure delete this item?",onConfirm:function(){return e.deleteMedicalCertificate(t)},okText:"Yes",cancelText:"No"},m.a.createElement(j.a,{type:"delete"}))]},m.a.createElement(ht.a,{title:"Medical Leave #"+t.id,description:"Excused From :"+t.excused_duty_from+" till "+t.excused_duty_to}))}}),m.a.createElement(L.a,{loaderFunction:function(){return e.loadData(t.state.loadMoreCertificate)},loading:this.state.loading,hidden:!this.state.loadMoreCertificate})))),m.a.createElement(h.a,{visible:this.state.showAddModal,onCancel:function(){return e.triggerAddModal(!1)},footer:null},m.a.createElement(a,{title:"Add Files",fields:n,defaultValues:l,formProp:r})),m.a.createElement(h.a,{visible:this.state.showPDFFile,key:this.state.showPDFFile,centered:!0,width:1e3,onCancel:function(){return e.togglePDFModal(!1)},footer:null,style:{padding:0},title:m.a.createElement("h4",null,m.a.createElement("span",{style:{color:"red",textAlign:"right"},onClick:function(){return e.deleteFile(e.state.showPDFFile)}},"DELETE"))},this.state.showPDFFile?m.a.createElement("iframe",{src:Object(F.g)(this.state.showPDFFile.file_type),frameborder:"0",style:{width:"100%",minHeight:"80vh"}}):null))}}]),t}(m.a.Component),Ft=(m.a.Component,a(292),a(294));function At(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Lt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?At(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):At(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Vt=Ft.a.TabPane,Nt=["Complaints","Observations","Diagnoses","Investigations","Notes","Recent Medication"],Rt={Complaints:A.db,Observations:A.ib,Diagnoses:A.eb,Investigations:A.gb,Notes:A.kb,"Recent Medication":A.hb},Bt=0,zt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).setInitialData=function(){var e=Object(o.a)(a),t=a.state.editClinicNotes;t.chief_complaints&&t.chief_complaints.split(Y.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Complaints",t)}),500)})),t.investigations&&t.investigations.split(Y.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Investigations",t)}),500)})),t.diagnosis&&t.diagnosis.split(Y.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Diagnoses",t)}),500)})),t.notes&&t.notes.split(Y.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Notes",t)}),500)})),t.observations&&t.observations.split(Y.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Observations",t)}),500)})),t.medication&&t.medication.split(Y.r).forEach((function(t){return setTimeout((function(){t.length&&e.addValues("Recent Medication",t)}),500)}))},a.loadRequiredResources=function(e,t){var n=Object(o.a)(a);Object(F.c)(e,(function(e){n.setState((function(a){var n=Lt({},a.resourceList,Object(w.a)({},t,e));return{resourceList:n,filteredResourceList:n,filterStrings:{}}}))}),(function(){console.log(t+" fetching error")}))},a.add=function(e){var t=a.props.form,n=t.getFieldValue(e).concat(++Bt);t.setFieldsValue(Object(w.a)({},e,n))},a.remove=function(e,t){var n=a.props.form,r=n.getFieldValue(e);1!==r.length&&n.setFieldsValue(Object(w.a)({},e,r.filter((function(e){return e!==t}))))},a.addValues=function(e,t){var n,r=a.props.form,i=r.getFieldValue(e),l=i.concat(++Bt);r.setFieldsValue((n={},Object(w.a)(n,e,l),Object(w.a)(n,"field[".concat(i[i.length-1],"]"),t),n))},a.changeValues=function(e,t){var n=a.props.form.getFieldValue(e);n.indexOf(t)==n.length-1&&a.add(e)},a.toggleModal=function(e){var t=null,n=Object(o.a)(a);a.setState((function(a){return console.log(a.resourceAddModal),a.resourceAddModal&&(t=a.resourceAddModal),{resourceAddModal:e}}),(function(){t&&n.loadRequiredResources(Object(F.f)(Rt[t],[n.props.active_practiceId]),t)}))},a.searchValues=function(e,t){var n=Object(o.a)(a);a.setState((function(a){var n=Lt({},a.searchStrings);return n[e]=t,{searchStrings:n}}),(function(){n.filterValues(e)}))},a.filterValues=function(e){a.setState((function(t){var a=[];return t.resourceList[e]&&(t.searchStrings[e]?t.resourceList[e].forEach((function(n){n.name&&n.name.toString().toLowerCase().includes(t.searchStrings[e].toLowerCase())&&a.push(n)})):a=t.resourceList[e]),{filteredResourceList:Lt({},t.filteredResourceList,Object(w.a)({},e,a))}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFieldsAndScroll((function(e,n){if(!e){var r={};r.chief_complaints=n.Complaints.map((function(e){return n.field[e]})).join(Y.r),r.investigations=n.Investigations.map((function(e){return n.field[e]})).join(Y.r),r.diagnosis=n.Diagnoses.map((function(e){return n.field[e]})).join(Y.r),r.notes=n.Notes.map((function(e){return n.field[e]})).join(Y.r),r.observations=n.Observations.map((function(e){return n.field[e]})).join(Y.r),r.medication=n["Recent Medication"].map((function(e){return n.field[e]})).join(Y.r),r.patient=t.props.match.params.id,r.practice=t.props.active_practiceId,r.doctor=t.state.selectedDoctor&&t.state.selectedDoctor.id?t.state.selectedDoctor.id:t.state.selectedDoctor,r.date=t.state.selectedDate&&G()(t.state.selectedDate).isValid()?G()(t.state.selectedDate).format("YYYY-MM-DD"):null,t.state.editClinicNotes&&(r.id=t.state.editClinicNotes.id);Object(F.j)(Object(F.f)(A.nc,[a.props.match.params.id]),r,(function(e){t.props.loadData&&t.props.loadData(),t.props.history.push("/patient/"+t.props.match.params.id+"/emr/clinicnotes/")}),(function(){}))}}))},a.changeTab=function(e,t){},a.selectDoctor=function(e){a.setState({selectedDoctor:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.state={resourceList:{},filteredResourceList:{},filterStrings:{},practiceDoctors:[],selectedDoctor:{},selectedDate:G()(),resourceAddModal:null,selectedTab:"Complaints",editClinicNotes:a.props.editClinicNotes?a.props.editClinicNotes:null},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){Object(de.d)(this),this.loadRequiredResources(Object(F.f)(A.db,[this.props.active_practiceId]),"Complaints"),this.loadRequiredResources(Object(F.f)(A.ib,[this.props.active_practiceId]),"Observations"),this.loadRequiredResources(Object(F.f)(A.eb,[this.props.active_practiceId]),"Diagnoses"),this.loadRequiredResources(Object(F.f)(A.gb,[this.props.active_practiceId]),"Investigations"),this.loadRequiredResources(Object(F.f)(A.kb,[this.props.active_practiceId]),"Notes"),this.loadRequiredResources(Object(F.f)(A.hb,[this.props.active_practiceId]),"Recent Medication"),this.state.editClinicNotes&&this.setInitialData()}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,n=a.getFieldDecorator,r=a.getFieldValue,i={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},l={};Nt.forEach((function(e){n(e,{initialValue:[++Bt]}),l[e]=r(e)}));var c=l,o=S.a.create()(R.a);return m.a.createElement(k.a,null,m.a.createElement(f.a,null,m.a.createElement(y.a,{span:18},m.a.createElement("h2",null,"Clinical Notes"),m.a.createElement(S.a,{onSubmit:this.handleSubmit},Nt.map((function(a){return m.a.createElement("div",null,m.a.createElement(v.a,{style:{margin:5}},a),m.a.createElement("div",{style:{backgroundColor:a==t.state.selectedTab?"#ddd":"initial",padding:10}},c[a].map((function(r,l){return m.a.createElement(S.a.Item,Object.assign({},i,{label:a+" "+(l+1),key:r}),n("field[".concat(r,"]"),{validateTrigger:["onChange","onBlur"],rules:[{whitespace:!0}]})(m.a.createElement(M.a,{placeholder:a,style:{width:"60%",marginRight:8},key:r,onFocus:function(e){return t.changeTab(e,a)},onChange:function(){return t.changeValues(a,r)}})),c[a].length-1!=l?m.a.createElement(P.a,{shape:"circle",type:"danger",size:"small",icon:"delete",onClick:function(){return e.remove(a,r)}}):null)}))))})),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(k.a,null,m.a.createElement(f.a,null,m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(pt.a,{placement:"topCenter",overlay:m.a.createElement(Ie.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Ie.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(T.a,{value:this.state.selectedDate,allowClear:!1,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY"}),m.a.createElement(P.a,{type:"primary",htmlType:"submit",style:{float:"right",margin:5}},"Save"),t.props.history?m.a.createElement(P.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null),m.a.createElement(f.a,null,"Next Follow up"))))),m.a.createElement(y.a,{span:6},m.a.createElement(Ft.a,{type:"card"},Nt.map((function(a){return m.a.createElement(Vt,{tab:a,key:a},m.a.createElement("div",{style:{padding:5}},m.a.createElement(P.a,{type:"primary",block:!0,size:"small",onClick:function(){return t.toggleModal(a)}},m.a.createElement(j.a,{type:"plus"}),"Add\xa0",a),m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(M.a.Search,{placeholder:"Search in "+a+" ...",onChange:function(t){return e.searchValues(a,t.target.value)}})),m.a.createElement(b.a,{key:a,size:"small",dataSource:t.state.filteredResourceList[a],renderItem:function(t){return m.a.createElement(b.a.Item,{key:t.id,onClick:function(){return e.addValues(a,t.name)}},t.name)}})))})))),m.a.createElement(h.a,{visible:!!this.state.resourceAddModal,onCancel:function(){return t.toggleModal(null)},title:"Add "+this.state.resourceAddModal,footer:null},this.state.resourceAddModal?m.a.createElement(o,{fields:[{label:this.state.resourceAddModal,required:!0,type:N.Y,key:"name"}],defaultValues:[{key:"practice",value:this.props.active_practiceId}],formProp:{method:"post",action:Object(F.f)(Rt[this.state.resourceAddModal],[this.props.active_practiceId]),successFn:function(){t.toggleModal(null),Object(F.a)(N.Wb,t.state.resourceAddModal+" added successfully!!")},errorFn:function(e){console.log(e)}}}):null)))}}]),t}(m.a.Component),Yt=S.a.create()(zt),qt=ce.Modal.confirm,Gt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,clinicNotes:[],editClinicNotes:null,loading:!0},a.loadClinicNotes=a.loadClinicNotes.bind(Object(o.a)(a)),a.editClinicNotesData=a.editClinicNotesData.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadClinicNotes()}},{key:"loadClinicNotes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=function(e){t.setState((function(t){return 1==e.current?{clinicNotes:Object(D.a)(e.results),next:e.next,loading:!1}:{clinicNotes:[].concat(Object(D.a)(t.clinicNotes),Object(D.a)(e.results)),next:e.next,loading:!1}}))},n=function(){t.setState({loading:!1})},r={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(r.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete r.practice,Object(F.c)(A.nc,a,n,r)}},{key:"editClinicNotesData",value:function(e){this.setState({editClinicNotes:e,loading:!1});var t=this.props.match.params.id;this.props.history.push("/patient/"+t+"/emr/clinicnotes/edit")}},{key:"deleteClinicNote",value:function(e){var t=this;qt({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a={id:e.id,patient:e.patient,is_active:!1};Object(F.j)(Object(F.f)(A.nc,[t.props.match.params.id]),a,(function(e){t.loadClinicNotes()}),(function(){}))},onCancel:function(){console.log("Cancel")}})}},{key:"loadPDF",value:function(e){Object(F.c)(Object(F.f)(A.R,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this;return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/clinicnotes/add",render:function(t){return m.a.createElement(Yt,Object.assign({},t,e.props,{loadData:e.loadClinicNotes}))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/clinicnotes/edit",render:function(a){return e.state.editClinicNotes?m.a.createElement(Yt,Object.assign({},e.state,a,{loadData:e.loadClinicNotes})):m.a.createElement(p.a,{to:"/patient/"+t.props.match.params.id+"/emr/clinicnotes/"})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(k.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" ClinicNotes":"ClinicNotes",extra:m.a.createElement(P.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/clinicnotes/add"},m.a.createElement(P.a,{type:"primary"},m.a.createElement(j.a,{type:"plus"}),"Add")))}),this.state.clinicNotes.map((function(a){return m.a.createElement(k.a,{style:{marginTop:20},title:m.a.createElement("small",null,a.date?G()(a.date).format("ll"):null),extra:m.a.createElement(pt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Ie.a,null,m.a.createElement(Ie.a.Item,{key:"1",onClick:function(){return t.editClinicNotesData(a)},disabled:a.practice&&a.practice.id!=e.props.active_practiceId},m.a.createElement(j.a,{type:"edit"}),"Edit"),m.a.createElement(Ie.a.Item,{key:"2",onClick:function(){return t.deleteClinicNote(a)},disabled:a.practice&&a.practice.id!=e.props.active_practiceId},m.a.createElement(j.a,{type:"delete"}),"Delete"),m.a.createElement(Ie.a.Divider,null),m.a.createElement(Ie.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+a.patient+"/emr/timeline"},m.a.createElement(j.a,{type:"clock-circle"}),"\xa0 Patient Timeline")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(a.id)}},m.a.createElement(j.a,{type:"printer"})))},m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Complaints")),m.a.createElement(y.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.chief_complaints?a.chief_complaints.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Observations")),m.a.createElement(y.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.observations?a.observations.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Investigations")),m.a.createElement(y.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.investigations?a.investigations.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Diagnoses")),m.a.createElement(y.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.diagnosis?a.diagnosis.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Notes")),m.a.createElement(y.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.notes?a.notes.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Recent Medications")),m.a.createElement(y.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.medication?a.medication.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement("div",null,a.doctor?m.a.createElement(g.a,{color:a.doctor?a.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+a.doctor.user.first_name," ")):null,a.practice?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,a.practice.name," "))):null))})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadClinicNotes(t.state.next)},loading:this.state.loading,hidden:!this.state.next}))))):m.a.createElement("div",null,m.a.createElement(k.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Clinic Notes":"Clinic Notes",extra:m.a.createElement(P.a.Group,null,m.a.createElement(P.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(j.a,{type:"plus"}),"Add"))}),this.state.clinicNotes.map((function(a){return m.a.createElement(k.a,{style:{marginTop:10},key:a.id,extra:m.a.createElement(pt.a.Button,{size:"small",overlay:m.a.createElement(Ie.a,null,m.a.createElement(Ie.a.Item,{key:"1",onClick:function(){return t.editClinicNotesData(a)},disabled:a.practice&&a.practice.id!=e.props.active_practiceId},m.a.createElement(j.a,{type:"edit"}),"Edit"),m.a.createElement(Ie.a.Item,{key:"2",onClick:function(){return t.deleteClinicNote(a)},disabled:a.practice&&a.practice.id!=e.props.active_practiceId},m.a.createElement(j.a,{type:"delete"}),"Delete"),m.a.createElement(Ie.a.Divider,null),m.a.createElement(Ie.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+a.patient+"/emr/timeline"},m.a.createElement(j.a,{type:"clock-circle"}),"\xa0 Patient Timeline")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(a.id)}},m.a.createElement(j.a,{type:"printer"}))),title:m.a.createElement("div",null,m.a.createElement("small",null,a.date?G()(a.date).format("ll"):null,m.a.createElement(le.b,{to:"/patient/"+a.patient.id+"/emr/clinicnotes"},"\xa0\xa0 ",a.patient.user?a.patient.user.first_name:null," (ID: ",a.patient.custom_id?a.patient.custom_id:a.patient.id,")\xa0"),m.a.createElement("span",null,", ",a.patient.gender)))},m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Complaints")),m.a.createElement(y.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.chief_complaints?a.chief_complaints.split(Y.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Observations")),m.a.createElement(y.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.observations?a.observations.split(Y.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Investigations")),m.a.createElement(y.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.investigations?a.investigations.split(Y.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Diagnoses")),m.a.createElement(y.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.diagnosis?a.diagnosis.split(Y.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Notes")),m.a.createElement(y.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.notes?a.notes.split(Y.r).map((function(e,t){return m.a.createElement("span",{key:e},t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Recent Medications")),m.a.createElement(y.a,{span:18,style:{borderLeft:"1px solid #ccc",padding:4}},m.a.createElement("div",{style:{minHeight:30}},a.medication?a.medication.split(Y.r).map((function(e,t){return m.a.createElement("span",null,t?m.a.createElement("br",null):null,e)})):null),m.a.createElement(v.a,{style:{margin:0}}))),m.a.createElement("div",null,a.doctor?m.a.createElement(g.a,{color:a.doctor?a.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+a.doctor.user.first_name," ")):null,a.practice?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,a.practice.name," "))):null))})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadClinicNotes(t.state.next)},loading:this.state.loading,hidden:!this.state.next}))}}]),t}(m.a.Component),Wt=(a(616),a(618)),Ht=u.a.Header,Ut=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.refreshWallet&&this.props.refreshWallet()}},{key:"render",value:function(){var e=this,t=this;return m.a.createElement(Ht,{className:"header",style:{background:"#e4e4e4",padding:"0px 20px"}},m.a.createElement("div",null,this.props.currentPatient?m.a.createElement("div",{style:{display:"inline"}},m.a.createElement("div",{style:{display:"inline",textSize:"15px"}},m.a.createElement(we.a,{title:"Switch Back to All Patients"},m.a.createElement(P.a,{onClick:function(){return e.props.setCurrentPatient(null)},type:"primary",ghost:!0},m.a.createElement(j.a,{type:"solution"})," \xa0 Back"))),m.a.createElement("a",{style:{padding:"8px",fontSize:"15px"},onClick:function(){return e.props.togglePatientListModal(!0)}},this.props.currentPatient.image?m.a.createElement(O.a,{src:Object(F.g)(this.props.currentPatient.image)}):m.a.createElement(O.a,{style:{backgroundColor:"#87d068"}},this.props.currentPatient.user.first_name?this.props.currentPatient.user.first_name.charAt(0):m.a.createElement(j.a,{type:"user"})),"\xa0\xa0",t.props.currentPatient.user.first_name.length<16?t.props.currentPatient.user.first_name:t.props.currentPatient.user.first_name.slice(0,12)+"...",m.a.createElement("small",null,m.a.createElement("i",null,m.a.createElement("b",null," [ID: ",t.props.currentPatient.custom_id?t.props.currentPatient.custom_id:t.props.currentPatient.id,"]")))),"\xa0\xa0\xa0\xa0",m.a.createElement(be.a,{placement:"topLeft",title:"Medical History",content:m.a.createElement("div",{style:{width:250}},t.props.currentPatient.medical_history_data?t.props.currentPatient.medical_history_data.map((function(e,t){return m.a.createElement(g.a,{color:"#"+Object(de.b)(Object(de.a)(e.name))},e.name)})):null)},t.props.currentPatient.medical_history_data?t.props.currentPatient.medical_history_data.map((function(e,a){return a>1?2==a&&m.a.createElement(g.a,null,"+",t.props.currentPatient.medical_history_data.length-2):m.a.createElement(g.a,{color:"#"+Object(de.b)(Object(de.a)(e.name))},e.name)})):null),m.a.createElement(Wt.a,{style:{marginLeft:20},checked:this.props.showAllClinic,onChange:function(t){return e.props.toggleShowAllClinic(t)},checkedChildren:"All Clinics",unCheckedChildren:"Current Clinic"}),this.props.pendingAmount?m.a.createElement(m.a.Fragment,null,m.a.createElement(P.a,{style:{marginLeft:"20px"},type:"primary",size:"small"},m.a.createElement(le.b,{to:"/patient/"+this.props.currentPatient.id+"/billing/payments/add"}," Pay Now!")),m.a.createElement(be.a,{placement:"rightTop",content:m.a.createElement(b.a,{size:"small",dataSource:this.props.pendingAmount.practice_data,renderItem:function(e){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:e.name,description:"Rs. "+(e.total<0?-1*e.total+" (Advance)":e.total)}))}}),title:"Pending Payments"},m.a.createElement("div",{style:{display:"inline",float:"left",maxWidth:200,position:"absolute",margin:"0px 15px",zIndex:5}},m.a.createElement(_.a,{title:"Total Pending Amount",value:this.props.pendingAmount.grand_total,valueStyle:{color:this.props.pendingAmount.grand_total>0?"#cf1322":"initial",fontWeight:500},precision:2})))):null,this.props.walletAmount&&this.props.walletAmount.length?m.a.createElement(be.a,{placement:"rightTop",title:"Agent Wallet Amount",content:m.a.createElement("p",null,"Non-Refundable : ",this.props.walletAmount[0].non_refundable)},m.a.createElement("div",{style:{display:"inline",float:"left",maxWidth:400,position:"absolute",paddingLeft:173,margin:"12px 15px"}},m.a.createElement(_.a,{tile:"wallet",value:this.props.walletAmount[0].refundable_amount+this.props.walletAmount[0].non_refundable,prefix:m.a.createElement(j.a,{type:"wallet"})}))):null):m.a.createElement("a",{style:{padding:"8px",fontSize:"20px"},onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement("div",{style:{display:"inline"}},m.a.createElement(j.a,{type:"solution"})," \xa0 All Patient")),m.a.createElement(pt.a,{overlay:de.f},m.a.createElement(P.a,{style:{float:"right",margin:"15px"}},m.a.createElement(j.a,{type:"setting"})," Settings ",m.a.createElement(j.a,{type:"down"}))),t.props.activePracticePermissions.AddPatient||t.props.allowAllPermissions?m.a.createElement(le.b,{to:"/patients/profile/add"},m.a.createElement(P.a,{type:"primary",style:{float:"right",margin:"15px"}},m.a.createElement(j.a,{type:"plus"})," Add Patient")):null),m.a.createElement(h.a,{width:1300,maskClosable:!1,centered:!0,footer:null,closable:!1,visible:this.props.listModalVisible,style:{height:"calc(100vh - 120px)"}},m.a.createElement(P.a,{icon:"close",type:"danger",shape:"circle",style:{position:"absolute",top:"-50px",right:0},onClick:function(){return e.props.togglePatientListModal(!1)}}),m.a.createElement(ne,this.props)))}}]),t}(m.a.Component);function Kt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Xt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).onChanged=function(e,t){a.setState(Object(w.a)({},e,t))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Kt(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Kt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{medicine_till:G()(n.medicine_till).format("YYYY-MM-DD"),follow_up_date:G()(n.follow_up_date).format("YYYY-MM-DD")});t.setState({saving:!0});Object(F.l)(Object(F.f)(A.wc,[a.props.currentPatient.id]),r,(function(e){Object(F.a)(N.Wb,"Communication Settings Saved Successfully!!"),t.setState({saving:!1})}),(function(){t.setState({saving:!1})}))}}))},a.state={parient_communication_history:null,patientProfile:null,saving:!1},a.loadCommunication=a.loadCommunication.bind(Object(o.a)(a)),a.loadProfile=a.loadProfile.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.currentPatient&&(this.loadCommunication(),this.loadProfile())}},{key:"loadProfile",value:function(){var e=this;console.log("props",e.props.match.params.id),Object(F.c)(Object(F.f)(A.wc,[e.props.match.params.id]),(function(t){e.setState({patientProfile:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"loadCommunication",value:function(){var e=this;Object(F.c)(Object(F.f)(A.oc,[this.props.currentPatient.user.id]),(function(t){e.setState({parient_communication_history:t.user_sms,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a={labelCol:{xs:{span:8},sm:{span:8},md:{span:8},lg:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16},md:{span:16},lg:{span:16}}},n=[{title:"SENT TIME",dataIndex:"created_at",key:"created_at",render:function(e){return m.a.createElement("span",null,G()(e).format("LLL"))}},{title:"MESSAGE",dataIndex:"body",key:"body"},{title:"TYPE",dataIndex:"sms_type",key:"sms_type"},{title:"MESSAGE STATUS",dataIndex:"status",key:"status"}],r=Y.Cb.map((function(e){return m.a.createElement(I.a,{value:e.value},e.title)})),i=Y.B.map((function(e){return m.a.createElement(I.a,{value:e.value},e.title)})),l=Y.j.map((function(e){return m.a.createElement(I.a,{value:e.value},e.title)}));return m.a.createElement(S.a,{onSubmit:this.handleSubmit},m.a.createElement(k.a,{title:this.props.currentPatient?this.props.currentPatient.user.first_name+" Communication":"Patient Communication",extra:m.a.createElement(P.a,{type:"primary",htmlType:"submit",loading:this.state.saving},m.a.createElement(j.a,{type:"save"})," Save Communication Setting")},m.a.createElement(S.a.Item,Object.assign({},a,{key:"sms_enable"})," ",m.a.createElement("label",null,m.a.createElement("span",{className:"ant-form-text"},"Enable SMS the patient"," : "),t("sms_enable",{initialValue:!!this.state.patientProfile&&this.state.patientProfile.sms_enable})(m.a.createElement(I.a.Group,{onChange:function(t){return e.onChanged("sms_enable",t.target.value)}},r)))),m.a.createElement(S.a.Item,Object.assign({},a,{key:"email_enable"})," ",m.a.createElement("label",null," ",m.a.createElement("span",{className:"ant-form-text"},"Enable Email the patient"," : "),t("email_enable",{initialValue:!!this.state.patientProfile&&this.state.patientProfile.email_enable})(m.a.createElement(I.a.Group,{onChange:function(t){return e.onChanged("email_enable",t.target.value)}},i)))),m.a.createElement(S.a.Item,Object.assign({},a,{key:"birthday_sms_email"})," ",m.a.createElement("label",null," ",m.a.createElement("span",{className:"ant-form-text"}," ","Send Birthday wish SMS & Email"," : "),t("birthday_sms_email",{initialValue:!!this.state.patientProfile&&this.state.patientProfile.birthday_sms_email})(m.a.createElement(I.a.Group,{onChange:function(t){return e.onChanged("birthday_sms_email",t.target.value)}},l)))),m.a.createElement(S.a.Item,Object.assign({},a,{key:"medicine_till"})," ",m.a.createElement("label",null,m.a.createElement("span",{className:"ant-form-text"}," ","Medicine Till Date"," : "),t("medicine_till",{initialValue:this.state.patientProfile&&this.state.patientProfile.medicine_till?G()(this.state.patientProfile.medicine_till):null})(m.a.createElement(T.a,null)))),m.a.createElement(S.a.Item,Object.assign({},a,{key:"medicine_till"})," ",m.a.createElement("label",null,m.a.createElement("span",{className:"ant-form-text"}," ","Next follow-up To"," : "),t("follow_up_date",{initialValue:this.state.patientProfile&&this.state.patientProfile.follow_up_date?G()(this.state.patientProfile.follow_up_date):null})(m.a.createElement(T.a,null)))),m.a.createElement("div",null,m.a.createElement(v.a,{dashed:!0}),m.a.createElement("h2",null,"Past Communication"),m.a.createElement(V.a,{loading:this.state.loading,columns:n,dataSource:this.state.parient_communication_history}))))}}]),t}(m.a.Component),Qt=S.a.create()(Xt),Zt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return m.a.createElement(Qt,Object.assign({},this.state,this.props))}}]),t}(m.a.Component),Jt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={redirect:!1,vitalSign:null,editVitalSign:a.props.editVitalSign?a.props.editVitalSign:null},a.changeRedirect=a.changeRedirect.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"render",value:function(){var e,t=this,a=[{label:"Pulse",key:"pulse",initialValue:this.props.editVitalSign?this.props.editVitalSign.pulse:null,type:N.rb,follow:"BPM"},{label:"Temperature",key:"temperature",initialValue:this.props.editVitalSign?this.props.editVitalSign.temperature:null,type:N.rb,follow:"Fahrenheit"},{label:"Temperature Part",key:"temperature_part",type:N.Rb,initialValue:this.props.editVitalSign?this.props.editVitalSign.temperature_part:null,options:[{label:"forehead",value:"forehead"},{label:"armpit",value:"armpit"},{label:"oral ",value:"oral"}]},{label:"Blood Pressure Up",key:"blood_pressure_up",initialValue:this.props.editVitalSign?this.props.editVitalSign.blood_pressure_up:null,type:N.rb,follow:"mmhg"},{label:"Blood Pressure Down",key:"blood_pressure_down",initialValue:this.props.editVitalSign?this.props.editVitalSign.blood_pressure_down:null,type:N.rb,follow:"mmhg"},{label:"Position",key:"position",type:N.Rb,initialValue:this.props.editVitalSign?this.props.editVitalSign.position:null,options:[{label:"standing",value:"standing"},{label:"sitting",value:"sitting"}]},{label:"Weight",key:"weight",initialValue:this.props.editVitalSign?this.props.editVitalSign.weight:null,type:N.rb,follow:"kg."},{label:"Resp Rate",key:"resp_rate",initialValue:this.props.editVitalSign?this.props.editVitalSign.resp_rate:null,type:N.rb,follow:"breaths/min"},{label:"Creatinine Level",key:"creatinine",initialValue:this.props.editVitalSign?this.props.editVitalSign.creatinine:null,type:N.rb},{label:"Haemoglobin Level",key:"haemoglobin",initialValue:this.props.editVitalSign?this.props.editVitalSign.haemoglobin:null,type:N.rb},{label:"Urea Level",key:"urea",initialValue:this.props.editVitalSign?this.props.editVitalSign.urea:null,type:N.rb},{label:"Uric Acid Level",key:"uric_acid",initialValue:this.props.editVitalSign?this.props.editVitalSign.uric_acid:null,type:N.rb},{label:"Date",key:"date",initialValue:this.props.editVitalSign&&this.props.editVitalSign.date?this.props.editVitalSign.date:G()(),type:N.M,required:!0}],n=[{key:"patient",value:this.props.match.params.id},{key:"practice",value:this.props.active_practiceId}],r=this,i=S.a.create()(R.a);this.state.editVitalSign&&(e={successFn:function(e){Object(F.a)(N.Wb,"success"),r.props.loadData&&r.props.loadData()},errorFn:function(){},action:Object(F.f)(A.Md,[this.props.match.params.id]),method:"post"},n.push({key:"id",value:this.state.editVitalSign.id}));var l={successFn:function(e){Object(F.a)(N.Wb,"success"),r.props.loadData&&r.props.loadData()},errorFn:function(){},action:Object(F.f)(A.Md,[this.props.match.params.id]),method:"post"};return m.a.createElement(f.a,null,m.a.createElement(k.a,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/vitalsigns/edit",render:function(){return t.state.editVitalSign?m.a.createElement(i,{defaultValues:n,title:"Edit Report Manual",changeRedirect:t.changeRedirect,formProp:e,fields:a}):m.a.createElement(p.a,{to:"/patients/profile"})}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/vitalsigns/add",render:function(){return m.a.createElement(i,{title:"Add Report Manual",defaultValues:n,changeRedirect:t.changeRedirect,formProp:l,fields:a})}})),this.state.redirect&&m.a.createElement(p.a,{to:"/patient/"+this.props.match.params.id+"/emr/vitalsigns"}))}}]),t}(m.a.Component),$t=a(258);function ea(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var ta=h.a.confirm,aa=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).deleteVitalSign=function(e){var t=Object(o.a)(a);ta({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ea(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ea(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{is_active:!1});Object(F.j)(Object(F.f)(A.Md,[e.patient]),a,(function(e){t.loadVitalsigns(),Object(F.a)(N.Wb,"Deleted Successfully!!")}),(function(){}))},onCancel:function(){console.log("Cancel")}})},a.editObject=function(e){if(a.setState({editVitalSign:e,loading:!1}),a.props.match.params.id){var t=a.props.match.params.id;a.props.history.push("/patient/"+t+"/emr/vitalsigns/edit")}else a.props.history.push("/patient/"+e.patient+"/emr/vitalsigns")},a.state={currentPatient:a.props.currentPatient,vitalsign:[],loading:!0},a.loadVitalsigns=a.loadVitalsigns.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadVitalsigns()}},{key:"loadVitalsigns",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=function(e){t.setState((function(t){return 1==e.current?{vitalsign:Object(D.a)(e.results),next:e.next,loading:!1}:{vitalsign:[].concat(Object(D.a)(t.vitalsign),Object(D.a)(e.results)),next:e.next,loading:!1}}))},n=function(){},r={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(r.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete r.practice,Object(F.c)(A.Md,a,n,r)}},{key:"loadPDF",value:function(e){Object(F.c)(Object(F.f)(A.Nd,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=[{title:"Date",dataIndex:"date",key:"date",render:function(e,t){return m.a.createElement("span",null,t.date?G()(t.date).format("LL"):"")}},{title:"Temp(F)",key:"temperature",render:function(e,t){return m.a.createElement("span",null," ",t.temperature,m.a.createElement("br",null),",",t.temperature_part)}},{title:"Pulse (BPM)",dataIndex:"pulse",key:"pulse"},{title:"RR breaths/min",dataIndex:"resp_rate",key:"resp_rate"},{title:"SYS/DIA mmhg",key:"address",render:function(e,t){return m.a.createElement("span",null," ",t.blood_pressure_up,"/",t.blood_pressure_down,m.a.createElement("br",null),",",t.position)}},{title:"WEIGHT kg",dataIndex:"weight",key:"weight"},{title:"Creatinine Level",key:"creatinine",dataIndex:"creatinine"},{title:"Haemoglobin Level",key:"haemoglobin",dataIndex:"haemoglobin"},{title:"Urea Level",key:"urea",dataIndex:"urea"},{title:"Uric Acid Level",key:"uric_acid",dataIndex:"uric_acid"},{title:"Action",key:"action",render:function(a,n){return m.a.createElement("span",null,m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},"Print"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{onClick:function(){return e.editObject(n)},disabled:n.practice!=t.props.active_practiceId},"Edit"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{onClick:function(){return t.deleteVitalSign(n)},disabled:n.practice!=t.props.active_practiceId},"Delete"))}}];return this.props.match.params.id?m.a.createElement(p.d,null,m.a.createElement(p.b,{path:"/patient/:id/emr/vitalsigns/add",render:function(t){return m.a.createElement(Jt,Object.assign({},e.props,{key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t,{loadData:e.loadVitalsigns}))}}),m.a.createElement(p.b,{path:"/patient/:id/emr/vitalsigns/edit",render:function(t){return m.a.createElement(Jt,Object.assign({},e.props,{key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t,{loadData:e.loadVitalsigns}))}}),m.a.createElement(p.b,null,m.a.createElement(k.a,{title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Report Manual":"Patient Report Manual",extra:m.a.createElement(P.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/vitalsigns/add"},m.a.createElement(P.a,{type:"primary"},m.a.createElement(j.a,{type:"plus"}),"Add")))},m.a.createElement(Ft.a,null,m.a.createElement(Ft.a.TabPane,{tab:"Charts",key:1,style:{margin:"auto"}},m.a.createElement(v.a,null,"Pulse Chart (bpm)"),m.a.createElement("div",{style:{height:200}},m.a.createElement($t.k,null,m.a.createElement($t.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement($t.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:t.state.vitalsign.length}),m.a.createElement($t.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement($t.b,{strokeDasharray:"3 3"}),m.a.createElement($t.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement($t.g,{type:"monotone",dataKey:"pulse",stroke:"#8884d8",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Temperature (F)"),m.a.createElement("div",{style:{height:200}},m.a.createElement($t.k,null,m.a.createElement($t.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement($t.f,{verticalAlign:"top",height:36}),m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement($t.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement($t.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement($t.b,{strokeDasharray:"3 3"}),m.a.createElement($t.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement($t.g,{type:"monotone",dataKey:"temperature",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Blood Pressure (mmhg)"),m.a.createElement("div",{style:{height:200}},m.a.createElement($t.k,null,m.a.createElement($t.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#ffc658",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#ffc658",stopOpacity:0}))),m.a.createElement($t.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement($t.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement($t.b,{strokeDasharray:"3 3"}),m.a.createElement($t.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement($t.g,{type:"monotone",dataKey:"blood_pressure_up",stroke:"#ffc658",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"}),m.a.createElement($t.g,{type:"monotone",dataKey:"blood_pressure_down",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Weight (kg)"),m.a.createElement("div",{style:{height:200}},m.a.createElement($t.k,null,m.a.createElement($t.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#8884d8",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#8884d8",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement($t.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement($t.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement($t.b,{strokeDasharray:"3 3"}),m.a.createElement($t.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement($t.g,{type:"monotone",dataKey:"weight",stroke:"#8884d8",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Respiratory Rate (breaths/min)"),m.a.createElement("div",{style:{height:200}},m.a.createElement($t.k,null,m.a.createElement($t.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement($t.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement($t.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement($t.b,{strokeDasharray:"3 3"}),m.a.createElement($t.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement($t.g,{type:"monotone",dataKey:"resp_rate",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Creatinine Level"),m.a.createElement("div",{style:{height:200}},m.a.createElement($t.k,null,m.a.createElement($t.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement($t.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement($t.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement($t.b,{strokeDasharray:"3 3"}),m.a.createElement($t.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement($t.g,{type:"monotone",dataKey:"creatinine",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Haemoglobin Level"),m.a.createElement("div",{style:{height:200}},m.a.createElement($t.k,null,m.a.createElement($t.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement($t.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement($t.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement($t.b,{strokeDasharray:"3 3"}),m.a.createElement($t.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement($t.g,{type:"monotone",dataKey:"haemoglobin",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Urea Level"),m.a.createElement("div",{style:{height:200}},m.a.createElement($t.k,null,m.a.createElement($t.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement($t.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement($t.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement($t.b,{strokeDasharray:"3 3"}),m.a.createElement($t.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement($t.g,{type:"monotone",dataKey:"urea",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"})))),m.a.createElement(v.a,null,"Uric Acid Level"),m.a.createElement("div",{style:{height:200}},m.a.createElement($t.k,null,m.a.createElement($t.d,{width:700,height:200,data:this.state.vitalsign.reverse(),margin:{top:10,right:30,left:0,bottom:0}},m.a.createElement("defs",null,m.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),m.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},m.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),m.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),m.a.createElement($t.n,{dataKey:"date",tickFormatter:function(e){return G()(e).format("LL")},tickCount:this.state.vitalsign.length}),m.a.createElement($t.o,{domain:[function(e){return Math.abs(e)},function(e){return(1.1*e).toFixed(0)}]}),m.a.createElement($t.b,{strokeDasharray:"3 3"}),m.a.createElement($t.m,{labelFormatter:function(e){return e&&G()(e).isValid()?G()(e).format("LL"):"--"}}),m.a.createElement($t.g,{type:"monotone",dataKey:"uric_acid",stroke:"#82ca9d",fillOpacity:1,strokeWidth:4,fill:"url(#colorUv)"}))))),m.a.createElement(Ft.a.TabPane,{tab:"Details",key:2},m.a.createElement(V.a,{columns:a,pagination:!1,dataSource:this.state.vitalsign}),m.a.createElement(L.a,{loaderFunction:function(){return e.loadInvoices(t.state.next)},loading:this.state.loading,hidden:!this.state.next})))))):m.a.createElement("div",null,m.a.createElement(k.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Report Manual":"Patients Report Manual",extra:m.a.createElement(P.a.Group,null,m.a.createElement(P.a,{type:"primary",onClick:function(){return t.props.togglePatientListModal(!0)}},m.a.createElement(j.a,{type:"plus"}),"Add"))}),this.state.vitalsign.map((function(e){return m.a.createElement("div",null,m.a.createElement(k.a,{style:{marginTop:10},title:m.a.createElement("small",null,e.date?G()(e.date).format("ll"):null,m.a.createElement(le.b,{to:"/patient/"+e.patient_data.id+"/emr/vitalsigns"},"\xa0\xa0 ",e.patient_data.user?e.patient_data.user.first_name:null," (ID: ",e.patient_data.custom_id?e.patient_data.custom_id:e.patient_data.id,")\xa0"),m.a.createElement("span",null,", ",e.patient_data.gender)),bodyStyle:{padding:0}},m.a.createElement(ke.a,{columns:a,pagination:!1,dataSource:[e],footer:function(){return function(e){if(e)return console.log(e),m.a.createElement("div",null,e.doctor?m.a.createElement(g.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+e.doctor.user.first_name," ")):null,e.practice_data?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice_data.name," "))):null);return null}(e)}})))})),m.a.createElement(L.a,{loaderFunction:function(){return e.loadVitalsigns(t.state.next)},loading:this.state.loading,hidden:!this.state.next}))}}]),t}(m.a.Component);var na=a(324);function ra(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ia(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ra(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ra(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var la=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).calculateItem=function(e){var t=a.props.form.getFieldsValue;console.log(t()),a.setState((function(e){Object(D.a)(e.tableFormValues).forEach((function(e){}))}))},a.addNotes=function(e,t){a.setState((function(a){return{addNotes:ia({},a.addNotes,Object(w.a)({},e,!!t))}}))},a.removeTreatment=function(e){a.setState((function(t){return{tableFormValues:Object(D.a)(Object(na.remove)(t.tableFormValues,(function(t){return t._id!=e})))}}))},a.add=function(e){Object(o.a)(a);a.setState((function(t){var a=Math.random().toFixed(7);return{addNotes:ia({},t.addNotes,Object(w.a)({},a,!!e.default_notes)),tableFormValues:[ia({},e,{_id:a})].concat(Object(D.a)(t.tableFormValues))}}),(function(){}))},a.selectDoctor=function(e){a.setState({selectedDoctor:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(!e){console.log("Received values of form: ",a);var n={treatment_plans:[],patient:t.props.match.params.id,doctor:t.state.selectedDoctor.id,date:t.state.selectedDate&&G()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null,practice:t.props.active_practiceId};t.props.editId&&(n.id=t.props.editTreatmentPlan.id),t.state.tableFormValues.forEach((function(e){console.log(e),e.quantity=a.quantity[e._id],e.cost=a.cost[e._id],e.discount=a.discount[e._id],a.notes&&(e.notes=a.notes[e._id]);var t={procedure:e.id,cost:e.cost,quantity:e.quantity,margin:e.margin,default_notes:e.notes,is_active:!0,is_completed:!0,discount:e.discount,discount_type:"%"};n.treatment_plans.push(t)}));Object(F.j)(Object(F.f)(A.Ed,[t.props.match.params.id]),n,(function(e){Object(F.a)("Inventory updated successfully"),t.props.loadData&&t.props.loadData();var a="/patient/"+t.props.match.params.id+"/emr/workdone";t.props.history.push(a)}),(function(){}))}}))},a.searchValues=function(e){var t=Object(o.a)(a);return a.setState((function(t){return{searchString:e}}),(function(){t.loadProcedures()})),!1},a.state={loadingProcedures:!0,procedure_category:[],tableFormValues:[],addNotes:{},practiceDoctors:[],selectedDoctor:{},selectedDate:G()()},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.editId&&this.setState((function(e){var t=[];return this.props.editTreatmentPlan.treatment_plans.forEach((function(e){var a=Math.random().toFixed(7);t.push(ia({},e,{},e.procedure,{_id:a}))})),ia({},this.props.editTreatmentPlan,{tableFormValues:t,selectedDate:G()(this.props.editTreatmentPlan.date),selectedDoctor:this.props.editTreatmentPlan.doctor})})),this.loadProcedures(),Object(de.d)(this)}},{key:"loadProcedures",value:function(){var e=this,t={};this.state.searchString&&(t.name=this.state.searchString),e.setState({loadingProcedures:!0});Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),(function(a){t.name&&e.state.searchString!=t.name||e.setState({loadingProcedures:!1,filteredItems:a.results})}),(function(){e.setState({loadingProcedures:!1})}),t)}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,n=a.getFieldDecorator,r=(a.getFieldValue,a.getFieldsValue,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}}),i=[{title:"Treatments",dataIndex:"name",key:"name",render:function(t,a){return m.a.createElement("span",null,m.a.createElement("b",null,t),m.a.createElement("br",null),e.state.addNotes[a._id]||e.props.editId?m.a.createElement(S.a.Item,Object.assign({key:"default_notes[".concat(a._id,"]")},r),n("notes[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.default_notes})(m.a.createElement(M.a.TextArea,{min:0,placeholder:"Notes..."}))):m.a.createElement("a",{onClick:function(){return e.addNotes(a._id,!0)}},"+ Add Note"))}},{title:"Quantity",dataIndex:"quantity",key:"quantity",render:function(t,a){return m.a.createElement(S.a.Item,Object.assign({key:"quantity[".concat(a._id,"]")},r),n("quantity[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:a.quantity})(m.a.createElement(C.a,{min:0,placeholder:"Quantity",size:"small",onChange:function(){return e.calculateItem(a._id)}})))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(t,a){return m.a.createElement(S.a.Item,Object.assign({key:"cost[".concat(a._id,"]")},r),n("cost[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:a.cost})(m.a.createElement(C.a,{min:0,placeholder:"Cost",size:"small",onChange:function(){return e.calculateItem(a._id)}})))}},{title:"Discount",dataIndex:"discount",key:"discount",render:function(t,a){return m.a.createElement(S.a.Item,Object.assign({key:"discount[".concat(a._id,"]")},r),n("discount[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}]})(m.a.createElement(C.a,{min:0,placeholder:"Discount",size:"small",onChange:function(){return e.calculateItem(a._id)}}))," %")}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement(P.a,{icon:"close",onClick:function(){return e.removeTreatment(a._id)},type:"danger",shape:"circle",size:"small"}))}}];return m.a.createElement("div",null,m.a.createElement(k.a,{title:"Completed Procedures"},m.a.createElement(f.a,null,m.a.createElement(y.a,{span:17},m.a.createElement(S.a,{onSubmit:this.handleSubmit},m.a.createElement(ke.a,{pagination:!1,bordered:!0,dataSource:this.state.tableFormValues,columns:i}),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(k.a,null,m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(pt.a,{placement:"topCenter",overlay:m.a.createElement(Ie.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Ie.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(T.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement(S.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0,float:"right"}}),m.a.createElement(P.a,{type:"primary",htmlType:"submit",style:{margin:5}},"Save Treatment Plan"),t.props.history?m.a.createElement(P.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null))),m.a.createElement("div",{ref:function(e){t.bottomPoint=e}}))),m.a.createElement(y.a,{span:7},m.a.createElement(Je.a,{offsetTop:0},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(M.a.Search,{placeholder:"Search in plans ...",onChange:function(t){return e.searchValues(t.target.value)}})),m.a.createElement(b.a,{size:"small",loading:this.state.loadingProcedures,style:{maxHeight:"100vh",overflowX:"scroll"},itemLayout:"horizontal",dataSource:this.state.filteredItems,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.add(t)}},m.a.createElement(b.a.Item.Meta,{title:t.name}))}}))))))}}]),t}(m.a.Component),ca=S.a.create()(la),oa=h.a.confirm,sa=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,treatmentPlans:[],procedure_category:null,completedTreatmentPlans:[],incompletedTreatmentPlans:[],productMargin:[],loading:!0},a.loadTreatmentPlans=a.loadTreatmentPlans.bind(Object(o.a)(a)),a.editTreatmentPlanData=a.editTreatmentPlanData.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadTreatmentPlans(),this.loadProductMargin()}},{key:"loadProductMargin",value:function(){var e=this;Object(F.c)(A.Mc,(function(t){e.setState({productMargin:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"loadTreatmentPlans",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=[],a=this,n=function(e){a.setState((function(t){return 1==e.current?{treatmentPlans:Object(D.a)(e.results),next:e.next,loading:!1}:{treatmentPlans:[].concat(Object(D.a)(t.treatmentPlans),Object(D.a)(e.results)),next:e.next,loading:!1}})),e.results.forEach((function(e){e.is_completed||t.push(e)})),a.setState((function(e){return{incompletedTreatmentPlans:[].concat(Object(D.a)(e.incompletedTreatmentPlans),t),loading:!1}}))},r=function(){a.setState({loading:!1})},i={page:e,practice:this.props.active_practiceId,complete:!0};this.props.match.params.id&&(i.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete i.practice,Object(F.c)(A.Ed,n,r,i)}},{key:"editTreatmentPlanData",value:function(e){this.setState({editTreatmentPlan:e});var t=this.props.match.params.id;this.props.history.push("/patient/"+t+"/emr/workdone/edit")}},{key:"deleteTreatmentPlans",value:function(e){var t=this;oa({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a={id:e.id,patient:e.patient.id,is_active:!1};Object(F.j)(Object(F.f)(A.Ed,[t.props.match.params.id],null),a,(function(e){Object(F.a)(N.Wb,"Completed Procedure Deleted Successfully!"),t.loadTreatmentPlans()}),(function(){}))},onCancel:function(){console.log("Cancel")}})}},{key:"loadPDF",value:function(e){Object(F.c)(Object(F.f)(A.Gd,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=[{title:"",key:"is_completed",render:function(e,t){return t.is_completed?m.a.createElement(j.a,{type:"check-circle",theme:"twoTone",style:{marginLeft:"8px",fontSize:"20px"}}):null}},{title:"Procedure",key:"procedure.name",dataIndex:"procedure.name"},{title:"Quantity",dataIndex:"quantity",initialValue:this.state.editFields?this.state.editFields.quantity:null,key:"quantity"},{title:"Discount",dataIndex:"discount",key:"discount"},{title:"Cost per  Unit",dataIndex:"cost",key:"cost"},{title:"Notes",dataIndex:"default_notes",key:"default_notes"}];return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/workdone/add",render:function(a){return m.a.createElement(ca,Object.assign({},e.state,t.props,a,{loadData:e.loadTreatmentPlans}))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/workdone/edit",render:function(a){return e.state.editTreatmentPlan?m.a.createElement(ca,Object.assign({},e.state,a,t.props,{editId:e.state.editTreatmentPlan.id,loadData:e.loadTreatmentPlans})):m.a.createElement(p.a,{to:"/patient/"+e.props.match.params.id+"/emr/workdone"})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(k.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Completed Procedures":"Completed Procedures ",extra:m.a.createElement(P.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/workdone/add"},m.a.createElement(P.a,null,m.a.createElement(j.a,{type:"plus"}),"Add")))}),this.state.treatmentPlans.map((function(n){return m.a.createElement(k.a,{bodyStyle:{padding:0},style:{marginTop:15}},m.a.createElement("div",{style:{padding:16}},m.a.createElement("h4",null,n.date?G()(n.date).format("ll"):null,m.a.createElement(pt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Ie.a,null,m.a.createElement(Ie.a.Item,{key:"1",onClick:function(){return t.editTreatmentPlanData(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(j.a,{type:"edit"}),"Edit"),m.a.createElement(Ie.a.Item,{key:"2",onClick:function(){return t.deleteTreatmentPlans(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(j.a,{type:"delete"}),"Delete"),m.a.createElement(Ie.a.Divider,null),m.a.createElement(Ie.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+n.patient+"/emr/timeline"},m.a.createElement(j.a,{type:"clock-circle"}),"\xa0 Patient Timeline")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},m.a.createElement(j.a,{type:"printer"}))))),m.a.createElement(ke.a,{loading:e.state.loading,columns:a,dataSource:n.treatment_plans,footer:function(){return ua(n)},pagination:!1,key:n.id}))})),m.a.createElement(L.a,{loaderFunction:function(){return e.loadTreatmentPlans(t.state.next)},loading:this.state.loading,hidden:!this.state.next}))))):m.a.createElement("div",null,m.a.createElement(k.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Completed Procedures":"Completed Procedures ",extra:m.a.createElement(P.a.Group,null,m.a.createElement(P.a,{onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(j.a,{type:"plus"}),"Add"))}),this.state.treatmentPlans.map((function(n){return m.a.createElement(k.a,{bodyStyle:{padding:0},key:n.id,style:{marginTop:15}},m.a.createElement("div",{style:{padding:16}},m.a.createElement("h4",null,n.date?G()(n.date).format("ll"):null,m.a.createElement(le.b,{to:"/patient/"+n.patient.id+"/emr/workdone"},"\xa0\xa0 ",n.patient.user?n.patient.user.first_name:null," (ID: ",n.patient.custom_id?n.patient.custom_id:n.patient.id,")\xa0"),m.a.createElement("span",null,", ",n.patient.gender),m.a.createElement(pt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Ie.a,null,m.a.createElement(Ie.a.Item,{key:"1",disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(le.b,{to:"/patient/"+n.patient.id+"/emr/workdone/edit"},m.a.createElement(j.a,{type:"edit"}),"\xa0 Edit")),m.a.createElement(Ie.a.Item,{key:"2",onClick:function(){return t.deleteTreatmentPlans(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(j.a,{type:"delete"}),"Delete"),m.a.createElement(Ie.a.Divider,null),m.a.createElement(Ie.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+n.patient.id+"/emr/timeline"},m.a.createElement(j.a,{type:"clock-circle"}),"\xa0 Patient Timeline")))},m.a.createElement(j.a,{type:"printer"})))),m.a.createElement(ke.a,{loading:e.state.loading,columns:a,dataSource:n.treatment_plans,footer:function(){return ua(n)},pagination:!1,key:n.id}))})),m.a.createElement(L.a,{loaderFunction:function(){return e.loadTreatmentPlans(t.state.next)},loading:this.state.loading,hidden:!this.state.next}))}}]),t}(m.a.Component);function ua(e){return e?m.a.createElement("div",null,e.doctor?m.a.createElement(g.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"Completed by  "+e.doctor.user.first_name," ")):null,e.practice?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null):null}function da(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ma(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?da(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):da(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var pa=Ft.a.TabPane,fa=0,ha=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).addInstructions=function(e,t){a.setState((function(a){return{addInstructions:ma({},a.addInstructions,Object(w.a)({},e,!!t))}}))},a.changeDurationUnits=function(e,t){a.setState((function(a){return{changeDurationUnits:ma({},a.changeDurationUnits,Object(w.a)({},e,!!t))}}))},a.removeDrug=function(e){a.setState((function(t){return{formDrugList:Object(D.a)(Object(na.remove)(t.formDrugList,(function(t){return t._id!=e})))}}))},a.removeLabs=function(e,t){a.setState((function(a){return{addedLabs:ma({},a.addedLabs,Object(w.a)({},t.id,!1)),formLabList:Object(D.a)(Object(na.remove)(a.formLabList,(function(t){return t._id!=e})))}}))},a.addLabs=function(e){a.setState((function(t){var a=Math.random().toFixed(7);return console.log("LAb state",t),t.addedLabs[e.id]?(Object(F.a)(N.fc,"Item Already Added"),!1):{addedLabs:ma({},t.addedLabs,Object(w.a)({},e.id,!0)),formLabList:[].concat(Object(D.a)(t.formLabList),[ma({},e,{_id:a})])}}))},a.addTemplate=function(e){a.setState((function(t){Math.random().toFixed(7);if(t.addTemplate[e.id])return Object(F.a)(N.fc,"Item Already Added"),!1;var a=Object(D.a)(t.formLabList),n=ma({},t.addedLabs);e.labs&&e.labs.forEach((function(e){var t=Math.random().toFixed(7);a.push(ma({},e,{_id:t})),n=ma({},n,Object(w.a)({},e.id,!0))}));var r=Object(D.a)(t.formDrugList),i=ma({},t.addedDrugs);return e.drugs&&e.drugs.forEach((function(t){var a=Math.random().toFixed(7);r.push(ma({},t,{_id:a,advice_data:e.advice_data})),i=ma({},i,Object(w.a)({},t.id,!0))})),{addedLabs:n,formLabList:a,addedDrugs:i,formDrugList:r}}))},a.removeTemplates=function(e,t){a.setState((function(a){return{addTemplate:ma({},a.addTemplate,Object(w.a)({},t.id,!1)),formTemplateList:Object(D.a)(Object(na.remove)(a.formTemplateList,(function(t){return t._id!=e})))}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(console.log("value form",a),!e){var n=ma({},a,{drug:[],labs:[],advice_data:[],patient:t.props.match.params.id,practice:t.props.active_practiceId});t.state.formDrugList.forEach((function(e){console.log("advice search",e),e.dosage=a.does[e._id],e.duration_type=a.duration_unit[e._id],e.duration=a.duration[e._id],e.frequency=a.does_frequency[e._id],a.instruction&&(e.instruction=a.instruction[e._id]),a.food_time[e._id]?(e.after_food=!0,e.before_food=!1):(e.before_food=!0,e.after_food=!1),e.advice_data&&e.advice_data.map((function(e){n.advice_data.push(e.id)}));var r={inventory:e.id,name:e.name,dosage:e.dosage,frequency:e.frequency,duration:e.duration,duration_type:e.duration_type,instruction:e.instruction,before_food:e.before_food,after_food:e.after_food,advice_data:t.state.prescriptionTemplate.advice_data,is_active:!0};n.drug.push(r)})),t.state.formLabList.forEach((function(e){n.labs.push(e.id)}));console.log("final",n),Object(F.j)(Object(F.f)(A.Ic,[t.props.active_practiceId]),n,(function(e){t.props.history.goBack()}),(function(){}))}}))},a.handleAddFields=function(){var e=a.props.form,t=e.getFieldValue("keys").concat(fa++);e.setFieldsValue({keys:t})},a.remove=function(e){var t=a.props.form,n=t.getFieldValue("keys");1!==n.length&&t.setFieldsValue({keys:n.filter((function(t){return t!==e}))})},a.onChange=function(e){a.setState({})},a.searchValues=function(e,t){var n=Object(o.a)(a);a.setState((function(a){var n=ma({},a.searchStrings);return n[e]=t,{searchStrings:n}}),(function(){"Drugs"==e?n.loadDrugList():n.filterValues(e)}))},a.filterValues=function(e){a.setState((function(t){var a=[];return t.items[e]&&(t.searchStrings[e]?t.items[e].forEach((function(n){n.name&&n.name.toString().toLowerCase().includes(t.searchStrings[e].toLowerCase())&&a.push(n)})):a=t.items[e]),{filteredItems:ma({},t.filteredItems,Object(w.a)({},e,a))}}))},a.state={items:{},filteredItems:{},drugList:[],labList:[],formDrugList:[],formLabList:[],addInstructions:{},changeDurationUnits:{},addedDrugs:{},addedLabs:{},addTemplate:{},formTemplateList:[],searchStrings:{}},a.loadPrescriptionTemplate=a.loadPrescriptionTemplate.bind(Object(o.a)(a)),a.deletePrescriptionTemplate=a.deletePrescriptionTemplate.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadDrugList(),this.loadLabList(),this.loadPrescriptionTemplate()}},{key:"loadPrescriptionTemplate",value:function(){var e=this;console.log("template",e.state.prescriptionTemplate),Object(F.c)(Object(F.f)(A.Ic,[e.props.active_practiceId]),(function(t){e.setState({prescriptionTemplate:t.results})}),(function(){}))}},{key:"loadLabList",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Fb,[e.props.active_practiceId]),(function(t){e.setState({labList:t.results})}),(function(){}))}},{key:"loadDrugList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=function(e){t.setState((function(t){var a=ma({},t.items);return{items:ma({},a,{Drugs:e.results}),filteredItems:ma({},t.filteredItems,{Drugs:e.results})}}))},n=function(){},r={practice:this.props.active_practiceId,item_type:Y.z,page:e};t.state.searchStrings.Drugs&&(r.item_name=t.state.searchStrings.Drugs),Object(F.c)(A.xb,a,n,r)}},{key:"addDrug",value:function(e){this.setState((function(t){var a=Math.random().toFixed(7);return t.addedDrugs[e.id]?(Object(F.a)(N.fc,"Item Already Added"),!1):{addedDrugs:ma({},t.addedDrugs,Object(w.a)({},e.id,!0)),formDrugList:[].concat(Object(D.a)(t.formDrugList),[ma({},e,{_id:a})])}}))}},{key:"deletePrescriptionTemplate",value:function(e){var t=this,a={id:e,is_active:!1};Object(F.j)(Object(F.f)(A.Ic,[t.props.active_practiceId]),a,(function(e){t.loadPrescriptionTemplate()}),(function(){}))}},{key:"render",value:function(){var e=this,a=this,n={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:12}}},r={wrapperCol:{xs:{span:24,offset:0},sm:{span:12,offset:4}}},i=this.props.form,l=i.getFieldDecorator,c=i.getFieldValue;i.getFieldsValue;l("keys",{initialValue:[]});var o=c("keys"),s=o.map((function(t,a){return m.a.createElement(S.a.Item,Object.assign({},0===a?n:r,{label:0===a?"Advice":"",required:!1,key:t}),l("advice_data[".concat(t,"]"),{validateTrigger:["onChange","onBlur"]})(m.a.createElement(M.a,{style:{width:"60%",marginRight:8}})),o.length>1?m.a.createElement(j.a,{className:"dynamic-delete-button",type:"minus-circle-o",onClick:function(){return e.remove(t)}}):null)})),u=[{title:"Drug Name",dataIndex:"name",key:"name",render:function(e){return m.a.createElement("h2",null,e)}},{title:"Dosage & Frequency",dataIndex:"dosage",key:"dosage",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(S.a.Item,{extra:m.a.createElement("span",null,"does(s)"),key:"does[".concat(a._id,"]")},l("does[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"]},{rules:[{message:"This field is required."}]})(m.a.createElement(C.a,{min:0,size:"small"}))),m.a.createElement(S.a.Item,{key:"does_frequency[".concat(a._id,"]")},l("does_frequency[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:"twice daily"})(m.a.createElement(x.a,{size:"small",onChange:function(){return e.changeDurationUnits(a._id,!1)}},Y.y.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))))}},{title:"Duration",dataIndex:"duration",key:"duration",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(S.a.Item,{key:"duration[".concat(a._id,"]")},l("duration[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"]},{rules:[{message:"This field is required."}]})(m.a.createElement(C.a,{min:0,size:"small"}))),m.a.createElement(S.a.Item,{key:"duration_unit[".concat(a._id,"]")},l("duration_unit[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:"day(s)"})(m.a.createElement(x.a,{size:"small",onChange:function(){return e.changeDurationUnits(a._id,!1)}},Y.A.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))))}},{title:"Instructions",dataIndex:"instruction",key:"instruction",render:function(t,a){return m.a.createElement("div",null,e.state.addInstructions[a._id]?m.a.createElement(S.a.Item,{extra:m.a.createElement("a",{onClick:function(){return e.addInstructions(a._id,!1)}},"Remove Instructions"),key:"instruction[".concat(a._id,"]")},l("instruction[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}]})(m.a.createElement(M.a.TextArea,{min:0,placeholder:"Instructions...",size:"small"}))):m.a.createElement("a",{onClick:function(){return e.addInstructions(a._id,!0)}},"+ Add Instructions"))}},{title:"Timing",dataIndex:"food_time",key:"food_time",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(S.a.Item,{key:"food_time[".concat(a._id,"]")},l("food_time[".concat(a._id,"]"))(m.a.createElement(I.a.Group,{onChange:e.onChange},m.a.createElement(I.a,{value:1},"After Food"),m.a.createElement(I.a,{value:0},"Before Food")))))}},{title:"",dataIndex:"action",key:"action",render:function(t,a){return m.a.createElement(S.a.Item,null,m.a.createElement(P.a,{icon:"close",onClick:function(){return e.removeDrug(a._id)},type:"danger",shape:"circle",size:"small"}))}}],d=[{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return m.a.createElement("span",null,m.a.createElement("b",null,e))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(e,t){return m.a.createElement("span",null,t.cost)}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement(P.a,{icon:"close",onClick:function(){return e.removeLabs(a._id,a)},type:"danger",shape:"circle",size:"small"}))}}];return m.a.createElement(k.a,{title:"Prescriptions Template"},m.a.createElement(f.a,null,m.a.createElement(y.a,{span:18},m.a.createElement(S.a,{onSubmit:this.handleSubmit},m.a.createElement(S.a.Item,Object.assign({},n,{label:"Template Name"}),l("name",{})(m.a.createElement(M.a,null))),m.a.createElement(S.a.Item,Object.assign({},n,{label:"Schedule"}),l("schedule",{})(m.a.createElement(C.a,{min:1}))),m.a.createElement(ke.a,{pagination:!1,bordered:!1,columns:u,dataSource:this.state.formDrugList}),m.a.createElement(v.a,null," Lab Test"),m.a.createElement(ke.a,{pagination:!1,bordered:!1,columns:d,dataSource:this.state.formLabList}),m.a.createElement(v.a,null),s,m.a.createElement(S.a.Item,r,m.a.createElement(P.a,{type:"dashed",onClick:this.handleAddFields,style:{width:"60%"}},m.a.createElement(j.a,{type:"plus"})," Add advice field")),m.a.createElement(Je.a,{target:function(){return e.container}},m.a.createElement(P.a,{type:"primary",htmlType:"submit"},"Save")))),m.a.createElement(y.a,{span:6},m.a.createElement(Ft.a,{type:"card"},m.a.createElement(pa,{tab:"Drugs",key:"1"},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(M.a.Search,{key:"Drugs",placeholder:"Search in Medicine...",onChange:function(t){return e.searchValues("Drugs",t.target.value)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.filteredItems.Drugs,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.addDrug(t)},actions:t.maintain_inventory?null:[m.a.createElement(g.a,null,"Not Sold")]},m.a.createElement(b.a.Item.Meta,{title:t.name}))}})),m.a.createElement(pa,{tab:"Labs",key:"2"},m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.labList,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.addLabs(t)}},m.a.createElement(b.a.Item.Meta,{title:t.name}))}})),m.a.createElement(pa,{tab:"Template",key:"3"},m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.prescriptionTemplate,renderItem:function(t){return m.a.createElement(b.a.Item,{onConfirm:function(){return a.deletePrescriptionTemplate(t.id)}},m.a.createElement(b.a.Item.Meta,{onClick:function(){return e.addTemplate(t)},title:t.name}),m.a.createElement(E.a,{title:"Are you sure delete this item?",onConfirm:function(){return a.deletePrescriptionTemplate(t.id)},okText:"Yes",cancelText:"No"},m.a.createElement("a",null,"Delete")))}})))),m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/prescriptions/template/add",renderRoute:function(a){return m.a.createElement(t,Object.assign({},e.state,a))}}))))}}]),t}(m.a.Component),ba=S.a.create()(ha);function ga(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ya(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ga(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ga(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Ea=Ft.a.TabPane,va=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).selectDoctor=function(e){a.setState({selectedDoctor:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.addInstructions=function(e,t){a.setState((function(a){return{addInstructions:ya({},a.addInstructions,Object(w.a)({},e,!!t))}}))},a.changeDurationUnits=function(e,t){a.setState((function(a){return{changeDurationUnits:ya({},a.changeDurationUnits,Object(w.a)({},e,!!t))}}))},a.removeDrug=function(e){a.setState((function(t){return{formDrugList:Object(D.a)(Object(na.remove)(t.formDrugList,(function(t){return t._id!=e})))}}))},a.removeLabs=function(e,t){a.setState((function(a){return{addedLabs:ya({},a.addedLabs,Object(w.a)({},t.id,!1)),formLabList:Object(D.a)(Object(na.remove)(a.formLabList,(function(t){return t._id!=e})))}}))},a.addLabs=function(e){a.setState((function(t){var a=Math.random().toFixed(7);return t.addedLabs[e.id]?(Object(F.a)(N.fc,"Item Already Added"),!1):{addedLabs:ya({},t.addedLabs,Object(w.a)({},e.id,!0)),formLabList:[].concat(Object(D.a)(t.formLabList),[ya({},e,{_id:a})])}}))},a.addTemplate=function(e){a.setState((function(t){if(t.addTemplate[e.id])return Object(F.a)(N.fc,"Item Already Added"),!1;var a=Object(D.a)(t.formLabList),n=ya({},t.addedLabs);e.labs.forEach((function(e){var t=Math.random().toFixed(7);a.push(ya({},e,{_id:t})),n=ya({},n,Object(w.a)({},e.id,!0))}));var r=Object(D.a)(t.formDrugList),i=ya({},t.addedDrugs);return e.drugs.forEach((function(t){var a=Math.random().toFixed(7);r.push(ya({},t,{_id:a,advice_data:e.advice_data})),n=ya({},i,Object(w.a)({},t.id,!0))})),{addedLabs:n,formLabList:a,addedDrugs:i,formDrugList:r}}))},a.removeTemplates=function(e,t){a.setState((function(a){return{addTemplate:ya({},a.addTemplate,Object(w.a)({},t.id,!1)),formTemplateList:Object(D.a)(Object(na.remove)(a.formTemplateList,(function(t){return t._id!=e})))}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(e)console.log(e);else{var n={drugs:[],labs:[],patient:parseInt(t.props.match.params.id),practice:t.props.active_practiceId,doctor:t.state.selectedDoctor?t.state.selectedDoctor.id:null,date:t.state.selectedDate?t.state.selectedDate.format("YYYY-MM-DD"):null,advice_data:[]};t.props.editId&&(n.id=t.props.editId),t.state.formDrugList.forEach((function(e){e.dosage=a.dosage[e._id],e.duration_type=a.duration_type[e._id],e.duration=a.duration[e._id],e.frequency=a.frequency[e._id],a.instruction&&(e.instruction=a.instruction[e._id]),a.food_time[e._id]?(e.after_food=!0,e.before_food=!1):(e.before_food=!0,e.after_food=!1);var t={inventory:e.id,name:e.name,dosage:e.dosage,frequency:e.frequency,duration_type:e.duration_type,duration:e.duration,instruction:e.instruction,before_food:e.before_food,after_food:e.after_food,is_active:!0};n.drugs.push(t),console.log("item drug",e)})),t.state.formLabList.forEach((function(e){n.labs.push(e.id)}));Object(F.j)(Object(F.f)(A.Gc,[t.props.match.params.id]),n,(function(e){t.props.loadData&&t.props.loadData();var a="/patient/"+t.props.match.params.id+"/emr/prescriptions";t.props.history.push(a)}),(function(){}))}}))},a.onChange=function(e){a.setState({})},a.searchValues=function(e,t){var n=Object(o.a)(a);a.setState((function(a){var n=ya({},a.searchStrings);return n[e]=t,{searchStrings:n}}),(function(){"Drugs"==e?n.loadDrugList():n.filterValues(e)}))},a.filterValues=function(e){a.setState((function(t){var a=[];return t.items[e]&&(t.searchStrings[e]?t.items[e].forEach((function(n){n.name&&n.name.toString().toLowerCase().includes(t.searchStrings[e].toLowerCase())&&a.push(n)})):a=t.items[e]),{filteredItems:ya({},t.filteredItems,Object(w.a)({},e,a))}}))},a.state={items:{},filteredItems:{},formDrugList:[],formLabList:[],addInstructions:{},changeDurationUnits:{},addedDrugs:{},addedLabs:{},addTemplate:{},formTemplateList:[],practiceDoctors:[],selectedDoctor:{},selectedDate:G()(),searchStrings:{}},a.loadPrescriptionTemplate=a.loadPrescriptionTemplate.bind(Object(o.a)(a)),a.deletePrescriptionTemplate=a.deletePrescriptionTemplate.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.loadDrugList(),this.loadLabList(),this.loadPrescriptionTemplate(),Object(de.d)(this),this.props.editId&&this.setState((function(t){var a=[],n={},r={};e.props.editPrescription.drugs.forEach((function(e){var t=Math.random();a.push(ya({},e,{_id:t,food_time:e.after_food?1:0})),n[t]=!!e.instruction}));var i=[];return e.props.editPrescription.labs.forEach((function(e){i.push(ya({},e,{_id:Math.random()})),r[e.id]=!0})),ya({},e.props.editPrescription,{formDrugList:[].concat(a),formLabList:[].concat(i),addInstructions:ya({},n),addedLabs:ya({},r),selectedDoctor:e.props.editPrescription.doctor,selectedDate:G()(e.props.editPrescription.date).isValid()?G()(e.props.editPrescription.date):G()()})}))}},{key:"loadPrescriptionTemplate",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Ic,[e.props.active_practiceId]),(function(t){e.setState((function(e){var a=ya({},e.items);return{items:ya({},a,{Template:t.results}),filteredItems:ya({},e.filteredItems,{Template:t.results})}}))}),(function(){}))}},{key:"loadLabList",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Fb,[e.props.active_practiceId]),(function(t){e.setState((function(e){var a=ya({},e.items);return{items:ya({},a,{Labs:t.results}),filteredItems:ya({},e.filteredItems,{Labs:t.results})}}))}),(function(){}))}},{key:"loadDrugList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=t.state.searchStrings.Drugs,n=function(e){a==t.state.searchStrings.Drugs&&t.setState((function(t){var a=ya({},t.items);return{items:ya({},a,{Drugs:e.results}),filteredItems:ya({},t.filteredItems,{Drugs:e.results})}}))},r=function(){},i={practice:this.props.active_practiceId,item_type:Y.z,page:e};a&&(i.item_name=a),Object(F.c)(A.xb,n,r,i)}},{key:"addDrug",value:function(e){this.setState((function(t){var a=Math.random().toFixed(7);return{addedDrugs:ya({},t.addedDrugs,Object(w.a)({},e.id,!0)),formDrugList:[ya({},e,{_id:a})].concat(Object(D.a)(t.formDrugList))}}))}},{key:"deletePrescriptionTemplate",value:function(e){var t=this,a={id:e,is_active:!1};Object(F.j)(Object(F.f)(A.Ic,[t.props.active_practiceId]),a,(function(e){t.loadPrescriptionTemplate()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,n=a.getFieldDecorator,r=(a.getFieldValue,a.getFieldsValue,[{title:"Medicine Name",dataIndex:"name",key:"name",render:function(e){return m.a.createElement("h2",null,e)}},{title:"Dosage & Frequency",dataIndex:"dosage",key:"dosage",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(S.a.Item,{extra:m.a.createElement("span",null,"does(s)"),key:"dosage[".concat(a._id,"]")},n("dosage[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.dosage,min:0})(m.a.createElement(C.a,{size:"small"}))),m.a.createElement(S.a.Item,{key:"frequency[".concat(a._id,"]")},n("frequency[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.frequency||Y.y[0].value})(m.a.createElement(x.a,{size:"small",onChange:function(){return e.changeDurationUnits(a._id,!1)}},Y.y.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))))}},{title:"Duration",dataIndex:"duration",key:"duration",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(S.a.Item,{key:"duration[".concat(a._id,"]")},n("duration[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.duration,min:0})(m.a.createElement(C.a,{size:"small"}))),m.a.createElement(S.a.Item,{key:"duration_type[".concat(a._id,"]")},n("duration_type[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.duration_type||Y.A[0].value})(m.a.createElement(x.a,{size:"small",onChange:function(){return e.changeDurationUnits(a._id,!1)}},Y.A.map((function(e){return m.a.createElement(x.a.Option,{value:e.value},e.label)}))))))}},{title:"Instructions",dataIndex:"instruction",key:"instruction",render:function(t,a){return m.a.createElement("div",null,e.state.addInstructions[a._id]?m.a.createElement(S.a.Item,{extra:m.a.createElement("a",{onClick:function(){return e.addInstructions(a._id,!1)}},"Remove Instructions"),key:"instruction[".concat(a._id,"]")},n("instruction[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.instruction})(m.a.createElement(M.a.TextArea,{placeholder:"Instructions...",size:"small"}))):m.a.createElement("a",{onClick:function(){return e.addInstructions(a._id,!0)}},"+ Add Instructions"))}},{title:"Timing",dataIndex:"food_time",key:"food_time",render:function(t,a){return m.a.createElement("div",null,m.a.createElement(S.a.Item,{key:"food_time[".concat(a._id,"]")},n("food_time[".concat(a._id,"]"),{initialValue:a.food_time||0})(m.a.createElement(I.a.Group,{onChange:e.onChange},m.a.createElement(I.a,{value:1},"after"),m.a.createElement(I.a,{value:0},"before")))))}},{title:"",dataIndex:"action",key:"action",render:function(t,a){return m.a.createElement(S.a.Item,null,m.a.createElement(P.a,{icon:"close",onClick:function(){return e.removeDrug(a._id)},type:"danger",shape:"circle",size:"small"}))}}]),i=[{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return m.a.createElement("span",null,m.a.createElement("b",null,e))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(e,t){return m.a.createElement("span",null,t.cost)}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement(P.a,{icon:"close",onClick:function(){return e.removeLabs(a._id,a)},type:"danger",shape:"circle",size:"small"}))}}];return m.a.createElement(k.a,{title:"Prescriptions"},m.a.createElement(f.a,null,m.a.createElement(y.a,{span:18},m.a.createElement(S.a,{onSubmit:this.handleSubmit},m.a.createElement(ke.a,{pagination:!1,bordered:!1,columns:r,dataSource:this.state.formDrugList}),m.a.createElement(v.a,null," Lab Test"),m.a.createElement(ke.a,{pagination:!1,bordered:!1,columns:i,dataSource:this.state.formLabList}),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(k.a,null,m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(pt.a,{placement:"topCenter",overlay:m.a.createElement(Ie.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Ie.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(T.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY"}),m.a.createElement(P.a,{type:"primary",htmlType:"submit",style:{margin:5,float:"right"}},"Save"),t.props.history?m.a.createElement(P.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null)))),m.a.createElement(y.a,{span:6},m.a.createElement(Ft.a,{type:"card"},m.a.createElement(Ea,{tab:"Medicine",key:"1"},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(M.a.Search,{key:"Drugs",placeholder:"Search in Medicine...",onChange:function(t){return e.searchValues("Drugs",t.target.value)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.filteredItems.Drugs,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.addDrug(t)},actions:t.maintain_inventory?null:[m.a.createElement(g.a,null,"Not Sold")]},m.a.createElement(b.a.Item.Meta,{title:t.name}))}})),m.a.createElement(Ea,{tab:"Labs",key:"2"},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(M.a.Search,{key:"Labs",placeholder:"Search in Labs...",onChange:function(t){return e.searchValues("Labs",t.target.value)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.filteredItems.Labs,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.addLabs(t)}},m.a.createElement(b.a.Item.Meta,{title:t.name}))}})),m.a.createElement(Ea,{tab:"Template",key:"3"},m.a.createElement("div",null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/prescriptions/template/add"},m.a.createElement(P.a,{type:"primary",block:!0,size:"small"},m.a.createElement(j.a,{type:"plus"}),"\xa0Add Template"))),m.a.createElement(v.a,{style:{margin:0}}),m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(M.a.Search,{key:"Template",placeholder:"Search in Template...",onChange:function(t){return e.searchValues("Template",t.target.value)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.filteredItems.Template,renderItem:function(a){return m.a.createElement(b.a.Item,{onConfirm:function(){return t.deletePrescriptionTemplate(a.id)}},m.a.createElement(b.a.Item.Meta,{onClick:function(){return e.addTemplate(a)},title:a.name}),m.a.createElement(E.a,{title:"Are you sure delete this item?",onConfirm:function(){return t.deletePrescriptionTemplate(a.id)},okText:"Yes",cancelText:"No"},m.a.createElement("a",null,"Delete")))}})))),m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/prescriptions/template/add",render:function(t){return m.a.createElement(ba,Object.assign({},e.state,t))}}))))}}]),t}(m.a.Component),_a=S.a.create()(va),Oa=h.a.confirm,Pa=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,prescription:[],drug_catalog:null,editPrescription:null,loading:!0},a.loadPrescriptions=a.loadPrescriptions.bind(Object(o.a)(a)),a.loadDrugCatalog=a.loadDrugCatalog.bind(Object(o.a)(a)),a.editPrescriptionData=a.editPrescriptionData.bind(Object(o.a)(a)),a.deletePrescriptions=a.deletePrescriptions.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadPrescriptions(),this.loadDrugCatalog()}},{key:"loadPrescriptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;this.setState({loading:!0});var a=function(e){t.setState({prescription:e.results,nextPrescriptionPage:e.next,loading:!1})},n=function(){t.setState({loading:!1})},r={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(r.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete r.practice,Object(F.c)(A.Gc,a,n,r)}},{key:"loadPDF",value:function(e){Object(F.c)(Object(F.f)(A.Hc,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))}},{key:"loadDrugCatalog",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Z,[this.props.active_practiceId]),(function(t){e.setState({drug_catalog:t})}),(function(){e.setState({})}))}},{key:"editPrescriptionData",value:function(e){var t=this;this.setState({editPrescription:e},(function(){t.props.history.push("/patient/"+e.patient+"/emr/prescriptions/edit")}))}},{key:"deletePrescriptions",value:function(e){var t=this;Oa({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a={id:e.id,patient:e.patient,is_active:!1};Object(F.j)(Object(F.f)(A.Gc,[t.props.match.params.id]),a,(function(e){t.loadPrescriptions()}),(function(){}))},onCancel:function(){console.log("Cancel")}})}},{key:"render",value:function(){var e=this,t={};this.state.drug_catalog&&this.state.drug_catalog.forEach((function(e){t[e.id]=e.name+","+e.strength}));var a=this,r=[{title:"Drug",key:"name",dataIndex:"name"},{title:"Frequency",dataIndex:"frequency",key:"frequency",render:function(e,t){return m.a.createElement("span",null,t.dosage,"\xa0",t.frequency)}},{title:"Duration",dataIndex:"duration",key:"duration",render:function(e,t){return m.a.createElement("span",null,e,"\xa0",t.duration_type)}},{title:"Instruction",dataIndex:"instruction",key:"instruction",render:function(e,t){return m.a.createElement("span",null,t.before_food?m.a.createElement(g.a,null,"before food "):null,t.after_food?m.a.createElement(g.a,null,"after food"):null,e)}}];return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/prescriptions/add",render:function(t){return m.a.createElement(_a,Object.assign({},e.state,e.props,{loadData:e.loadPrescriptions},t))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/prescriptions/edit",render:function(t){return a.state.editPrescription?m.a.createElement(_a,Object.assign({},e.state,t,e.props,{loadData:e.loadPrescriptions,editId:a.state.editPrescription.id})):m.a.createElement(p.a,{to:"/patient/"+a.props.match.params.id+"/emr/prescriptions"})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(k.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Prescriptions":"Prescriptions",extra:m.a.createElement(P.a.Group,{style:{float:"right"}},m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/prescriptions/add"},m.a.createElement(P.a,{type:"primary"},m.a.createElement(j.a,{type:"plus"}),"Add")))}),this.state.prescription.map((function(t){return m.a.createElement("div",null,m.a.createElement(k.a,{style:{marginTop:10},bodyStyle:{padding:0},title:m.a.createElement("small",null,t.date?G()(t.date).format("ll"):null),extra:m.a.createElement(pt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Ie.a,null,m.a.createElement(Ie.a.Item,{key:"1",onClick:function(){return a.editPrescriptionData(t)},disabled:t.practice&&t.practice.id!=a.props.active_practiceId},m.a.createElement(j.a,{type:"edit"}),"Edit"),m.a.createElement(Ie.a.Item,{key:"2",onClick:function(){return a.deletePrescriptions(t)},disabled:t.practice&&t.practice.id!=a.props.active_practiceId},m.a.createElement(j.a,{type:"delete"}),"Delete"),m.a.createElement(Ie.a.Divider,null),m.a.createElement(Ie.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+t.patient+"/emr/timeline"},m.a.createElement(j.a,{type:"clock-circle"}),"\xa0 Patient Timeline")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(t.id)}},m.a.createElement(j.a,{type:"printer"})))},m.a.createElement(ke.a,{columns:r,dataSource:t.drugs,pagination:!1,footer:function(){return ja(t)},key:t.id})))})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(L.a,{loading:this.state.loading,loaderFunction:function(){return e.loadPrescriptions(e.state.nextPrescriptionPage)},hidden:!this.state.nextPrescriptionPage}))))):m.a.createElement("div",null,m.a.createElement(k.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Prescriptions":"Prescriptions",extra:m.a.createElement(P.a.Group,{style:{float:"right"}},m.a.createElement(P.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(j.a,{type:"plus"}),"Add"))}),this.state.prescription.map((function(t){return m.a.createElement("div",{key:t.id},m.a.createElement(k.a,{style:{marginTop:10},bodyStyle:{padding:0},title:m.a.createElement("small",null,t.date?G()(t.date).format("ll"):null,m.a.createElement(le.b,{to:"/patient/"+t.patient.id+"/emr/prescriptions"},"\xa0\xa0 ",t.patient.user?t.patient.user.first_name:null," (ID: ",t.patient.custom_id?t.patient.custom_id:t.patient.id,")\xa0"),m.a.createElement("span",null,", ",t.patient.gender)),extra:m.a.createElement(pt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Ie.a,null,m.a.createElement(Ie.a.Item,{key:"1",onClick:function(){return a.editPrescriptionData(t)},disabled:t.practice&&t.practice.id!=a.props.active_practiceId},m.a.createElement(j.a,{type:"edit"}),"Edit"),m.a.createElement(Ie.a.Item,{key:"2",onClick:function(){return a.deletePrescriptions(t)},disabled:t.practice&&t.practice.id!=a.props.active_practiceId},m.a.createElement(j.a,{type:"delete"}),"Delete"),m.a.createElement(Ie.a.Divider,null),m.a.createElement(Ie.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+t.patient+"/emr/timeline"},m.a.createElement(j.a,{type:"clock-circle"}),"\xa0 Patient Timeline")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(t.id)}},m.a.createElement(j.a,{type:"printer"})))},m.a.createElement(ke.a,{columns:r,dataSource:t.drugs,pagination:!1,footer:function(){return ja(t)},key:t.id})))})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(L.a,{loading:this.state.loading,loaderFunction:function(){return e.loadPrescriptions(e.state.nextPrescriptionPage)},hidden:!this.state.nextPrescriptionPage}))}}]),t}(m.a.Component);function ja(e){return e?m.a.createElement("div",null,e.doctor?m.a.createElement(we.a,{title:"Doctor"},m.a.createElement(g.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+e.doctor.user.first_name," "))):null,e.practice?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null,e.labs.length?m.a.createElement("div",null,"+",e.labs.length,"\xa0Lab Orders"):null):null}function ka(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ca(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ka(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ka(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Ia=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).calculateItem=function(e){var t=a.props.form.getFieldsValue;console.log(t()),a.setState((function(e){Object(D.a)(e.tableFormValues).forEach((function(e){}))}))},a.addNotes=function(e,t){a.setState((function(a){return{addNotes:Ca({},a.addNotes,Object(w.a)({},e,!!t))}}))},a.removeTreatment=function(e){a.setState((function(t){return{tableFormValues:Object(D.a)(Object(na.remove)(t.tableFormValues,(function(t){return t._id!=e})))}}))},a.add=function(e){Object(o.a)(a);a.setState((function(t){var a=Math.random().toFixed(7);return{addNotes:Ca({},t.addNotes,Object(w.a)({},a,!!e.default_notes)),tableFormValues:[Ca({},e,{_id:a})].concat(Object(D.a)(t.tableFormValues))}}),(function(){}))},a.selectDoctor=function(e){a.setState({selectedDoctor:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(!e){console.log("Received values of form: ",a);var n={treatment_plans:[],patient:t.props.match.params.id,doctor:t.state.selectedDoctor.id,date:t.state.selectedDate&&G()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null,practice:t.props.active_practiceId};t.props.editId&&(n.id=t.props.editTreatmentPlan.id),t.state.tableFormValues.forEach((function(e){console.log(e),e.quantity=a.quantity[e._id],e.cost=a.cost[e._id],e.discount=a.discount[e._id],a.notes&&(e.notes=a.notes[e._id]);var t={procedure:e.id,cost:e.cost,quantity:e.quantity,margin:e.margin,default_notes:e.default_notes,is_active:!0,is_completed:e.is_completed||!1,discount:e.discount,discount_type:"%"};n.treatment_plans.push(t)}));Object(F.j)(Object(F.f)(A.Ed,[t.props.match.params.id]),n,(function(e){Object(F.a)("Inventory updated successfully"),t.props.loadData&&t.props.loadData();var a="/patient/"+t.props.match.params.id+"/emr/plans";t.props.history.push(a)}),(function(){}))}}))},a.searchValues=function(e){var t=Object(o.a)(a);return a.setState((function(t){return{searchString:e}}),(function(){t.loadProcedures()})),!1},a.state={loadingProcedures:!0,procedure_category:[],tableFormValues:[],addNotes:{},practiceDoctors:[],selectedDoctor:{},selectedDate:G()()},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.editId&&this.setState((function(e){var t=[];return this.props.editTreatmentPlan.treatment_plans.forEach((function(e){var a=Math.random().toFixed(7);t.push(Ca({},e,{},e.procedure,{_id:a}))})),Ca({},this.props.editTreatmentPlan,{tableFormValues:t,selectedDate:G()(this.props.editTreatmentPlan.date),selectedDoctor:this.props.editTreatmentPlan.doctor})})),this.loadProcedures(),Object(de.d)(this)}},{key:"loadProcedures",value:function(){var e=this,t={};this.state.searchString&&(t.name=this.state.searchString),e.setState({loadingProcedures:!0});Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),(function(a){t.name&&e.state.searchString!=t.name||e.setState({loadingProcedures:!1,filteredItems:a.results})}),(function(){e.setState({loadingProcedures:!1})}),t)}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,n=a.getFieldDecorator,r=(a.getFieldValue,a.getFieldsValue,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}}),i=[{title:"Treatments",dataIndex:"name",key:"name",render:function(t,a){return m.a.createElement("span",null,m.a.createElement("b",null,t),m.a.createElement("br",null),e.state.addNotes[a._id]?m.a.createElement(S.a.Item,Object.assign({key:"default_notes[".concat(a._id,"]")},r),n("default_notes[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}],initialValue:a.default_notes})(m.a.createElement(M.a.TextArea,{min:0,placeholder:"Notes..."}))):m.a.createElement("a",{onClick:function(){return e.addNotes(a._id,!0)}},"+ Add Note"))}},{title:"Quantity",dataIndex:"quantity",key:"quantity",render:function(t,a){return m.a.createElement(S.a.Item,Object.assign({key:"quantity[".concat(a._id,"]")},r),n("quantity[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:1})(m.a.createElement(C.a,{min:0,placeholder:"Quantity",size:"small",onChange:function(){return e.calculateItem(a._id)}})))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(t,a){return m.a.createElement(S.a.Item,Object.assign({key:"cost[".concat(a._id,"]")},r),n("cost[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:a.cost})(m.a.createElement(C.a,{min:0,placeholder:"Cost",size:"small",onChange:function(){return e.calculateItem(a._id)}})))}},{title:"Discount",dataIndex:"discount",key:"discount",render:function(t,a){return m.a.createElement(S.a.Item,Object.assign({key:"discount[".concat(a._id,"]")},r),n("discount[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{message:"This field is required."}]})(m.a.createElement(C.a,{min:0,placeholder:"Discount",size:"small",onChange:function(){return e.calculateItem(a._id)}}))," %")}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement(P.a,{icon:"close",onClick:function(){return e.removeTreatment(a._id)},type:"danger",shape:"circle",size:"small"}))}}];return m.a.createElement("div",null,m.a.createElement(k.a,{title:"Treatment Plans"},m.a.createElement(f.a,null,m.a.createElement(y.a,{span:17},m.a.createElement(S.a,{onSubmit:this.handleSubmit},m.a.createElement(ke.a,{pagination:!1,bordered:!0,dataSource:this.state.tableFormValues,columns:i}),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(k.a,null,m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(pt.a,{placement:"topCenter",overlay:m.a.createElement(Ie.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Ie.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(T.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement(S.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0,float:"right"}}),m.a.createElement(P.a,{type:"primary",htmlType:"submit",style:{margin:5}},"Save Treatment Plan"),t.props.history?m.a.createElement(P.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null))),m.a.createElement("div",{ref:function(e){t.bottomPoint=e}}))),m.a.createElement(y.a,{span:7},m.a.createElement(Je.a,{offsetTop:0},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(M.a.Search,{placeholder:"Search in plans ...",onChange:function(t){return e.searchValues(t.target.value)}})),m.a.createElement(b.a,{size:"small",style:{maxHeight:"100vh",overflowX:"scroll"},itemLayout:"horizontal",dataSource:this.state.filteredItems,loading:this.state.loadingProcedures,renderItem:function(t){return m.a.createElement(b.a.Item,{onClick:function(){return e.add(t)}},m.a.createElement(b.a.Item.Meta,{title:t.name}))}}))))))}}]),t}(m.a.Component),Sa=S.a.create()(Ia);function xa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Da(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?xa(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):xa(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var wa=h.a.confirm,Ta=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,treatmentPlans:[],procedure_category:null,incompletedTreatmentPlans:[],loading:!0,selectedTreatments:{}},a.loadTreatmentPlans=a.loadTreatmentPlans.bind(Object(o.a)(a)),a.editTreatmentPlanData=a.editTreatmentPlanData.bind(Object(o.a)(a)),a.submitCompleteTreatment=a.submitCompleteTreatment.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadTreatmentPlans()}},{key:"loadTreatmentPlans",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=[],a=this;this.setState({loading:!0});var n=function(e){a.setState((function(t){return 1==e.current?{treatmentPlans:Object(D.a)(e.results),next:e.next,loading:!1}:{treatmentPlans:[].concat(Object(D.a)(t.treatmentPlans),Object(D.a)(e.results)),next:e.next,loading:!1}})),e.results.forEach((function(e){e.is_completed||t.push(e)})),a.setState((function(a){return 1==e.current?{incompletedTreatmentPlans:[].concat(t),loading:!1}:{incompletedTreatmentPlans:[].concat(Object(D.a)(a.incompletedTreatmentPlans),t),loading:!1}}))},r=function(){a.setState({loading:!1})},i={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(i.patient=this.props.match.params.id),this.props.showAllClinic&&this.props.match.params.id&&delete i.practice,Object(F.c)(A.Ed,n,r,i)}},{key:"editTreatmentPlanData",value:function(e){console.log("record",e.id),this.setState({editTreatmentPlan:e,loading:!1});e.patient;this.props.history.push("/patient/"+e.id+"/emr/plans/edit")}},{key:"deleteTreatmentPlans",value:function(e){var t=this;wa({title:"Are you sure to delete this item?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var a={id:e.id,patient:e.patient.id,is_active:!1};Object(F.j)(Object(F.f)(A.Ed,[t.props.match.params.id],null),a,(function(e){t.loadTreatmentPlans(),Object(F.a)(N.Wb,"Treatment Plan Deleted Successfully!")}),(function(){}))},onCancel:function(){console.log("Cancel")}})}},{key:"treatmentCompleteToggle",value:function(e,t){this.setState((function(a){return{selectedTreatments:Da({},a.selectedTreatments,Object(w.a)({},e,!!t))}}))}},{key:"submitCompleteTreatment",value:function(){var e=this,t=this.state.selectedTreatments,a=Object.keys(t),n={treatment:[],patient:e.props.match.params.id};a.forEach((function(e){var a={id:e,is_completed:t[e]};n.treatment.push(a)}));Object(F.j)(Object(F.f)(A.Fd,[this.props.match.params.id]),n,(function(t){e.loadTreatmentPlans(),e.setState({selectedTreatments:{}})}),(function(){}))}},{key:"loadPDF",value:function(e){Object(F.c)(Object(F.f)(A.Gd,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=[{title:"",key:"is_completed",render:function(t,a){return a.is_completed?m.a.createElement(j.a,{type:"check-circle",theme:"twoTone",style:{marginLeft:"8px",fontSize:"20px"}}):m.a.createElement(fe.a,{key:a.id,onChange:function(t){return e.treatmentCompleteToggle(a.id,t.target.checked)},value:e.state.selectedTreatments[a.id]})}},{title:"Procedure",dataIndex:"procedure",key:"procedure",render:function(e,t){return m.a.createElement("span",null," ",e.name)}},{title:"Quantity",dataIndex:"quantity",key:"quantity"},{title:"Discount",dataIndex:"discount",key:"discount"},{title:"Cost per  Unit",dataIndex:"cost",key:"cost"},{title:"Notes",dataIndex:"default_notes",key:"default_notes"}];return this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/plans/add",render:function(a){return m.a.createElement(Sa,Object.assign({},e.state,a,t.props,{loadData:e.loadTreatmentPlans}))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/plans/edit",render:function(a){return e.state.editTreatmentPlan?m.a.createElement(Sa,Object.assign({},e.state,a,t.props,{loadData:e.loadTreatmentPlans,editId:e.state.editTreatmentPlan.id})):m.a.createElement(p.a,{to:"/patient/"+e.props.match.params.id+"/emr/plans"})}}),m.a.createElement("div",null,m.a.createElement(k.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" TreatmentPlans":"TreatmentPlans",extra:m.a.createElement(P.a.Group,null,m.a.createElement(P.a,{onClick:this.submitCompleteTreatment},m.a.createElement(j.a,{type:"save"}),"Save"),m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/plans/add"},m.a.createElement(P.a,{type:"primary"},m.a.createElement(j.a,{type:"plus"}),"Add")))}),m.a.createElement(n.a,{spinning:this.state.loading},this.state.treatmentPlans.map((function(n){return m.a.createElement(k.a,{bodyStyle:{padding:0},style:{marginTop:15}},m.a.createElement("div",{style:{padding:16}},m.a.createElement("h4",null,n.date?G()(n.date).format("ll"):null,m.a.createElement(pt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Ie.a,null,m.a.createElement(Ie.a.Item,{key:"1",onClick:function(){return t.editTreatmentPlanData(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(j.a,{type:"edit"}),"Edit"),m.a.createElement(Ie.a.Item,{key:"2",onClick:function(){return t.deleteTreatmentPlans(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(j.a,{type:"delete"}),"Delete"),m.a.createElement(Ie.a.Divider,null),m.a.createElement(Ie.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+n.patient+"/emr/timeline"},m.a.createElement(j.a,{type:"clock-circle"}),"\xa0 Patient Timeline")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},m.a.createElement(j.a,{type:"printer"}))))),m.a.createElement(ke.a,{loading:e.state.loading,columns:a,dataSource:n.treatment_plans,footer:function(){return Ma(n)},pagination:!1,key:n.id}))}))),m.a.createElement(L.a,{loaderFunction:function(){return e.loadTreatmentPlans(t.state.next)},loading:this.state.loading,hidden:!this.state.next})))):m.a.createElement("div",null,m.a.createElement(k.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.user.first_name+" TreatmentPlans":"TreatmentPlans",extra:m.a.createElement(P.a.Group,null,m.a.createElement(P.a,{onClick:this.submitCompleteTreatment},m.a.createElement(j.a,{type:"save"}),"Save"),m.a.createElement(P.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(j.a,{type:"plus"}),"Add"))}),m.a.createElement(n.a,{spinning:this.state.loading},this.state.treatmentPlans.map((function(n){return m.a.createElement(k.a,{bodyStyle:{padding:0},key:n.id,style:{marginTop:15}},m.a.createElement("div",{style:{padding:16}},m.a.createElement("h4",null,n.date?G()(n.date).format("ll"):null,m.a.createElement(le.b,{to:"/patient/"+n.patient.id+"/emr/plans"},"\xa0\xa0 ",n.patient.user?n.patient.user.first_name:null," (ID: ",n.patient.custom_id?n.patient.custom_id:n.patient.id,")\xa0"),m.a.createElement("span",null,", ",n.patient.gender),m.a.createElement(pt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Ie.a,null,m.a.createElement(Ie.a.Item,{key:"1",disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(le.b,{to:"/patient/"+n.patient.id+"/emr/plans/edit"},m.a.createElement(j.a,{type:"edit"}),"\xa0 Edit")),m.a.createElement(Ie.a.Item,{key:"2",onClick:function(){return t.deleteTreatmentPlans(n)},disabled:n.practice&&n.practice.id!=e.props.active_practiceId},m.a.createElement(j.a,{type:"delete"}),"Delete"),m.a.createElement(Ie.a.Divider,null),m.a.createElement(Ie.a.Item,{key:"3"},m.a.createElement(le.b,{to:"/patient/"+n.patient+"/emr/timeline"},m.a.createElement(j.a,{type:"clock-circle"}),"\xa0 Patient Timeline")))},m.a.createElement("a",{onClick:function(){return e.loadPDF(n.id)}},m.a.createElement(j.a,{type:"printer"}))))),m.a.createElement(ke.a,{loading:e.state.loading,columns:a,dataSource:n.treatment_plans,footer:function(){return Ma(n)},pagination:!1,key:n.id}))}))),m.a.createElement(L.a,{loaderFunction:function(){return e.loadTreatmentPlans(t.state.next)},loading:this.state.loading,hidden:!this.state.next}))}}]),t}(m.a.Component);function Ma(e){return e?m.a.createElement("div",null,e.doctor?m.a.createElement(g.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+e.doctor.user.first_name," ")):null,e.practice?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null):null}function Fa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Aa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fa(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fa(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var La=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).calculateItem=function(e){var t=a.props.form.getFieldsValue;console.log(t()),a.setState((function(e){Object(D.a)(e.tableFormValues).forEach((function(e){}))}))},a.removeTests=function(e,t){a.setState((function(a){return{addedLabs:Aa({},a.addedLabs,Object(w.a)({},t.id,!1)),tableFormValues:Object(D.a)(Object(na.remove)(a.tableFormValues,(function(t){return t._id!=e})))}}))},a.add=function(e){console.log("item",e),a.setState((function(t){console.log("preview",t);var a=Math.random().toFixed(7);return t.addedLabs[e.id]?(Object(F.a)(N.fc,"Item Already Added"),!1):{addedLabs:Aa({},t.addedLabs,Object(w.a)({},e.id,!0)),tableFormValues:[].concat(Object(D.a)(t.tableFormValues),[Aa({},e,{_id:a})])}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,a){if(!e){var n={treatment:[],patient:t.props.match.params.id};t.state.tableFormValues.forEach((function(e){e.cost=a.cost[e._id];var t={name:e.id,cost:e.cost,instruction:e.instruction,is_active:!0,practice:e.practice,margin:e.margin};n.treatment.push(t)}));console.log("DataSet",n)}}))},a.state={lab_test:[],tableFormValues:[],addedLabs:{}},console.log("urgent",a.props.active_practiceId),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadLabs()}},{key:"loadLabs",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Fb,[e.props.active_practiceId]),(function(t){e.setState({lab_test:t})}),(function(){}))}},{key:"render",value:function(){var e=this,t=this.props.form,a=t.getFieldDecorator,n=(t.getFieldValue,t.getFieldsValue,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}}),r=[{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return m.a.createElement("span",null,m.a.createElement("b",null,e))}},{title:"Cost",dataIndex:"cost",key:"cost",render:function(e,t){return m.a.createElement("span",null,m.a.createElement(S.a.Item,Object.assign({key:"cost[".concat(t._id,"]")},n),a("cost[".concat(t._id,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}],initialValue:t.cost})))}},{title:"Total",dataIndex:"total",key:"total",render:function(t,a){return m.a.createElement("span",null,t,m.a.createElement("a",{onClick:function(){return e.removeTests(a._id,a)}},m.a.createElement(j.a,{type:"close-circle",theme:"twoTone",twoToneColor:"#f00"})))}}];return m.a.createElement("div",null,m.a.createElement(S.a,{onSubmit:this.handleSubmit},m.a.createElement(k.a,{title:"Patient Lab Orders",bodyStyle:{padding:0},extra:m.a.createElement(S.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0}}),m.a.createElement(P.a,{type:"primary",htmlType:"submit"},"Save Lab Orders"))},m.a.createElement(f.a,{gutter:16},m.a.createElement(y.a,{span:7},m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.lab_test,renderItem:function(t){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:t.name}),m.a.createElement(P.a,{type:"primary",size:"small",shape:"circle",onClick:function(){return e.add(t)},icon:"arrow-right"}))}})),m.a.createElement(y.a,{span:17},m.a.createElement(ke.a,{pagination:!1,bordered:!0,dataSource:this.state.tableFormValues,columns:r}))))))}}]),t}(m.a.Component),Va=S.a.create()(La),Na=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,loading:!1},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"Time",dataIndex:"created_at",key:"name",render:function(e){return m.a.createElement("span",null,G()(e).format("LLL"))}},{title:"Drug",key:"drug"},{title:"Quantity",dataIndex:"qunatity",key:"quantity"},{title:"Cost Per  Unit",dataIndex:"cost",key:"cost"},{title:"Completed",key:"is_completed",render:function(e,t){return m.a.createElement(fe.a,{checked:t.is_completed})}},{title:"Action",key:"action",render:function(t,a){return m.a.createElement("span",null,m.a.createElement("a",{onClick:function(){return e.editPrescriptionData(a)}},"Edit"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{href:"javascript:;"},"Delete"))}}];return m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/labtrackings/add",render:function(t){return m.a.createElement(Va,Object.assign({},e.state,t))}}),m.a.createElement(k.a,{title:this.state.currentPatient?this.state.currentPatient.user.first_name+" Lab Order":"Patients Lab Order",extra:m.a.createElement(P.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/emr/labtrackings/add"},m.a.createElement(P.a,null,m.a.createElement(j.a,{type:"plus"}),"Add")))},m.a.createElement(ke.a,{loading:this.state.loading,columns:t,dataSource:this.state.payments}))))}}]),t}(m.a.Component),Ra=(a(140),a(103)),Ba=(a(392),a(393));function za(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ya(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?za(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):za(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var qa=M.a.Search,Ga=Ft.a.TabPane,Wa=Ba.a.Text,Ha={_id:null,quantity:0,batch:null},Ua=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).selectedDefaultDate=function(e){a.setState({selectedDate:e})},a.loadEditInvoiceData=function(){var e=Object(o.a)(a),t=a.props.editInvoice;a.setState((function(a){var n=[];t.procedure.forEach((function(t){var a=Math.random().toFixed(7);n.push(Ya({},t.procedure_data,{},t,{selectedDoctor:t.doctor_data,selectedDate:G()(t.date).isValid()?G()(t.date):null,_id:a,item_type:Y.ub})),e.changeNetPrice(a,t.discount)}));var r=Ya({},a.stocks);return t.inventory.forEach((function(t){var i=Math.random().toFixed(7);if(a.itemBatches[t.inventory]){if(r[t.inventory]){var l=r[t.inventory];l[t.batch_number],l[t.batch_number]+=t.unit}else{var c={};c[t.batch_number]=t.unit,r[t.inventory]=c}a.itemBatches[t.inventory].forEach((function(e){e.batch_number==t.batch_number&&(t.selectedBatch=e)}))}n.push(Ya({},t.inventory_item_data,{},t,{selectedDoctor:t.doctor_data,_id:i,item_type:Y.X,selectOption:!!t.offers})),e.changeNetPrice(i,t.discount)})),{tableFormValues:n,selectedDate:G()(t.date).isValid()?G()(t.date):null,stocks:r,notes:t.notes}}))},a.remove=function(e){a.setState((function(t){var a=[];return t.tableFormValues.forEach((function(t){t._id!=e&&a.push(t)})),{tableFormValues:a}}))},a.add=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random().toFixed(7);a.setState((function(a){return e.item_type==Y.ub?e=Ya({},e,{id:void 0,unit_cost:e.cost,procedure:e.id,selectedDoctor:a.selectedDoctor?a.selectedDoctor:null,selectedDate:G()(),taxes:e.taxes.map((function(e){return e.id}))}):e.item_type==Y.X&&(e=Ya({},e,{id:void 0,inventory:e.id,unit_cost:e.retail_without_tax,selectedDoctor:a.selectedDoctor?a.selectedDoctor:null})),{tableFormValues:[Ya({},Ha,{},e,{id:void 0,_id:t})].concat(Object(D.a)(a.tableFormValues))}}))},a.selectDoctor=function(e,t,n){a.setState((function(a){var r=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?r.push(Ya({},a,{selectedDoctor:e})):r.push(a)})),{tableFormValues:r}}))},a.selectedDate=function(e,t,n){a.setState((function(a){var r=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?r.push(Ya({},a,{selectedDate:e})):r.push(a)})),{tableFormValues:r}}))},a.selectBatch=function(e,t,n){a.setState((function(a){var r=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?r.push(Ya({},a,{selectedBatch:e})):r.push(a)})),{tableFormValues:r}}))},a.addPrescription=function(e){var t=Object(o.a)(a);e.drugs.forEach((function(a){a.inventory.maintain_inventory&&t.add(Ya({},a.inventory,{item_type:Y.X,inventory:e.inventory.id,id:void 0}))})),t.setState((function(t){return{selectedPrescriptions:[].concat(Object(D.a)(t.selectedPrescriptions),[e.id])}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);a.props.form.validateFields((function(a,n){if(!a){t.setState({});var r={promo_code:t.state.promoCode,practice:t.props.active_practiceId,patient:t.props.match.params.id,unit:null,cost:null,discount:null,taxes:0,total:null,procedure:[],inventory:[],prescription:t.state.selectedPrescriptions,notes:n.notes,date:t.state.selectedDate&&G()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null};t.state.tableFormValues.forEach((function(e){switch(e.unit=n.unit[e._id],e.taxes=n.taxes[e._id],e.item_type){case Y.ub:r.procedure.push({name:e.name,unit:e.unit,procedure:e.procedure,default_notes:null,is_active:!0,margin:e.margin,taxes:e.taxes,unit_cost:e.unit_cost,discount:e.discount,discount_type:e.discount_type,offers:e.offers,doctor:e.selectedDoctor?e.selectedDoctor.id:null,id:t.props.editId?e.id:void 0});break;case Y.X:r.inventory.push({inventory:e.inventory,name:e.name,unit:e.unit,taxes:e.taxes,unit_cost:e.unit_cost,discount:e.discount,discount_type:e.discount_type,offers:e.offers,doctor:e.selectedDoctor?e.selectedDoctor.id:null,instruction:e.instruction,is_active:!0,batch_number:e.selectedBatch?e.selectedBatch.batch_number:null,id:t.props.editId?e.id:void 0});break;default:return null}}));var i=function(a){if(t.setState({saveLoading:!1}),Object(F.a)("Inventory updated successfully"),t.props.loadData(),e)t.props.history.goBack();else{var n="/patient/"+t.props.match.params.id+"/billing/payments/add?invoices="+a.id;t.props.history.push(n)}},l=function(){t.setState({saveLoading:!1})};t.props.editId?Object(F.l)(Object(F.f)(A.hd,[t.props.editId]),r,i,l):Object(F.j)(A.V,r,i,l)}}))},a.addItemThroughQR=function(e){var t=Object(o.a)(a);t.setState({loadingQr:!0});var n=e.split("*");Object(F.c)(A.Wc,(function(e){var a=t.props.form,r=a.setFieldsValue,i=(a.getFieldsValue,a.getFieldValue),l=Math.random().toFixed(7),c=!0;if(t.state.tableFormValues.forEach((function(e){if(e.name==n[0]){var t=e._id,a=e.selectedBatch.batch_number,l=i("unit[".concat(t,"]"));a==n[1]&&(c=!1,r(Object(w.a)({},"unit[".concat(t,"]"),l+1)))}})),c){var o=null;e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(t){t.batch_number==n[1]&&(e.selectedBatch=t,o=t.unit_cost)})),t.add(Ya({},e,{item_type:Y.X}),l),r(Object(w.a)({},"unit_cost[".concat(l,"]"),o))}t.setState((function(e){return{loadingQr:!1,qrValue:""}}))}),(function(){}),{qr:e,form:"Invoice"})},a.setQrValue=function(e){var t=e.target.value;a.setState({qrValue:t})},a.searchValues=function(e,t){var n=Object(o.a)(a),r=e.target.value;a.setState({searchItem:r},(function(){t==Y.X?n.loadInventoryItemList():t==Y.sb?n.loadPrescriptions():t==Y.ub&&n.loadProcedures()}))},a.changeNetPrice=function(e,t){var n=Object(o.a)(a),r=a.props.form,i=r.getFieldsValue;r.setFields;setTimeout((function(){var a=i();a.unit_cost[e]||a.unit[e]||a.discount[e]||a.discount_type[e]?n.setState((function(n){var r=[];return n.tableFormValues.forEach((function(i){if(i._id==e){var l=0,c=0,o="%",s=null,u=!(!i.selectOption&&0!=i.selectOption)&&i.selectOption;a.taxes[e].forEach((function(e){n.taxes_list.forEach((function(t){t.id==e&&(l+=t.tax_value)}))})),t&&"0"==t&&(u=!1),a.discount_type&&a.discount_type[e]?(c=a.discount[e],o=a.discount_type[e],s=null):(c=a.discount[e]?a.discount[e].toString().split("#")[0]:"",o=a.discount[e]?a.discount[e].toString().split("#")[1]:"",s=a.discount[e]?a.discount[e].toString().split("#")[2]:null);var d=a.unit[e]*(a.unit_cost[e]?a.unit_cost[e]:0);"%"==o&&c?(c>100&&(c=100),d*=1-.01*c):"INR"==o&&c&&(d>c?d-=c:d=0);var m=(d*=1+.01*l)/a.unit[e];r.push(Ya({},i,{total_unit_cost:m,total:d,selectOption:u,discount:c,discount_type:o,offers:s}))}else r.push(i)})),{tableFormValues:r}})):n.setState({retail_price:0}),n.checkPromoCode()}),1e3)},a.applyPromoCodeDiscounts=function(e){var t=Object(o.a)(a),n=t.props.form,r=n.setFieldsValue,i=n.getFieldsValue,l=[],c=i(),s=e,u={};t.state.tableFormValues.forEach((function(e){var a=0,n=0,r=!(!e.selectOption&&0!=e.selectOption)&&e.selectOption;c.taxes[e._id].forEach((function(e){t.state.taxes_list.forEach((function(t){t.id==e&&(a+=t.tax_value)}))}));var i=c.unit[e._id]*(c.unit_cost[e._id]?c.unit_cost[e._id]:0);s&&(i>s?(i-=s,n=s,s=0):(s-=i,n=i,i=0));var o=(i*=1+.01*a)/c.unit[e._id];l.push(Ya({},e,{total_unit_cost:o,total:i,selectOption:r,discount:s,discount_type:"INR",offers:null})),u["discount[".concat(e._id,"]")]=n.toFixed(2),u["discount_type[".concat(e._id,"]")]="INR"})),t.setState({tableFormValues:l}),r(u)},a.loadLoyaltyDiscount=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.gc,[a.props.active_practiceId]),(function(t){e.setState({offers:t})}),(function(){e.setState({})}))},a.onChangeOption=function(e,t){Object(o.a)(a).setState((function(e){var a=[];return e.tableFormValues.forEach((function(e){e._id==t?a.push(Ya({},e,{selectOption:!0})):a.push(e)})),{tableFormValues:a}}))},a.onChangeOffer=function(e,t){Object(o.a)(a).setState((function(a){var n=[];return a.tableFormValues.forEach((function(r){r._id==t?("none"==e&&n.push(Ya({},r,{loyaltyDiscount:null})),"0"==e?n.push(Ya({},r,{selectOption:!1})):a.offers.forEach((function(t){t.id==e&&n.push(Ya({},r,{loyaltyDiscount:t.discount}))}))):n.push(r)})),{tableFormValues:n}}))},a.onchangeDiscountSimple=function(e,t){console.log(e,t),Object(o.a)(a).setState((function(a){var n=[];return a.tableFormValues.forEach((function(a){if(a._id==t){var r=a.unit_cost/(1+.01*e);console.log(r),n.push(Ya({},a,{loyaltyDiscount:e}))}else n.push(a)})),{tableFormValues:n}}))},a.enterPromoCode=function(e){a.setState({promoCode:e.target.value})},a.calculateGrandTotalWithoutDiscount=function(){var e=0,t=Object(o.a)(a),n=(0,a.props.form.getFieldsValue)();return a.state.tableFormValues.forEach((function(a){var r=0;n.taxes[a._id].forEach((function(e){t.state.taxes_list.forEach((function(t){t.id==e&&(r+=t.tax_value)}))}));var i=n.unit[a._id]*(n.unit_cost[a._id]?n.unit_cost[a._id]:0);e+=i*=1+.01*r})),e},a.checkPromoCode=function(e){var t=Object(o.a)(a);t.setState({promoCodeCheckLoading:!0});var n={promo_code:a.state.promoCode,practice:a.props.active_practiceId,patient:t.props.match.params.id,amount:a.calculateGrandTotalWithoutDiscount()};n.promo_code?Object(F.c)(A.O,(function(e){t.setState({appliedPromoCodeDiscount:e.discount,promoCodeCheckLoading:!1}),t.applyPromoCodeDiscounts(e.discount)}),(function(){t.setState({promoCodeCheckLoading:!1,appliedPromoCodeDiscount:null,promoCode:""})}),n):t.setState({promoCodeCheckLoading:!1})},a.removePromoCode=function(){a.setState({appliedPromoCodeDiscount:0,promoCodeCheckLoading:!1,promoCode:""}),a.applyPromoCodeDiscounts(0)},a.state={classType:e.type,tableFormValues:[],maxQuantityforConsume:{},items:{},practiceDoctors:[],selectedPrescriptions:[],selectedDate:G()(),stocks:{},itemBatches:{},saveLoading:!1,qrValue:"",searchItem:"",selectedDoctor:{},tempValues:{},offers:[],loading:!1,taxes_list:[],promoCode:"",appliedPromoCodeDiscount:null,promoCodeCheckLoading:!1},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(de.d)(this),this.loadInventoryItemList(),this.loadProcedures(),this.loadPrescriptions(),this.loadTaxes(),this.loadLoyaltyDiscount(),this.props.editId&&setTimeout(function(){e.setState({loading:!1}),e.loadEditInvoiceData()}.bind(this),2e3)}},{key:"loadInventoryItemList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=this.state.searchItem;t.setState({loadingInventory:!0});var n=function(e){var n=e.results,r=[];t.state.searchItem==a&&t.setState((function(t){var a=Ya({},t.stocks),i={};n.forEach((function(e){if(e.item_type==Y.z){if(r.push(e),a[e.id]){var t=a[e.id];e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(e){t[e.batch_number],t[e.batch_number]+=e.quantity}))}else{var n={};e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(e){n[e.batch_number]=e.quantity})),a[e.id]=n}i[e.id]=e.item_type_stock.item_stock}}));var l=t.items;return l[Y.X]=Ya({},e,{results:r}),{items:l,stocks:Ya({},t.stocks,{},a),itemBatches:Ya({},t.itemBatches,{},i),loadingInventory:!1}}),(function(){t.props.editId&&t.loadEditInvoiceData()}))},r=function(){t.setState({loadingInventory:!1})},i={practice:this.props.active_practiceId,maintain_inventory:!0,page:e};this.state.searchItem&&(i.item_name=a),Object(F.c)(A.xb,n,r,i)}},{key:"loadProcedures",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=this.state.searchItem,n=function(e){var n=t.state.items;n[Y.ub]=e,t.state.searchItem==a&&t.setState({items:n})},r=function(){},i={practice:this.props.active_practiceId,page:e};this.state.searchItem&&(i.name=a),Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),n,r,i)}},{key:"loadPrescriptions",value:function(){var e=this,t=this.state.searchItem,a={practice:this.props.active_practiceId};this.state.searchItem&&(a.item_name=t),Object(F.c)(Object(F.f)(A.Hd,[e.props.match.params.id]),(function(a){e.state.searchItem==t&&e.setState((function(e){return{items:Ya({},e.items,Object(w.a)({},Y.sb,a))}}))}),(function(){}),a)}},{key:"loadTaxes",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Dd,[this.props.active_practiceId]),(function(t){e.setState({taxes_list:t})}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=this.props.form.getFieldDecorator,r={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:24},md:{span:24},lg:{span:24},xl:{span:24}}};a("keys",{initialValue:[]});var i=[{title:"Item Name",key:"item_name",dataIndex:"name",width:180,render:function(e,n){switch(n.item_type){case Y.ub:return m.a.createElement(S.a.Item,Object.assign({key:"name[".concat(n._id,"]")},r),a("name[".concat(n._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:e,rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(M.a,{min:0,placeholder:"Item name",size:"small"})),m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(pt.a,{placement:"topCenter",overlay:m.a.createElement(Ie.a,null,t.state.practiceDoctors.map((function(e){return m.a.createElement(Ie.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return t.selectDoctor(e,n._id,Y.ub)}},e.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,n.selectedDoctor.user?n.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(T.a,{value:n.selectedDate,size:"small",onChange:function(e){return t.selectedDate(e,n._id,Y.ub)},format:"DD-MM-YYYY"}));case Y.sb:return m.a.createElement("b",null,n.name);case Y.X:return m.a.createElement("div",null,m.a.createElement("span",null,n.name),m.a.createElement("span",null,m.a.createElement("br",null),"by \xa0\xa0"),m.a.createElement(pt.a,{placement:"topCenter",overlay:m.a.createElement(Ie.a,null,t.state.practiceDoctors.map((function(e){return m.a.createElement(Ie.a.Item,{key:e.id},m.a.createElement("a",{onClick:function(){return t.selectDoctor(e,n._id,Y.X)}},e.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,n.selectedDoctor.user?n.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null,m.a.createElement("br",null),"from batch \xa0\xa0"),m.a.createElement(pt.a,{placement:"topCenter",overlay:m.a.createElement(Ie.a,null,t.state.itemBatches[n.inventory]&&t.state.itemBatches[n.inventory].map((function(e,a){return G()()>=G()(e.expiry_date)?m.a.createElement(Ie.a.Item,{key:a,disabled:!0},e.batch_number,"\xa0(",e.quantity,") \xa0\xa0",e.expiry_date):m.a.createElement(Ie.a.Item,{key:a},m.a.createElement("a",{onClick:function(){return t.selectBatch(e,n._id,Y.X)}},e.batch_number,"\xa0(",e.quantity,") \xa0\xa0",e.expiry_date))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,n.selectedBatch?n.selectedBatch.batch_number:"Select Batch"))));default:return null}}}];return i=(i=i.concat([{title:"Unit",key:"unit",width:100,dataIndex:"unit",render:function(n,i){return i.item_type==Y.X?m.a.createElement(S.a.Item,Object.assign({key:"unit[".concat(i._id,"]")},r),a("unit[".concat(i._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:i.unit||1,rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(C.a,{min:1,max:i.selectedBatch&&t.state.stocks[i.inventory]&&t.state.stocks[i.inventory][i.selectedBatch.batch_number]?t.state.stocks[i.inventory][i.selectedBatch.batch_number]:0,placeholder:"units",size:"small",onChange:function(t){return e.changeNetPrice(i._id,i.discount)},disabled:!(i.selectedBatch&&t.state.stocks[i.inventory]&&t.state.stocks[i.inventory][i.selectedBatch.batch_number])}))):m.a.createElement(S.a.Item,Object.assign({key:"unit[".concat(i._id,"]")},r),a("unit[".concat(i._id,"]"),{initialValue:i.unit||1,validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(C.a,{min:1,max:100,placeholder:"unit",size:"small",onChange:function(t){return e.changeNetPrice(i._id,i.discount)}})))}},{title:"Unit Cost",key:"unit_cost",width:100,dataIndex:"unit_cost",render:function(e,n){return m.a.createElement(S.a.Item,Object.assign({key:"unit_cost[".concat(n._id,"]")},r),a("unit_cost[".concat(n._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:n.item_type==Y.X?n.retail_without_tax:n.cost,rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(C.a,{min:1,placeholder:"Unit Cost",size:"small",onChange:function(){return t.changeNetPrice(n._id,n.discount)}})))}},{title:"Discount",key:"discount",dataIndex:"discount",render:function(n,i){return i.selectOption?m.a.createElement(S.a.Item,{key:"discount[".concat(i._id,"]"),extra:m.a.createElement("span",null,i&&i.discount?i.discount+" "+i.discount_type+" Discount":null," ")},a("discount[".concat(i._id,"]"),{initialValue:i.offers,validateTrigger:["onChange","onBlur"]})(m.a.createElement(x.a,{style:{width:150},onChange:function(e){return t.changeNetPrice(i._id,e)},size:"small",disabled:e.state.appliedPromoCodeDiscount},m.a.createElement(x.a.Option,{value:"0"},"Custom Offer"),t.state.offers.map((function(e){return m.a.createElement(x.a.Option,{value:e.discount+"#"+e.unit+"#"+e.id},e.code)}))))):m.a.createElement(S.a.Item,Object.assign({extra:m.a.createElement("a",{onClick:function(){return t.onChangeOption("selectOption",i._id)},disabled:e.state.appliedPromoCodeDiscount},"Choose Offer"),key:"discount[".concat(i._id,"]")},r),a("discount[".concat(i._id,"]"),{initialValue:i.discount?i.discount:0,validateTrigger:["onChange","onBlur"]})(m.a.createElement(M.a,{placeholder:"discount",disabled:e.state.appliedPromoCodeDiscount,addonAfter:a("discount_type[".concat(i._id,"]"),{initialValue:i.discount_type||"%"})(m.a.createElement(x.a,{onChange:function(e){return t.changeNetPrice(i._id,e)},disabled:e.state.appliedPromoCodeDiscount},Y.p.map((function(e){return m.a.createElement(x.a.Option,{value:e.value}," ",e.value)})))),size:"small",style:{width:150},onChange:function(t){return e.changeNetPrice(i._id,t.target.value)}})))}},{title:"Taxes",key:"taxes",dataIndex:"taxes",render:function(n,i){return m.a.createElement(S.a.Item,Object.assign({key:"taxes[".concat(i._id,"]")},r),a("taxes[".concat(i._id,"]"),{initialValue:i.taxes||[],validateTrigger:["onChange","onBlur"]})(m.a.createElement(x.a,{placeholder:"Taxes",size:"small",mode:"multiple",style:{width:150},onChange:function(){return t.changeNetPrice(i._id,i.discount)}},e.state.taxes_list&&e.state.taxes_list.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name,"@",e.tax_value,"%")})))))}},{title:"Total Unit Cost",key:"total_unit_cost",width:80,align:"right",dataIndex:"total_unit_cost",render:function(e,t){return m.a.createElement("span",null,e?e.toFixed(2):"0.00")}},{title:"Total",key:"total",width:80,align:"right",dataIndex:"total",render:function(e,t){return e?e.toFixed(2):"0.00"}}])).concat([{key:"_id",dataIndex:"_id",render:function(e,a){return m.a.createElement(P.a,{icon:"close",onClick:function(){return t.remove(a._id)},type:"danger",shape:"circle",size:"small"})}}]),m.a.createElement("div",null,m.a.createElement(n.a,{spinning:this.state.saveLoading,tip:"Saving Invoice..."},m.a.createElement(n.a,{spinning:this.state.promoCodeCheckLoading,tip:"Checking Promo Code and Discounts..."},m.a.createElement(k.a,{title:this.props.editId?"Edit Invoice (INV "+this.props.editId+")":"Add Invoice",extra:m.a.createElement(qa,{loading:this.state.loadingQr,value:this.state.qrValue,onChange:this.setQrValue,placeholder:"Search QR Code",onSearch:this.addItemThroughQR,style:{width:200}}),bodyStyle:{padding:0}},m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement(Ft.a,{size:"small",type:"card"},m.a.createElement(Ga,{tab:Y.X,key:Y.X},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(M.a.Search,{placeholder:"Search in "+Y.X,onChange:function(t){return e.searchValues(t,Y.X)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",loading:this.state.loadingInventory,dataSource:this.state.items&&this.state.items[Y.X]?this.state.items[Y.X].results:[],renderItem:function(t){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:t.name+" ("+t.total_quantity+")"}),m.a.createElement(P.a,{type:"primary",size:"small",shape:"circle",onClick:function(){return e.add(Ya({},t,{item_type:Y.X}))},icon:"arrow-right"}))}}),this.state.items&&this.state.items[Y.X]?m.a.createElement("div",{style:{textAlign:"center"}},m.a.createElement("a",{style:{margin:5},disabled:!this.state.items[Y.X].previous,onClick:function(){return e.loadInventoryItemList(e.state.items[Y.X].previous)}},m.a.createElement(j.a,{type:"left"}),"Previous"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{style:{margin:5},disabled:!this.state.items[Y.X].next,onClick:function(){return e.loadInventoryItemList(e.state.items[Y.X].next)}},"Next",m.a.createElement(j.a,{type:"right"}))):null),m.a.createElement(Ga,{tab:Y.sb,key:Y.sb},m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.items?this.state.items[Y.sb]:[],renderItem:function(t){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:t.drugs.map((function(e){return m.a.createElement("div",null,m.a.createElement("span",null,e.name)," ",e.inventory.maintain_inventory?null:m.a.createElement(g.a,{color:"red",style:{float:"right",lineHeight:"18px"}},"Not Sold"),m.a.createElement("br",null))})),description:t.doctor?m.a.createElement(g.a,{color:t.doctor?t.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+t.doctor.user.first_name," ")):null}),m.a.createElement(P.a,{type:"primary",size:"small",shape:"circle",onClick:function(){return e.addPrescription(Ya({},t))},icon:"arrow-right"}))}})),m.a.createElement(Ga,{tab:Y.ub,key:Y.ub},m.a.createElement("div",{style:{backgroundColor:"#ddd",padding:8}},m.a.createElement(M.a.Search,{placeholder:"Search in "+Y.ub,onChange:function(t){return e.searchValues(t,Y.ub)}})),m.a.createElement(b.a,{size:"small",itemLayout:"horizontal",dataSource:this.state.items&&this.state.items[Y.ub]?this.state.items[Y.ub].results:[],renderItem:function(t){return m.a.createElement(b.a.Item,null,m.a.createElement(b.a.Item.Meta,{title:t.name}),m.a.createElement(P.a,{type:"primary",size:"small",shape:"circle",onClick:function(){return e.add(Ya({},t,{item_type:Y.ub}))},icon:"arrow-right"}))}}),this.state.items&&this.state.items[Y.ub]?m.a.createElement("div",{style:{textAlign:"center"}},m.a.createElement("a",{style:{margin:5},disabled:!this.state.items[Y.ub].previous,onClick:function(){return e.loadProcedures(e.state.items[Y.ub].previous)}},m.a.createElement(j.a,{type:"left"}),"Previous"),m.a.createElement(v.a,{type:"vertical"}),m.a.createElement("a",{style:{margin:5},disabled:!this.state.items[Y.ub].next,onClick:function(){return e.loadProcedures(e.state.items[Y.ub].next)}},"Next",m.a.createElement(j.a,{type:"right"}))):null))),m.a.createElement(y.a,{span:18},m.a.createElement(S.a,null,m.a.createElement(ke.a,{pagination:!1,loading:t.state.loading,bordered:!0,dataSource:this.state.tableFormValues,columns:i}),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(k.a,null,m.a.createElement(y.a,{span:8},m.a.createElement(S.a.Item,Object.assign({label:"Notes",key:"notes"},r),a("notes",{initialValue:this.state.notes,validateTrigger:["onChange","onBlur"]})(m.a.createElement(M.a.TextArea,{row:2,placeholder:"unit",size:"small"}))),m.a.createElement("h3",null,"Grand Total: ",m.a.createElement("b",null,this.state.tableFormValues.reduce((function(e,t){return(parseFloat(e)+(t&&t.total?t.total:0)).toFixed(2)}),0)))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(T.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDefaultDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement(S.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0,float:"right"}}),m.a.createElement(P.a,{type:"primary",htmlType:"submit",onClick:function(){return e.handleSubmit(!0)},style:{margin:5}},"Save Invoice"),m.a.createElement(P.a,{type:"primary",htmlType:"submit",onClick:function(){return e.handleSubmit(!1)},style:{margin:5}},"Save & Create Payment"),t.props.history?m.a.createElement(P.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null)))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:12,style:{padding:10}},m.a.createElement("div",null,this.state.appliedPromoCodeDiscount?m.a.createElement("div",null,m.a.createElement(g.a,null,"'",this.state.promoCode,"' Applied ",m.a.createElement(j.a,{onClick:function(){return e.removePromoCode()},theme:"twoTone",twoToneColor:"#f00",type:"close-circle"})),m.a.createElement(Wa,{type:"success"},m.a.createElement("br",null),"Discount INR ",this.state.appliedPromoCodeDiscount)):m.a.createElement("div",null,m.a.createElement(qa,{enterButton:"Apply",value:this.state.promoCode,placeholder:"Promo Code",onChange:this.enterPromoCode,onSearch:this.checkPromoCode,style:{width:200}})))))))))))}}]),t}(m.a.Component),Ka=S.a.create()(Ua);function Xa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Qa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Xa(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Xa(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}M.a.Search,T.a.MonthPicker,Ft.a.TabPane;var Za={_id:null,quantity:0,batch:null},Ja=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).selectedDefaultDate=function(e){a.setState({selectedDate:e})},a.loadEditInvoiceData=function(){var e=a.props.editInvoice;a.setState((function(t){var a=[];e.procedure.forEach((function(e){a.push(Qa({},e.procedure_data,{},e,{selectedDoctor:e.doctor_data,selectedDate:G()(e.date).isValid()?G()(e.date):null,_id:Math.random().toFixed(7),item_type:Y.ub}))}));var n=Qa({},t.stocks);return e.inventory.forEach((function(e){if(t.itemBatches[e.inventory]){if(n[e.inventory]){var r=n[e.inventory];r[e.batch_number],r[e.batch_number]+=e.unit}else{var i={};i[e.batch_number]=e.unit,n[e.inventory]=i}t.itemBatches[e.inventory].forEach((function(t){t.batch_number==e.batch_number&&(e.selectedBatch=t)}))}a.push(Qa({},e.inventory_item_data,{},e,{selectedDoctor:e.doctor_data,_id:Math.random().toFixed(7),item_type:Y.X}))})),{tableFormValues:a,selectedDate:G()(e.date).isValid()?G()(e.date):null,stocks:n}}))},a.remove=function(e){a.setState((function(t){var a=[];return t.tableFormValues.forEach((function(t){t._id!=e&&a.push(t)})),{tableFormValues:a}}))},a.add=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random().toFixed(7);a.setState((function(a){return e.item_type==Y.ub?e=Qa({},e,{id:void 0,unit_cost:e.cost,procedure:e.id,selectedDoctor:a.selectedDoctor?a.selectedDoctor:null,selectedDate:G()(),taxes:e.taxes.map((function(e){return e.id}))}):e.item_type==Y.X&&(e=Qa({},e,{id:void 0,inventory:e.id,unit_cost:e.retail_without_tax,selectedDoctor:a.selectedDoctor?a.selectedDoctor:null})),{tableFormValues:[].concat(Object(D.a)(a.tableFormValues),[Qa({},Za,{},e,{id:void 0,_id:t})])}}))},a.selectDoctor=function(e,t,n){a.setState((function(a){var r=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?r.push(Qa({},a,{selectedDoctor:e})):r.push(a)})),{tableFormValues:r}}))},a.selectedDate=function(e,t,n){a.setState((function(a){var r=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?r.push(Qa({},a,{selectedDate:e})):r.push(a)})),{tableFormValues:r}}))},a.selectBatch=function(e,t,n){a.setState((function(a){var r=[];return a.tableFormValues.forEach((function(a){a._id==t&&a.item_type==n?r.push(Qa({},a,{selectedBatch:e})):r.push(a)})),{tableFormValues:r}}))},a.addPrescription=function(e){var t=Object(o.a)(a);e.drugs.forEach((function(a){a.inventory.maintain_inventory&&t.add(Qa({},a.inventory,{item_type:Y.X,inventory:e.inventory.id,id:void 0}))})),t.setState((function(t){return{selectedPrescriptions:[].concat(Object(D.a)(t.selectedPrescriptions),[e.id])}}))},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){t.setState({saveLoading:!0});var r={bank:"",number:"",practice:t.props.active_practiceId,return_mode:null,invoice:a.props.editInvoice.id,procedure:[],inventory:[],notes:n.notes,patient:t.props.match.params.id,staff:a.props.editInvoice.staff_data?a.props.editInvoice.staff_data.id:null,prescription:t.state.selectedPrescriptions,date:t.state.selectedDate&&G()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null,with_tax:!!a.state.return_with_tax,cash_return:n.cash_return,advance_value:a.state.returnCashAvailable-n.cash_return||0};t.state.tableFormValues.forEach((function(e){e.unit=n.unit[e._id];var t=e.id;if(delete e.id,e.unit)switch(e.item_type){case Y.ub:r.procedure.push(Qa({},e,{unit:e.unit,procedure_inv:t}));break;case Y.X:r.inventory.push(Qa({},e,{unit:e.unit,inventory_inv:t}));break;default:return null}}));Object(F.j)(A.Db,r,(function(e){t.setState({saveLoading:!1}),Object(F.a)("Inventory updated successfully"),t.props.loadData();var a="/patient/"+t.props.match.params.id+"/billing/invoices";t.props.history.push(a)}),(function(){t.setState({saveLoading:!1})}))}}))},a.addItemThroughQR=function(e){var t=Object(o.a)(a);t.setState({loadingQr:!0});var n=e.split("*");Object(F.c)(A.Wc,(function(e){var a=t.props.form,r=a.setFieldsValue,i=(a.getFieldsValue,a.getFieldValue),l=Math.random().toFixed(7),c=!0;if(t.state.tableFormValues.forEach((function(e){if(e.name==n[0]){var t=e._id,a=e.selectedBatch.batch_number,l=i("unit[".concat(t,"]"));a==n[1]&&(c=!1,r(Object(w.a)({},"unit[".concat(t,"]"),l+1)))}})),c){var o=null;e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(t){t.batch_number==n[1]&&(e.selectedBatch=t,o=t.unit_cost)})),t.add(Qa({},e,{item_type:Y.X}),l),r(Object(w.a)({},"unit_cost[".concat(l,"]"),o))}t.setState((function(e){return{loadingQr:!1,qrValue:""}}))}),(function(){}),{qr:e,form:"Invoice"})},a.setQrValue=function(e){var t=e.target.value;a.setState({qrValue:t})},a.searchValues=function(e){var t=e.target.value;a.setState({searchItem:t},(function(){this.loadInventoryItemList()}))},a.changeNetPrice=function(e){var t=Object(o.a)(a),n=a.props.form,r=n.getFieldsValue;n.setFields;setTimeout((function(){var a=r();a.total_unit_cost[e]?t.setState((function(t){var n=[];return t.tableFormValues.forEach((function(r){if(r._id==e){var i=0;a.taxes[e].forEach((function(e){t.taxes_list.forEach((function(t){t.id==e&&(i+=t.tax_value)}))}));var l=a.total_unit_cost[e]/(1+.01*i);n.push(Qa({},r,{unit_cost:l}))}else n.push(r)})),{tableFormValues:n}})):t.setState({retail_price:0})}),1e3)},a.onChangeHandle=function(e){var t=Object(o.a)(a);a.setState({return_with_tax:e.target.checked},(function(){t.calculateReturnCashAvailable()}))},a.calculateReturnCashAvailable=function(){var e=Object(o.a)(a),t=a.state.editInvoice.payments.reduce((function(e,t){return e+t.pay_amount}),0),n=a.state.editInvoice.total-t,r=0,i=a.props.form.getFieldsValue;setTimeout((function(){var t=i(),a=e.state.return_with_tax;e.state.tableFormValues.forEach((function(e){var n=t.unit[e._id];e.item_type==Y.X?(r+=n*e.unit_cost,r+=a?e.tax_value/e.unit*n:null):e.item_type==Y.sb?(r+=n*e.unit_cost,r+=a?e.tax_value/e.unit*n:null):e.item_type==Y.ub&&(r+=n*e.unit_cost,r+=a?e.tax_value/e.unit*n:null)})),e.setState({returnCashAvailable:(r>n?r-n:0).toFixed(2)})}),500)},a.state={editInvoice:a.props.editInvoice,classType:e.type,tableFormValues:[],maxQuantityforConsume:{},items:{},practiceDoctors:[],selectedPrescriptions:[],selectedDate:G()(),stocks:{},itemBatches:{},saveLoading:!1,qrValue:"",searchItem:"",return_with_tax:!1,returnCashAvailable:0},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){Object(de.d)(this),this.loadInventoryItemList(),this.loadProcedures(),this.loadPrescriptions(),this.loadTaxes(),this.props.editId&&this.loadEditInvoiceData()}},{key:"loadInventoryItemList",value:function(){var e=this,t={practice:this.props.active_practiceId,maintain_inventory:!0};this.state.searchItem&&(t.item_name=this.state.searchItem),Object(F.c)(A.xb,(function(t){var a=t.results,n=[];e.setState((function(t){var r=Qa({},t.stocks),i={};a.forEach((function(e){if(e.item_type==Y.z){if(n.push(e),r[e.id]){var t=r[e.id];e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(e){t[e.batch_number],t[e.batch_number]+=e.quantity}))}else{var a={};e.item_type_stock&&e.item_type_stock.item_stock&&e.item_type_stock.item_stock.forEach((function(e){a[e.batch_number]=e.quantity})),r[e.id]=a}i[e.id]=e.item_type_stock.item_stock}}));var l=e.state.items;return l[Y.X]=n,{items:l,stocks:Qa({},t.stocks,{},r),itemBatches:Qa({},t.itemBatches,{},i)}}),(function(){e.props.editId&&e.loadEditInvoiceData()}))}),(function(){}),t)}},{key:"loadProcedures",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),(function(t){var a=e.state.items;a[Y.ub]=t,e.setState({items:a})}),(function(){}))}},{key:"loadPrescriptions",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Hd,[e.props.match.params.id]),(function(t){e.setState((function(e){return{items:Qa({},e.items,Object(w.a)({},Y.sb,t))}}))}),(function(){}))}},{key:"loadTaxes",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Dd,[this.props.active_practiceId]),(function(t){e.setState({taxes_list:t})}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,r=a.getFieldDecorator,i=(a.getFieldValue,a.getFieldsValue,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:24},md:{span:24},lg:{span:24},xl:{span:24}}});r("keys",{initialValue:[]});var l=[{title:"Item Name",key:"item_name",dataIndex:"name",render:function(e,a){switch(a.item_type){case Y.ub:return m.a.createElement(S.a.Item,Object.assign({key:"name[".concat(a._id,"]")},i),r("name[".concat(a._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:e,rules:[{required:!0,message:"This field is required."}]})(m.a.createElement(M.a,{min:0,placeholder:"Item name",size:"small",disabled:!0})),m.a.createElement("span",null,"by \xa0\xa0"),m.a.createElement(pt.a,{placement:"topCenter",disabled:!0,overlay:m.a.createElement(Ie.a,null,t.state.practiceDoctors.map((function(e){return m.a.createElement(Ie.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return t.selectDoctor(e,a._id,Y.ub)}},e.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,a.selectedDoctor.user?a.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(T.a,{value:a.selectedDate,disabled:!0,size:"small",onChange:function(e){return t.selectedDate(e,a._id,Y.ub)},format:"DD-MM-YYYY"}));case Y.sb:return m.a.createElement("b",null,a.name);case Y.X:return m.a.createElement("div",null,a.name,m.a.createElement("span",null,m.a.createElement("br",null),"by \xa0\xa0"),m.a.createElement(pt.a,{placement:"topCenter",disabled:!0,overlay:m.a.createElement(Ie.a,null,t.state.practiceDoctors.map((function(e){return m.a.createElement(Ie.a.Item,{key:e.id},m.a.createElement("a",{onClick:function(){return t.selectDoctor(e,a._id,Y.ub)}},e.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,a.selectedDoctor&&a.selectedDoctor.user?a.selectedDoctor.user.first_name:"+Add Doctor"))),m.a.createElement("span",null,m.a.createElement("br",null),"from batch \xa0\xa0"),m.a.createElement(pt.a,{placement:"topCenter",disabled:!0,overlay:m.a.createElement(Ie.a,null,t.state.itemBatches[a.inventory]&&t.state.itemBatches[a.inventory].map((function(e,n){return G()()>=G()(e.expiry_date)?m.a.createElement(Ie.a.Item,{key:n,disabled:!0},e.batch_number,"\xa0(",e.quantity,") \xa0\xa0",e.expiry_date):m.a.createElement(Ie.a.Item,{key:n},m.a.createElement("a",{onClick:function(){return t.selectBatch(e,a._id,Y.X)}},e.batch_number,"\xa0(",e.quantity,") \xa0\xa0",e.expiry_date))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,a.selectedBatch?a.selectedBatch.batch_number:"Select Batch"))));default:return null}}}];return l=l.concat([{title:"Returning Unit",key:"unit",width:100,dataIndex:"unit",render:function(a,n){return n.item_type==Y.X?m.a.createElement(S.a.Item,Object.assign({key:"unit[".concat(n._id,"]")},i),r("unit[".concat(n._id,"]"),{validateTrigger:["onChange","onBlur"],initialValue:0})(m.a.createElement(C.a,{max:n.unit,onChange:e.calculateReturnCashAvailable,min:0,placeholder:"units",size:"small",disabled:!(n.selectedBatch&&t.state.stocks[n.inventory]&&t.state.stocks[n.inventory][n.selectedBatch.batch_number])})),m.a.createElement("span",{className:"ant-form-text"},"Items: ",n.unit)):m.a.createElement(S.a.Item,Object.assign({key:"unit[".concat(n._id,"]")},i),r("unit[".concat(n._id,"]"),{initialValue:0,validateTrigger:["onChange","onBlur"]})(m.a.createElement(C.a,{min:0,max:n.unit,placeholder:"unit",size:"small",onChange:e.calculateReturnCashAvailable})),m.a.createElement("span",{className:"ant-form-text"},"Items: ",n.unit))}},{title:"Unit Cost",key:"unit_cost",width:100,dataIndex:"unit_cost",render:function(e,t){return e?e.toFixed(2):null}},{title:"discount %",key:"discount",width:100,dataIndex:"discount",render:function(e,t){return m.a.createElement(S.a.Item,Object.assign({key:"discount[".concat(t._id,"]")},i),r("discount[".concat(t._id,"]"),{initialValue:t.discount,validateTrigger:["onChange","onBlur"]})(m.a.createElement(C.a,{min:0,max:100,placeholder:"discount",size:"small",disabled:!0})))}},{title:"Taxes",key:"taxes",dataIndex:"taxes",render:function(a,n){return m.a.createElement(S.a.Item,Object.assign({key:"taxes[".concat(n._id,"]")},i),r("taxes[".concat(n._id,"]"),{initialValue:n.taxes||[],validateTrigger:["onChange","onBlur"]})(m.a.createElement(x.a,{placeholder:"Taxes",size:"small",mode:"multiple",disabled:!0,style:{width:150},onChange:function(){return t.changeNetPrice(n._id)}},e.state.taxes_list&&e.state.taxes_list.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name,"@",e.tax_value,"%")})))))}},{title:"Total Unit Cost",key:"total",width:100,dataIndex:"total",render:function(e,t){return t.unit?(t.total/t.unit).toFixed(2):t.total.toFixed(2)}}]),m.a.createElement("div",null,m.a.createElement(n.a,{spinning:this.state.saveLoading,tip:"Saving Invoice..."},m.a.createElement(f.a,{gutter:16},m.a.createElement(y.a,{span:20},m.a.createElement(k.a,{title:this.props.editId?"Return Invoice (INV "+this.props.editId+")":"Add Invoice",bodyStyle:{padding:0}},m.a.createElement(f.a,{gutter:16},m.a.createElement(y.a,{span:24},m.a.createElement(S.a,{onSubmit:this.handleSubmit,layout:"inline"},m.a.createElement(ke.a,{pagination:!1,bordered:!0,dataSource:this.state.tableFormValues,columns:l}),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(k.a,null,m.a.createElement(f.a,{gutter:16},m.a.createElement(y.a,{span:6},m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(T.a,{value:this.state.selectedDate,disabled:!0,onChange:function(t){return e.selectedDefaultDate(t)},format:"DD-MM-YYYY",allowClear:!1}),m.a.createElement("br",null),m.a.createElement("br",null),m.a.createElement(fe.a,{onChange:this.onChangeHandle,defaultChecked:this.state.return_with_tax},"Return With Tax")),m.a.createElement(y.a,{span:8},m.a.createElement(S.a.Item,{label:"Returned Cash "},r("cash_return")(m.a.createElement(C.a,{min:0,max:this.state.returnCashAvailable,placeholder:"Cash Returned"})),m.a.createElement("span",null,m.a.createElement("br",null),"Max Cash Return Allowed (INR) ",this.state.returnCashAvailable))),m.a.createElement(y.a,{span:10},m.a.createElement(S.a.Item,{label:"Notes",key:"notes"},r("notes",{initialValue:this.state.tableFormValues.notes,validateTrigger:["onChange","onBlur"]})(m.a.createElement(M.a.TextArea,{row:2,placeholder:"Notes...",size:"small",style:{width:"100%"}}))),m.a.createElement(S.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},{style:{marginBottom:0,float:"right"}}),m.a.createElement(P.a,{type:"primary",htmlType:"submit",style:{margin:5}},"Save Return Invoice"),t.props.history?m.a.createElement(P.a,{style:{margin:5,float:"right"},onClick:function(){return t.props.history.goBack()}},"Cancel"):null)))))))))),m.a.createElement(y.a,{span:4},m.a.createElement(v.a,null,"Payments Done"),m.a.createElement(b.a,{dataSource:this.state.editInvoice.payments,renderItem:function(e){return m.a.createElement(k.a,{title:e.payment_id,style:{marginBottom:10},bodyStyle:{padding:5}},m.a.createElement("p",null,"Paid (INR)",m.a.createElement("span",{style:{float:"right",fontWeight:600}}," ",e.pay_amount.toFixed(2))))}})))))}}]),t}(m.a.Component),$a=S.a.create()(Ja);function en(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var tn=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitReturnInvoice=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?en(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):en(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{practice:a.props.active_practiceId});Object(F.j)(A.M,r,(function(e){t.setState({returnIncoiceVisible:!1}),t.returnInvoiceData(t.props.editInvoice),t.props.returnInvoiceClose()}),(function(){}))}}))},a.returnInvoiceData=function(e){var t=Object(o.a)(a);a.setState({editInvoice:e},(function(){t.props.history.push("/patient/"+e.patient_data.id+"/billing/invoices/return/")}))},a.state={returnIncoiceVisible:a.props.returnIncoiceVisible,otpSent:a.props.otpSent},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"sendOTP",value:function(){Object(F.c)(A.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return m.a.createElement(h.a,{visible:this.state.returnIncoiceVisible&&this.props.editInvoice&&this.props.editInvoice.id==this.props.invoice.id,title:"Return Invoice",footer:null,onOk:this.props.handleSubmitReturnInvoice,onCancel:this.props.returnInvoiceClose},m.a.createElement(S.a,null,m.a.createElement(S.a.Item,null,e("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(M.a,{prefix:m.a.createElement(j.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(S.a.Item,null,this.props.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(P.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitReturnInvoice},"Submit"),"\xa0",m.a.createElement(P.a,{size:"small",onClick:this.props.returnInvoiceClose},"Close"))))}}]),t}(m.a.Component),an=S.a.create()(tn);function nn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var rn=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitEditInvoice=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?nn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):nn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{practice:a.props.active_practiceId});Object(F.j)(A.M,r,(function(e){t.setState({editIncoiceVisible:!1}),t.editInvoiceData(t.props.editInvoice),t.props.editInvoiceClose()}),(function(){}))}}))},a.editInvoiceData=function(e){var t=Object(o.a)(a);a.setState({editInvoice:e},(function(){t.props.history.push("/patient/"+e.patient_data.id+"/billing/invoices/edit/")}))},a.state={otpSent:a.props.otpSent,returnIncoiceVisible:a.props.returnIncoiceVisible,editIncoiceVisible:a.props.editIncoiceVisible},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"sendOTP",value:function(){Object(F.c)(A.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return m.a.createElement(h.a,{visible:this.state.editIncoiceVisible&&this.props.editInvoice&&this.props.editInvoice.id==this.props.invoice.id,title:"Edit Invoice",footer:null,onOk:this.handleSubmitEditInvoice,onCancel:this.props.editInvoiceClose},m.a.createElement(S.a,null,m.a.createElement(S.a.Item,null,e("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(M.a,{prefix:m.a.createElement(j.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(S.a.Item,null,this.props.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(P.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitEditInvoice},"Submit"),"\xa0",m.a.createElement(P.a,{size:"small",onClick:this.props.editInvoiceClose},"Close"))))}}]),t}(m.a.Component),ln=S.a.create()(rn);function cn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var on=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitCancelInvoice=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?cn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):cn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{practice:a.props.active_practiceId});Object(F.j)(A.M,r,(function(e){t.setState({cancelIncoiceVisible:!1}),t.deleteInvoice(t.props.patientId,t.props.invoiceId)}),(function(){}))}}))},a.state={cancelIncoiceVisible:a.props.cancelIncoiceVisible,otpSent:a.props.otpSent},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"deleteInvoice",value:function(e,t){var a=this,n={patient:e,is_cancelled:!0};Object(F.l)(Object(F.f)(A.gd,[t]),n,(function(e){Object(F.a)(N.Wb,"Invoice cancelled successfully"),a.props.loadInvoices()}),(function(){}))}},{key:"sendOTP",value:function(){Object(F.c)(A.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return m.a.createElement(h.a,{visible:this.state.cancelIncoiceVisible&&this.props.editInvoice&&this.props.editInvoice.id==this.props.invoice.id,title:"Cancel Invoice",footer:null,onOk:this.handleSubmitCancelInvoice,onCancel:this.cancelInvoiceClose},m.a.createElement(S.a,null,m.a.createElement(S.a.Item,null,e("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(M.a,{prefix:m.a.createElement(j.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(S.a.Item,null,this.props.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(P.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitCancelInvoice},"Submit"),"\xa0",m.a.createElement(P.a,{size:"small",onClick:this.cancelInvoiceClose},"Close"))))}}]),t}(m.a.Component),sn=S.a.create()(on);function un(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function dn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?un(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):un(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}h.a.confirm;var mn=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPDF=function(e){Object(o.a)(a);Object(F.c)(Object(F.f)(A.Cb,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))},a.returnModelOpen=function(e){var t=Object(o.a)(a);if(G()().diff(e.created_at,"minutes")>N.sb){t.setState({returnIncoiceVisible:!0,editIncoiceVisible:!1,cancelIncoiceVisible:!1,editInvoice:e});var n={practice:a.props.active_practiceId,type:"Invoice:"+e.invoice_id+" Return"};Object(F.j)(A.K,n,(function(a){t.setState({otpSent:!0,patientId:e.patient,invoiceId:e.id})}),(function(){}))}else a.setState({editInvoice:e},(function(){t.props.history.push("/patient/"+e.patient_data.id+"/billing/invoices/return/")}))},a.cancelModalOpen=function(e){var t=Object(o.a)(a);if(G()().diff(e.created_at,"minutes")>N.sb){t.setState({cancelIncoiceVisible:!0,editIncoiceVisible:!1,returnIncoiceVisible:!1,editInvoice:e});var n={practice:a.props.active_practiceId,type:"Invoice:"+e.invoice_id+"  Cancellation"};Object(F.j)(A.K,n,(function(a){t.setState({otpSent:!0,patientId:e.patient,invoiceId:e.id})}),(function(){}))}else t.deleteInvoice(e.patient,e.id)},a.editInvoiceClose=function(){a.setState({editIncoiceVisible:!1})},a.returnInvoiceClose=function(){a.setState({returnIncoiceVisible:!1})},a.cancelInvoiceClose=function(){a.setState({cancelIncoiceVisible:!1})},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,invoices:[],drug_catalog:null,procedure_category:null,taxes_list:null,editInvoice:null,loading:!0,returnIncoiceVisible:!1,editIncoiceVisible:!1,cancelIncoiceVisible:!1},a.loadInvoices=a.loadInvoices.bind(Object(o.a)(a)),a.loadDrugCatalog=a.loadDrugCatalog.bind(Object(o.a)(a)),a.loadProcedureCategory=a.loadProcedureCategory.bind(Object(o.a)(a)),a.loadTaxes=a.loadTaxes.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadInvoices()}},{key:"loadInvoices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;t.props.refreshWallet&&1==e&&t.props.refreshWallet(),t.setState({loading:!0});var a=function(e){1==e.current?t.setState({total:e.count,invoices:e.results,loading:!1,loadMoreInvoice:e.next}):t.setState((function(t){return{total:e.count,invoices:[].concat(Object(D.a)(t.invoices),Object(D.a)(e.results)),loading:!1,loadMoreInvoice:e.next}}))},n=function(){t.setState({loading:!1})},r={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(r.patient=this.props.match.params.id),Object(F.c)(A.Bb,a,n,r)}},{key:"loadDrugCatalog",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Z,[this.props.active_practiceId]),(function(t){e.setState({drug_catalog:t})}),(function(){}))}},{key:"loadProcedureCategory",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),(function(t){e.setState({procedure_category:t})}),(function(){}))}},{key:"loadTaxes",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Dd,[this.props.active_practiceId]),(function(t){e.setState({taxes_list:t})}),(function(){}))}},{key:"editModelOpen",value:function(e){var t=this;if(G()().diff(e.created_at,"minutes")>N.sb){t.setState({editIncoiceVisible:!0,cancelIncoiceVisible:!1,returnIncoiceVisible:!1,editInvoice:e});var a={practice:this.props.active_practiceId,type:"Invoice:"+e.invoice_id+" Edit"};Object(F.j)(A.K,a,(function(a){t.setState({otpSent:!0,patientId:e.patient,invoiceId:e.id})}),(function(){}))}else this.setState({editInvoice:e},(function(){t.props.history.push("/patient/"+e.patient_data.id+"/billing/invoices/edit/")}))}},{key:"deleteInvoice",value:function(e,t){var a=this,n={patient:e,is_cancelled:!0};Object(F.l)(Object(F.f)(A.gd,[t]),n,(function(e){Object(F.a)(N.Wb,"Invoice cancelled successfully"),a.loadInvoices()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a={};this.state.drug_catalog&&this.state.drug_catalog.forEach((function(e){a[e.id]=e.name+","+e.strength}));var r={};this.state.procedure_category&&this.state.procedure_category.forEach((function(e){r[e.id]=e.name}));var i={};return this.state.taxes_list&&this.state.taxes_list.forEach((function(e){i[e.id]=e.name})),this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{path:"/patient/:id/billing/invoices/add",render:function(t){return m.a.createElement(Ka,Object.assign({},t,e.props,{loadData:e.loadInvoices}))}}),m.a.createElement(p.b,{path:"/patient/:id/billing/invoices/edit",render:function(t){return e.state.editInvoice?m.a.createElement(Ka,Object.assign({},e.state,t,e.props,{editId:e.state.editInvoice.id,loadData:e.loadInvoices})):m.a.createElement(p.a,{to:"/patient/"+e.props.match.params.id+"/billing/invoices"})}}),m.a.createElement(p.b,{path:"/patient/:id/billing/invoices/return",render:function(t){return e.state.editInvoice?m.a.createElement($a,Object.assign({},e.state,t,{editId:e.state.editInvoice.id,loadData:e.loadInvoices})):m.a.createElement(p.a,{to:"/patient/"+e.props.match.params.id+"/billing/invoices"})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(Ra.a,{banner:!0,showIcon:!0,type:"info",message:"The invoices shown are only for the current selected practice!"}),m.a.createElement(Je.a,{offsetTop:0},m.a.createElement(k.a,{bodyStyle:{padding:0},style:{boxShadow:"0 5px 8px rgba(0, 0, 0, 0.09)"},title:(this.state.currentPatient?this.state.currentPatient.user.first_name+" Invoice ":"Invoices ")+(this.state.total?"(Total:".concat(this.state.total,")"):""),extra:m.a.createElement(P.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/billing/invoices/add"},m.a.createElement(P.a,{type:"primary"},m.a.createElement(j.a,{type:"plus"}),"Add")))})),this.state.invoices.map((function(e){return hn(e,t)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadInvoices(e.state.loadMoreInvoice)},loading:this.state.loading,hidden:!this.state.loadMoreInvoice}))))):m.a.createElement("div",null,m.a.createElement(Je.a,{offsetTop:0},m.a.createElement(k.a,{bodyStyle:{padding:0},style:{boxShadow:"0 5px 8px rgba(0, 0, 0, 0.09)"},title:(this.state.currentPatient?this.state.currentPatient.user.first_name+" Invoice ":"Invoice ")+(this.state.total?"(Total:".concat(this.state.total,")"):""),extra:m.a.createElement(P.a.Group,null,m.a.createElement(P.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(j.a,{type:"plus"}),"Add"))})),this.state.invoices.map((function(e){return hn(e,t)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadInvoices(e.state.loadMoreInvoice)},loading:this.state.loading,hidden:!this.state.loadMoreInvoice}))}}]),t}(m.a.Component),pn=S.a.create()(mn);function fn(e){return e?m.a.createElement("p",null,e.doctor?m.a.createElement(we.a,{title:"Doctor"},m.a.createElement(g.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+e.doctor.user.first_name," "))):null,e.practice?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null,e.notes?m.a.createElement("p",null,"Notes: ",e.notes):null):null}function hn(e,t){var a=[];t.props.form.getFieldDecorator;if(e.reservation){var n=e.reservation_data.medicines.map((function(e){return Object.create(dn({},e,{unit:1,total:e.final_price,unit_cost:e.price,discount:0}))})),r={NORMAL:{total:"final_normal_price",tax:"normal_tax_value",unit_cost:"normal_price"},TATKAL:{total:"final_tatkal_price",tax:"tatkal_tax_value",unit_cost:"tatkal_price"}};a=[].concat(Object(D.a)(a),[dn({},e.reservation_data.bed_package,{unit:1,total:e.reservation_data.bed_package?e.reservation_data.bed_package[r[e.reservation_data.seat_type].total]:null,tax_value:e.reservation_data.bed_package?e.reservation_data.bed_package[r[e.reservation_data.seat_type].tax]:null,unit_cost:e.reservation_data.bed_package?e.reservation_data.bed_package[r[e.reservation_data.seat_type].unit_cost]:null})],Object(D.a)(n))}return m.a.createElement(k.a,{key:e.id,style:{marginTop:10},bodyStyle:{padding:0},title:m.a.createElement("small",null,e.date?G()(e.date).format("ll"):null,t.state.currentPatient?null:m.a.createElement("span",null,m.a.createElement(le.b,{to:"/patient/"+(e.patient_data?e.patient_data.id:null)+"/billing/invoices"},"\xa0\xa0 ",e.patient_data?e.patient_data.user.first_name:null," (ID: ",e.patient_data&&e.patient_data.custom_id?e.patient_data.custom_id:e.patient_data.id,")\xa0"),", ",e.patient_data?e.patient_data.gender:null)),extra:m.a.createElement(pt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Ie.a,null,m.a.createElement(Ie.a.Item,{key:"1"},m.a.createElement(le.b,{to:"/patient/"+(e.patient_data?e.patient_data.id:null)+"/billing/payments/add?invoices="+e.id},m.a.createElement(j.a,{type:"dollar"}),"\xa0 Pay")),m.a.createElement(Ie.a.Divider,null),m.a.createElement(Ie.a.Item,{key:"2",onClick:function(){return t.editModelOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.payments_data||e.is_cancelled},m.a.createElement(j.a,{type:"edit"}),"Edit"),m.a.createElement(Ie.a.Item,{key:"5",onClick:function(){return t.returnModelOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.is_cancelled},m.a.createElement(j.a,{type:"redo"}),"Return"),m.a.createElement(Ie.a.Item,{key:"3",onClick:function(){return t.cancelModalOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.payments_data||e.is_cancelled},m.a.createElement(j.a,{type:"delete"}),"Cancel"),m.a.createElement(Ie.a.Divider,null),m.a.createElement(Ie.a.Item,{key:"4"},m.a.createElement(le.b,{to:"/patient/"+e.patient+"/emr/timeline"},m.a.createElement(j.a,{type:"clock-circle"}),"Patient Timeline")))},m.a.createElement("a",{onClick:function(){return t.loadPDF(e.id)}},m.a.createElement(j.a,{type:"printer"})))},m.a.createElement(f.a,{gutter:8},m.a.createElement(y.a,{xs:24,sm:24,md:6,lg:4,xl:4,xxl:4,style:{padding:10}},e.is_cancelled?m.a.createElement(Ra.a,{message:"Cancelled",type:"error",showIcon:!0}):null,m.a.createElement(v.a,{style:{marginBottom:0}},e.invoice_id),m.a.createElement(_.a,{title:"Paid / Total ",value:e.payments_data?e.payments_data.toFixed(2):0,suffix:"/ "+e.total.toFixed(2)})),m.a.createElement(y.a,{xs:24,sm:24,md:18,lg:20,xl:20,xxl:20},"Membership Amount."==e.type?m.a.createElement(ke.a,{bordered:!0,pagination:!1,columns:bn,dataSource:[{inventory:!0,name:"Membership",unit_cost:e.total,unit:1,discount_value:0,tax_value:0,total:e.total}],footer:function(){return fn({practice:e.practice_data,notes:e.notes})}}):m.a.createElement(ke.a,{bordered:!0,pagination:!1,columns:bn,dataSource:[].concat(Object(D.a)(a),Object(D.a)(e.inventory),Object(D.a)(e.procedure)),footer:function(){return fn({practice:e.practice_data,notes:e.notes})}}))),t.state.cancelIncoiceVisible&&t.state.otpSent&&m.a.createElement(sn,Object.assign({},t.state,{invoice:e,cancelInvoiceClose:t.cancelInvoiceClose},t.props,{loadInvoices:t.loadInvoices})),t.state.editIncoiceVisible&&t.state.otpSent&&m.a.createElement(ln,Object.assign({},t.state,{invoice:e,editInvoiceClose:t.editInvoiceClose},t.props)),t.state.returnIncoiceVisible&&t.state.otpSent&&m.a.createElement(an,Object.assign({},t.state,{invoice:e,returnInvoiceClose:t.returnInvoiceClose},t.props)))}var bn=[{title:"Treatment & Products",dataIndex:"drug",key:"drug",render:function(e,t){return m.a.createElement("span",null," ",m.a.createElement("b",null,t.name?t.name:null),m.a.createElement("br",null)," ",t.doctor_data?m.a.createElement(g.a,{color:t.doctor_data?t.doctor_data.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+t.doctor_data.user.first_name," ")):null)}},{title:"Cost",dataIndex:"unit_cost",key:"unit_cost",render:function(e,t){return m.a.createElement("span",null,t.unit_cost?t.unit_cost.toFixed(2):null)}},{title:"Unit",dataIndex:"unit",key:"unit"},{title:"Discount",dataIndex:"discount_value",key:"discount_value",render:function(e,t){return m.a.createElement("span",null,t.discount_value?t.discount_value.toFixed(2):null)}},{title:"Tax",dataIndex:"tax_value",key:"tax_value",render:function(e,t){return m.a.createElement("span",null,t.tax_value?t.tax_value.toFixed(2):null)}},{title:"Total",dataIndex:"total",key:"total",render:function(e){return e?e.toFixed(2):null}}];function gn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function yn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?gn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):gn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var En=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadEditPyament=function(e){var t=Object(o.a)(a),n={},r=[],i=0;a.setState((function(a){return e.forEach((function(e){n[e.invoice]=!0,r.push(yn({},e,{},e.invoice_data)),i+=e.pay_amount+e.pay_amount_wallet}),(function(){t.calculateInvoicePayments(),t.setPaymentAmount(i)})),{addedInvoice:r,addedInvoiceId:n}}))},a.loadAvailableAdvance=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.t,[e.props.match.params.id]),(function(t){e.setState({availableAdvance:t})}),(function(){}),{practice_id:a.props.active_practiceId})},a.loadPaymentModes=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.zc,[a.props.active_practiceId]),(function(t){e.setState({paymentModes:t,selectedPaymentMode:t.length?t[0].id:null})}),(function(){}))},a.loadInvoices=function(e){var t=Object(o.a)(a);t.setState({invoiceLoading:!0});Object(F.c)(A.Bb,(function(a){t.setState((function(e){return{invoicesList:[].concat(Object(D.a)(a.results),Object(D.a)(e.addedInvoice)),invoiceLoading:!1,loadMoreInvoice:a.next}}),(function(){e&&e.forEach((function(e){t.addInvoiceToPayments(e)})),t.calculateInvoicePayments()}))}),(function(){t.setState({invoiceLoading:!1})}),{page:t.state.loadMoreInvoice||1,is_cancelled:!1,is_pending:!0,patient:a.props.match.params.id,practice:a.props.active_practiceId})},a.addInvoiceToPayments=function(e){var t=Object(o.a)(a);a.setState((function(t){var a=null;return t.invoicesList.forEach((function(t){t.id==e&&(a=t)})),a?{addedInvoice:[].concat(Object(D.a)(t.addedInvoice),[a]),addedInvoiceId:yn({},t.addedInvoiceId,Object(w.a)({},e,!0)),invoicePayments:yn({},t.addedInvoiceId,Object(w.a)({},e,0))}:null}),(function(){t.calculateInvoicePayments()}))},a.removeInvoiceToPayments=function(e){var t=Object(o.a)(a);a.setState((function(t){var a=[];return t.addedInvoice.forEach((function(t){t.id!=e&&a.push(t)})),a?{addedInvoice:a,addedInvoiceId:yn({},t.addedInvoiceId,Object(w.a)({},e,!1))}:null}),(function(){t.calculateInvoicePayments()}))},a.calculateInvoicePayments=function(){a.setState((function(e){var t=0,a=e.totalPayingAmount+e.totalPayingFromAdvanceAmount,n={};return e.addedInvoice.forEach((function(e){var r=e.total-e.payments_data;e.pay_amount&&(r+=e.pay_amount),e.pay_amount_wallet&&(r+=e.pay_amount_wallet),t+=r,a>=r?(a-=r,n[e.id]=r):(n[e.id]=a,a=0)})),{advanceToBeSent:a,totalPayableAmount:t.toFixed(2),invoicePayments:n}}))},a.setPaymentAmount=function(e){var t=Object(o.a)(a);a.setState({totalPayingAmount:e},(function(){t.calculateInvoicePayments()}))},a.setPaymentFromAdvanceAmount=function(e){var t=Object(o.a)(a);a.setState({totalPayingFromAdvanceAmount:e},(function(){t.calculateInvoicePayments()}))},a.changeSelectedPaymentMode=function(e){a.setState({selectedPaymentMode:e})},a.changeNotes=function(e){a.setState({notes:e})},a.selectedDate=function(e){Object(o.a)(a).setState({selectDate:e})},a.handleSubmit=function(e){if(!a.state.totalPayingAmount)return Object(F.a)(N.fc,"Payment Amount of O INR is not allowed."),!1;a.setState({loading:!0});var t=Object(o.a)(a),n={invoices:[],bank:"",number:0,is_active:!0,notes:t.state.notes,is_cancelled:!1,practice:t.props.active_practiceId,patient:t.props.match.params.id,payment_mode:t.state.selectedPaymentMode,advance_value:t.state.advanceToBeSent,is_advance:!!t.state.advanceToBeSent,date:G()(t.state.selectDate).format("YYYY-MM-DD")},r=[];t.state.totalPayingAmount-t.state.totalPayableAmount>1&&(r.advance_value=t.state.totalPayingAmount-t.state.totalPayableAmount,r.is_advance=!0);var i=Object.keys(t.state.invoicePayments),l=yn({},t.state.invoicePayments),c=t.state.totalPayingFromAdvanceAmount,s=0;for(c&&t.state.availableAdvance.data.forEach((function(e){var t=c;for(e.advance_value<t&&(t=e.advance_value);c&&i.length>s;)l[i[s]]&&t>l[i[s]]?(e.advance_value-=l[i[s]],e.invoices.push({pay_amount_advance:l[i[s]],pay_amount:l[i[s]],is_active:!0,invoice:i[s]}),c-=l[i[++s]],l[i[s]]-=l[i[s]]):l[i[s]]&&(e.invoices.push({pay_amount_advance:t,pay_amount:t,is_active:!0,invoice:i[s]}),l[i[s]]-=t,c-=t,e.advance_value-=t);r.push(e)}));i.length>s;s++)n.invoices.push({pay_amount:l[i[s]],type:"Invoice",is_active:!0,invoice:i[s]});a.props.editPayment&&a.props.editPayment.id&&(n.id=a.props.editPayment.id),(n.invoices.length||n.id||n.is_advance)&&r.push(n),t.state.receivedPayIdFromRazorPay&&(n.bank="RazorPay",n.number=t.state.receivedPayIdFromRazorPay);Object(F.j)(A.H,r,(function(e){t.setState({loading:!1}),t.props.loadData(),t.props.history.push("/patient/"+t.props.match.params.id+"/billing/payments")}),(function(){t.setState({loading:!1})}))},a.state={invoicesList:[],invoiceLoading:!0,addedInvoiceId:{},addedInvoice:[],paymentModes:[],totalPayableAmount:0,invoicePayments:{},totalPayingAmount:0,totalPayingFromAdvanceAmount:0,selectedPaymentMode:null,availableAdvance:null,advanceToBeSent:0,selectDate:G()(),loading:!1},a.loadEditPyament=a.loadEditPyament.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){this.props.editPayment&&this.props.editPayment.invoices&&this.loadEditPyament(this.props.editPayment.invoices);var e=[];if(this.props.history&&this.props.history.location.search){var t=this.props.history.location.search.substr(1).split("&");t.length&&t.forEach((function(t){"invoices"==t.split("=")[0]&&(e=t.split("=")[1].split(","))}))}this.loadInvoices(e),this.loadPaymentModes(),this.loadAvailableAdvance()}},{key:"paymentHandler",value:function(e,t,a){if(!a)return Object(F.a)(N.fc,"Payment Amount of O INR is not allowed."),!1;var n=this,r={key:ot.c,amount:100*a.toFixed(2),name:t.custom_id,description:"Payment for "+e,prefill:{name:t.user.first_name,email:t.user.email,contact:t.user.mobile},handler:function(e){var t=e.razorpay_payment_id,r={payment_id:t,amount:a};n.setState({loading:!0});Object(F.j)(A.a,r,(function(e){Object(F.a)(N.Wb,e.detail),n.setState({loading:!1,receivedPayIdFromRazorPay:t},(function(){n.handleSubmit()}))}),(function(){n.setState({loading:!1}),console.log("Request failed")}))}};new window.Razorpay(r).open()}},{key:"render",value:function(){var e=this,t=this;return m.a.createElement("div",null,m.a.createElement(n.a,{spinning:this.state.loading,size:"large"},m.a.createElement(f.a,{gutter:8},m.a.createElement(y.a,{xs:24,sm:24,md:16,lg:16,xl:18,xxl:18},m.a.createElement(k.a,null,m.a.createElement(f.a,null,m.a.createElement(y.a,{span:24},m.a.createElement("table",{style:{width:"100%"}},m.a.createElement("tbody",null,m.a.createElement("tr",{style:{borderBottom:"2px solid #ccc"}},m.a.createElement("td",{style:{width:"20%"}},m.a.createElement("small",null,"INVOICE NO")),m.a.createElement("td",{style:{width:"20%"}},m.a.createElement("small",null,"PROCEDURE")),m.a.createElement("td",{style:{width:"20%",textAlign:"right"}},m.a.createElement("small",null,"DUE(INR)")),m.a.createElement("td",{style:{width:"20%",textAlign:"right"}},m.a.createElement("small",null,"PAY NOW(INR)")),m.a.createElement("td",{style:{width:"20%",textAlign:"right"}},m.a.createElement("small",null,"DUE AFTER PAYMENT(INR)"))),this.state.addedInvoice.map((function(a){return m.a.createElement("tr",{style:{borderBottom:"2px solid #ccc"}},m.a.createElement("td",null,m.a.createElement(P.a,{size:"small",type:"danger",shape:"circle",icon:"close",style:{position:"absolute",right:"-35px"},onClick:function(){return e.removeInvoiceToPayments(a.id)}}),m.a.createElement("h3",null,a.invoice_id),a.date),m.a.createElement("td",null,a.procedure.map((function(e){return e.procedure_data.name+", "})),a.inventory.map((function(e){return e.inventory_item_data.name+", "})),a.reservation?a.type+",":null,a.reservation_data&&a.reservation_data.medicines?a.reservation_data.medicines.map((function(e){return e.name+","})):null),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(a.total-a.payments_data+(a.pay_amount||0)+(a.pay_amount_wallet||0)).toFixed(2))),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,t.state.invoicePayments[a.id])),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(a.total-a.payments_data+(a.pay_amount||0)+(a.pay_amount_wallet||0)-t.state.invoicePayments[a.id]).toFixed(2))))})))))),m.a.createElement(f.a,{style:{borderBottom:"2px dashed #ccc",marginTop:"20px"}},m.a.createElement(y.a,{span:6},m.a.createElement("h3",null,"Total Payable :")),m.a.createElement(y.a,{span:6},m.a.createElement("h2",null,this.state.totalPayableAmount))),m.a.createElement(f.a,{gutter:16,style:{marginTop:"20px"}},m.a.createElement(y.a,{span:12},m.a.createElement(f.a,null,m.a.createElement(y.a,{span:12},m.a.createElement("h3",null,"Amount From Advance :",m.a.createElement("br",null),m.a.createElement("small",null,"Available: ",this.state.availableAdvance?this.state.availableAdvance.max_allowed:0," INR"))),m.a.createElement(y.a,{span:12},m.a.createElement(C.a,{min:0,step:1,max:this.state.availableAdvance?this.state.availableAdvance.max_allowed:0,disabled:!this.state.availableAdvance||!this.state.availableAdvance.max_allowed,value:this.state.totalPayingFromAdvanceAmount,onChange:this.setPaymentFromAdvanceAmount}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:12},m.a.createElement("h3",null,"Pay Now:")),m.a.createElement(y.a,{span:12},m.a.createElement(C.a,{min:0,step:1,value:this.state.totalPayingAmount,onChange:this.setPaymentAmount})))),m.a.createElement(y.a,{span:12},m.a.createElement(M.a.TextArea,{row:2,placeholder:"Notes...",size:"small",onChange:function(t){return e.changeNotes(t.target.value)}},this.state.notes),m.a.createElement(x.a,{style:{width:"100%"},value:this.state.selectedPaymentMode,onChange:this.changeSelectedPaymentMode},this.state.paymentModes.map((function(e){return m.a.createElement(x.a.Option,{value:e.id,key:e.id},e.mode)}))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6},m.a.createElement("br",null),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(T.a,{style:{width:150},defaultValue:G()(),onChange:function(e){return t.selectedDate(e)}}))))),m.a.createElement(f.a,null,m.a.createElement(y.a,{span:24,style:{align:"center"}},m.a.createElement(E.a,{title:"Are you sure to take payment of INR "+this.state.totalPayingAmount+"?",onConfirm:function(){return e.paymentHandler(e.state.addedInvoice.map((function(e){return e.invoice_id})).join(", "),e.props.currentPatient,e.state.totalPayingAmount)}},m.a.createElement(P.a,{type:"primary",style:{margin:5},disabled:t.props.editPayment&&t.props.editPayment.invoices},"Pay Online & Save Payments")),m.a.createElement(E.a,{title:"Are you sure to take payment of INR "+this.state.totalPayingAmount+"?",onConfirm:this.handleSubmit},m.a.createElement(P.a,{type:"primary",style:{margin:5}},"Only Save Payments")))))),m.a.createElement(y.a,{xs:24,sm:24,md:6,lg:8,xl:6,xxl:6},m.a.createElement(b.a,{loading:this.state.invoiceLoading,dataSource:this.state.invoicesList,renderItem:function(a){return t.state.addedInvoiceId[a.id]?m.a.createElement("div",null):m.a.createElement(k.a,{hoverable:!0,onClick:function(){return e.addInvoiceToPayments(a.id)},style:{marginBottom:"10px"}},m.a.createElement("table",{style:{width:"100%"}},m.a.createElement("tbody",null,m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},m.a.createElement("h4",null,a.invoice_id)),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,a.date))))),m.a.createElement(v.a,{style:{margin:0}}),m.a.createElement("table",{style:{width:"100%"}},m.a.createElement("tbody",null,a.procedure.map((function(e){return m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},e.procedure_data.name),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(e.unit*e.unit_cost).toFixed(2))))})),a.inventory.map((function(e){return m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},e.inventory_item_data.name),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(e.unit*e.unit_cost).toFixed(2))))})),a.reservation?m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},a.type),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,a.reservation_data.bed_package_price?a.reservation_data.bed_package_price.toFixed(2):null))):null,a.reservation_data&&a.reservation_data.medicines?m.a.createElement(m.a.Fragment,null,a.reservation_data.medicines.map((function(e){return m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},e.name),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,e.final_price.toFixed(2))))}))):null)),m.a.createElement(v.a,{style:{margin:0}}),m.a.createElement("table",{style:{width:"100%"}},m.a.createElement("tbody",null,m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},"Invoice Amount"),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,a.total.toFixed(2)))),m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},"Paid Amount"),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,a.payments_data?a.payments_data.toFixed(2):0))),m.a.createElement("tr",null,m.a.createElement("td",{style:{maxWidth:"calc(100% - 60px)"}},m.a.createElement("b",null,"Amount Due")),m.a.createElement("td",{style:{textAlign:"right"}},m.a.createElement("b",null,(a.total-a.payments_data).toFixed(2)))))))}})))))}}]),t}(m.a.Component);function vn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var _n=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitEditPayment=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?vn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):vn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{practice:a.props.active_practiceId});Object(F.j)(A.M,r,(function(e){t.setState({editPaymentVisible:!1}),t.editPaymentData(t.props.editPayment),t.props.editPaymentClose()}),(function(){}))}}))},a.editPaymentData=function(e){Object(o.a)(a).props.history.push("/patient/"+e.patient+"/billing/payments/edit/")},a.state={otpSent:a.props.otpSent,editPaymentVisible:a.props.editPaymentVisible,cancelPaymentVisible:a.props.cancelPaymentVisible},a.editPaymentData=a.editPaymentData.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"sendOTP",value:function(){Object(F.c)(A.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return m.a.createElement(h.a,{visible:this.state.editPaymentVisible&&this.props.editPayment&&this.props.editPayment.id==this.props.payment.id,title:"Edit Invoice",footer:null,onOk:this.handleSubmitEditPayment,onCancel:this.props.editPaymentClose},m.a.createElement(S.a,null,m.a.createElement(S.a.Item,null,e("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(M.a,{prefix:m.a.createElement(j.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(S.a.Item,null,this.props.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(P.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitEditPayment},"Submit"),"\xa0",m.a.createElement(P.a,{size:"small",onClick:this.props.editPaymentClose},"Close"))))}}]),t}(m.a.Component),On=S.a.create()(_n);function Pn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var jn=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSubmitCancelPayment=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Pn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Pn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{practice:a.props.active_practiceId});Object(F.j)(A.M,r,(function(e){t.setState({cancelPaymentVisible:!1}),t.deletePayment(t.props.patientId,t.props.paymentId),t.props.cancelPaymentClose()}),(function(){}))}}))},a.state={cancelPaymentVisible:a.props.cancelPaymentVisible,otpSent:a.props.otpSent},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"deletePayment",value:function(e,t){var a=this,n={patient:e,is_cancelled:!0};Object(F.l)(Object(F.f)(A.od,[t]),n,(function(e){Object(F.a)(N.Wb,"Payment cancelled successfully"),a.props.loadPayments()}),(function(){}))}},{key:"sendOTP",value:function(){Object(F.c)(A.L,(function(e){}),(function(){}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return m.a.createElement(h.a,{visible:this.state.cancelPaymentVisible&&this.props.editPayment&&this.props.editPayment.id==this.props.payment.id,title:"Cancel Payment",footer:null,onOk:this.handleSubmitCancelPayment,onCancel:this.props.cancelPaymentClose},m.a.createElement(S.a,null,m.a.createElement(S.a.Item,null,e("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(M.a,{prefix:m.a.createElement(j.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(S.a.Item,null,this.state.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:this.sendOTP},"Resend Otp ?"):null,m.a.createElement(P.a,{size:"small",type:"primary",htmlType:"submit",onClick:this.handleSubmitCancelPayment},"Submit"),"\xa0",m.a.createElement(P.a,{size:"small",onClick:this.props.cancelPaymentClose},"Close"))))}}]),t}(m.a.Component),kn=S.a.create()(jn),Cn=(ce.Modal.confirm,function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPayments=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(o.a)(a);t.props.refreshWallet&&1==e&&t.props.refreshWallet(),a.setState({loading:!0});var n=function(e){t.setState((function(t){return 1==e.current?{payments:Object(D.a)(e.results),next:e.next,loading:!1}:{payments:[].concat(Object(D.a)(t.payments),Object(D.a)(e.results)),next:e.next,loading:!1}}))},r=function(){t.setState({loading:!1})},i={page:e,practice:a.props.active_practiceId};a.props.match.params.id&&(i.patient=a.props.match.params.id),Object(F.c)(A.uc,n,r,i)},a.loadPDF=function(e){Object(o.a)(a);Object(F.c)(Object(F.f)(A.Ac,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))},a.editModelOpen=function(e){var t=Object(o.a)(a);if(G()().diff(e.created_at,"minutes")>N.sb){t.setState({editPaymentVisible:!0,cancelPaymentVisible:!1,editPayment:e});var n={practice:a.props.active_practiceId,type:"Payment:"+e.payment_id+" Edit"};Object(F.j)(A.K,n,(function(a){t.setState({otpSent:!0,patientId:e.patient,paymentId:e.payment_id})}),(function(){}))}else t.setState({editPayment:e},(function(){t.props.history.push("/patient/"+e.patient+"/billing/payments/edit")}))},a.editPaymentData=function(e){var t=Object(o.a)(a);t.setState({editPayment:e},(function(){t.props.history.push("/patient/"+e.patient+"/billing/payments/edit/")}))},a.cancelModalOpen=function(e){var t=Object(o.a)(a);if(G()().diff(e.created_at,"minutes")>N.sb){t.setState({editPaymentVisible:!1,cancelPaymentVisible:!0,editPayment:e});var n={practice:a.props.active_practiceId,type:"Payment:"+e.payment_id+"  Cancellation"};Object(F.j)(A.K,n,(function(a){t.setState({otpSent:!0,patientId:e.patient,paymentId:e.id})}),(function(){}))}else t.deletePayment(e.patient,e.id)},a.editPaymentClose=function(){a.setState({editPaymentVisible:!1})},a.cancelPaymentClose=function(){a.setState({cancelPaymentVisible:!1})},a.state={payments:[],active_practiceId:a.props.active_practiceId,loading:!0,otpSent:!1,editPaymentVisible:!1,editPayment:null},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadPayments()}},{key:"deletePayment",value:function(e,t){var a=this,n={patient:e,is_cancelled:!0};Object(F.l)(Object(F.f)(A.od,[t]),n,(function(e){Object(F.a)(N.Wb,"Payment cancelled successfully"),a.loadPayments()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a={};return this.state.paymentModes&&this.state.paymentModes.forEach((function(e){a[e.id]=e.mode})),this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/payments/add",render:function(t){return m.a.createElement(En,Object.assign({},e.state,t,e.props,{loadData:e.loadPayments}))}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/payments/edit",render:function(a){return t.state.editPayment?m.a.createElement(En,Object.assign({},e.state,a,e.props,{paymentId:e.state.paymentId,loadData:e.loadPayments})):m.a.createElement(p.a,{to:"/patient/"+a.match.params.id+"/billing/payments"})}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(Ra.a,{banner:!0,showIcon:!0,type:"info",message:"The payments shown are only for the current selected practice!"}),m.a.createElement(k.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.name+" Payments":"Payments",extra:m.a.createElement(P.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/billing/payments/add"},m.a.createElement(P.a,null,m.a.createElement(j.a,{type:"plus"}),"Add")))}),this.state.payments.map((function(t){return xn(t,e)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadPayments(t.state.next)},loading:this.state.loading,hidden:!this.state.next}))))):m.a.createElement("div",null,m.a.createElement(k.a,{bodyStyle:{padding:0},title:this.state.currentPatient?this.state.currentPatient.name+" Payments":"Payments",extra:m.a.createElement(P.a.Group,null,m.a.createElement(P.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(j.a,{type:"plus"}),"Add"))}),this.state.payments.map((function(t){return xn(t,e)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadPayments(t.state.next)},loading:this.state.loading,hidden:!this.state.next}))}}]),t}(m.a.Component)),In=S.a.create()(Cn),Sn=[{title:"INVOICE",dataIndex:"invoice_id",key:"invoice",render:function(e){return m.a.createElement("span",null,e)}},{title:"Amount Paid",key:"pay_amount",dataIndex:"pay_amount",render:function(e){return e.toFixed(2)}}];function xn(e,t){t.props.form.getFieldDecorator;var a=[];return e.is_advance&&a.push({invoice_id:"Advance Payment",pay_amount:e.advance_value}),m.a.createElement(k.a,{style:{marginTop:10},key:e.id,bodyStyle:{padding:0},title:e.patient_data&&!t.props.currentPatient?m.a.createElement("small",null,e.date?G()(e.date).format("lll"):null,m.a.createElement(le.b,{to:"/patient/"+e.patient_data.id+"/billing/payments"},"\xa0\xa0 ",e.patient_data.user.first_name," (ID: ",e.patient_data.custom_id?e.patient_data.custom_id:e.patient_data.id,")\xa0"),m.a.createElement("span",null,", ",e.patient_data.gender)):m.a.createElement("small",null,e.created_at?G()(e.created_at).format("lll"):null),extra:m.a.createElement(pt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Ie.a,null,m.a.createElement(Ie.a.Item,{key:"2",onClick:function(){return t.editModelOpen(e)},disabled:e.practice!=t.props.active_practiceId},m.a.createElement(j.a,{type:"edit"}),"Edit"),m.a.createElement(Ie.a.Item,{key:"3",onClick:function(){return t.cancelModalOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.is_cancelled},m.a.createElement(j.a,{type:"delete"}),"Cancel"),m.a.createElement(Ie.a.Divider,null),m.a.createElement(Ie.a.Item,{key:"4"},m.a.createElement(le.b,{to:"/patient/"+e.patient+"/emr/timeline"},m.a.createElement(j.a,{type:"clock-circle"}),"Patient Timeline")))},m.a.createElement("a",{onClick:function(){return t.loadPDF(e.id)}},m.a.createElement(j.a,{type:"printer"})))},m.a.createElement(f.a,{gutter:8},m.a.createElement(y.a,{xs:24,sm:24,md:6,lg:4,xl:4,xxl:4,style:{padding:10}},e.is_cancelled?m.a.createElement(Ra.a,{message:"Cancelled",type:"error",showIcon:!0}):null,m.a.createElement(v.a,{style:{marginBottom:0}},e.payment_id)),m.a.createElement(y.a,{xs:24,sm:24,md:18,lg:20,xl:20,xxl:20},m.a.createElement(ke.a,{columns:Sn,pagination:!1,footer:function(){return function(e){if(e)return m.a.createElement("p",null,e.doctor?m.a.createElement(we.a,{title:"Doctor"},m.a.createElement(g.a,{color:e.doctor?e.doctor.calendar_colour:null},m.a.createElement("b",null,"prescribed by  "+e.doctor.user.first_name," "))):null,e.practice?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,e.practice.name," "))):null,e.notes?m.a.createElement("p",null,"Notes: ",e.notes):null);return null}({practice:e.practice_data,notes:e.notes})},dataSource:[].concat(Object(D.a)(e.invoices),a),rowKey:e.id}))),t.state.editPaymentVisible&&t.state.otpSent&&m.a.createElement(On,Object.assign({},t.state,{payment:e,editPaymentClose:t.editPaymentClose,editPaymentData:t.editPaymentData},t.props)),t.state.cancelPaymentVisible&&t.state.otpSent&&m.a.createElement(kn,Object.assign({},t.state,{payment:e,cancelPaymentClose:t.cancelPaymentClose},t.props,{loadPayments:t.loadPayments})))}function Dn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function wn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Dn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Dn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Tn=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPDF=function(e){Object(o.a)(a);Object(F.c)(Object(F.f)(A.Qc,[e]),(function(e){e.report&&window.open(ot.a+e.report)}),(function(){}))},a.cancelModalOpen=function(e){var t=Object(o.a)(a);if(G()().diff(e.created_at,"minutes")>N.sb){t.setState({cancelReturnIncoiceVisible:!0,editReturnInvoice:e});var n={practice:a.props.active_practiceId,type:"Return Invoice:"+e.return_id+"  Cancellation"};Object(F.j)(A.K,n,(function(a){t.setState({otpSent:!0,patientId:e.patient,returnInvoiceId:e.id})}),(function(){}))}else t.deleteReturnInvoice(e.patient,e.id)},a.cancelReturnInvoiceClose=function(){a.setState({cancelReturnIncoiceVisible:!1})},a.handleSubmitCancelReturnInvoice=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var r=wn({},n,{practice:a.props.active_practiceId});Object(F.j)(A.M,r,(function(e){t.setState({cancelReturnIncoiceVisible:!1}),t.deleteReturnInvoice(t.state.patientId,t.state.returnInvoiceId)}),(function(){}))}}))},a.state={currentPatient:a.props.currentPatient,active_practiceId:a.props.active_practiceId,returnInvoices:[],drug_catalog:null,procedure_category:null,taxes_list:null,loading:!0,cancelReturnIncoiceVisible:!1},a.loadReturnInvoices=a.loadReturnInvoices.bind(Object(o.a)(a)),a.loadDrugCatalog=a.loadDrugCatalog.bind(Object(o.a)(a)),a.loadProcedureCategory=a.loadProcedureCategory.bind(Object(o.a)(a)),a.loadTaxes=a.loadTaxes.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadReturnInvoices()}},{key:"loadReturnInvoices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;t.props.refreshWallet&&1==e&&t.props.refreshWallet(),t.setState({loading:!0});var a=function(e){1==e.current?t.setState({total:e.count,returnInvoices:e.results,loading:!1,loadMoreReturnInvoice:e.next}):t.setState((function(t){return{total:e.count,returnInvoices:[].concat(Object(D.a)(t.returnInvoices),Object(D.a)(e.results)),loading:!1,loadMoreReturnInvoice:e.next}}))},n=function(){t.setState({loading:!1})},r={page:e,practice:this.props.active_practiceId};this.props.match.params.id&&(r.patient=this.props.match.params.id),Object(F.c)(A.Db,a,n,r)}},{key:"loadDrugCatalog",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Z,[this.props.active_practiceId]),(function(t){e.setState({drug_catalog:t})}),(function(){}))}},{key:"loadProcedureCategory",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Kc,[this.props.active_practiceId]),(function(t){e.setState({procedure_category:t})}),(function(){}))}},{key:"loadTaxes",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Dd,[this.props.active_practiceId]),(function(t){e.setState({taxes_list:t})}),(function(){}))}},{key:"sendOTP",value:function(){Object(F.c)(A.L,(function(e){}),(function(){}))}},{key:"deleteReturnInvoice",value:function(e,t){var a=this,n={patient:e,is_cancelled:!0};Object(F.l)(Object(F.f)(A.td,[t]),n,(function(e){Object(F.a)(N.Wb,"Return Invoice cancelled successfully"),a.loadReturnInvoices()}),(function(){}))}},{key:"render",value:function(){var e=this,t=this,a={};this.state.drug_catalog&&this.state.drug_catalog.forEach((function(e){a[e.id]=e.name+","+e.strength}));var r={};this.state.procedure_category&&this.state.procedure_category.forEach((function(e){r[e.id]=e.name}));var i={};return this.state.taxes_list&&this.state.taxes_list.forEach((function(e){i[e.id]=e.name})),this.props.match.params.id?m.a.createElement("div",null,m.a.createElement(p.d,null,m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement(Ra.a,{banner:!0,showIcon:!0,type:"info",message:"The invoices return shown are only for the current selected practice!"}),m.a.createElement(Je.a,{offsetTop:0},m.a.createElement(k.a,{bodyStyle:{padding:0},style:{boxShadow:"0 5px 8px rgba(0, 0, 0, 0.09)"},title:(this.state.currentPatient?this.state.currentPatient.user.first_name+" Invoice Return":"Invoices Return ")+(this.state.total?"(Total:".concat(this.state.total,")"):"")})),this.state.returnInvoices.map((function(e){return Fn(e,t)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadInvoices(e.state.loadMoreInvoice)},loading:this.state.loading,hidden:!this.state.loadMoreInvoice}))))):m.a.createElement("div",null,m.a.createElement(Je.a,{offsetTop:0},m.a.createElement(k.a,{bodyStyle:{padding:0},style:{boxShadow:"0 5px 8px rgba(0, 0, 0, 0.09)"},title:(this.state.currentPatient?this.state.currentPatient.user.first_name+" Invoice Return":"Invoice Return ")+(this.state.total?"(Total:".concat(this.state.total,")"):"")})),this.state.returnInvoices.map((function(e){return Fn(e,t)})),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,null)),m.a.createElement(L.a,{loaderFunction:function(){return e.loadInvoices(e.state.loadMoreInvoice)},loading:this.state.loading,hidden:!this.state.loadMoreInvoice}))}}]),t}(m.a.Component),Mn=S.a.create()(Tn);function Fn(e,t){var a=t.props.form.getFieldDecorator;return m.a.createElement(k.a,{key:e.id,style:{marginTop:10},bodyStyle:{padding:0},title:m.a.createElement("small",null,e.date?G()(e.date).format("ll"):null,t.state.currentPatient?null:m.a.createElement("span",null,m.a.createElement(le.b,{to:"/patient/"+(e.patient_data?e.patient_data.id:null)+"/billing/return/invoices"},"\xa0\xa0 ",e.patient_data?e.patient_data.user.first_name:null," (ID: ",e.patient_data.custom_id?e.patient_data.custom_id:e.patient_data.id,")\xa0"),", ",e.patient_data?e.patient_data.gender:null)),extra:m.a.createElement(pt.a.Button,{size:"small",style:{float:"right"},overlay:m.a.createElement(Ie.a,null,m.a.createElement(Ie.a.Item,{key:"1",onClick:function(){return t.cancelModalOpen(e)},disabled:e.practice!=t.props.active_practiceId||e.payments_data||e.is_cancelled},m.a.createElement(j.a,{type:"delete"}),"Cancel"))},m.a.createElement("a",{onClick:function(){return t.loadPDF(e.id)}},m.a.createElement(j.a,{type:"printer"})))},m.a.createElement(f.a,{gutter:8},m.a.createElement(y.a,{xs:24,sm:24,md:6,lg:4,xl:4,xxl:4,style:{padding:10}},e.is_cancelled?m.a.createElement(Ra.a,{message:"Cancelled",type:"error",showIcon:!0}):null,m.a.createElement(v.a,{style:{marginBottom:0}},e.return_id),m.a.createElement(_.a,{title:"Cash / Return ",value:e.cash_return?e.cash_return.toFixed(2):0,suffix:"/ "+(e.return_value?e.return_value.toFixed(2):0)})),m.a.createElement(y.a,{xs:24,sm:24,md:18,lg:20,xl:20,xxl:20},m.a.createElement(ke.a,{bordered:!0,pagination:!1,columns:An,dataSource:[].concat(Object(D.a)(e.inventory),Object(D.a)(e.procedure)),footer:function(){return(t=wn({},e))?m.a.createElement("p",null,t.staff?m.a.createElement(we.a,{title:"Staff"},m.a.createElement(g.a,{color:t.staff?t.staff_data.calendar_colour:null},m.a.createElement("b",null,"Return by  "+t.staff_data.user.first_name," "))):null,t.practice?m.a.createElement(g.a,{style:{float:"right"}},m.a.createElement(we.a,{title:"Practice Name"},m.a.createElement("b",null,t.practice_data.name," "))):null,t.notes?m.a.createElement("p",null,"Notes: ",t.notes):null):null;var t}}))),m.a.createElement(h.a,{visible:t.state.cancelReturnIncoiceVisible&&t.state.editReturnInvoice&&t.state.editReturnInvoice.id==e.id,title:"Cancel Return Invoice",footer:null,onOk:t.handleSubmitCancelReturnInvoice,onCancel:t.cancelReturnInvoiceClose},m.a.createElement(S.a,null,m.a.createElement(S.a.Item,null,a("otp",{rules:[{required:!0,message:"Please input Otp!"}]})(m.a.createElement(M.a,{prefix:m.a.createElement(j.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Otp"}))),m.a.createElement(S.a.Item,null,t.state.otpSent?m.a.createElement("a",{style:{float:"right"},type:"primary",onClick:t.sendOTP},"Resend Otp ?"):null,m.a.createElement(P.a,{size:"small",type:"primary",htmlType:"submit",onClick:t.handleSubmitCancelReturnInvoice},"Submit"),"\xa0",m.a.createElement(P.a,{size:"small",onClick:t.cancelReturnInvoiceClose},"Close")))))}var An=[{title:"Treatment & Products",dataIndex:"drug",key:"drug",render:function(e,t){return m.a.createElement("span",null," ",m.a.createElement("b",null,t.name?t.name:null))}},{title:"Cost",dataIndex:"unit_cost",key:"unit_cost",render:function(e,t){return m.a.createElement("span",null,t.unit_cost?t.unit_cost.toFixed(2):null)}},{title:"Unit",dataIndex:"unit",key:"unit"},{title:"Discount",dataIndex:"discount_value",key:"discount_value",render:function(e,t){return m.a.createElement("span",null,t.discount_value?t.discount_value.toFixed(2):null)}},{title:"Tax",dataIndex:"tax_value",key:"tax_value",render:function(e,t){return m.a.createElement("span",null,t.tax_value?t.tax_value.toFixed(2):null)}},{title:"Total",dataIndex:"total",key:"total",render:function(e){return e?e.toFixed(2):null}}],Ln=function(e){var t="";return"Invoice"!=e.type&&(t+=e.type+", "),e.procedure&&e.procedure.forEach((function(e){e.procedure_data&&(t+=e.procedure_data.name+", ")})),e.inventory&&e.inventory.forEach((function(e){e.inventory_item_data&&(t+=e.inventory_item_data.name+", ")})),e.reservation&&(t+=e.type+","),e.reservation_data&&e.reservation_data.medicines&&e.reservation_data.medicines.forEach((function(e){t+=e.name+","})),t.trim(",")},Vn=function(e){var t="";return e.invoices&&e.invoices.forEach((function(e){e.invoice&&(t+=e.invoice.invoice_id+", ")})),t},Nn=function(e){var t="";return e.procedure&&e.procedure.forEach((function(e){e.procedure_data&&(t+=e.procedure_data.name+", ")})),e.inventory&&e.inventory.forEach((function(e){t+=e.name+", "})),e.reservation&&(t+=e.type+","),e.reservation_data&&e.reservation_data.medicines&&e.reservation_data.medicines.forEach((function(e){t+=e.name+","})),t.trim(",")};function Rn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Bn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Rn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Rn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var zn=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPatientLedger=function(){var e=Object(o.a)(a);e.props.refreshWallet&&e.props.refreshWallet(),a.setState({loadingLedger:!0});var t={practice_id:a.props.active_practiceId};a.props.showAllClinic&&a.props.match.params.id&&delete t.practice,Object(F.c)(Object(F.f)(A.rc,[e.props.currentPatient.id]),(function(t){var a=[],n=0,r=0,i=0;t.forEach((function(e){var t={date:e.date,type:e.ledger_type};"Invoice"==e.ledger_type?(t.type_id=e.invoice_id,t.details=Ln(e),t.credit=e.total,t.debit=0,t.return=0,t.cash_return=0):"Payment"==e.ledger_type?(t.type_id=e.payment_id,t.details=Vn(e),e.return_pay?(t.credit=0,t.debit=0,t.return=-1*(e.total+e.advance_value)):(t.credit=0,t.debit=e.total+e.advance_value,t.return=0),t.cash_return=0):"Return"==e.ledger_type&&(t.type_id=e.return_id,t.details=Nn(e),t.credit=e.cash_return,t.debit=0,t.return=e.return_value,0==e.with_tax&&(t.credit+=e.taxes),t.cash_return=e.cash_return),n+=t.credit,n-=t.debit,i+=t.debit,r+=t.credit,t.balance=n,a.push(t)})),e.setState({loadingLedger:!1,credit:r,debit:i,balance:n,ledger:a})}),(function(){e.setState({loadingLedger:!1})}),t)},a.loadPDF=function(e){Object(o.a)(a)},a.state={loading:!1,ledger:[],loadingLedger:!1,selectedList:{},credit:0,debit:0,balance:0},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadPatientLedger()}},{key:"ledgerCompleteToggle",value:function(e,t){this.setState((function(a){return{selectedList:Bn({},a.selectedList,Object(w.a)({},e,!!t))}}))}},{key:"render",value:function(){return m.a.createElement(f.a,null,m.a.createElement(k.a,{title:this.state.currentPatient?this.state.currentPatient.name+" Payment Ledger":"Patient Ledgers",extra:m.a.createElement(P.a.Group,null,m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/billing/payments"}," ",m.a.createElement(P.a,{type:"primary"},m.a.createElement(j.a,{type:"plus"}),"\xa0Add Payment")),m.a.createElement(le.b,{to:"/patient/"+this.props.match.params.id+"/billing/invoices"}," ",m.a.createElement(P.a,{type:"primary"},m.a.createElement(j.a,{type:"plus"}),"\xa0Add Invoice")),"\xa0")},m.a.createElement(ke.a,{loading:this.state.loadingLedger,columns:[{title:"Date",key:"date",dataIndex:"date",width:120},{title:"Invoice/ Receipt/ Return No",key:"type_id",dataIndex:"type_id"},{title:"Details",key:"details",dataIndex:"details"},{title:"Type",key:"type",dataIndex:"type"},{title:"Return(INR)",key:"return",dataIndex:"return",align:"right",render:function(e){return e.toFixed(2)}},{title:"Cash Return(INR)",key:"cash_return",dataIndex:"cash_return",align:"right",render:function(e){return e.toFixed(2)}},{title:"Credit(INR)",key:"credit",dataIndex:"credit",align:"right",render:function(e){return e.toFixed(2)}},{title:"Debit(INR)",key:"debit",dataIndex:"debit",align:"right",render:function(e){return e.toFixed(2)}},{title:"Balance(INR)",key:"balance",dataIndex:"balance",align:"right",render:function(e){return e.toFixed(2)}}],dataSource:this.state.ledger,pagination:!1}),m.a.createElement(f.a,{style:{marginTop:20,textAlign:"center"}},m.a.createElement(y.a,{span:8},m.a.createElement("h3",null,"Total Credit: ",this.state.credit.toFixed(2))),m.a.createElement(y.a,{span:8},m.a.createElement("h3",null,"Total Debit: ",this.state.debit.toFixed(2))),m.a.createElement(y.a,{span:8},m.a.createElement("h3",null,"Total Balance: ",this.state.balance<0?(-1*this.state.balance).toFixed(2)+" (Advance)":this.state.balance.toFixed(2))))))}}]),t}(m.a.Component),Yn=(a(379),a(395)),qn=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).searchPatient=function(e){a.setState({searchPatientString:e});var t=Object(o.a)(a);e&&Object(F.c)(Object(F.f)(A.Vc,[e]),(function(e){e&&t.setState({patientListData:e.results})}),(function(){}))},a.removePatient=function(e){a.setState(Object(w.a)({},e,null))},a.handlePatientSelect=function(e,t){if(console.log(e),e){var n=Object(o.a)(a);Object(F.c)(Object(F.f)(A.wc,[e]),(function(e){n.setState(Object(w.a)({},t,e))}),(function(){}))}},a.mergePatient=function(){a.setState({loading:!0});var e=Object(o.a)(a),t={patient_from:a.state.patient_from.id,patient_to:a.state.patient_to.id};Object(F.j)(A.cc,t,(function(t){Object(F.a)(N.Wb,"Patients Merged Successfully!!"),e.setState({loading:!1,patient_from:null,patient_to:null})}),(function(){Object(F.a)(N.S,"Patients Merging Failed!!"),e.setState({loading:!1})}))},a.state={patient_from:null,patient_to:null,loading:!1,patientListData:[]},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return m.a.createElement("div",null,m.a.createElement("h2",null,"Merge Patients"),m.a.createElement(k.a,null,m.a.createElement(Ra.a,{message:"Profile details and records of Patient 1 will be moved to Patient 2. You cannot undo this action once done.",type:"warning"}),m.a.createElement(n.a,{spinning:this.state.loading},m.a.createElement(f.a,{gutter:16,style:{marginTop:10}},m.a.createElement(y.a,{span:12,style:{textAlign:"center"}},m.a.createElement("h3",null,"Patient 1"),this.state.patient_from?m.a.createElement(k.a,{bordered:!1,style:{background:"#ECECEC",textAlign:"left"}},m.a.createElement(k.a.Meta,{avatar:this.state.patient_from.image?m.a.createElement(O.a,{src:Object(F.g)(this.state.patient_from.image)}):m.a.createElement(O.a,{style:{backgroundColor:"#87d068"}},this.state.patient_from.user.first_name?this.state.patient_from.user.first_name.charAt(0):m.a.createElement(j.a,{type:"user"})),title:this.state.patient_from.user.first_name,description:this.state.patient_from.user.mobile}),m.a.createElement(P.a,{type:"primary",style:{float:"right"},onClick:function(){return e.removePatient("patient_from")}},"Select Different Patient")):m.a.createElement(Yn.a,{placeholder:"Patient Name",showSearch:!0,onSearch:this.searchPatient,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onChange:this.handleChange,onSelect:function(t){return e.handlePatientSelect(t,"patient_from")}},this.state.patientListData.map((function(e){return m.a.createElement(Yn.a.Option,{value:e.id.toString()},m.a.createElement(b.a.Item,{style:{padding:0}},m.a.createElement(b.a.Item.Meta,{avatar:e.image?m.a.createElement(O.a,{src:Object(F.g)(e.image)}):m.a.createElement(O.a,{style:{backgroundColor:"#87d068"}},e.user.first_name?e.user.first_name.charAt(0):m.a.createElement(j.a,{type:"user"})),title:e.user.first_name+" ("+e.user.id+")",description:m.a.createElement("small",null,e.user.mobile)})))})))),m.a.createElement(y.a,{span:12,style:{textAlign:"center"}},m.a.createElement("h3",null,"Patient 2"),this.state.patient_to?m.a.createElement(k.a,{bordered:!1,style:{background:"#ECECEC",textAlign:"left"}},m.a.createElement(k.a.Meta,{avatar:this.state.patient_to.image?m.a.createElement(O.a,{src:Object(F.g)(this.state.patient_to.image)}):m.a.createElement(O.a,{style:{backgroundColor:"#87d068"}},this.state.patient_to.user.first_name?this.state.patient_to.user.first_name.charAt(0):m.a.createElement(j.a,{type:"user"})),title:this.state.patient_to.user.first_name,description:this.state.patient_to.user.mobile}),m.a.createElement(P.a,{type:"primary",style:{float:"right"},onClick:function(){return e.removePatient("patient_to")}},"Select Different Patient")):m.a.createElement(Yn.a,{placeholder:"Patient Name",showSearch:!0,onSearch:this.searchPatient,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onChange:this.handleChange,onSelect:function(t){return e.handlePatientSelect(t,"patient_to")}},this.state.patientListData.map((function(e){return m.a.createElement(Yn.a.Option,{value:e.id.toString()},m.a.createElement(b.a.Item,{style:{padding:0}},m.a.createElement(b.a.Item.Meta,{avatar:e.image?m.a.createElement(O.a,{src:Object(F.g)(e.image)}):m.a.createElement(O.a,{style:{backgroundColor:"#87d068"}},e.user.first_name?e.user.first_name.charAt(0):m.a.createElement(j.a,{type:"user"})),title:e.user.first_name+" ("+e.user.id+")",description:m.a.createElement("small",null,e.user.mobile)})))})))),m.a.createElement(y.a,{span:24,style:{textAlign:"center",marginTop:30}},m.a.createElement(P.a,{disabled:this.state.loading||!this.state.patient_from||!this.state.patient_to,type:"primary",onClick:this.mergePatient},m.a.createElement(j.a,{type:"plus"}),"Merge Patients"))))))}}]),t}(m.a.Component),Gn=function(e){function t(e){return Object(r.a)(this,t),Object(l.a)(this,Object(c.a)(t).call(this,e))}return Object(s.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return m.a.createElement(k.a,{style:{textAlign:"center"}},m.a.createElement("h2",null," Please select patient to further continue !!"),this.props.togglePatientListModal?m.a.createElement(P.a,{type:"primary",onClick:function(){return e.props.togglePatientListModal(!0)}},m.a.createElement(j.a,{type:"user"})," Select Patient"):null)}}]),t}(m.a.Component),Wn=(a(377),a(394));function Hn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Un=M.a.TextArea,Kn=x.a.Option,Xn=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleCheck=function(e){a.setState({excused_duty_checked:!a.state.excused_duty_checked})},a.handleLighDutyCheck=function(e){a.setState({fit_light_duty_checked:!a.state.fit_light_duty_checked})},a.onChangeHandle=function(e){console.log("handlechanged",e),a.setState({value:e.target.value})},a.handleAttendanceCheck=function(e){a.setState({attendance_checked:!a.state.attendance_checked})},a.handleChangeStart=function(e){a.setState({startDate:e})},a.onChange=function(e){a.setState({proof_attendance_from:e})},a.selectedDate=function(e){a.setState({selectedDate:e})},a.selectDoctor=function(e){a.setState({selectedDoctor:e})},a.handleSubmit=function(e){var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(n.excused_duty||n.fit_light_duty||n.proof_attendance){if(!e){var r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Hn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Hn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{doctor:t.state.selectedDoctor.id,practice:t.props.active_practiceId,date:t.state.selectedDate&&G()(t.state.selectedDate).isValid()?t.state.selectedDate.format("YYYY-MM-DD"):null,excused_duty_from:G()(n.excused_duty_from).format("YYYY-MM-DD"),excused_duty_to:G()(n.excused_duty_to).format("YYYY-MM-DD"),fit_light_duty_from:G()(n.fit_light_duty_from).format("YYYY-MM-DD"),fit_light_duty_to:G()(n.fit_light_duty_to).format("YYYY-MM-DD"),proof_attendance_date:G()(n.proof_attendance_date).format("YYYY-MM-DD"),proof_attendance_from:G()(n.proof_attendance_from).format("LT"),proof_attendance_to:G()(n.proof_attendance_to).format("LT"),patient:t.props.match.params.id,is_active:!0,valid_court:!1,invalid_court:!1,no_mention:!1});n.group&&(r[n.group]=!0),delete r.group;Object(F.j)(Object(F.f)(A.Sb,[a.props.currentPatient.id]),r,(function(e){Object(F.a)(N.Wb,"Medical Certificate Generated."),t.props.history.push("/patient/"+t.props.match.params.id+"/emr/files")}),(function(){t.setState({})}))}}else Object(F.a)(N.S,"Please select at least one of the above options")}))},a.state={redirect:!1,excused_duty_checked:!1,fit_light_duty_checked:!1,attendance_checked:!1,startDate:a.props.value,endDate:new Date,proof_attendance_from:null,days:0,practiceDoctors:[],selectedDoctor:{},selectedDate:G()(),value:""},a.handleChangeStart=a.handleChangeStart.bind(Object(o.a)(a)),a.handleChangeEnd=a.handleChangeEnd.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){Object(de.d)(this)}},{key:"changeRedirect",value:function(){var e=this.state.redirect;this.setState({redirect:!e})}},{key:"handleChangeEnd",value:function(e){this.setState({endDate:e})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=Y.fb.map((function(e){return m.a.createElement(I.a,{value:e.value},e.label)}));return m.a.createElement(S.a,Object.assign({onSubmit:this.handleSubmit},{labelCol:{xs:{span:24},sm:{span:8},md:{span:8},lg:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16},md:{span:16},lg:{span:16}}}),m.a.createElement(k.a,{title:"ADD MEDICAL LEAVE CERTIFICATE",extra:m.a.createElement(P.a.Group,null,m.a.createElement(P.a,{type:"primary",htmlType:"submit"},"Save Certificate"))},m.a.createElement(S.a.Item,null,t("excused_duty",{})(m.a.createElement(fe.a,{onClick:this.handleCheck,defaultChecked:this.state.excused_duty_checked},"Excused from duty"))),this.state.excused_duty_checked?m.a.createElement(f.a,null,m.a.createElement(y.a,{span:6,offset:6},m.a.createElement(S.a.Item,{label:"From"},t("excused_duty_from",{})(m.a.createElement(T.a,null))),m.a.createElement(S.a.Item,{label:"till"},t("excused_duty_to",{})(m.a.createElement(T.a,null)))),m.a.createElement(y.a,{span:6},m.a.createElement(S.a.Item,null,t("excused_duty_from_session",{initialValue:"Morning"})(m.a.createElement(x.a,null,m.a.createElement(Kn,{value:"Morning"},"Morning Session"),m.a.createElement(Kn,{value:"Morning"},"Evening Session")))),m.a.createElement(S.a.Item,null,t("excused_duty_to_session",{initialValue:"Morning"})(m.a.createElement(x.a,null,m.a.createElement(Kn,{value:"Morning"},"Morning Session"),m.a.createElement(Kn,{value:"Morning"},"Evening Session")))))):null,m.a.createElement(S.a.Item,null,t("fit_light_duty",{})(m.a.createElement(fe.a,{onClick:this.handleLighDutyCheck,defaultChecked:this.state.fit_light_duty_checked},"Fit for light duty"))),this.state.fit_light_duty_checked?m.a.createElement(f.a,null,m.a.createElement(y.a,null,m.a.createElement(S.a.Item,{label:"From"},t("fit_light_duty_from",{})(m.a.createElement(T.a,null))),m.a.createElement(S.a.Item,{label:"till"},t("fit_light_duty_to",{})(m.a.createElement(T.a,null))))):null,m.a.createElement(S.a.Item,null,t("proof_attendance",{})(m.a.createElement(fe.a,{onClick:this.handleAttendanceCheck,defaultChecked:this.state.attendance_checked},"Proof of attendance at practice"))),this.state.attendance_checked?m.a.createElement(f.a,null,m.a.createElement(S.a.Item,{label:"on"},t("proof_attendance_date",{})(m.a.createElement(T.a,null))),m.a.createElement(y.a,{span:6,offset:6},m.a.createElement(S.a.Item,{label:"From"},t("proof_attendance_from",{})(m.a.createElement(Wn.a,{use12Hours:!0,format:"h:mm A"}))),m.a.createElement(S.a.Item,{label:"till"},t("proof_attendance_to",{})(m.a.createElement(Wn.a,{use12Hours:!0,format:"h:mm A"}))))):null,m.a.createElement(S.a.Item,{label:"Notes"},t("notes",{})(m.a.createElement(Un,null))),m.a.createElement(S.a.Item,null,t("group",{initialValue:"no_mention"})(m.a.createElement(I.a.Group,null,a))),m.a.createElement(Je.a,{offsetBottom:0},m.a.createElement(k.a,null,m.a.createElement("span",null,"Issued by \xa0\xa0"),m.a.createElement(pt.a,{placement:"topCenter",overlay:m.a.createElement(Ie.a,null,this.state.practiceDoctors.map((function(t){return m.a.createElement(Ie.a.Item,{key:"0"},m.a.createElement("a",{onClick:function(){return e.selectDoctor(t)}},t.user.first_name))}))),trigger:["click"]},m.a.createElement("a",{className:"ant-dropdown-link",href:"#"},m.a.createElement("b",null,this.state.selectedDoctor.user?this.state.selectedDoctor.user.first_name:"No DOCTORS Found"))),m.a.createElement("span",null," \xa0\xa0on\xa0\xa0"),m.a.createElement(T.a,{value:this.state.selectedDate,onChange:function(t){return e.selectedDate(t)},format:"DD-MM-YYYY",allowClear:!1})))))}}]),t}(m.a.Component),Qn=S.a.create()(Xn);function Zn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Jn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Zn(a,!0).forEach((function(t){Object(w.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Zn(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var $n=k.a.Meta,er=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPackages=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.v,[a.props.active_practiceId]),(function(t){e.setState({packages:t})}),(function(){}))},a.loadDiseases=function(){var e=Object(o.a)(a);Object(F.c)(Object(F.f)(A.X,[a.props.active_practiceId]),(function(t){e.setState({diseases:t})}),(function(){}))},a.searchPatient=function(e){var t=Object(o.a)(a);Object(F.c)(Object(F.f)(A.Vc,[e]),(function(e){e&&t.setState({patientList:e,ptr:e})}),(function(){}))},a.handlePatientSelect=function(e){if(e){var t=Object(o.a)(a);Object(F.c)(Object(F.f)(A.wc,[e]),(function(e){t.setState({patientDetails:e})}),(function(){}))}},a.checkBedStatus=function(e,t){var n=Object(o.a)(a);n.handleRoomType(),a.setState(Object(w.a)({},e,t),(function(){n.calculateTotalAmount();var e=n.state,t=e.from_date,a=e.bed_package;if(t&&a){var r=null;if(n.state.packages.forEach((function(e){a==e.id&&(r=G()(t).add(e.no_of_days-1,"day"))})),t&&r&&a)(0,n.props.form.setFieldsValue)({to_date:r}),Object(F.c)(Object(F.f)(A.P,[n.props.active_practiceId]),(function(e){n.setState({availabilitySeatTatkal:e.TATKAL,availabilitySeatNormal:e.NORMAL}),e[n.props.form.getFieldValue("seat_type")]||(n.props.form.setFieldsValue({seat_type:null}),n.calculateTotalAmount())}),(function(){}),{start:G()(t).format("YYYY-MM-DD"),end:G()(r).format("YYYY-MM-DD"),bed_package:a})}}))},a.handleSubmit=function(e){a.setState({loading:!0});var t=Object(o.a)(a);e.preventDefault(),a.props.form.validateFields((function(e,n){if(!e){var r=Jn({},n,{to_date:G()(n.to_date).format("YYYY-MM-DD"),from_date:G()(n.from_date).format("YYYY-MM-DD"),paid:!1,total_price:a.state.totalPayableAmount,date:G()().format("YYYY-MM-DD"),total_tax:a.state.tax,patient:a.state.patientDetails.id,rest_diseases:n.rest_diseases?n.rest_diseases.join(","):null,report_upload:n.file&&n.file.file.response?n.file.file.response.image_path:null});Object(F.j)(Object(F.f)(A.G,[a.props.active_practiceId]),r,(function(e){Object(F.a)(N.Wb,"Saved Successfully!!"),t.props.history.goBack(),t.props.loadData&&t.props.loadData()}),(function(){}))}}))},a.handleClick=function(e){a.setState({patientDetails:null})},a.handleRoomType=function(e,t){var n=Object(o.a)(a);a.setState(Object(w.a)({},e,t),(function(){n.calculateTotalAmount()}))},a.calculateTotalAmount=function(){Object(o.a)(a).setState((function(e){var t=0,a=0,n={},r=[],i=0;return e.packages.forEach((function(i){e.bed_package==i.id&&("NORMAL"==e.seat_type&&(t=i.normal_price+i.normal_tax_value,a+=i.normal_tax_value,n=Jn({},i,{type:"BED",price_with_tax:t,tax:i.normal_tax_value,price:i.normal_price,_id:Math.random().toFixed(7)}),r=[n]),"TATKAL"==e.seat_type&&(t=i.tatkal_price+i.tatkal_tax_value,a+=i.tatkal_tax_value,n=Jn({},i,{type:"BED",price_with_tax:t,tax:i.tatkal_tax_value,price:i.tatkal_price,_id:Math.random().toFixed(7)}),r=[n]))})),e.medicinePackage.forEach((function(t){e.medicineItem.forEach((function(e){t.id==e&&(i+=t.final_price,a+=t.tax_value,r=[].concat(Object(D.a)(r),[Jn({},t,{type:"MEDICINE",price_with_tax:t.final_price,tax:t.tax_value,_id:Math.random().toFixed(7)})]))}))})),{totalPayableAmount:t+i,tax:a,choosePkg:Object(D.a)(r)}}))},a.setPaymentAmount=function(e){var t=Object(o.a)(a);a.setState({totalPayingAmount:e},(function(){t.calculateTotalAmount()}))},a.handleMedicineSelect=function(e){var t=e;a.setState({medicineItem:t},(function(){this.calculateTotalAmount()}))},a.changeDiscount=function(e,t){Object(o.a)(a).setState((function(a){var n=[];return a.choosePkg.forEach((function(a){a._id==e?n.push(Jn({},a,{discount:t})):n.push(a)})),{choosePkg:n}}))},a.state={packages:[],totalPayableAmount:0,totalPayingAmount:0,patientList:[],paymentModes:[],medicinePackage:[],medicineItem:[],diseases:[]},a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.currentPatient&&this.handlePatientSelect(this.props.currentPatient.id),this.loadPackages(),this.loadPaymentModes(),this.loadMedicinePackages(),this.loadDiseases()}},{key:"loadMedicinePackages",value:function(){var e=this;Object(F.c)(Object(F.f)(A.Wb,[this.props.active_practiceId]),(function(t){e.setState({medicinePackage:t})}),(function(){}))}},{key:"loadPaymentModes",value:function(){var e=this;Object(F.c)(Object(F.f)(A.zc,[this.props.active_practiceId]),(function(t){e.setState({paymentModes:t})}),(function(){}))}},{key:"render",value:function(){var e=this,t=[{value:"NORMAL",is_or_not:!(!this.state.availabilitySeatNormal||!this.state.availabilitySeatNormal.available)},{value:"TATKAL",is_or_not:!(!this.state.availabilitySeatTatkal||!this.state.availabilitySeatTatkal.available)}],a=this,n=this.props.form.getFieldDecorator,r={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:14}}},i=[{title:"Item",key:"name",dataIndex:"name"},{title:"Normal Price",key:"normal_price",dataIndex:"normal_price"},{title:"Tatkal Price",key:"tatkal_price",dataIndex:"tatkal_price"},{title:"discount %",key:"discount",width:100,dataIndex:"discount",render:function(e,t){return m.a.createElement(S.a.Item,Object.assign({key:"discount[".concat(t._id,"]")},r),n("discount[".concat(t._id,"]"),{initialValue:t.discount,validateTrigger:["onChange","onBlur"]})(m.a.createElement(C.a,{min:0,max:100,placeholder:"discount",size:"small",value:t.discount,onChange:function(e){return a.changeDiscount(t._id,e)}})))}},{title:"Price",key:"price",dataIndex:"price",render:function(e,t){return m.a.createElement("p",null,e?e.toFixed(2):null)}},{title:"Tax",key:"tax",dataIndex:"tax",render:function(e,t){return m.a.createElement("p",null,e?e.toFixed(2):null)}},{title:"Total Amount",key:"price_with_tax",dataIndex:"price_with_tax",render:function(e,t){return m.a.createElement("p",null,e?e.toFixed(2):null)}}],l={name:"image",data:{name:"hello"},action:Object(F.h)(A.sb),headers:{authorization:"authorization-text"},onChange:function(e){e.file.status,"done"===e.file.status?ge.a.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&ge.a.error("".concat(e.file.name," file upload failed."))}};return m.a.createElement("div",null,m.a.createElement(k.a,{title:"Book a Seat/Bed"},m.a.createElement(S.a,null,m.a.createElement(f.a,null,m.a.createElement(y.a,{xs:24,sm:24,md:12,lg:12,xl:12},m.a.createElement("div",null,this.state.patientDetails?m.a.createElement(S.a.Item,Object.assign({key:"id",value:this.state.patientDetails?this.state.patientDetails.id:""},{wrapperCol:{xs:{offset:6,span:24},sm:{offset:6,span:14}}}),m.a.createElement(k.a,{bordered:!1,style:{background:"#ECECEC"}},m.a.createElement($n,{avatar:this.state.patientDetails.image?m.a.createElement(O.a,{src:Object(F.g)(this.state.patientDetails.image)}):m.a.createElement(O.a,{style:{backgroundColor:"#87d068"}},this.state.patientDetails.user.first_name?this.state.patientDetails.user.first_name.charAt(0):m.a.createElement(j.a,{type:"user"})),title:this.state.patientDetails.user.first_name,description:this.state.patientDetails.user.mobile}))):m.a.createElement("div",null,m.a.createElement(S.a.Item,Object.assign({label:"Patient"},r),n("patient",{rules:[{required:!0,message:"this field required"}]})(m.a.createElement(Yn.a,{placeholder:"Patient Name",showSearch:!0,onSearch:this.searchPatient,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onSelect:this.handlePatientSelect},this.state.patientList.map((function(e){return m.a.createElement(Yn.a.Option,{value:e?e.id.toString():""},m.a.createElement(b.a.Item,{style:{padding:0}},m.a.createElement(b.a.Item.Meta,{avatar:e.image?m.a.createElement(O.a,{style:{backgroundColor:"#ffff"},src:Object(F.g)(e.image)}):m.a.createElement(j.a,{type:"user"}),title:e.user.first_name+" ("+e.user.id+")",description:m.a.createElement("small",null,e.user.mobile)})))})))),this.state.ptr?m.a.createElement(Ra.a,{message:"Patient Not Found !!",description:"Please Search another patient or create new patient.",type:"error"}):null)),m.a.createElement(S.a.Item,Object.assign({label:"Bed Package"},r),n("bed_package",{rules:[{required:!0,message:"this field required!"}]})(m.a.createElement(x.a,{onChange:function(e){return a.checkBedStatus("bed_package",e)}},a.state.packages.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)}))))),m.a.createElement(S.a.Item,Object.assign({label:"Book From"},r),n("from_date",{rules:[{required:!0,message:"Input From Date!"}]})(m.a.createElement(T.a,{onChange:function(e){return a.checkBedStatus("from_date",e)},format:"DD-MM-YYYY"}))),m.a.createElement(S.a.Item,Object.assign({label:"Book To"},r),n("to_date",{rules:[{required:!0,message:"Input To Date!"}]})(m.a.createElement(T.a,{disabled:!0,format:"DD-MM-YYYY"}))),m.a.createElement(S.a.Item,Object.assign({label:"Booking Type"},r),n("seat_type",{rules:[{required:!0,message:"this field required"}]})(m.a.createElement(I.a.Group,{onChange:function(t){return e.handleRoomType("seat_type",t.target.value)}},t.map((function(e){return m.a.createElement(I.a,{value:e.is_or_not?e.value:"",disabled:!e.is_or_not},e.value)}))))),m.a.createElement(S.a.Item,Object.assign({label:"Medicine  Package"},r),n("medicines",{})(m.a.createElement(x.a,{mode:"multiple",onChange:this.handleMedicineSelect},a.state.medicinePackage.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)}))))),m.a.createElement(S.a.Item,Object.assign({label:"Pay Now : "},r),n("pay_value",{rules:[{required:!0,message:"this field is required"}],initialValue:this.state.totalPayingAmount?this.state.totalPayingAmount:null})(m.a.createElement(C.a,{min:0,step:1,max:this.state.totalPayableAmount,onChange:this.setPaymentAmount}))),m.a.createElement(S.a.Item,Object.assign({label:"Payment Mode"},r),n("payment_mode",{rules:[{required:!0,message:"this field required"}]})(m.a.createElement(x.a,{showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.paymentModes.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.mode)}))))))),m.a.createElement(y.a,{xs:24,sm:24,md:12,lg:12,xl:12},m.a.createElement(v.a,null,"Patient Details"),m.a.createElement(S.a.Item,Object.assign({label:"Creatinine Level"},r),n("creatinine",{})(m.a.createElement(M.a,null))),m.a.createElement(S.a.Item,Object.assign({label:"Urea Level"},r),n("urea_level",{})(m.a.createElement(M.a,null))),m.a.createElement(S.a.Item,Object.assign({label:"Currently on Dialysis?"},r),n("dialysis",{})(m.a.createElement(x.a,{showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},m.a.createElement(x.a.Option,{value:!0},"YES"),m.a.createElement(x.a.Option,{value:!1},"NO")))),m.a.createElement(S.a.Item,Object.assign({label:"Diseases"},r),n("other_diseases",{})(m.a.createElement(x.a,{showSearch:!0,mode:"multiple",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.diseases.map((function(e){return m.a.createElement(x.a.Option,{value:e.id},e.name)}))))),m.a.createElement(S.a.Item,Object.assign({label:"Other Diseases"},r),n("rest_diseases",{})(m.a.createElement(x.a,{mode:"tags"}))),m.a.createElement(S.a.Item,Object.assign({label:"Upload Report"},r),n("file",{})(m.a.createElement(he.a,l,m.a.createElement(P.a,null,m.a.createElement(j.a,{type:"upload"})," Select File")))),m.a.createElement(ke.a,{pagination:!1,columns:i,size:"small",dataSource:this.state.choosePkg})),m.a.createElement(y.a,{span:24},m.a.createElement("h3",null,"Grand Total: ",m.a.createElement("b",null,this.state.totalPayableAmount.toFixed(2))),m.a.createElement(S.a.Item,null,m.a.createElement(E.a,{title:"Are you sure to take payment of INR "+this.state.totalPayingAmount+"?",onConfirm:this.handleSubmit},m.a.createElement(P.a,{type:"primary"},"Submit")),a.props.history?m.a.createElement(P.a,{style:{margin:5},onClick:function(){return a.props.history.goBack()}},"Cancel"):null))))))}}]),t}(m.a.Component),tr=S.a.create()(er),ar=u.a.Content,nr=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadBedBookingReport=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(o.a)(a);a.setState({loading:!0});var n=function(e){console.log(e),1==e.current?t.setState({bedBookingReports:e.results,loading:!1,nextReport:e.next}):t.setState((function(t){return{bedBookingReports:[].concat(Object(D.a)(t.bedBookingReports),Object(D.a)(e.results)),loading:!1,nextReport:e.next}}))},r=function(){t.setState({loading:!1})};Object(F.c)(Object(F.f)(A.u,[a.props.active_practiceId]),n,r,{page:e,patients:a.state.patient.id})},a.state={loading:!0,bedBookingReports:[],patient:a.props.currentPatient||{}},a.loadBedBookingReport=a.loadBedBookingReport.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadBedBookingReport()}},{key:"render",value:function(){var e=this,t=this,a=[{title:"Bed Package",key:"name",dataIndex:"bed_package.name"},{title:"Medicine Package",key:"medicine",dataIndex:"medicines",render:function(e,t){return m.a.createElement("span",null,e.map((function(e){return m.a.createElement(g.a,null,e.name)})))}},{title:"From ",key:"from_date",render:function(e,t){return m.a.createElement("span",null,G()(t.from_date).format("LL"))}},{title:"To ",key:"to_date",render:function(e,t){return m.a.createElement("span",null,G()(t.to_date).format("LL"))}},{title:"Seat/Bed Type",key:"seat_type",dataIndex:"seat_type"},{title:"Seat Number",key:"seat_no",dataIndex:"seat_no"},{title:"Total price",key:"total_price",dataIndex:"total_price",render:function(e){return m.a.createElement("p",null,e.toFixed(2))}},{title:"Payment Status",key:"payment_status",dataIndex:"payment_status"}];return m.a.createElement(ar,{className:"main-container",style:{minHeight:280}},m.a.createElement(u.a,null,m.a.createElement(p.d,null,m.a.createElement(p.b,{path:"/patient/:patient/booking/bed-booking",render:function(){return t.props.activePracticePermissions.PatientBookings||t.props.allowAllPermissions?m.a.createElement(tr,Object.assign({},e.props,{bedBooking:!0,loadData:e.loadBedBookingReport})):m.a.createElement(X.a,null)}}),m.a.createElement(p.b,null,m.a.createElement("div",null,m.a.createElement("h2",null,"Bed Booking Management",m.a.createElement(le.b,{to:"/patient/"+this.state.patient.id+"/booking/bed-booking"},m.a.createElement(P.a,{type:"primary",style:{float:"right"}},m.a.createElement(j.a,{type:"plus"}),"\xa0Book A Seat"))),m.a.createElement(k.a,null,m.a.createElement(V.a,{pagination:!1,hideReport:!0,loading:this.state.loading,columns:a,size:"small",dataSource:this.state.bedBookingReports}),m.a.createElement(L.a,{loaderFunction:function(){return e.loadBedBookingReport(e.state.nextReport)},loading:this.state.loading,hidden:!this.state.nextReport})))))))}}]),t}(m.a.Component),rr=a(619),ir=u.a.Content,lr=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).loadPatientPendingAmount=function(){var e=Object(o.a)(a);if(a.state.currentPatient&&a.state.currentPatient.id){Object(F.c)(Object(F.f)(A.vc,[a.state.currentPatient.id]),(function(t){e.setState({pendingAmount:t})}),(function(){}))}else a.setState({pendingAmount:null})},a.loadPatientWallet=function(){var e=Object(o.a)(a);if(a.state.currentPatient&&a.state.currentPatient.id){Object(F.c)(Object(F.f)(A.g,[a.state.currentPatient.id]),(function(t){e.setState({walletAmount:t})}),(function(){}))}else a.setState({pendingAmount:null})},a.refreshWallet=function(){a.loadPatientWallet(),a.loadPatientPendingAmount()},a.state={currentPatient:null,active_practiceId:a.props.active_practiceId,medicalHistory:[],listModalVisible:!1,loading:!1,showAllClinic:Object(F.d)("showAllClinic"),pendingAmount:null,walletAmount:null,hideSidePanel:!1},a.setCurrentPatient=a.setCurrentPatient.bind(Object(o.a)(a)),a.togglePatientListModal=a.togglePatientListModal.bind(Object(o.a)(a)),a.toggleShowAllClinic=a.toggleShowAllClinic.bind(Object(o.a)(a)),a.loadPatientPendingAmount=a.loadPatientPendingAmount.bind(Object(o.a)(a)),a.loadPatientWallet=a.loadPatientWallet.bind(Object(o.a)(a)),a}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){!this.props.match.params.id||this.state.currentPatient&&this.props.match.params.id==this.state.currentPatient.id||this.getPatientListData(this.props.match.params.id),this.loadPatientPendingAmount(),this.loadPatientWallet()}},{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.state.currentPathLocation!=e.location&&this.setState({currentPathLocation:e.location},(function(){for(var e=!1,t=0;t<Y.yb.length;t++)Object(p.f)(a.state.currentPathLocation.pathname,{path:Y.yb[t],exact:!1,strict:!1})&&(e=!0,a.setState({hideSidePanel:!0}));e||a.setState({hideSidePanel:!1})}))}},{key:"getPatientListData",value:function(e){var t=this;t.setState({loading:!0});Object(F.c)(Object(F.f)(A.wc,[e]),(function(e){t.setCurrentPatient(e)}),(function(){Object(F.a)(N.S,"Patient Loading Failed"),t.setState({loading:!1})}))}},{key:"setCurrentPatient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this,n=this.props.location.pathname.split("/");isNaN(parseInt(n[2]))?e&&(n[1]="patient",n.splice(2,0,e.id)):e?(n[1]="patient",n[2]=e.id):(n[1]="patients",n.splice(2,1)),this.props.history.push(n.join("/")),this.setState({currentPatient:e,loading:!1,listModalVisible:!1},(function(){t&&a.props.history.push(Object(F.f)(t,[e.id]))}))}},{key:"togglePatientListModal",value:function(e){this.setState({listModalVisible:!!e})}},{key:"toggleShowAllClinic",value:function(e){this.setState({showAllClinic:!!e},(function(){Object(F.n)("showAllClinic",!!e)}))}},{key:"render",value:function(){var e=this,t=this;return m.a.createElement(ir,null,m.a.createElement(n.a,{spinning:this.state.loading,size:"large"},m.a.createElement(Ut,Object.assign({},this.state,this.props,{togglePatientListModal:this.togglePatientListModal,key:this.state.currentPatient,setCurrentPatient:this.setCurrentPatient,toggleShowAllClinic:this.toggleShowAllClinic,refreshWallet:this.refreshWallet})),m.a.createElement(u.a,null,m.a.createElement(De,Object.assign({},this.state,this.props)),m.a.createElement(u.a,null,m.a.createElement(ir,{className:"main-container",key:this.state.showAllClinic.toString(),style:{padding:"0px 5px",minHeight:280}},m.a.createElement(p.d,null,m.a.createElement(p.b,{exact:!0,path:"/patients/merge",render:function(a){return t.props.activePracticePermissions.MergePatients||t.props.allowAllPermissions?m.a.createElement(qn,e.state):m.a.createElement(X.a,null)}}),t.props.activePracticePermissions.WebAdmin||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/profile",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/profile"}):m.a.createElement(me,Object.assign({},e.state,{key:e.state.currentPatient,setCurrentPatient:e.setCurrentPatient},e.props))}}):null,m.a.createElement(p.b,{exact:!0,path:"/patients/profile/add",render:function(a){return t.props.activePracticePermissions.AddPatient||t.props.allowAllPermissions?m.a.createElement(Pe,Object.assign({key:e.state.currentPatient},e.props,a)):m.a.createElement(X.a,null)}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/profile",render:function(a){return t.props.activePracticePermissions.ViewPatient||t.props.allowAllPermissions?m.a.createElement(me,Object.assign({},e.state,{key:e.state.currentPatient,setCurrentPatient:e.setCurrentPatient},e.props,a)):m.a.createElement(X.a,null)}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/profile/edit",render:function(a){return t.props.activePracticePermissions.EditPatient||t.props.allowAllPermissions?m.a.createElement(Pe,Object.assign({key:e.state.currentPatient},e.state,e.props,a)):m.a.createElement(X.a,null)}}),t.props.activePracticePermissions.PatientAppointments||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/appointments",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/appointments"}):m.a.createElement(Ce,Object.assign({key:e.state.currentPatient},e.state,t,e.props))}}):null,t.props.activePracticePermissions.PatientAppointments||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patient/:id/appointments",render:function(t){return m.a.createElement(Ce,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t,e.props))}}):null,t.props.activePracticePermissions.PatientAppointments||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/appointments/:appointmentid",render:function(t){return m.a.createElement(Ce,Object.assign({key:e.state.currentPatient},e.state,t,e.props))}}):null,t.props.activePracticePermissions.PatientCommunications||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/communications",render:function(){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/communications"}):m.a.createElement(Gn,{togglePatientListModal:e.togglePatientListModal})}}):null,t.props.activePracticePermissions.PatientCommunications||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patient/:id/communications",render:function(t){return m.a.createElement(Zt,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t))}}):null,t.props.activePracticePermissions.PatientVitalSigns||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/vitalsigns",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/emr/vitalsigns"}):m.a.createElement(aa,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t))}}):null,m.a.createElement(p.b,{path:"/patient/:id/emr/vitalsigns",render:function(a){return t.props.activePracticePermissions.PatientVitalSigns||t.allowAllPermissions?m.a.createElement(aa,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),m.a.createElement(p.b,{exact:!0,path:"/patient/:id/emr/vitalsigns/edit",render:function(a){return t.props.activePracticePermissions.PatientVitalSigns||t.allowAllPermissions?m.a.createElement(Jt,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),m.a.createElement(p.b,{path:"/patients/emr/clinicnotes",render:function(t){return m.a.createElement(Gt,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}),"}/>",m.a.createElement(p.b,{path:"/patient/:id/emr/clinicnotes",render:function(t){return m.a.createElement(Gt,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}),t.props.activePracticePermissions.PatientCompletedProcedure||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/workdone",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/emr/workdone"}):m.a.createElement(sa,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}):null,t.props.activePracticePermissions.PatientCompletedProcedure||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/workdone",render:function(a){return m.a.createElement(sa,Object.assign({},t.props,{key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a))}}):null,t.props.activePracticePermissions.PatientFiles||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/files",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/emr/files"}):m.a.createElement(Mt,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},t,e.state))}}):null,t.props.activePracticePermissions.PatientFiles||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/files",render:function(t){return m.a.createElement(Mt,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,t,e.state))}}):null,t.props.activePracticePermissions.PatientFiles||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/create-medicalCertificate",render:function(t){return m.a.createElement(Qn,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,t,e.state))}}):null,t.props.activePracticePermissions.PatientPrescriptions||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/prescriptions",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/emr/prescriptions"}):m.a.createElement(Pa,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}):null,t.props.activePracticePermissions.PatientPrescriptions||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/prescriptions",render:function(t){return m.a.createElement(Pa,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}):null,t.props.activePracticePermissions.PatientTreatmentPlans||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/emr/plans",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/emr/plans"}):m.a.createElement(Ta,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,e.props,t))}}):null,t.props.activePracticePermissions.PatientTreatmentPlans||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patient/:id/emr/plans",render:function(a){return m.a.createElement(Ta,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t.props,a))}}):null,m.a.createElement(p.b,{path:"/patient/:id/emr/timeline",render:function(a){return t.props.activePracticePermissions.PatientTimeline||t.allowAllPermissions?m.a.createElement(mt,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),t.props.activePracticePermissions.PatientLabOrders||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patient/emr/labtrackings",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/emr/labtrackings"}):m.a.createElement(Na,Object.assign({key:e.state.currentPatient},e.state,t))}}):null,m.a.createElement(p.b,{path:"/patient/:id/emr/labtrackings",render:function(a){return t.props.activePracticePermissions.PatientLabOrders||t.allowAllPermissions?m.a.createElement(Na,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),t.props.activePracticePermissions.PatientInvoices||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/billing/invoices",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/billing/invoices"}):m.a.createElement(pn,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,t))}}):null,m.a.createElement(p.b,{path:"/patient/:id/billing/invoices",render:function(a){return t.props.activePracticePermissions.PatientInvoices||t.allowAllPermissions?m.a.createElement(pn,Object.assign({refreshWallet:e.refreshWallet,key:e.state.currentPatient?e.state.currentPatient.id:null},e.props,e.state,a)):m.a.createElement(X.a,null)}}),t.props.activePracticePermissions.PatientReturns||t.allowAllPermissions?m.a.createElement(p.b,{exact:!0,path:"/patients/billing/return/invoices",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/billing/return/invoices"}):m.a.createElement(Mn,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,t))}}):null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/return/invoices",render:function(a){return t.props.activePracticePermissions.PatientReturns||t.allowAllPermissions?m.a.createElement(Mn,Object.assign({refreshWallet:e.refreshWallet,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),t.props.activePracticePermissions.PatientPayments||t.allowAllPermissions?m.a.createElement(p.b,{path:"/patients/billing/payments",render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/billing/payments"}):m.a.createElement(In,Object.assign({togglePatientListModal:e.togglePatientListModal,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,e.props,t))}}):null,m.a.createElement(p.b,{path:"/patient/:id/billing/payments",render:function(a){return t.props.activePracticePermissions.PatientPayments||t.allowAllPermissions?m.a.createElement(In,Object.assign({refreshWallet:e.refreshWallet,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),this.state.currentPatient?m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/ledger",render:function(a){return t.props.activePracticePermissions.PatientLedger||t.allowAllPermissions?m.a.createElement(zn,Object.assign({refreshWallet:e.refreshWallet,key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}):null,m.a.createElement(p.b,{exact:!0,path:"/patient/:id/prescriptions/template/add",render:function(a){return t.props.activePracticePermissions.PatientPrescriptions||t.allowAllPermissions?m.a.createElement(ba,Object.assign({key:e.state.currentPatient?e.state.currentPatient.id:null},e.state,a)):m.a.createElement(X.a,null)}}),m.a.createElement(p.b,{path:"/patient/:id/booking",render:function(a){return t.props.activePracticePermissions.PatientBookings||t.props.allowAllPermissions?m.a.createElement(nr,Object.assign({},e.state,e.props,a,{key:e.state.currentPatient?e.state.currentPatient.id:null})):m.a.createElement(X.a,null)}}),this.state.currentPatient&&this.state.currentPatient.is_agent?m.a.createElement(p.b,{exact:!0,path:"/patient/:id/billing/wallet",render:function(a){return t.props.activePracticePermissions.PatientBookings||t.props.allowAllPermissions?m.a.createElement(rr.a,Object.assign({},e.state,e.props,a,{key:e.state.currentPatient?e.state.currentPatient.id:null})):m.a.createElement(X.a,null)}}):null,m.a.createElement(p.b,{render:function(t){return e.state.currentPatient?m.a.createElement(p.a,{to:"/patient/"+e.state.currentPatient.id+"/profile"}):m.a.createElement(me,Object.assign({},e.state,{key:e.state.currentPatient,setCurrentPatient:e.setCurrentPatient},e.props))}})))))))}}]),t}(m.a.Component);t.default=lr},236:function(e,t,a){"use strict";a(247);var n=a(248),r=(a(262),a(263)),i=(a(223),a(224)),l=(a(231),a(232)),c=a(33),o=(a(237),a(18)),s=(a(228),a(227)),u=(a(254),a(257)),d=a(96),m=a(97),p=a(100),f=a(98),h=a(44),b=a(99),g=a(0),y=a.n(g),E=a(488),v=a.n(E),_=(a(614),a(64)),O=a.n(_),P=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n="",r=[];return a&&(e.forEach((function(e){r.push(e)})),n+=r.join(","),n+="\r\n"),t.forEach((function(t){r=[],e.forEach((function(e){t[e]?r.push(t[e]):r.push("--")})),n+=r.join(","),n+="\r\n"})),n},j=function(e,t){var a,n=t+".csv",r=[];r.push(255,254);for(var i=0;i<e.length;++i)a=e.charCodeAt(i),r.push(255&a),r.push(a/256>>>0);var l=new Blob([new Uint8Array(r)],{type:"text/csv;charset=UTF-16LE;"});if(navigator.msSaveBlob)navigator.msSaveBlob(l,n);else{var c=document.createElement("a");if(void 0!==c.download){var o=window.URL.createObjectURL(l);c.setAttribute("href",o),c.setAttribute("download",n),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(o)}}};function k(e){e.line(10,20,200,20)}function C(e){e.line(10,270,200,270),e.setFontSize(8),e.text(10,275,"This is a computer generated report.")}var I=a(615),S=a.n(I);function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(a,!0).forEach((function(t){Object(c.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}a.d(t,"a",(function(){return w}));var w=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).getColumnSearchProps=function(e){return{filterDropdown:function(t){var n=t.setSelectedKeys,r=t.selectedKeys,i=t.confirm,l=t.clearFilters;return y.a.createElement("div",{style:{padding:8}},y.a.createElement(u.a,{ref:function(e){a.searchInput=e},placeholder:"Search ".concat(e),value:r[0],onChange:function(e){return n(e.target.value?[e.target.value]:[])},onPressEnter:function(){return a.handleSearch(r,i)},style:{width:188,marginBottom:8,display:"block"}}),y.a.createElement(s.a,{type:"primary",onClick:function(){return a.handleSearch(r,i)},icon:"search",size:"small",style:{width:90,marginRight:8}},"Search"),y.a.createElement(s.a,{onClick:function(){return a.handleReset(l)},size:"small",style:{width:90}},"Reset"))},filterIcon:function(e){return y.a.createElement(o.a,{type:"search",style:{color:e?"#1890ff":void 0}})},onFilter:function(t,a){return null!=a[e]?a[e].toString().toLowerCase().includes(t.toLowerCase()):""},onFilterDropdownVisibleChange:function(e){e&&setTimeout((function(){return a.searchInput.select()}))},render:function(e){return y.a.createElement(S.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[a.state.searchText],autoEscape:!0,textToHighlight:e?e.toString():""})}}},a.handleSearch=function(e,t){t(),a.setState({searchText:e[0]})},a.handleReset=function(e){e(),a.setState({searchText:""})},a.state=D({},e,{searchText:""}),a.excelExport=a.excelExport.bind(Object(h.a)(a)),a.pdfExport=a.pdfExport.bind(Object(h.a)(a)),a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.columns==this.state.columns&&e.dataSource==this.state.dataSource&&e.loading==this.state.loading||this.setState(D({},e))}},{key:"pdfExport",value:function(){var e=this,t=[];e.state.columns.forEach((function(e){e.hideExport||t.push({title:e.title,dataKey:e.title})}));var a=[];e.state.dataSource.forEach((function(t,n){var r={};e.state.columns.forEach((function(e){e.export?r[e.title]=e.export(t[e.dataIndex],t,n):r[e.title]=t[e.dataIndex]})),a.push(r)})),function(e,t,a){!(arguments.length>3&&void 0!==arguments[3])||arguments[3];var n=new v.a("p","mm","a4");k(n);var r=Object.create(t);n.autoTable(e,r,{margin:{top:35},startY:n.autoTableEndPosY()+20,headerStyle:{overflow:"linebreak"},bodyStyles:{overflow:"linebreak"}}),C(n),n.save(a+".pdf")}(t,a,"Export"+O()(),!0)}},{key:"excelExport",value:function(){var e=this,t=[];e.state.columns.forEach((function(e){e.hideExport||t.push(e.title)}));var a=[];e.state.dataSource.forEach((function(t,n){var r={};e.state.columns.forEach((function(e){e.export?r[e.title]=e.export(t[e.dataIndex],t,n):r[e.title]=t[e.dataIndex]})),a.push(r)})),function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"download",n=P(e,t);j(n,a)}(t,a,"Export"+O()())}},{key:"render",value:function(){var e=this,t=this.state.columns.map((function(t){return t.render?D({},t):D({},t,{},e.getColumnSearchProps(t.dataIndex))}));return y.a.createElement("div",null,this.props.hideReport?null:y.a.createElement(i.a,null,y.a.createElement(l.a,null,y.a.createElement(s.a.Group,{size:"small"},y.a.createElement(s.a,{disabled:this.state.loading,type:"primary",onClick:this.excelExport},y.a.createElement(o.a,{type:"file-excel"})," Excel"),y.a.createElement(s.a,{disabled:this.state.loading,type:"primary",onClick:this.pdfExport},y.a.createElement(o.a,{type:"file-pdf"})," PDF")))),y.a.createElement(i.a,null,y.a.createElement(n.a,Object.assign({pagination:{position:"both",pageSizeOptions:["10","20","30","40","50","100"],showSizeChanger:!0,showQuickJumper:!0,size:"small",showTotal:function(e,t){return y.a.createElement(r.a,null,"Showing ",y.a.createElement("b",null,t[0])," to ",y.a.createElement("b",null,t[1])," of ",y.a.createElement("b",null,e)," items")}}},this.state,{columns:t}))))}}]),t}(y.a.Component)},278:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));a(228);var n=a(227),r=(a(241),a(242)),i=(a(223),a(224)),l=a(96),c=a(97),o=a(100),s=a(98),u=a(44),d=a(99),m=a(0),p=a.n(m),f=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(s.a)(t).call(this,e))).startLoading=function(){a.props.loaderFunction&&(a.props.loaderFunction(),a.startMakingExtraLabels())},a.startMakingExtraLabels=function(){var e=Object(u.a)(a);a.setState((function(e){return e.extraLoadingLabel.length>2?{extraLoadingLabel:""}:{extraLoadingLabel:e.extraLoadingLabel+"."}}),(function(){e.props.loading&&setTimeout((function(){e.startMakingExtraLabels()}),500)}))},a.state={extraLoadingLabel:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.props.loading?p.a.createElement(r.a,{spinning:this.props.loading},p.a.createElement(i.a,{style:{minHeight:200}})):this.props.hidden?p.a.createElement(i.a,null,p.a.createElement("div",{style:{textAlign:"center",margin:"15px 0px"}},p.a.createElement("small",null,"No More Data Found"))):p.a.createElement(i.a,null,p.a.createElement("div",{style:{textAlign:"center",margin:"15px 0px"}},p.a.createElement(n.a,{type:"primary",onClick:this.startLoading,loading:this.props.loading},this.props.loading?"Loading"+this.state.extraLoadingLabel:"Load More")))}}]),t}(p.a.Component)},616:function(e,t,a){"use strict";a(51),a(617)},617:function(e,t,a){},618:function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a(0),r=a(1),i=a(562),l=a.n(i),c=a(4),o=a.n(c),s=a(50),u=a(430),d=a(18),m=a(22),p=a(8);function f(e){return(f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function b(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function g(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t){return!t||"object"!==f(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=y(this,E(t).call(this,e))).saveSwitch=function(e){a.rcSwitch=e},a.renderSwitch=function(e){var t,r=e.getPrefixCls,i=a.props,c=i.prefixCls,m=i.size,p=i.loading,f=i.className,g=void 0===f?"":f,y=i.disabled,E=r("switch",c),v=o()(g,(b(t={},"".concat(E,"-small"),"small"===m),b(t,"".concat(E,"-loading"),p),t)),_=p?n.createElement(d.a,{type:"loading",className:"".concat(E,"-loading-icon")}):null;return n.createElement(u.a,{insertExtraNode:!0},n.createElement(l.a,h({},Object(s.default)(a.props,["loading"]),{prefixCls:E,className:v,disabled:y||p,ref:a.saveSwitch,loadingIcon:_})))},Object(p.a)("checked"in e||!("value"in e),"Switch","`value` is not validate prop, do you mean `checked`?"),a}var a,r,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),a=t,(r=[{key:"focus",value:function(){this.rcSwitch.focus()}},{key:"blur",value:function(){this.rcSwitch.blur()}},{key:"render",value:function(){return n.createElement(m.a,null,this.renderSwitch)}}])&&g(a.prototype,r),i&&g(a,i),t}(n.Component);_.__ANT_SWITCH=!0,_.propTypes={prefixCls:r.string,size:r.oneOf(["small","default","large"]),className:r.string}},619:function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));a(225);var n=a(226),r=(a(252),a(253)),i=(a(237),a(18)),l=(a(223),a(224)),c=(a(280),a(281)),o=(a(230),a(229)),s=(a(231),a(232)),u=a(33),d=a(255),m=a(96),p=a(97),f=a(100),h=a(98),b=a(44),g=a(99),y=(a(392),a(393)),E=a(0),v=a.n(E),_=a(236),O=a(23),P=a(32),j=a(64),k=a.n(j),C=a(278),I=y.a.Text,S=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).loadPatientWallet=function(){var e=Object(b.a)(a);if(a.props.currentPatient&&a.props.currentPatient.id){Object(O.c)(Object(O.f)(P.g,[a.props.currentPatient.id]),(function(t){t.length&&e.setState({walletAmount:t[0]})}),(function(){}))}else a.setState({pendingAmount:null})},a.loadData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(b.a)(a);a.setState({loading:!0});var n=function(e){1==e.current?t.setState({ledger:e.results,loading:!1,nextPage:e.next}):t.setState((function(t){return{ledger:[].concat(Object(d.a)(t.ledger),Object(d.a)(e.results)),loading:!1,nextPage:e.next}}))},r=function(){t.setState({loading:!1})},i={page:e,start:a.state.selectedStartDate.startOf("day").format(),end:a.state.selectedEndDate.endOf("day").format(),agents:a.state.selectedAgents.join(",")};a.state.selectedAgents&&(i.agents=a.state.selectedAgents.join(",")),Object(O.c)(Object(O.f)(P.Od,[a.props.currentPatient.id]),n,r,i)},a.loadSumData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object(b.a)(a),n=function(e){t.setState({ledgerDetails:e,nextPage:e.next})},r=function(){},i={page:e,start:a.state.selectedStartDate.format(),end:a.state.selectedEndDate.format(),agents:a.state.selectedAgents.join(",")};a.state.selectedAgents&&(i.agents=a.state.selectedAgents.join(",")),Object(O.c)(Object(O.f)(P.Pd,[a.props.currentPatient.id]),n,r,i)},a.changeExpenseFilters=function(e,t){var n=Object(b.a)(a);a.setState(Object(u.a)({},e,t),(function(){n.loadData(1)}))},a.state={ledger:[],ledgerDetails:{},loading:!1,walletAmount:null,selectedStartDate:k()().subtract(1,"month"),selectedEndDate:k()(),agents:[],selectedAgents:[]},a}return Object(g.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.loadData(),this.loadPatientWallet(),this.loadAgents(),this.loadSumData()}},{key:"loadAgents",value:function(){var e=this;Object(O.c)(Object(O.f)(P.fc,[this.props.currentPatient.id]),(function(t){e.setState({agents:t})}),(function(){}),{agent:!0,pagination:!1})}},{key:"render",value:function(){var e=this,t=[{title:"Date",dataIndex:"created_at",key:"created_at",render:function(e){return k()(e).format("LLL")}},{title:"Patient",dataIndex:"received_from",key:"received_from",render:function(e,t){return e?v.a.createElement(I,null,e.user.first_name," (",e.custom_id,")"):"--"}},,{title:"Refered By",dataIndex:"received_from.user.referer_data",key:"received_from.user.referer_data",render:function(e,t){return e&&e.referer?v.a.createElement(I,null,e.referer.first_name," (",e.custom_id,")"):"--"}},{title:"Ledger Comment",dataIndex:"comments",key:"comments",render:function(e,t){return t.is_cancelled?v.a.createElement(I,{delete:!0},e):e}},{title:"Cr/Dr",dataIndex:"ledger_type",key:"ledger_type",render:function(e,t){return t.is_cancelled?v.a.createElement(I,{delete:!0},e):e}},{title:"Amount",dataIndex:"amount",key:"amount",render:function(e,t){return t.is_cancelled?v.a.createElement(I,{delete:!0},e.toFixed(2)):e.toFixed(2)}}];return v.a.createElement("div",null,v.a.createElement(n.a,{title:"Wallet Ledger"},v.a.createElement(l.a,{gutter:16,style:{marginBottom:10}},v.a.createElement(s.a,{span:2,style:{textAlign:"right"}},v.a.createElement("b",null," Agents")),v.a.createElement(s.a,{span:4},v.a.createElement(o.a,{style:{width:"100%"},value:this.state.selectedAgents,mode:"multiple",disabled:this.state.loading,onChange:function(t){return e.changeExpenseFilters("selectedAgents",t)}},this.state.agents.map((function(e){return v.a.createElement(o.a.Option,{value:e.id},e.user.first_name)})))),v.a.createElement(s.a,{span:2,style:{textAlign:"right"}},v.a.createElement("b",null," From")),v.a.createElement(s.a,{span:4},v.a.createElement(c.a,{value:this.state.selectedStartDate,disabled:this.state.loading,onChange:function(t){return e.changeExpenseFilters("selectedStartDate",t)}})),v.a.createElement(s.a,{span:2,style:{textAlign:"right"}},v.a.createElement("b",null," To")),v.a.createElement(s.a,{span:4},v.a.createElement(c.a,{value:this.state.selectedEndDate,disabled:this.state.loading,onChange:function(t){return e.changeExpenseFilters("selectedEndDate",t)}}))),this.state.walletAmount?v.a.createElement(l.a,{style:{textAlign:"center",marginBottom:10}},v.a.createElement(s.a,{span:24},v.a.createElement(r.a,{title:"Wallet Total",prefix:v.a.createElement(i.a,{type:"wallet"}),value:this.state.walletAmount.non_refundable,precision:2}))):null,v.a.createElement(_.a,{dataSource:this.state.ledger,loading:this.state.loading,columns:t,hideReport:!0,pagination:!1}),v.a.createElement(C.a,{loading:this.state.loading,hidden:!this.state.nextPage,loaderFunction:function(){return e.loadData(e.state.nextPage)}}),v.a.createElement(l.a,{style:{textAlign:"center",marginBottom:10}},v.a.createElement(s.a,{span:8},v.a.createElement(r.a,{title:"Credit",value:this.state.ledgerDetails.credit,precision:2})),v.a.createElement(s.a,{span:8},v.a.createElement(r.a,{title:"Debit",value:this.state.ledgerDetails.debit,precision:2})),v.a.createElement(s.a,{span:8},v.a.createElement(r.a,{title:"Profit",value:this.state.ledgerDetails.credit-this.state.ledgerDetails.debit,precision:2})))))}}]),t}(v.a.Component)}}]);
//# sourceMappingURL=12.33644045.chunk.js.map