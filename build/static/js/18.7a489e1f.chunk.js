(this["webpackJsonpbk-erp-front"]=this["webpackJsonpbk-erp-front"]||[]).push([[18],{1102:function(t,e,a){},1260:function(t,e,a){"use strict";a.r(e);a(119);var n=a(34),s=(a(121),a(15)),o=(a(332),a(333)),i=(a(326),a(327)),r=(a(363),a(360)),c=(a(358),a(356)),l=(a(373),a(372)),m=(a(370),a(368)),d=(a(180),a(120)),p=(a(330),a(12)),u=(a(366),a(367)),h=a(338),f=a(46),g=a(21),b=a(62),y=a(61),E=a(64),v=a(63),A=a(18),C=a(65),O=(a(347),a(348)),T=(a(183),a(122)),L=a(0),D=a.n(L),k=a(322),S=a.n(k),j=(a(698),a(699),a(700)),H=a.n(j),_=a(707),w=a.n(_),F=a(754),x=(a(1102),a(37)),I=a(84),P=a(485),R=a(4),M=a(16),Y=a(35),N=(a(400),a(406)),z=a(545),G=function(t){function e(t){return Object(b.a)(this,e),Object(E.a)(this,Object(v.a)(e).call(this,t))}return Object(C.a)(e,t),Object(y.a)(e,[{key:"render",value:function(){return D.a.createElement(N.a,{placement:"right",content:D.a.createElement(z.a,Object.assign({appointmentId:this.props.event.appointment.id,key:this.props.event.appointment.id},this.props)),trigger:"hover"},D.a.createElement("div",{style:{color:"white",height:"100%"}},D.a.createElement("h1",{style:{color:"white"}},D.a.createElement(p.a,{type:"user"}),this.props.title)))}}]),e}(D.a.Component),B=a(6),V=a(325),W=D.a.createElement(m.a,null,D.a.createElement(m.a.Item,{key:"1"},D.a.createElement(I.b,{to:"/settings/calendarsettings#timings"},"Modify Calendar Timings")),D.a.createElement(m.a.Item,{key:"2"},D.a.createElement(I.b,{to:"/settings/clinics-staff#staff"},"Add/Edit Doctor or Staff")),D.a.createElement(m.a.Item,{key:"3"},D.a.createElement(I.b,{to:"/settings/clinics-staff#notification"},"Modify SMS/Email for Doctor/Staff")),D.a.createElement(m.a.Item,{key:"4"},D.a.createElement(I.b,{to:"/settings/communication-settings"},"Modify SMS/Email for Patients")),D.a.createElement(m.a.Item,{key:"5"},D.a.createElement(I.b,{to:"/settings/calendarsettings#categories"},"Add/Edit Categroies"))),J=function(t,e){var a=B.get(R.v);a||(a={}),a=Object(g.a)({},a,Object(f.a)({},t,e)),B.set(R.v,a)},K=function(t){var e=!0,a=S()(t.value).isValid()?S()(t.value).format("dddd").toLowerCase():null;if("DOCTOR"!=t.filterType||"ALL"==t.selectedDoctor)if(t.calendarTimings&&a&&t.calendarTimings[a]){var n=t.calendarTimings[a];n.lunch?(S()(t.value,"HH:mm:ss").format("HH:mm:ss")<=n.startTime.format("HH:mm:ss")||S()(t.value,"HH:mm:ss").format("HH:mm:ss")>n.endTime.format("HH:mm:ss")||S()(t.value,"HH:mm:ss").format("HH:mm:ss")<n.lunchEndTime.format("HH:mm:ss")&&S()(t.value,"HH:mm:ss").format("HH:mm:ss")>=n.lunchStartTime.format("HH:mm:ss"))&&(e=!1):(S()(t.value,"HH:mm:ss").format("HH:mm:ss")<=n.startTime.format("HH:mm:ss")||S()(t.value,"HH:mm:ss").format("HH:mm:ss")>n.endTime.format("HH:mm:ss"))&&(e=!1)}else a&&!t.calendarTimings[a]&&(e=!1);else if(t.doctorTimings&&a&&t.doctorTimings[a]){var s=t.doctorTimings[a];s.lunch?(S()(t.value,"HH:mm:ss").format("HH:mm:ss")<=s.startTime.format("HH:mm:ss")||S()(t.value,"HH:mm:ss").format("HH:mm:ss")>s.endTime.format("HH:mm:ss")||S()(t.value,"HH:mm:ss").format("HH:mm:ss")<s.lunchEndTime.format("HH:mm:ss")&&S()(t.value,"HH:mm:ss").format("HH:mm:ss")>=s.lunchStartTime.format("HH:mm:ss"))&&(e=!1):(S()(t.value,"HH:mm:ss").format("HH:mm:ss")<=s.startTime.format("HH:mm:ss")||S()(t.value,"HH:mm:ss").format("HH:mm:ss")>s.endTime.format("HH:mm:ss"))&&(e=!1)}else t.doctorTimings&&a&&!t.doctorTimings[a]&&(e=!1);if(t.showCalendarEvents&&e)for(var o=0;o<t.blockedCalendar.length;o++)if(t.blockedCalendar[o].doctor&&"DOCTOR"==t.filterType){if(t.blockedCalendar[o].doctor==t.selectedDoctor&&S()(t.value).isBetween(S()(t.blockedCalendar[o].block_from),S()(t.blockedCalendar[o].block_to))){e=!1;break}}else if(S()(t.value).isBetween(S()(t.blockedCalendar[o].block_from),S()(t.blockedCalendar[o].block_to))){e=!1;break}if(e)return t.children;var i=D.a.Children.only(t.children);return D.a.cloneElement(i,{className:"".concat(i.props.className," rbc-off-range-bg")})},q=(a(354),a(357)),U=a(337),Q=function(t){function e(t){var a;return Object(b.a)(this,e),(a=Object(E.a)(this,Object(v.a)(e).call(this,t))).changeDate=function(t){var e=Object(A.a)(a);a.setState((function(e){return t?{selectedDate:e.selectedDate.add(1,"days")}:{selectedDate:e.selectedDate.subtract(1,"days")}}),(function(){e.todaysAppointments()}))},a.todaysAppointments=function(){var t=Object(A.a)(a);t.setState({loading:!0});Object(M.c)(Object(M.f)(Y.q,[a.props.active_practiceId]),(function(e){t.setState((function(t){var a={},n=[];return e.forEach((function(e){if(e.status==U.m)return!0;a[e.status]?a[e.status]+=1:a[e.status]=1,"ALL"==t.todaysAppointmentFilter?n.push(e):t.todaysAppointmentFilter==e.status&&n.push(e)})),{todaysAppointments:e,todaysAppointmentOverview:a,todaysFilteredAppointments:n,loading:!1}}))}),(function(){t.setState({loading:!1})}),{start:t.state.selectedDate.format("YYYY-MM-DD"),end:t.state.selectedDate.format("YYYY-MM-DD")})},a.filterTodaysAppointment=function(t){a.setState((function(e){var a=[];return e.todaysAppointments.forEach((function(e){"ALL"==t?a.push(e):t==e.status&&a.push(e)})),{todaysFilteredAppointments:a,todaysAppointmentFilter:t}}))},a.changeAppointmentStatus=function(t,e,n){var s=Object(A.a)(a);Object(M.c)(Object(M.f)(Y.o,[t]),(function(a){a.status==e?s.updateAppointmentStatus(t,e,n):(Object(M.a)(R.Q,"Appointment status has already changed. Updating Appointments..."),s.todaysAppointments())}),(function(){}))},a.updateAppointmentStatus=function(t,e,n){var s=Object(A.a)(a),o={status:n};n==U.Ib?o.waiting=S()().format():n==U.F?o.engaged=S()().format():n==U.n&&(o.checkout=S()().format());Object(M.l)(Object(M.f)(Y.o,[t]),o,(function(t){Object(M.a)(R.Sb,"Appointment Status Changed Successfully!!"),s.todaysAppointments()}),(function(){}))},a.state={todaysAppointments:[],todaysFilteredAppointments:[],todaysAppointmentOverview:{},todaysAppointmentFilter:"ALL",selectedDate:a.props.selectedDate},a.todaysAppointments=a.todaysAppointments.bind(Object(A.a)(a)),a}return Object(C.a)(e,t),Object(y.a)(e,[{key:"componentDidMount",value:function(){this.todaysAppointments()}},{key:"render",value:function(){var t=this,e=this;return D.a.createElement("div",null,D.a.createElement(l.a,{trigger:"click",overlay:W},D.a.createElement(d.a,{block:!0,style:{margin:5}},D.a.createElement(p.a,{type:"setting"})," Settings ",D.a.createElement(p.a,{type:"down"}))),e.props.activePracticePermissions.AddWalkinAppointment||e.props.allowAllPermissions?D.a.createElement(I.b,{to:"/calendar/create-appointment"},D.a.createElement(d.a,{block:!0,type:"primary",style:{margin:5}}," Walkin Appointment")):null,D.a.createElement(n.a,{gutter:8},D.a.createElement(s.a,{span:6,onClick:function(){return t.filterTodaysAppointment(t.state.todaysAppointmentFilter==U.Db?"ALL":U.Db)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==U.Db?"#FF6600":null,color:this.state.todaysAppointmentFilter==U.Db?"white":"#FF6600",boxShadow:"0 2px 4px #111 inset"}},D.a.createElement("small",null,U.Db),D.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==U.Db?"white":"#FF6600"}},this.state.todaysAppointmentOverview[U.Db]?this.state.todaysAppointmentOverview[U.Db]:0)),D.a.createElement(s.a,{span:6,onClick:function(){return t.filterTodaysAppointment(t.state.todaysAppointmentFilter==U.Ib?"ALL":U.Ib)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==U.Ib?"#FC0000":null,color:this.state.todaysAppointmentFilter==U.Ib?"white":"#FC0000",boxShadow:"0 2px 4px #111 inset"}},D.a.createElement("small",null,U.Ib),D.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==U.Ib?"white":"#FC0000"}},this.state.todaysAppointmentOverview[U.Ib]?this.state.todaysAppointmentOverview[U.Ib]:0)),D.a.createElement(s.a,{span:6,onClick:function(){return t.filterTodaysAppointment(t.state.todaysAppointmentFilter==U.F?"ALL":U.F)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==U.F?"#598C01":null,color:this.state.todaysAppointmentFilter==U.F?"white":"#598C01",boxShadow:"0 2px 4px #111 inset"}},D.a.createElement("small",null,U.F),D.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==U.F?"white":"#598C01"}},this.state.todaysAppointmentOverview[U.F]?this.state.todaysAppointmentOverview[U.F]:0)),D.a.createElement(s.a,{span:6,onClick:function(){return t.filterTodaysAppointment(t.state.todaysAppointmentFilter==U.n?"ALL":U.n)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==U.n?"#0094DE":null,color:this.state.todaysAppointmentFilter==U.n?"white":"#0094DE",boxShadow:"0 2px 4px #111 inset"}},D.a.createElement("small",null,U.n),D.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==U.n?"white":"#0094DE"}},this.state.todaysAppointmentOverview[U.n]?this.state.todaysAppointmentOverview[U.n]:0))),D.a.createElement(i.a,null,D.a.createElement("a",{type:"primary",onClick:function(){return t.changeDate(!1)}},D.a.createElement(p.a,{type:"left"})),this.state.selectedDate.format("MMM Do")==S()().format("MMM Do")?"Today":this.state.selectedDate.format("MMM Do"),"'s Schedule (",this.state.todaysFilteredAppointments.length,") \xa0",D.a.createElement("a",{type:"primary",onClick:function(){return t.changeDate(!0)}},D.a.createElement(p.a,{type:"right"}))),D.a.createElement(o.a,{spinning:this.state.loading},D.a.createElement(q.a,{size:"small",dataSource:this.state.todaysFilteredAppointments,renderItem:function(a){return a.status==U.m?D.a.createElement("div",null):D.a.createElement(q.a.Item,{color:"transparent",style:{padding:0}},D.a.createElement("div",{style:{border:"1px solid #ddd",borderRadius:"5px",textDecoration:a.status==U.m?"line-through":"inherit",backgroundColor:a.status==U.m?"#aaa":"#eee",width:"100%",marginTop:"2px",borderLeft:"5px solid".concat(a.doctor&&e.props.doctors_object&&e.props.doctors_object[a.doctor]?e.props.doctors_object[a.doctor].calendar_colour:"transparent")}},D.a.createElement(X,Object.assign({},a,{changeAppointmentStatus:t.changeAppointmentStatus},t.props))))}})))}}]),e}(D.a.Component);function X(t){return D.a.createElement("div",{style:{width:"100%"}},D.a.createElement("p",{style:{marginBottom:0}},D.a.createElement(N.a,{placement:"right",content:D.a.createElement(z.a,Object.assign({appointmentId:t.id,key:t.id},t))},D.a.createElement("span",{style:{width:"calc(100% - 60px)"}},D.a.createElement("b",null,S()(t.schedule_at).format("LT")),"\xa0",t.patient.user.first_name)),t.status==U.Db?D.a.createElement("span",{style:{width:"70px",float:"right"}},D.a.createElement("a",{onClick:function(){return t.changeAppointmentStatus(t.id,U.Db,U.Ib)},disabled:!t.activePracticePermissions.ChangeAppointmentStatus}," Check In")):null,t.status==U.Ib?D.a.createElement("span",{style:{width:"70px",float:"right"}},D.a.createElement("a",{onClick:function(){return t.changeAppointmentStatus(t.id,U.Ib,U.F)},disabled:!t.activePracticePermissions.ChangeAppointmentStatus}," Engage")):null,t.status==U.F?D.a.createElement("span",{style:{width:"70px",float:"right"}},D.a.createElement("a",{onClick:function(){return t.changeAppointmentStatus(t.id,U.F,U.n)},disabled:!t.activePracticePermissions.ChangeAppointmentStatus}," Check Out")):null,t.status==U.n?D.a.createElement("span",{style:{width:"70px",float:"right"}},D.a.createElement("small",null,"Checked Out")):null))}var Z=a(761),$=a(380),tt=Object(F.c)(S.a),et=H()(F.a),at=T.a.Content,nt=O.a.confirm,st=function(t){function e(t){var a;return Object(b.a)(this,e),(a=Object(E.a)(this,Object(v.a)(e).call(this,t))).changeCalendarType=function(t){var e=Object(A.a)(a);a.setState({calendarType:t,selectedDoctor:"ALL",selectedCategory:"ALL",filterType:"DOCTOR"},(function(){"APPOINTMENTS"==t?e.changeFilter("selectedDoctor","ALL"):"AVAILABILITY"==t&&e.state.practice_doctors.length&&e.changeFilter("selectedDoctor",e.state.practice_doctors[0].id)}))},a.resizeEvent=function(t){var e=t.event,n=t.start,s=t.end;if(e.appointment.status!=U.Db)return Object(M.a)(R.bc,"Action Not Allowed"),!0;var o=a.state.events,i={},r=Object(A.a)(a),c=[];o.forEach((function(t){t.id==e.id&&(i={schedule_at:S()(n).format(),slot:parseInt((s-n)/6e4)})}));var l=function(t){Object(M.a)(R.Sb,"time changed"),o.forEach((function(t){c.push(t.id==e.id?Object(g.a)({},t,{start:n,end:s}):t)})),r.setState({events:c},(function(){r.refreshFilterList()}))},m=function(){};nt({title:"Are you sure to change the time of this appointment?",onOk:function(){Object(M.l)(Object(M.f)(Y.o,[e.id]),i,l,m)},onCancel:function(){}})},a.blockedCalendarTiming=function(t,e){var n=Object(A.a)(a);Object(M.c)(Y.x,(function(t){n.setState({blockedCalendar:t})}),(function(){}),{practice:a.props.active_practiceId,cal_fdate:t.format(),cal_tdate:e.format()})},a.onRangeChange=function(t){if(t.start&&t.end)if(a.appointmentList(S()(t.start),S()(t.end)),1==S()(t.start).date())a.setState({selectedDate:S()(t.start)});else{var e=S()(t.start);a.setState({selectedDate:e.month(e.month()+1).date(1)})}else t.length&&(7==t.length?a.appointmentList(S()(t[0]).subtract(1,"day"),S()(t[t.length-1]).subtract(1,"day")):a.appointmentList(S()(t[0]),S()(t[t.length-1])),a.setState({selectedDate:S()(t[0])}))},a.onSelectedDateChange=function(t){var e=Object(A.a)(a);a.setState({selectedDate:S()(t)},(function(){e.appointmentList(S()(t).startOf("day"),S()(t).endOf("day"))}))},a.setFilterType=function(t){var e=Object(A.a)(a);a.setState({filterType:t.key,selectedDoctor:"ALL",selectedCategory:"ALL"},(function(){"DOCTOR"==t.key?e.changeFilter("selectedDoctor","ALL"):"CATEGORY"==t.key&&e.changeFilter("selectedCategory","ALL")}))},a.setFilter=function(t,e){var n=Object(A.a)(a);a.setState(Object(f.a)({},t,e),(function(){J(t,e),n.changeFilter("tempKey","ALL")}))},a.refreshFilterList=function(){var t=a.state;"DOCTOR"==t.filterType?a.changeFilter("selectedDoctor",t.selectedDoctor):"CATEGORY"==t.filterType&&a.changeFilter("selectedCategory",t.selectedCategory)},a.changeFilter=function(t,e){"selectedDoctor"==t&&"ALL"!=e&&a.loadDoctorTiming(e),a.setState((function(a){var n,s=[];return a.events.forEach((function(n){if(!a.filterCancelledAppointment&&n.appointment.status==U.m)return!0;"ALL"==e?s.push(n):"selectedDoctor"==t&&n.doctor==e?s.push(n):"selectedCategory"==t&&n.appointment.category==e&&s.push(n)})),n={},Object(f.a)(n,t,e),Object(f.a)(n,"filteredEvent",s),n}))},a.changeState=function(t,e){a.setState(Object(f.a)({},t,e),(function(){J(t,e)}))},a.loadDoctorTiming=function(t){var e=Object(A.a)(a);Object(M.c)(Object(M.f)(Y.Y,[a.props.active_practiceId]),(function(a){var n={};a.length&&(n=a[0]);var s={};U.s.forEach((function(t){s[t]={},n.visting_hour_same_week?(s[t].startTime=S()(n.first_start_time,"HH:mm:ss"),s[t].endTime=S()(n.second_end_time,"HH:mm:ss"),n.is_two_sessions?(s[t].lunch=!0,s[t].lunchStartTime=S()(n.first_end_time,"HH:mm:ss"),s[t].lunchEndTime=S()(n.second_start_time,"HH:mm:ss")):s[t].lunch=!1):n[t]?(s[t].startTime=S()(n["first_start_time_".concat(t)],"HH:mm:ss"),s[t].endTime=S()(n["second_end_time_".concat(t)],"HH:mm:ss"),n["is_two_sessions_".concat(t)]?(s[t].lunch=!0,s[t].lunchStartTime=S()(n["first_end_time_".concat(t)],"HH:mm:ss"),s[t].lunchEndTime=S()(n["second_start_time_".concat(t)],"HH:mm:ss")):s[t].lunch=!1):s[t]=null})),e.setState((function(e){return{doctorTiming:Object(g.a)({},e.doctorTiming,Object(f.a)({},t,Object(g.a)({},s)))}}))}),(function(){}),{doctor:t})},a.state=Object(g.a)({startTime:null,visiblePopover:!1,events:[],filteredEvent:[],appointments:[],practice_doctors:[],practice_categories:[],practice_staff:[],doctors_object:null,categories_object:null,calendarTimings:null,timing:{},loading:!0,selectedDoctor:"ALL",selectedCategory:"ALL",selectedDate:S()(),filterType:"DOCTOR",calendarType:"APPOINTMENTS",doctorsAppointmentCount:{},categoriesAppointmentCount:{},blockedCalendar:[],showCalendarEvents:!0,showAppointments:!0,doctorTiming:{}},function(){var t=B.get(R.v);return t||(t={}),t}()),a.onSelectSlot=a.onSelectSlot.bind(Object(A.a)(a)),a.onSelectEvent=a.onSelectEvent.bind(Object(A.a)(a)),a.moveEvent=a.moveEvent.bind(Object(A.a)(a)),a.resizeEvent=a.resizeEvent.bind(Object(A.a)(a)),a.loadDoctors=a.loadDoctors.bind(Object(A.a)(a)),a.eventStyleGetter=a.eventStyleGetter.bind(Object(A.a)(a)),a.loadCalendarTimings=a.loadCalendarTimings.bind(Object(A.a)(a)),a.loadCalendarTimings(),a}return Object(C.a)(e,t),Object(y.a)(e,[{key:"componentDidMount",value:function(){var t;this.appointmentList(S()().startOf("day"),S()().endOf("day")),this.loadDoctors(),t=this,Object(M.c)(Object(M.f)(Y.p,[t.props.active_practiceId]),(function(e){var a={},n=e.map((function(t){return a[t.id]=Object(g.a)({},t,{calendar_colour:Object(V.b)(Object(V.a)(t.name))}),a[t.id]}));t.setState({categories_object:a,practice_categories:n})}),(function(){}))}},{key:"loadDoctors",value:function(){var t=this;t.setState({doctorLoading:!0});Object(M.c)(Object(M.f)(Y.Ec,[this.props.active_practiceId]),(function(e){var a=[],n=[],s={};e.staff.forEach((function(t){t.role==R.N?(a.push(t),s[t.id]=t):n.push(t)})),t.setState({practice_staff:n,practice_doctors:a,doctors_object:s,doctorLoading:!1})}),(function(){t.setState({doctorLoading:!1})}))}},{key:"loadCalendarTimings",value:function(){var t=this;Object(M.c)(Object(M.f)(Y.J,[this.props.active_practiceId]),(function(e){var a={};e.length&&(a=e[0]);var n={};U.s.forEach((function(t){n[t]={},a.visting_hour_same_week?(n[t].startTime=S()(a.first_start_time,"HH:mm:ss"),n[t].endTime=S()(a.second_end_time,"HH:mm:ss"),a.is_two_sessions?(n[t].lunch=!0,n[t].lunchStartTime=S()(a.first_end_time,"HH:mm:ss"),n[t].lunchEndTime=S()(a.second_start_time,"HH:mm:ss")):n[t].lunch=!1):a[t]?(n[t].startTime=S()(a["first_start_time_".concat(t)],"HH:mm:ss"),n[t].endTime=S()(a["second_end_time_".concat(t)],"HH:mm:ss"),a["is_two_sessions_".concat(t)]?(n[t].lunch=!0,n[t].lunchStartTime=S()(a["first_end_time_".concat(t)],"HH:mm:ss"),n[t].lunchEndTime=S()(a["second_start_time_".concat(t)],"HH:mm:ss")):n[t].lunch=!1):n[t]=null})),t.setState({calendarTimings:Object(g.a)({},a),timing:Object(g.a)({},n),loading:!1})}),(function(){t.setState({loading:!1})}))}},{key:"moveEvent",value:function(t){var e=t.event,a=t.start,n=t.end,s=t.isAllDay;if(e.appointment.status!=U.Db)return Object(M.a)(R.bc,"Action Not Allowed"),!0;var o=this.state.events,i=o.indexOf(e),r=e.allDay,c=this;!e.allDay&&s?r=!0:e.allDay&&!s&&(r=!1);var l=Object(g.a)({},e,{start:a,end:n,allDay:r}),m=Object(h.a)(o),d={schedule_at:S()(a).format(),slot:parseInt((n-a)/6e4)},p=function(t){Object(M.a)(R.Sb,"time changed"),m.splice(i,1,l),c.setState({events:m},(function(){c.refreshFilterList()}))},u=function(){};nt({title:"Are you sure to change the time of this appointment?",onOk:function(){Object(M.l)(Object(M.f)(Y.o,[e.id]),d,p,u)},onCancel:function(){}})}},{key:"onSelectSlot",value:function(t){var e=S()(t.start).format();"doubleClick"==t.action&&(this.setState({startTime:e,redirect:!0}),this.props.history.push("/calendar/create-appointment"))}},{key:"onSelectEvent",value:function(t,e){this.setState({visiblePopover:!0}),this.props.history.push("/patients/appointments/".concat(t.id))}},{key:"appointmentList",value:function(t,e){var a=this;a.setState({loading:!0});Object(M.c)(Object(M.f)(Y.q,[this.props.active_practiceId]),(function(t){a.setState((function(e){e.events;var a=[],n=[],s={},o={};return t.forEach((function(t){var i=new S.a(t.schedule_at).add(t.slot,"minutes"),r={appointment:t,start:new Date(S()(t.schedule_at)),end:new Date(i),title:t.patient.user.first_name,id:t.id,doctor:t.doctor,loading:!1};if(s.ALL?(s.ALL.ALL+=1,t.status==U.m&&(s.ALL.CANCELLED+=1)):(s.ALL={},s.ALL.ALL=1,t.status==U.m?s.ALL.CANCELLED=1:s.ALL.CANCELLED=0),t.doctor&&s[t.doctor]?(s[t.doctor].ALL+=1,t.status==U.m&&(s[t.doctor].CANCELLED+=1)):(s[t.doctor]={},s[t.doctor].ALL=1,t.status==U.m?s[t.doctor].CANCELLED=1:s[t.doctor].CANCELLED=0),t.category&&s[t.category]?o[t.category]+=1:o[t.category]=1,a.push(r),!e.filterCancelledAppointment&&r.appointment.status==U.m)return!0;"DOCTOR"==e.filterType&&"ALL"==e.selectedDoctor||"CATEGORY"==e.filterType&&"ALL"==e.selectedCategory?n.push(r):"DOCTOR"==e.filterType&&r.doctor==e.selectedDoctor?n.push(r):"CATEGORY"==e.filterType&&r.appointment.category==e.selectedCategory&&n.push(r)})),{events:a,filteredEvent:n,doctorsAppointmentCount:Object(g.a)({},s),categoriesAppointmentCount:Object(g.a)({},o,{ALL:t.length}),appointments:t,loading:!1}}))}),(function(){a.setState({loading:!1})}),{start:t.format("YYYY-MM-DD"),end:e.format("YYYY-MM-DD")}),this.blockedCalendarTiming(t,e)}},{key:"eventStyleGetter",value:function(t,e,a,n){var s=t.doctor,o=t.appointment.category,i=null,r={borderRadius:"0px",opacity:.8,border:"5px",color:"white",display:"block"};return t.appointment.status==U.m?(r.backgroundColor="#aaa",r.textDecoration="line-through"):("DOCTOR"==this.state.filterType?i=s&&this.state.doctors_object&&this.state.doctors_object[s]?this.state.doctors_object[s].calendar_colour:"black":"CATEGORY"==this.state.filterType&&(i=o&&this.state.categories_object&&this.state.categories_object[o]?"#".concat(this.state.categories_object[o].calendar_colour):"black"),r.backgroundColor=i),{style:r}}},{key:"render",value:function(){var t=this,e=this;this.state.startTime;this.state.calendarTimings&&(new Date(new S.a(this.state.calendarTimings.start_time,"HH:mm:ss")),new Date(new S.a(this.state.calendarTimings.end_time,"HH:mm:ss")));return D.a.createElement(at,{className:"main-container"},D.a.createElement("div",{style:{padding:"5px"}},D.a.createElement(x.d,null,D.a.createElement(x.b,{exact:!0,path:"/calendar/create-appointment",render:function(e){return t.props.activePracticePermissions.AddAppointment||t.props.allowAllPermissions?D.a.createElement(Z.a,Object.assign({},t.state,t.props,e,{startTime:t.state.startTime})):D.a.createElement($.a,null)}}),D.a.createElement(x.b,{exact:!0,path:"/calendar/:appointmentid/edit-appointment",render:function(e){return t.props.activePracticePermissions.EditAppointment||t.props.allowAllPermissions?D.a.createElement(Z.a,Object.assign({},t.state,t.props,e,{startTime:t.state.startTime})):D.a.createElement($.a,null)}}),D.a.createElement(x.b,null,D.a.createElement("div",{style:{backgroundColor:"#fff",padding:"5px 10px"}},D.a.createElement(n.a,{gutter:16},D.a.createElement(s.a,{span:3},D.a.createElement(u.a,{onChange:this.onSelectedDateChange,value:this.state.selectedDate,format:"DD-MM-YYYY",style:{margin:5},allowClear:!1}),"APPOINTMENTS"==this.state.calendarType?D.a.createElement("div",null,e.props.activePracticePermissions.BlockCalendar||e.props.allowAllPermissions?D.a.createElement(d.a,{block:!0,style:{margin:5}},D.a.createElement(I.b,{to:"/calendar/blockcalendar"},D.a.createElement(p.a,{type:"stop"})," Block Calendar")):null,D.a.createElement(l.a,{trigger:"click",overlay:D.a.createElement(m.a,{onClick:this.setFilterType},D.a.createElement(m.a.Item,{key:"DOCTOR"},"DOCTOR"),D.a.createElement(m.a.Item,{key:"CATEGORY"},"CATEGORY"))},D.a.createElement(d.a,{block:!0,style:{margin:5}},this.state.filterType," ",D.a.createElement(p.a,{type:"caret-down"})))):null,D.a.createElement(o.a,{spinning:this.state.doctorLoading},"DOCTOR"==this.state.filterType?D.a.createElement(m.a,{selectedKeys:[this.state.selectedDoctor],size:"small",onClick:function(e){return t.changeFilter("selectedDoctor",e.key)}},"APPOINTMENTS"==this.state.calendarType?D.a.createElement(m.a.Item,{key:"ALL",style:{marginBottom:2,textOverflow:"ellipsis",borderLeft:"5px solid black",borderRight:"none"}},D.a.createElement("span",null,"(",this.state.doctorsAppointmentCount.ALL?this.state.filterCancelledAppointment?this.state.doctorsAppointmentCount.ALL.ALL:this.state.doctorsAppointmentCount.ALL.ALL-this.state.doctorsAppointmentCount.ALL.CANCELLED:0,") All Doctors")):null,this.state.practice_doctors.map((function(e){return D.a.createElement(m.a.Item,{key:e.id,style:{textOverflow:"ellipsis",borderRight:"none",borderLeft:"5px solid ".concat(e.calendar_colour),backgroundColor:t.state.selectedDoctor==e.id?e.calendar_colour:"inherit",color:t.state.selectedDoctor==e.id?"white":"inherit",fontWeight:t.state.selectedDoctor==e.id?"bold":"inherit"}},D.a.createElement("span",null,"(",t.state.doctorsAppointmentCount[e.id]?t.state.filterCancelledAppointment?t.state.doctorsAppointmentCount[e.id].ALL:t.state.doctorsAppointmentCount[e.id].ALL-t.state.doctorsAppointmentCount[e.id].CANCELLED:0,") ",e.user.first_name))}))):D.a.createElement(m.a,{selectedKeys:[this.state.selectedCategory],size:"small",onClick:function(e){return t.changeFilter("selectedCategory",e.key)}},D.a.createElement(m.a.Item,{key:"ALL",style:{marginBottom:2,textOverflow:"ellipsis",borderLeft:"5px solid black",borderRight:"none"}},D.a.createElement("span",null,"(",this.state.categoriesAppointmentCount.ALL?this.state.categoriesAppointmentCount.ALL:0,") All Categories")),this.state.practice_categories.map((function(e){return D.a.createElement(m.a.Item,{key:e.id,style:{textOverflow:"ellipsis",borderRight:"none",borderLeft:"5px solid #".concat(e.calendar_colour),backgroundColor:t.state.selectedCategory==e.id?"#".concat(e.calendar_colour):"inherit",color:t.state.selectedCategory==e.id?"white":"inherit",fontWeight:t.state.selectedCategory==e.id?"bold":"inherit"}},D.a.createElement("span",null,"(",t.state.categoriesAppointmentCount[e.id]?t.state.categoriesAppointmentCount[e.id]:0,") ",e.name))}))),D.a.createElement("div",{style:{marginTop:16}},D.a.createElement(c.a.Group,{size:"small",checked:this.state.calendarType,defaultValue:this.state.calendarType,buttonStyle:"solid",onChange:function(e){return t.changeCalendarType(e.target.value)}},D.a.createElement(c.a.Button,{value:"APPOINTMENTS"},D.a.createElement("small",null,"Appointments")),D.a.createElement(c.a.Button,{value:"AVAILABILITY"},D.a.createElement("small",null,"Availability")))),D.a.createElement("div",{style:{position:"fixed",bottom:10,zIndex:9}},this.state.openMorePanel?D.a.createElement("div",{style:{boxShadow:"0 2px 4px #111",border:"1px solid #bbb",borderRadius:2,padding:5,backgroundColor:"white"}},D.a.createElement("ul",{style:{listStyle:"none",paddingInlineStart:0}},D.a.createElement("li",null,D.a.createElement(r.a,{checked:this.state.showCalendarEvents,onChange:function(t){return e.changeState("showCalendarEvents",t.target.checked)}},D.a.createElement("small",null,"Events"))),D.a.createElement("li",null,D.a.createElement(r.a,{checked:this.state.showAppointments,onChange:function(t){return e.changeState("showAppointments",t.target.checked)}},D.a.createElement("small",null,"Appointments"))),D.a.createElement("li",null,D.a.createElement(r.a,{checked:this.state.show24HourCalendar,onChange:function(t){return e.changeState("show24HourCalendar",t.target.checked)}},D.a.createElement("small",null,"24 Hours"))),D.a.createElement("li",null,D.a.createElement(r.a,{checked:this.state.filterCancelledAppointment,onChange:function(t){return e.setFilter("filterCancelledAppointment",t.target.checked)}},D.a.createElement("small",null,"Cancellled Appointment"))),D.a.createElement("li",null,D.a.createElement(i.a,null)),D.a.createElement("li",null,D.a.createElement(I.b,{to:"/settings/clinics-staff#staff"},D.a.createElement("small",null,"Add Doctor"))),D.a.createElement("li",null,D.a.createElement(I.b,{to:"/settings/calendarsettings#timings"},D.a.createElement("small",null," Customize Calendar"))),D.a.createElement("li",null,D.a.createElement("a",null,D.a.createElement("small",null,"Resync")),D.a.createElement(d.a,{onClick:function(){return t.changeState("openMorePanel",!1)},shape:"circle",size:"small",type:"danger",icon:"close",style:{float:"right"}})))):D.a.createElement("a",{onClick:function(){return t.changeState("openMorePanel",!0)}},"More ",D.a.createElement(p.a,{type:"caret-down"}))))),"APPOINTMENTS"==this.state.calendarType?D.a.createElement("div",null,D.a.createElement(s.a,{span:16},D.a.createElement(o.a,{size:"large",spinning:this.state.loading},D.a.createElement(et,{key:"APPOINTMENTS",defaultDate:new Date,localizer:tt,defaultView:"day",step:10,timeslots:1,truncateEvents:!1,events:this.state.showAppointments?this.state.filteredEvent:[],onEventDrop:this.moveEvent,onEventResize:this.resizeEvent,resizable:!0,selectable:!0,popup:this.onSelectEvent,onSelectSlot:this.onSelectSlot,views:{month:!0,week:ot,day:!0,agenda:!0},style:{height:"calc(100vh - 85px)"},eventPropGetter:this.eventStyleGetter,date:new Date(this.state.selectedDate.format()),onRangeChange:this.onRangeChange,components:{event:function(t){return D.a.createElement(G,Object.assign({},t,e.props))},timeSlotWrapper:function(t){return D.a.createElement(K,Object.assign({},t,{key:t.value.toString(),blockedCalendar:e.state.blockedCalendar,calendarTimings:e.state.timing,doctorTimings:e.state.doctorTiming[e.state.selectedDoctor],filterType:e.state.filterType,selectedDoctor:e.state.selectedDoctor,showCalendarEvents:e.state.showCalendarEvents}))}}}))),D.a.createElement(s.a,{span:5},D.a.createElement(Q,Object.assign({},this.props,this.state,{selectedDate:this.state.selectedDate,key:S()(this.state.selectedDate).format("l")})))):D.a.createElement(s.a,{span:21},D.a.createElement(et,{key:"AVAILABILITY",defaultDate:new Date,localizer:tt,defaultView:"day",step:10,timeslots:1,truncateEvents:!1,events:this.state.showAppointments?this.state.filteredEvent:[],onEventDrop:this.moveEvent,onEventResize:this.resizeEvent,resizable:!0,selectable:!0,popup:this.onSelectEvent,onSelectSlot:this.onSelectSlot,views:{week:!0,day:!0},style:{height:"calc(100vh - 85px)"},eventPropGetter:this.eventStyleGetter,date:new Date(this.state.selectedDate.format()),onRangeChange:this.onRangeChange,components:{event:function(t){return D.a.createElement(G,Object.assign({},t,e.props))},timeSlotWrapper:function(t){return D.a.createElement(K,Object.assign({},t,{key:t.value.toString(),blockedCalendar:e.state.blockedCalendar,calendarTimings:e.state.timing,doctorTimings:e.state.doctorTiming[e.state.selectedDoctor],filterType:e.state.filterType,selectedDoctor:e.state.selectedDoctor,showCalendarEvents:e.state.showCalendarEvents}))}}}))))))))}}]),e}(L.Component),ot=(e.default=st,function(t){function e(){return Object(b.a)(this,e),Object(E.a)(this,Object(v.a)(e).apply(this,arguments))}return Object(C.a)(e,t),Object(y.a)(e,[{key:"render",value:function(){var t=this.props.date,a=e.range(t);return D.a.createElement(w.a,Object.assign({},this.props,{range:a,eventOffset:15}))}}]),e}(D.a.Component));ot.range=function(t){for(var e=P.add(t,-1,"day"),a=P.add(e,6,"day"),n=e,s=[];P.lte(n,a,"day");)s.push(n),n=P.add(n,1,"day");return s},ot.navigate=function(t,e){switch(e){case F.b.PREVIOUS:return P.add(t,-3,"day");case F.b.NEXT:return P.add(t,3,"day");default:return t}},ot.title=function(t){return" ".concat(t.toLocaleDateString())}}}]);
//# sourceMappingURL=18.7a489e1f.chunk.js.map