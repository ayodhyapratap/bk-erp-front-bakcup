(this["webpackJsonpbk-erp-front"]=this["webpackJsonpbk-erp-front"]||[]).push([[22],{1259:function(e,t,a){"use strict";a.r(t);a(181);var n=a(57),i=(a(332),a(333)),r=(a(119),a(34)),l=(a(121),a(15)),o=(a(373),a(372)),c=(a(370),a(368)),s=(a(180),a(120)),d=(a(330),a(12)),m=a(46),u=a(21),p=a(62),h=a(61),f=a(64),g=a(63),b=a(18),E=a(65),y=a(0),v=a.n(y),O=(a(698),a(699),a(37)),j=a(84),S=a(700),k=a.n(S),w=a(754),L=a(322),D=a.n(L),M=a(707),I=a.n(M),C=a(485),A=(a(400),a(406)),U=(a(354),a(357)),T=(a(369),a(371)),V=(a(187),a(127)),P=(a(366),a(367)),N=(a(324),a(323)),_=(a(328),a(329)),x=(a(339),a(342)),Z=a(16),F=a(35),z=a(325),B=(a(38),a(326),a(327)),R=(a(344),a(345)),Y=(a(481),a(500)),W=a(4),H=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).loadMeetingDetails=function(){var e=Object(b.a)(a);e.setState({loading:!0});Object(Z.c)(Object(Z.f)(F.od,[e.props.meetingId]),(function(t){e.setState({loading:!1,meeting:t})}),(function(){e.setState({loading:!1})}))},a.openWindowLink=function(e){window.open(e)},a.state={loading:!1,meeting:null},a}return Object(E.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.loadMeetingDetails()}},{key:"copyToClipBoard",value:function(e){navigator.clipboard.writeText(e),Object(Z.a)(W.Sb,"Meeting URL & Password copied to clipboard")}},{key:"render",value:function(){var e=this;if(!this.state.meeting)return v.a.createElement(Y.a,{status:"warning",title:"Meeting Not Found"});var t=this;return v.a.createElement("div",{style:{width:"300px",minHeight:"200px",overflowY:"scroll",overflowX:"hidden"}},v.a.createElement(i.a,{spinning:this.state.loading},v.a.createElement("div",null,v.a.createElement("h4",null,this.state.meeting.name),v.a.createElement(R.a,{title:"Are you sure to start this meeting?",onConfirm:function(){return t.openWindowLink("https://clinic.bkarogyam.com/webcall/".concat(e.state.meeting.id))},okText:"Yes",cancelText:"No"},v.a.createElement("a",null,"Meeting Link")),v.a.createElement(s.a,{size:"small",onClick:function(){return e.copyToClipBoard("https://clinic.bkarogyam.com/webcall/".concat(e.state.meeting.id))},block:!0,shape:"round"},"Copy Link"),v.a.createElement("p",null,this.state.meeting.purpose))))}}]),t}(v.a.Component),J=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).state={loading:!1},a}return Object(E.a)(t,e),Object(h.a)(t,[{key:"componentWillReceiveProps",value:function(){this.loadTodayMeeting()}},{key:"loadTodayMeeting",value:function(){var e=this;this.setState({loading:!0});var t={start:D()().startOf("day").format(),end:D()().endOf("day").format()};Object(Z.c)(F.Zb,(function(t){e.setState({filterMeetingList:t,loading:!1})}),(function(){e.setState({loading:!1})}),t)}},{key:"render",value:function(){var e=this.state.filterMeetingList;return console.log("===",e),v.a.createElement("div",null,v.a.createElement(B.a,null,v.a.createElement("a",{type:"primary"},v.a.createElement(d.a,{type:"left"}))," Meeting's Schedule ",v.a.createElement("a",{type:"primary"},v.a.createElement(d.a,{type:"right"}))),v.a.createElement(i.a,{spinning:this.props.loading},v.a.createElement(U.a,{dataSource:e,bordered:!0,renderItem:function(e){return v.a.createElement(U.a.Item,null,v.a.createElement(X,e))}})))}}]),t}(v.a.Component);function X(e){return v.a.createElement("div",{style:{width:"100%"}},v.a.createElement("p",{style:{marginBottom:0}},v.a.createElement(A.a,{placement:"right",content:v.a.createElement(H,{meetingId:e.id,key:e.id})},v.a.createElement("span",{style:{width:"calc(100% - 60px)"}},v.a.createElement("b",null,D()(e.start).format("LT")),"\xa0",e.name))))}var K=0,q=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).loadPracticeStaff=function(){var e=Object(b.a)(a);Object(Z.c)(Object(Z.f)(F.Ec,[e.props.active_practiceId]),(function(t){e.setState({practiceStaff:t.staff})}),(function(){}))},a.loadPatient=function(e){var t=Object(b.a)(a);e&&Object(Z.c)(Object(Z.f)(F.Wc,[e]),(function(e){e.results.length>0&&t.setState({patientListData:e.results})}),(function(){}))},a.handleSubmit=function(e){var t=Object(b.a)(a);t.setState({loading:!0}),e.preventDefault(),a.props.form.validateFields((function(e,a){if(!e){var n=a;if(a.doctors){a.doctors.length;var i=a.doctors.values(),r=[],l=!0,o=!1,c=void 0;try{for(var s,d=i[Symbol.iterator]();!(l=(s=d.next()).done);l=!0){var m=s.value;r.push(m)}}catch(e){o=!0,c=e}finally{try{l||null==d.return||d.return()}finally{if(o)throw c}}n.doctors=r}if(a.patients){a.patients.length;var u=[],p=a.patients.values(),h=!0,f=!1,g=void 0;try{for(var b,E=p[Symbol.iterator]();!(h=(b=E.next()).done);h=!0){var y=b.value;u.push(y)}}catch(e){f=!0,g=e}finally{try{h||null==E.return||E.return()}finally{if(f)throw g}}n.patients=u}a.other_user&&a.other_user.length;Object(Z.j)(F.Yb,n,(function(e){t.setState({loading:!1}),t.props.history.push("/meeting-booking"),t.props.loadData()}),(function(){t.setState({loading:!1})}))}}))},a.addNewUser=function(){Object(b.a)(a);var e=a.props.form,t=e.getFieldValue("keys").concat(K++);e.setFieldsValue({keys:t})},a.removeNewOptionField=function(e){var t=a.props.form,n=t.getFieldValue("keys");t.setFieldsValue({keys:n.filter((function(t){return t!==e}))})},a.loadMeetingList=function(e,t,n){var i=Object(b.a)(a);i.setState({loading:!0});var r={start:e.format(),end:t.format(),zoom_user:n};Object(Z.c)(F.Zb,(function(e){i.setState({filterMeetingList:e,loading:!1,meetingNotAllowed:!!e.length})}),(function(){i.setState({meetingNotAllowed:!0,loading:!1})}),r)},a.checkMeetingAvailabilty=function(e,t){var n,i=Object(b.a)(a);a.setState((n={},Object(m.a)(n,e,t),Object(m.a)(n,"loading",!0),n),(function(){i.loadMeetingList(i.state.startSchedule,D()(i.state.startSchedule).add(i.state.duration,"minute"),i.state.zoomUser)}))},a.state={loading:!1,patientListData:[],no_of_participant:1,practiceDoctors:[],practiceStaff:[],zoom_user:[],add_new_user:!1,meetingNotAllowed:!0,duration:30,startSchedule:a.props?D()(a.props.startTime):D()(),filterMeetingList:[]},a.loadPatient=a.loadPatient.bind(Object(b.a)(a)),a.loadZoomUser=a.loadZoomUser.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(h.a)(t,[{key:"componentWillMount",value:function(){this.loadPatient(),Object(z.d)(this),this.loadPracticeStaff(),this.loadMeetingList(this.state.startSchedule,D()(this.state.startSchedule).add(this.state.duration,"minute"))}},{key:"loadZoomUser",value:function(){var e=this;Object(Z.c)(F.ac,(function(t){e.setState({zoom_user:t})}),(function(){}))}},{key:"onChangeParticipant",value:function(e){this.setState({no_of_participant:e})}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,o=a.getFieldDecorator,c=a.getFieldValue,m=this.state.filterMeetingList,u={labelCol:{span:6},wrapperCol:{span:18}};o("keys",{initialValue:[]});var p=c("keys").map((function(e,a){return v.a.createElement("div",null,v.a.createElement(l.a,{span:6,offset:4},v.a.createElement(_.a.Item,{label:"First Name",key:e},o("others[".concat(e,"][first_name]"),{initialValue:""})(v.a.createElement(x.a,{placeholder:"First Name"})))),v.a.createElement(l.a,{span:4},v.a.createElement(_.a.Item,{label:"Last Name"},o("others[".concat(e,"][last_name]"),{initialValue:""})(v.a.createElement(x.a,{placeholder:"Last Name"})))),v.a.createElement(l.a,{span:4},v.a.createElement(_.a.Item,{label:"Email Id"},o("others[".concat(e,"][email]"),{initialValue:""})(v.a.createElement(x.a,{placeholder:"Email Id"})))),v.a.createElement(l.a,{span:4},v.a.createElement(_.a.Item,{label:"phone"},o("others[".concat(e,"][phone]"),{initialValue:""})(v.a.createElement(x.a,{placeholder:"Phone Number"})))),v.a.createElement(l.a,{span:2},v.a.createElement(_.a.Item,{label:" ",colon:!1},v.a.createElement(s.a,{shape:"circle",onClick:function(){return t.removeNewOptionField(e)}},v.a.createElement(d.a,{className:"dynamic-delete-button",type:"minus-circle-o"})),v.a.createElement("br",null))))}));return v.a.createElement(n.a,{title:"Add Booking"},v.a.createElement(r.a,{gutter:16},v.a.createElement(l.a,{span:14},v.a.createElement(_.a,{onSubmit:this.handleSubmit},v.a.createElement(_.a.Item,Object.assign({label:"Purpose"},u),o("name",{initialValue:""})(v.a.createElement(x.a,{placeholder:"Purpose"}))),v.a.createElement(_.a.Item,Object.assign({label:"Agenda"},u),o("agenda",{initialValue:""})(v.a.createElement(x.a.TextArea,{placeholder:"Agenda",rows:3}))),v.a.createElement(_.a.Item,Object.assign({label:"Meeting Admins"},u,{key:"admins"}),o("admins",{initialValue:[]})(v.a.createElement(N.a,{mode:"multiple",placeholder:"Select Admins",style:{width:"100%"}},this.state.practiceStaff.map((function(e){return v.a.createElement(N.a.Option,{value:e.id},e.user.first_name)}))))),v.a.createElement(_.a.Item,Object.assign({label:"Patients"},u,{key:"patient"}),o("patients",{initialValue:[]})(v.a.createElement(N.a,{mode:"multiple",placeholder:"Select Patient",style:{width:"100%"},showSearch:!0,onSearch:this.loadPatient,filterOption:!1},this.state.patientListData.map((function(e){return v.a.createElement(N.a.Option,{value:e.id},e.user.first_name," (",e.custom_id,")")}))))),v.a.createElement(_.a.Item,Object.assign({label:"Doctors"},u,{key:"doctors"}),o("doctors",{initialValue:[]})(v.a.createElement(N.a,{placeholder:"Select Doctors",style:{width:"100%"},mode:"multiple"},this.state.practiceDoctors.map((function(e){return v.a.createElement(N.a.Option,{key:e.id},e.user.first_name)}))))),v.a.createElement(r.a,{gutter:16},p),v.a.createElement(_.a.Item,{wrapperCol:{xs:{span:24,offset:0},sm:{span:18,offset:6}}},v.a.createElement("a",{onClick:function(){return e.addNewUser()}}," ",v.a.createElement(d.a,{type:"plus"})," Add New User")),v.a.createElement(_.a.Item,Object.assign({label:"Booking From"},u),o("start",{initialValue:t.state.startSchedule&&D()(t.state.startSchedule).isValid()?D()(t.state.startSchedule):t.props.startTime&&D()(t.props.startTime).isValid()?D()(t.props.startTime):null})(v.a.createElement(P.a,{format:"YYYY/MM/DD HH:mm",showTime:!0,onChange:function(e){return t.checkMeetingAvailabilty("startSchedule",e)}})),this.state.filterMeetingList.length>0?v.a.createElement(V.a,{message:"Selected time slot Booked!!",type:"warning",showIcon:!0}):null),v.a.createElement(_.a.Item,Object.assign({label:"Duration"},u),o("duration",{initialValue:this.state.duration})(v.a.createElement(T.a,{onChange:function(e){return t.checkMeetingAvailabilty("duration",e)}})),v.a.createElement("span",{className:"ant-form-text"},"Minutes")),v.a.createElement(_.a.Item,u,v.a.createElement(s.a,{type:"primary",htmlType:"submit",style:{margin:5},disabled:this.state.meetingNotAllowed,loading:this.state.loading},"Submit"),t.props.history?v.a.createElement(s.a,{style:{margin:5},onClick:function(){return t.props.history.goBack()}},"Cancel"):null))),v.a.createElement(l.a,{span:6,style:{float:"Right"}},v.a.createElement("div",null,v.a.createElement(i.a,{spinning:this.props.loading},v.a.createElement(U.a,{dataSource:m,bordered:m.length>0,renderItem:function(e){return v.a.createElement(U.a.Item,null,v.a.createElement(Q,e))}}))))))}}]),t}(v.a.Component),G=_.a.create()(q);function Q(e){return v.a.createElement("div",{style:{width:"100%"}},v.a.createElement("p",{style:{marginBottom:0}},v.a.createElement(A.a,{placement:"right",content:v.a.createElement(H,{meetingId:e.id,key:e.id})},v.a.createElement("span",{style:{width:"calc(100% - 60px)"}},v.a.createElement("b",null,D()(e.start).format("LLL")),"\xa0",e.name))))}var $=function(e){function t(e){return Object(p.a)(this,t),Object(f.a)(this,Object(g.a)(t).call(this,e))}return Object(E.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return v.a.createElement(A.a,{placement:"right",content:v.a.createElement(H,Object.assign({meetingId:this.props.event.id,key:this.props.event.id},this.props)),trigger:"hover"},v.a.createElement("div",{style:{color:"white",height:"100%"}},v.a.createElement("h1",{style:{color:"white"}},v.a.createElement(d.a,{type:"user"}),this.props.event.name)))}}]),t}(v.a.Component),ee=a(380);a(337);a.d(t,"default",(function(){return ne}));var te=k()(w.a),ae=Object(w.c)(D.a),ne=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).onSelectSlot=function(e){var t=Object(b.a)(a),n=D()(e.start);"doubleClick"==e.action&&(t.setState({startTime:n,redirect:!0}),a.props.history.push("/meeting-booking/add"))},a.onRangeChange=function(e){var t=Object(b.a)(a);if(e.start&&e.end)if(1==D()(e.start).date())a.setState({selectedDate:D()(e.start),selectedStartDate:D()(e.start),selectedEndDate:D()(e.end)},(function(){t.loadMeetingList()}));else{var n=D()(e.start);a.setState({selectedDate:n.month(n.month()+1).date(1),selectedStartDate:D()(e.start),selectedEndDate:D()(e.end)},(function(){t.loadMeetingList()}))}else e.length&&(7==e.length?a.setState({selectedDate:D()(e[1]),selectedStartDate:D()(e[0]).subtract(1,"day"),selectedEndDate:D()(e[e.length-1]).add(1,"day")},(function(){t.loadMeetingList()})):(a.loadMeetingList(D()(e[0]),D()(e[e.length-1])),a.setState({selectedDate:D()(e[0]),selectedStartDate:D()(e[0]),selectedEndDate:D()(e[e.length-1])},(function(){t.loadMeetingList()}))))},a.loadMeetingList=function(){var e=Object(b.a)(a);e.setState({loading:!0});var t={start:D()(a.state.selectedStartDate).startOf("day").format(),end:D()(a.state.selectedEndDate).endOf("day").format()};Object(Z.c)(F.Zb,(function(t){var a=[];t.forEach((function(e){a.push(Object(u.a)({},e,{title:e.agenda,start:new Date(e.start),end:new Date(e.end)}))})),e.setState({meetingList:a,filterMeetingList:a,loading:!1})}),(function(){}),t)},a.setFilterType=function(e){var t=Object(b.a)(a);a.setState({filterType:e.key,selectedZoomUser:"ALL"},(function(){"Zoom User"==e.key&&t.changeFilter("selectedZoomUser","ALL")}))},a.changeFilter=function(e,t){"selectedDoctor"==e&&"ALL"!=t&&a.loadMeetingList(),a.setState((function(a){var n,i=[];return a.meetingList.forEach((function(a){"ALL"==t?i.push(a):"selectedZoomUser"==e&&a.zoom_user==t&&i.push(a)})),n={},Object(m.a)(n,e,t),Object(m.a)(n,"filterMeetingList",i),n}))},a.state={loading:!1,selectedDate:D()(),selectedStartDate:D()().subtract(1,"days"),selectedEndDate:D()().add(5,"days"),meetingList:[],filterMeetingList:[],filterType:"Zoom User",zoomUser:[]},a.loadZoomUser=a.loadZoomUser.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.loadMeetingList()}},{key:"loadZoomUser",value:function(){var e=this;Object(Z.c)(F.ac,(function(t){e.setState({zoomUser:t,loading:!1})}),(function(){e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this,t=this;return v.a.createElement("div",{style:{margin:20}},v.a.createElement(O.d,null,v.a.createElement(O.b,{exact:!0,path:"/meeting-booking/add",render:function(a){return t.props.activePracticePermissions||t.props.CreateMeeting?v.a.createElement(G,Object.assign({},e.state,a,e.props,{loadData:e.loadMeetingList})):v.a.createElement(ee.a,null)}}),v.a.createElement(O.b,{exact:!0,path:"/meeting-booking/edit/:id",render:function(a){return t.props.activePracticePermissions||t.props.UpdateMeeting?v.a.createElement(G,Object.assign({},a,e.props,e.state,{loadData:e.loadMeetingList})):v.a.createElement(ee.a,null)}}),v.a.createElement(n.a,{title:"Meeting Booking",extra:v.a.createElement(j.b,{to:"/meeting-booking/add"},v.a.createElement(s.a,{type:"primary"},v.a.createElement(d.a,{type:"plus"})," Add Booking"))},v.a.createElement(i.a,{size:"large",spinning:this.state.loading},v.a.createElement(r.a,{gutter:16},v.a.createElement(l.a,{span:3},v.a.createElement("div",null,v.a.createElement(o.a,{trigger:"click",overlay:v.a.createElement(c.a,null,v.a.createElement(c.a.Item,{key:"Zoom User"},"Zoom User"))},v.a.createElement(s.a,{block:!0,style:{margin:5}},this.state.filterType," ",v.a.createElement(d.a,{type:"caret-down"}))),v.a.createElement(c.a,{defaultSelectedKeys:"ALL",onClick:function(t){return e.changeFilter("selectedZoomUser",t.key)}},v.a.createElement(c.a.Item,{key:"ALL",style:{marginBottom:2,textOverflow:"ellipsis",borderRight:"none"}},v.a.createElement("span",null,"All Zoom User")),this.state.zoomUser.map((function(e){return v.a.createElement(c.a.Item,{key:e.id,style:{textOverflow:"ellipsis",borderRight:"none"}},v.a.createElement("span",null,e.id?e.username:null))}))))),v.a.createElement(l.a,{span:16},v.a.createElement(te,{localizer:ae,startAccessor:"start",defaultView:"week",step:10,timeslots:1,events:this.state.filterMeetingList,selectable:!0,date:new Date(this.state.selectedDate.format()),endAccessor:"end",defaultDate:new Date,views:{month:!0,week:ie,day:!0},onSelectSlot:this.onSelectSlot,style:{height:"calc(100vh - 85px)"},onRangeChange:this.onRangeChange,components:{event:function(e){return v.a.createElement($,Object.assign({},e,t.props))}}})),v.a.createElement(l.a,{span:5},v.a.createElement(J,Object.assign({},this.props,this.state))))))))}}]),t}(v.a.Component),ie=function(e){function t(){return Object(p.a)(this,t),Object(f.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.date,a=t.range(e);return v.a.createElement(I.a,Object.assign({},this.props,{range:a,eventOffset:15}))}}]),t}(v.a.Component);ie.range=function(e){for(var t=C.add(e,-1,"day"),a=C.add(t,6,"day"),n=t,i=[];C.lte(n,a,"day");)i.push(n),n=C.add(n,1,"day");return i},ie.navigate=function(e,t){switch(t){case w.b.PREVIOUS:return C.add(e,-3,"day");case w.b.NEXT:return C.add(e,3,"day");default:return e}},ie.title=function(e){return" ".concat(e.toLocaleDateString())}}}]);
//# sourceMappingURL=22.05c38d75.chunk.js.map