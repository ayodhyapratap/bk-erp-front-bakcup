(window["webpackJsonpbk-erp-front"]=window["webpackJsonpbk-erp-front"]||[]).push([[16],{1597:function(t,e,a){},1598:function(t,e,a){},1620:function(t,e,a){},1749:function(t,e,a){"use strict";a.r(e);a(223);var n=a(224),s=(a(231),a(232)),o=(a(241),a(242)),r=(a(234),a(235)),i=(a(278),a(276)),c=(a(273),a(270)),l=(a(290),a(289)),m=(a(287),a(283)),d=(a(228),a(227)),p=(a(237),a(18)),u=(a(281),a(282)),h=a(247),f=a(33),g=a(96),b=a(97),y=a(100),E=a(98),v=a(44),A=a(99),C=(a(259),a(260)),O=(a(138),a(101)),T=a(0),L=a.n(T),D=a(64),k=a.n(D),H=(a(1597),a(1598),a(857)),j=a.n(H),S=a(864),w=a.n(S),_=a(902),F=a(2),x=(a(1620),a(24)),P=a(65),I=a(475),R=a(23),M=a(32),Y=(a(343),a(357)),N=a(581),z=function(t){function e(t){return Object(g.a)(this,e),Object(y.a)(this,Object(E.a)(e).call(this,t))}return Object(A.a)(e,t),Object(b.a)(e,[{key:"render",value:function(){return L.a.createElement(Y.a,{placement:"right",content:L.a.createElement(N.a,Object.assign({appointmentId:this.props.event.appointment.id,key:this.props.event.appointment.id},this.props)),trigger:"hover"},L.a.createElement("div",{style:{color:"white",height:"100%"}},L.a.createElement("h1",{style:{color:"white"}},L.a.createElement(p.a,{type:"user"}),this.props.title)))}}]),e}(L.a.Component),G=a(233),B=a(3);function W(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function V(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?W(a,!0).forEach((function(e){Object(f.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):W(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var J=L.a.createElement(m.a,null,L.a.createElement(m.a.Item,{key:"1"},L.a.createElement(P.b,{to:"/settings/calendarsettings#timings"},"Modify Calendar Timings")),L.a.createElement(m.a.Item,{key:"2"},L.a.createElement(P.b,{to:"/settings/clinics-staff#staff"},"Add/Edit Doctor or Staff")),L.a.createElement(m.a.Item,{key:"3"},L.a.createElement(P.b,{to:"/settings/clinics-staff#notification"},"Modify SMS/Email for Doctor/Staff")),L.a.createElement(m.a.Item,{key:"4"},L.a.createElement(P.b,{to:"/settings/communication-settings"},"Modify SMS/Email for Patients")),L.a.createElement(m.a.Item,{key:"5"},L.a.createElement(P.b,{to:"/settings/calendarsettings#categories"},"Add/Edit Categroies"))),K=function(t,e){var a=B.get(F.v);a||(a={}),a=V({},a,Object(f.a)({},t,e)),B.set(F.v,a)},q=function(){var t=B.get(F.v);return t||(t={}),t},U=function(t){var e=!0,a=k()(t.value).isValid()?k()(t.value).format("dddd").toLowerCase():null;if("DOCTOR"!=t.filterType||"ALL"==t.selectedDoctor)if(t.calendarTimings&&a&&t.calendarTimings[a]){var n=t.calendarTimings[a];n.lunch?(k()(t.value,"HH:mm:ss").format("HH:mm:ss")<=n.startTime.format("HH:mm:ss")||k()(t.value,"HH:mm:ss").format("HH:mm:ss")>n.endTime.format("HH:mm:ss")||k()(t.value,"HH:mm:ss").format("HH:mm:ss")<n.lunchEndTime.format("HH:mm:ss")&&k()(t.value,"HH:mm:ss").format("HH:mm:ss")>=n.lunchStartTime.format("HH:mm:ss"))&&(e=!1):(k()(t.value,"HH:mm:ss").format("HH:mm:ss")<=n.startTime.format("HH:mm:ss")||k()(t.value,"HH:mm:ss").format("HH:mm:ss")>n.endTime.format("HH:mm:ss"))&&(e=!1)}else a&&!t.calendarTimings[a]&&(e=!1);else if(t.doctorTimings&&a&&t.doctorTimings[a]){var s=t.doctorTimings[a];s.lunch?(k()(t.value,"HH:mm:ss").format("HH:mm:ss")<=s.startTime.format("HH:mm:ss")||k()(t.value,"HH:mm:ss").format("HH:mm:ss")>s.endTime.format("HH:mm:ss")||k()(t.value,"HH:mm:ss").format("HH:mm:ss")<s.lunchEndTime.format("HH:mm:ss")&&k()(t.value,"HH:mm:ss").format("HH:mm:ss")>=s.lunchStartTime.format("HH:mm:ss"))&&(e=!1):(k()(t.value,"HH:mm:ss").format("HH:mm:ss")<=s.startTime.format("HH:mm:ss")||k()(t.value,"HH:mm:ss").format("HH:mm:ss")>s.endTime.format("HH:mm:ss"))&&(e=!1)}else t.doctorTimings&&a&&!t.doctorTimings[a]&&(e=!1);if(t.showCalendarEvents&&e)for(var o=0;o<t.blockedCalendar.length;o++)if(t.blockedCalendar[o].doctor&&"DOCTOR"==t.filterType){if(t.blockedCalendar[o].doctor==t.selectedDoctor&&k()(t.value).isBetween(k()(t.blockedCalendar[o].block_from),k()(t.blockedCalendar[o].block_to))){e=!1;break}}else if(k()(t.value).isBetween(k()(t.blockedCalendar[o].block_from),k()(t.blockedCalendar[o].block_to))){e=!1;break}if(e)return t.children;var r=L.a.Children.only(t.children);return L.a.cloneElement(r,{className:r.props.className+" rbc-off-range-bg"})},X=(a(268),a(271)),Q=a(245),Z=function(t){function e(t){var a;return Object(g.a)(this,e),(a=Object(y.a)(this,Object(E.a)(e).call(this,t))).changeDate=function(t){var e=Object(v.a)(a);a.setState((function(e){return t?{selectedDate:e.selectedDate.add(1,"days")}:{selectedDate:e.selectedDate.subtract(1,"days")}}),(function(){e.todaysAppointments()}))},a.todaysAppointments=function(){var t=Object(v.a)(a);t.setState({loading:!0});Object(R.c)(Object(R.f)(M.q,[a.props.active_practiceId]),(function(e){t.setState((function(t){var a={},n=[];return e.forEach((function(e){if(e.status==Q.m)return!0;a[e.status]?a[e.status]+=1:a[e.status]=1,"ALL"==t.todaysAppointmentFilter?n.push(e):t.todaysAppointmentFilter==e.status&&n.push(e)})),{todaysAppointments:e,todaysAppointmentOverview:a,todaysFilteredAppointments:n,loading:!1}}))}),(function(){t.setState({loading:!1})}),{start:t.state.selectedDate.format("YYYY-MM-DD"),end:t.state.selectedDate.format("YYYY-MM-DD")})},a.filterTodaysAppointment=function(t){a.setState((function(e){var a=[];return e.todaysAppointments.forEach((function(e){"ALL"==t?a.push(e):t==e.status&&a.push(e)})),{todaysFilteredAppointments:a,todaysAppointmentFilter:t}}))},a.changeAppointmentStatus=function(t,e,n){var s=Object(v.a)(a);Object(R.c)(Object(R.f)(M.o,[t]),(function(a){a.status==e?s.updateAppointmentStatus(t,e,n):(Object(R.a)(F.S,"Appointment status has already changed. Updating Appointments..."),s.todaysAppointments())}),(function(){}))},a.updateAppointmentStatus=function(t,e,n){var s=Object(v.a)(a),o={status:n};n==Q.Hb?o.waiting=k()().format():n==Q.F?o.engaged=k()().format():n==Q.n&&(o.checkout=k()().format());Object(R.l)(Object(R.f)(M.o,[t]),o,(function(t){Object(R.a)(F.Wb,"Appointment Status Changed Successfully!!"),s.todaysAppointments()}),(function(){}))},a.state={todaysAppointments:[],todaysFilteredAppointments:[],todaysAppointmentOverview:{},todaysAppointmentFilter:"ALL",selectedDate:k()()},a.todaysAppointments=a.todaysAppointments.bind(Object(v.a)(a)),a}return Object(A.a)(e,t),Object(b.a)(e,[{key:"componentDidMount",value:function(){this.todaysAppointments()}},{key:"render",value:function(){var t=this,e=this;return L.a.createElement("div",null,L.a.createElement(l.a,{trigger:"click",overlay:J},L.a.createElement(d.a,{block:!0,style:{margin:5}},L.a.createElement(p.a,{type:"setting"})," Settings ",L.a.createElement(p.a,{type:"down"}))),e.props.activePracticePermissions.AddWalkinAppointment||e.props.allowAllPermissions?L.a.createElement(P.b,{to:"/calendar/create-appointment"},L.a.createElement(d.a,{block:!0,type:"primary",style:{margin:5}}," Walkin Appointment")):null,L.a.createElement(n.a,{gutter:8},L.a.createElement(s.a,{span:6,onClick:function(){return t.filterTodaysAppointment(t.state.todaysAppointmentFilter==Q.Cb?"ALL":Q.Cb)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==Q.Cb?"#FF6600":null,color:this.state.todaysAppointmentFilter==Q.Cb?"white":"#FF6600",boxShadow:"0 2px 4px #111 inset"}},L.a.createElement("small",null,Q.Cb),L.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==Q.Cb?"white":"#FF6600"}},this.state.todaysAppointmentOverview[Q.Cb]?this.state.todaysAppointmentOverview[Q.Cb]:0)),L.a.createElement(s.a,{span:6,onClick:function(){return t.filterTodaysAppointment(t.state.todaysAppointmentFilter==Q.Hb?"ALL":Q.Hb)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==Q.Hb?"#FC0000":null,color:this.state.todaysAppointmentFilter==Q.Hb?"white":"#FC0000",boxShadow:"0 2px 4px #111 inset"}},L.a.createElement("small",null,Q.Hb),L.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==Q.Hb?"white":"#FC0000"}},this.state.todaysAppointmentOverview[Q.Hb]?this.state.todaysAppointmentOverview[Q.Hb]:0)),L.a.createElement(s.a,{span:6,onClick:function(){return t.filterTodaysAppointment(t.state.todaysAppointmentFilter==Q.F?"ALL":Q.F)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==Q.F?"#598C01":null,color:this.state.todaysAppointmentFilter==Q.F?"white":"#598C01",boxShadow:"0 2px 4px #111 inset"}},L.a.createElement("small",null,Q.F),L.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==Q.F?"white":"#598C01"}},this.state.todaysAppointmentOverview[Q.F]?this.state.todaysAppointmentOverview[Q.F]:0)),L.a.createElement(s.a,{span:6,onClick:function(){return t.filterTodaysAppointment(t.state.todaysAppointmentFilter==Q.n?"ALL":Q.n)},style:{textAlign:"center",border:"1px solid #ccc",borderRadius:"3px",backgroundColor:this.state.todaysAppointmentFilter==Q.n?"#0094DE":null,color:this.state.todaysAppointmentFilter==Q.n?"white":"#0094DE",boxShadow:"0 2px 4px #111 inset"}},L.a.createElement("small",null,Q.n),L.a.createElement("h2",{style:{color:this.state.todaysAppointmentFilter==Q.n?"white":"#0094DE"}},this.state.todaysAppointmentOverview[Q.n]?this.state.todaysAppointmentOverview[Q.n]:0))),L.a.createElement(r.a,null,L.a.createElement("a",{type:"primary",onClick:function(){return t.changeDate(!1)}},L.a.createElement(p.a,{type:"left"})),this.state.selectedDate.format("MMM Do")==k()().format("MMM Do")?"Today":this.state.selectedDate.format("MMM Do"),"'s Schedule (",this.state.todaysFilteredAppointments.length,") \xa0",L.a.createElement("a",{type:"primary",onClick:function(){return t.changeDate(!0)}},L.a.createElement(p.a,{type:"right"}))),L.a.createElement(o.a,{spinning:this.state.loading},L.a.createElement(X.a,{size:"small",dataSource:this.state.todaysFilteredAppointments,renderItem:function(a){return a.status==Q.m?L.a.createElement("div",null):L.a.createElement(X.a.Item,{color:"transparent",style:{padding:0}},L.a.createElement("div",{style:{border:"1px solid #ddd",borderRadius:"5px",textDecoration:a.status==Q.m?"line-through":"inherit",backgroundColor:a.status==Q.m?"#aaa":"#eee",width:"100%",marginTop:"2px",borderLeft:"5px solid"+(a.doctor&&e.props.doctors_object&&e.props.doctors_object[a.doctor]?e.props.doctors_object[a.doctor].calendar_colour:"transparent")}},L.a.createElement($,Object.assign({},a,{changeAppointmentStatus:t.changeAppointmentStatus},t.props))))}})))}}]),e}(L.a.Component);function $(t){return L.a.createElement("div",{style:{width:"100%"}},L.a.createElement("p",{style:{marginBottom:0}},L.a.createElement(Y.a,{placement:"right",content:L.a.createElement(N.a,Object.assign({appointmentId:t.id,key:t.id},t))},L.a.createElement("span",{style:{width:"calc(100% - 60px)"}},L.a.createElement("b",null,k()(t.schedule_at).format("LT")),"\xa0",t.patient.user.first_name)),t.status==Q.Cb?L.a.createElement("span",{style:{width:"70px",float:"right"}},L.a.createElement("a",{onClick:function(){return t.changeAppointmentStatus(t.id,Q.Cb,Q.Hb)},disabled:!t.activePracticePermissions.ChangeAppointmentStatus}," Check In")):null,t.status==Q.Hb?L.a.createElement("span",{style:{width:"70px",float:"right"}},L.a.createElement("a",{onClick:function(){return t.changeAppointmentStatus(t.id,Q.Hb,Q.F)},disabled:!t.activePracticePermissions.ChangeAppointmentStatus}," Engage")):null,t.status==Q.F?L.a.createElement("span",{style:{width:"70px",float:"right"}},L.a.createElement("a",{onClick:function(){return t.changeAppointmentStatus(t.id,Q.F,Q.n)},disabled:!t.activePracticePermissions.ChangeAppointmentStatus}," Check Out")):null,t.status==Q.n?L.a.createElement("span",{style:{width:"70px",float:"right"}},L.a.createElement("small",null,"Checked Out")):null))}var tt=a(921),et=a(302);function at(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function nt(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?at(a,!0).forEach((function(e){Object(f.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):at(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var st=Object(_.c)(k.a),ot=j()(_.a),rt=O.a.Content,it=C.a.confirm,ct=function(t){function e(t){var a;return Object(g.a)(this,e),(a=Object(y.a)(this,Object(E.a)(e).call(this,t))).changeCalendarType=function(t){var e=Object(v.a)(a);a.setState({calendarType:t,selectedDoctor:"ALL",selectedCategory:"ALL",filterType:"DOCTOR"},(function(){"APPOINTMENTS"==t?e.changeFilter("selectedDoctor","ALL"):"AVAILABILITY"==t&&e.state.practice_doctors.length&&e.changeFilter("selectedDoctor",e.state.practice_doctors[0].id)}))},a.resizeEvent=function(t){var e=t.event,n=t.start,s=t.end;if(e.appointment.status!=Q.Cb)return Object(R.a)(F.fc,"Action Not Allowed"),!0;var o=a.state.events,r={},i=Object(v.a)(a),c=[];o.forEach((function(t){t.id==e.id&&(r={schedule_at:k()(n).format(),slot:parseInt((s-n)/6e4)})}));var l=function(t){Object(R.a)(F.Wb,"time changed"),o.forEach((function(t){c.push(t.id==e.id?nt({},t,{start:n,end:s}):t)})),i.setState({events:c},(function(){i.refreshFilterList()}))},m=function(){};it({title:"Are you sure to change the time of this appointment?",onOk:function(){Object(R.l)(Object(R.f)(M.o,[e.id]),r,l,m)},onCancel:function(){}})},a.blockedCalendarTiming=function(t,e){var n=Object(v.a)(a);Object(R.c)(M.x,(function(t){n.setState({blockedCalendar:t})}),(function(){}),{practice:a.props.active_practiceId,cal_fdate:t.format(),cal_tdate:e.format()})},a.onRangeChange=function(t){if(t.start&&t.end)if(a.appointmentList(k()(t.start),k()(t.end)),1==k()(t.start).date())a.setState({selectedDate:k()(t.start)});else{var e=k()(t.start);a.setState({selectedDate:e.month(e.month()+1).date(1)})}else t.length&&(7==t.length?a.appointmentList(k()(t[0]).subtract(1,"day"),k()(t[t.length-1]).subtract(1,"day")):a.appointmentList(k()(t[0]),k()(t[t.length-1])),a.setState({selectedDate:k()(t[0])}))},a.onSelectedDateChange=function(t){a.setState({selectedDate:k()(t)})},a.setFilterType=function(t){var e=Object(v.a)(a);a.setState({filterType:t.key,selectedDoctor:"ALL",selectedCategory:"ALL"},(function(){"DOCTOR"==t.key?e.changeFilter("selectedDoctor","ALL"):"CATEGORY"==t.key&&e.changeFilter("selectedCategory","ALL")}))},a.setFilter=function(t,e){var n=Object(v.a)(a);a.setState(Object(f.a)({},t,e),(function(){K(t,e),n.changeFilter("tempKey","ALL")}))},a.refreshFilterList=function(){var t=a.state;"DOCTOR"==t.filterType?a.changeFilter("selectedDoctor",t.selectedDoctor):"CATEGORY"==t.filterType&&a.changeFilter("selectedCategory",t.selectedCategory)},a.changeFilter=function(t,e){"selectedDoctor"==t&&"ALL"!=e&&a.loadDoctorTiming(e),a.setState((function(a){var n,s=[];return a.events.forEach((function(n){if(!a.filterCancelledAppointment&&n.appointment.status==Q.m)return!0;"ALL"==e?s.push(n):"selectedDoctor"==t&&n.doctor==e?s.push(n):"selectedCategory"==t&&n.appointment.category==e&&s.push(n)})),n={},Object(f.a)(n,t,e),Object(f.a)(n,"filteredEvent",s),n}))},a.changeState=function(t,e){a.setState(Object(f.a)({},t,e),(function(){K(t,e)}))},a.loadDoctorTiming=function(t){var e=Object(v.a)(a);Object(R.c)(Object(R.f)(M.Y,[a.props.active_practiceId]),(function(a){var n={};a.length&&(n=a[0]);var s={};Q.s.forEach((function(t){s[t]={},n.visting_hour_same_week?(s[t].startTime=k()(n.first_start_time,"HH:mm:ss"),s[t].endTime=k()(n.second_end_time,"HH:mm:ss"),n.is_two_sessions?(s[t].lunch=!0,s[t].lunchStartTime=k()(n.first_end_time,"HH:mm:ss"),s[t].lunchEndTime=k()(n.second_start_time,"HH:mm:ss")):s[t].lunch=!1):n[t]?(s[t].startTime=k()(n["first_start_time_".concat(t)],"HH:mm:ss"),s[t].endTime=k()(n["second_end_time_".concat(t)],"HH:mm:ss"),n["is_two_sessions_".concat(t)]?(s[t].lunch=!0,s[t].lunchStartTime=k()(n["first_end_time_".concat(t)],"HH:mm:ss"),s[t].lunchEndTime=k()(n["second_start_time_".concat(t)],"HH:mm:ss")):s[t].lunch=!1):s[t]=null})),e.setState((function(e){return{doctorTiming:nt({},e.doctorTiming,Object(f.a)({},t,nt({},s)))}}))}),(function(){}),{doctor:t})},a.state=nt({startTime:null,visiblePopover:!1,events:[],filteredEvent:[],appointments:[],practice_doctors:[],practice_categories:[],practice_staff:[],doctors_object:null,categories_object:null,calendarTimings:null,timing:{},loading:!0,selectedDoctor:"ALL",selectedCategory:"ALL",selectedDate:k()(),filterType:"DOCTOR",calendarType:"APPOINTMENTS",doctorsAppointmentCount:{},categoriesAppointmentCount:{},blockedCalendar:[],showCalendarEvents:!0,showAppointments:!0,doctorTiming:{}},q()),a.onSelectSlot=a.onSelectSlot.bind(Object(v.a)(a)),a.onSelectEvent=a.onSelectEvent.bind(Object(v.a)(a)),a.moveEvent=a.moveEvent.bind(Object(v.a)(a)),a.resizeEvent=a.resizeEvent.bind(Object(v.a)(a)),a.loadDoctors=a.loadDoctors.bind(Object(v.a)(a)),a.eventStyleGetter=a.eventStyleGetter.bind(Object(v.a)(a)),a.loadCalendarTimings=a.loadCalendarTimings.bind(Object(v.a)(a)),a.loadCalendarTimings(),a}return Object(A.a)(e,t),Object(b.a)(e,[{key:"componentDidMount",value:function(){var t;this.appointmentList(k()().subtract(1,"days"),k()().add(5,"days")),this.loadDoctors(),t=this,Object(R.c)(Object(R.f)(M.p,[t.props.active_practiceId]),(function(e){var a={},n=e.map((function(t){return a[t.id]=V({},t,{calendar_colour:Object(G.b)(Object(G.a)(t.name))}),a[t.id]}));t.setState({categories_object:a,practice_categories:n})}),(function(){}))}},{key:"loadDoctors",value:function(){var t=this;t.setState({doctorLoading:!0});Object(R.c)(Object(R.f)(M.Dc,[this.props.active_practiceId]),(function(e){var a=[],n=[],s={};e.staff.forEach((function(t){t.role==F.P?(a.push(t),s[t.id]=t):n.push(t)})),t.setState({practice_staff:n,practice_doctors:a,doctors_object:s,doctorLoading:!1})}),(function(){t.setState({doctorLoading:!1})}))}},{key:"loadCalendarTimings",value:function(){var t=this;Object(R.c)(Object(R.f)(M.J,[this.props.active_practiceId]),(function(e){var a={};e.length&&(a=e[0]);var n={};Q.s.forEach((function(t){n[t]={},a.visting_hour_same_week?(n[t].startTime=k()(a.first_start_time,"HH:mm:ss"),n[t].endTime=k()(a.second_end_time,"HH:mm:ss"),a.is_two_sessions?(n[t].lunch=!0,n[t].lunchStartTime=k()(a.first_end_time,"HH:mm:ss"),n[t].lunchEndTime=k()(a.second_start_time,"HH:mm:ss")):n[t].lunch=!1):a[t]?(n[t].startTime=k()(a["first_start_time_".concat(t)],"HH:mm:ss"),n[t].endTime=k()(a["second_end_time_".concat(t)],"HH:mm:ss"),a["is_two_sessions_".concat(t)]?(n[t].lunch=!0,n[t].lunchStartTime=k()(a["first_end_time_".concat(t)],"HH:mm:ss"),n[t].lunchEndTime=k()(a["second_start_time_".concat(t)],"HH:mm:ss")):n[t].lunch=!1):n[t]=null})),t.setState({calendarTimings:nt({},a),timing:nt({},n),loading:!1})}),(function(){t.setState({loading:!1})}))}},{key:"moveEvent",value:function(t){var e=t.event,a=t.start,n=t.end,s=t.isAllDay;if(e.appointment.status!=Q.Cb)return Object(R.a)(F.fc,"Action Not Allowed"),!0;var o=this.state.events,r=o.indexOf(e),i=e.allDay,c=this;!e.allDay&&s?i=!0:e.allDay&&!s&&(i=!1);var l=nt({},e,{start:a,end:n,allDay:i}),m=Object(h.a)(o),d={schedule_at:k()(a).format(),slot:parseInt((n-a)/6e4)},p=function(t){Object(R.a)(F.Wb,"time changed"),m.splice(r,1,l),c.setState({events:m},(function(){c.refreshFilterList()}))},u=function(){};it({title:"Are you sure to change the time of this appointment?",onOk:function(){Object(R.l)(Object(R.f)(M.o,[e.id]),d,p,u)},onCancel:function(){}})}},{key:"onSelectSlot",value:function(t){var e=k()(t.start).format();"doubleClick"==t.action&&(this.setState({startTime:e,redirect:!0}),this.props.history.push("/calendar/create-appointment"))}},{key:"onSelectEvent",value:function(t,e){this.setState({visiblePopover:!0}),this.props.history.push("/patients/appointments/"+t.id)}},{key:"appointmentList",value:function(t,e){var a=this;a.setState({loading:!0});Object(R.c)(Object(R.f)(M.q,[this.props.active_practiceId]),(function(t){a.setState((function(e){e.events;var a=[],n=[],s={},o={};return t.forEach((function(t){var r=new k.a(t.schedule_at).add(t.slot,"minutes"),i={appointment:t,start:new Date(k()(t.schedule_at)),end:new Date(r),title:t.patient.user.first_name,id:t.id,doctor:t.doctor,loading:!1};if(s.ALL?(s.ALL.ALL+=1,t.status==Q.m&&(s.ALL.CANCELLED+=1)):(s.ALL={},s.ALL.ALL=1,t.status==Q.m?s.ALL.CANCELLED=1:s.ALL.CANCELLED=0),t.doctor&&s[t.doctor]?(s[t.doctor].ALL+=1,t.status==Q.m&&(s[t.doctor].CANCELLED+=1)):(s[t.doctor]={},s[t.doctor].ALL=1,t.status==Q.m?s[t.doctor].CANCELLED=1:s[t.doctor].CANCELLED=0),t.category&&s[t.category]?o[t.category]+=1:o[t.category]=1,a.push(i),!e.filterCancelledAppointment&&i.appointment.status==Q.m)return!0;"DOCTOR"==e.filterType&&"ALL"==e.selectedDoctor||"CATEGORY"==e.filterType&&"ALL"==e.selectedCategory?n.push(i):"DOCTOR"==e.filterType&&i.doctor==e.selectedDoctor?n.push(i):"CATEGORY"==e.filterType&&i.appointment.category==e.selectedCategory&&n.push(i)})),{events:a,filteredEvent:n,doctorsAppointmentCount:nt({},s),categoriesAppointmentCount:nt({},o,{ALL:t.length}),appointments:t,loading:!1}}))}),(function(){a.setState({loading:!1})}),{start:t.format("YYYY-MM-DD"),end:e.format("YYYY-MM-DD")}),this.blockedCalendarTiming(t,e)}},{key:"eventStyleGetter",value:function(t,e,a,n){var s=t.doctor,o=t.appointment.category,r=null,i={borderRadius:"0px",opacity:.8,border:"5px",color:"white",display:"block"};return t.appointment.status==Q.m?(i.backgroundColor="#aaa",i.textDecoration="line-through"):("DOCTOR"==this.state.filterType?r=s&&this.state.doctors_object&&this.state.doctors_object[s]?this.state.doctors_object[s].calendar_colour:"black":"CATEGORY"==this.state.filterType&&(r=o&&this.state.categories_object&&this.state.categories_object[o]?"#"+this.state.categories_object[o].calendar_colour:"black"),i.backgroundColor=r),{style:i}}},{key:"render",value:function(){var t=this,e=this;this.state.startTime;this.state.calendarTimings&&(new Date(new k.a(this.state.calendarTimings.start_time,"HH:mm:ss")),new Date(new k.a(this.state.calendarTimings.end_time,"HH:mm:ss")));return L.a.createElement(rt,{className:"main-container"},L.a.createElement("div",{style:{padding:"5px"}},L.a.createElement(x.d,null,L.a.createElement(x.b,{exact:!0,path:"/calendar/create-appointment",render:function(e){return t.props.activePracticePermissions.AddAppointment||t.props.allowAllPermissions?L.a.createElement(tt.a,Object.assign({},t.state,t.props,e,{startTime:t.state.startTime})):L.a.createElement(et.a,null)}}),L.a.createElement(x.b,{exact:!0,path:"/calendar/:appointmentid/edit-appointment",render:function(e){return t.props.activePracticePermissions.EditAppointment||t.props.allowAllPermissions?L.a.createElement(tt.a,Object.assign({},t.state,t.props,e,{startTime:t.state.startTime})):L.a.createElement(et.a,null)}}),L.a.createElement(x.b,null,L.a.createElement("div",{style:{backgroundColor:"#fff",padding:"5px 10px"}},L.a.createElement(n.a,{gutter:16},L.a.createElement(s.a,{span:3},L.a.createElement(u.a,{onChange:this.onSelectedDateChange,value:this.state.selectedDate,format:"DD-MM-YYYY",style:{margin:5},allowClear:!1}),"APPOINTMENTS"==this.state.calendarType?L.a.createElement("div",null,e.props.activePracticePermissions.BlockCalendar||e.props.allowAllPermissions?L.a.createElement(d.a,{block:!0,style:{margin:5}},L.a.createElement(P.b,{to:"/calendar/blockcalendar"},L.a.createElement(p.a,{type:"stop"})," Block Calendar")):null,L.a.createElement(l.a,{trigger:"click",overlay:L.a.createElement(m.a,{onClick:this.setFilterType},L.a.createElement(m.a.Item,{key:"DOCTOR"},"DOCTOR"),L.a.createElement(m.a.Item,{key:"CATEGORY"},"CATEGORY"))},L.a.createElement(d.a,{block:!0,style:{margin:5}},this.state.filterType," ",L.a.createElement(p.a,{type:"caret-down"})))):null,L.a.createElement(o.a,{spinning:this.state.doctorLoading},"DOCTOR"==this.state.filterType?L.a.createElement(m.a,{selectedKeys:[this.state.selectedDoctor],size:"small",onClick:function(e){return t.changeFilter("selectedDoctor",e.key)}},"APPOINTMENTS"==this.state.calendarType?L.a.createElement(m.a.Item,{key:"ALL",style:{marginBottom:2,textOverflow:"ellipsis",borderLeft:"5px solid black",borderRight:"none"}},L.a.createElement("span",null,"(",this.state.doctorsAppointmentCount.ALL?this.state.filterCancelledAppointment?this.state.doctorsAppointmentCount.ALL.ALL:this.state.doctorsAppointmentCount.ALL.ALL-this.state.doctorsAppointmentCount.ALL.CANCELLED:0,") All Doctors")):null,this.state.practice_doctors.map((function(e){return L.a.createElement(m.a.Item,{key:e.id,style:{textOverflow:"ellipsis",borderRight:"none",borderLeft:"5px solid "+e.calendar_colour,backgroundColor:t.state.selectedDoctor==e.id?e.calendar_colour:"inherit",color:t.state.selectedDoctor==e.id?"white":"inherit",fontWeight:t.state.selectedDoctor==e.id?"bold":"inherit"}},L.a.createElement("span",null,"(",t.state.doctorsAppointmentCount[e.id]?t.state.filterCancelledAppointment?t.state.doctorsAppointmentCount[e.id].ALL:t.state.doctorsAppointmentCount[e.id].ALL-t.state.doctorsAppointmentCount[e.id].CANCELLED:0,") ",e.user.first_name))}))):L.a.createElement(m.a,{selectedKeys:[this.state.selectedCategory],size:"small",onClick:function(e){return t.changeFilter("selectedCategory",e.key)}},L.a.createElement(m.a.Item,{key:"ALL",style:{marginBottom:2,textOverflow:"ellipsis",borderLeft:"5px solid black",borderRight:"none"}},L.a.createElement("span",null,"(",this.state.categoriesAppointmentCount.ALL?this.state.categoriesAppointmentCount.ALL:0,") All Categories")),this.state.practice_categories.map((function(e){return L.a.createElement(m.a.Item,{key:e.id,style:{textOverflow:"ellipsis",borderRight:"none",borderLeft:"5px solid #"+e.calendar_colour,backgroundColor:t.state.selectedCategory==e.id?"#"+e.calendar_colour:"inherit",color:t.state.selectedCategory==e.id?"white":"inherit",fontWeight:t.state.selectedCategory==e.id?"bold":"inherit"}},L.a.createElement("span",null,"(",t.state.categoriesAppointmentCount[e.id]?t.state.categoriesAppointmentCount[e.id]:0,") ",e.name))}))),L.a.createElement("div",{style:{marginTop:16}},L.a.createElement(c.a.Group,{size:"small",checked:this.state.calendarType,defaultValue:this.state.calendarType,buttonStyle:"solid",onChange:function(e){return t.changeCalendarType(e.target.value)}},L.a.createElement(c.a.Button,{value:"APPOINTMENTS"},L.a.createElement("small",null,"Appointments")),L.a.createElement(c.a.Button,{value:"AVAILABILITY"},L.a.createElement("small",null,"Availability")))),L.a.createElement("div",{style:{position:"fixed",bottom:10,zIndex:9}},this.state.openMorePanel?L.a.createElement("div",{style:{boxShadow:"0 2px 4px #111",border:"1px solid #bbb",borderRadius:2,padding:5,backgroundColor:"white"}},L.a.createElement("ul",{style:{listStyle:"none",paddingInlineStart:0}},L.a.createElement("li",null,L.a.createElement(i.a,{checked:this.state.showCalendarEvents,onChange:function(t){return e.changeState("showCalendarEvents",t.target.checked)}},L.a.createElement("small",null,"Events"))),L.a.createElement("li",null,L.a.createElement(i.a,{checked:this.state.showAppointments,onChange:function(t){return e.changeState("showAppointments",t.target.checked)}},L.a.createElement("small",null,"Appointments"))),L.a.createElement("li",null,L.a.createElement(i.a,{checked:this.state.show24HourCalendar,onChange:function(t){return e.changeState("show24HourCalendar",t.target.checked)}},L.a.createElement("small",null,"24 Hours"))),L.a.createElement("li",null,L.a.createElement(i.a,{checked:this.state.filterCancelledAppointment,onChange:function(t){return e.setFilter("filterCancelledAppointment",t.target.checked)}},L.a.createElement("small",null,"Cancellled Appointment"))),L.a.createElement("li",null,L.a.createElement(r.a,null)),L.a.createElement("li",null,L.a.createElement(P.b,{to:"/settings/clinics-staff#staff"},L.a.createElement("small",null,"Add Doctor"))),L.a.createElement("li",null,L.a.createElement(P.b,{to:"/settings/calendarsettings#timings"},L.a.createElement("small",null," Customize Calendar"))),L.a.createElement("li",null,L.a.createElement("a",null,L.a.createElement("small",null,"Resync")),L.a.createElement(d.a,{onClick:function(){return t.changeState("openMorePanel",!1)},shape:"circle",size:"small",type:"danger",icon:"close",style:{float:"right"}})))):L.a.createElement("a",{onClick:function(){return t.changeState("openMorePanel",!0)}},"More ",L.a.createElement(p.a,{type:"caret-down"}))))),"APPOINTMENTS"==this.state.calendarType?L.a.createElement("div",null,L.a.createElement(s.a,{span:16},L.a.createElement(o.a,{size:"large",spinning:this.state.loading},L.a.createElement(ot,{key:"APPOINTMENTS",defaultDate:new Date,localizer:st,defaultView:"day",step:10,timeslots:1,truncateEvents:!1,events:this.state.showAppointments?this.state.filteredEvent:[],onEventDrop:this.moveEvent,onEventResize:this.resizeEvent,resizable:!0,selectable:!0,popup:this.onSelectEvent,onSelectSlot:this.onSelectSlot,views:{month:!0,week:lt,day:!0,agenda:!0},style:{height:"calc(100vh - 85px)"},eventPropGetter:this.eventStyleGetter,date:new Date(this.state.selectedDate.format()),onRangeChange:this.onRangeChange,components:{event:function(t){return L.a.createElement(z,Object.assign({},t,e.props))},timeSlotWrapper:function(t){return L.a.createElement(U,Object.assign({},t,{key:t.value.toString(),blockedCalendar:e.state.blockedCalendar,calendarTimings:e.state.timing,doctorTimings:e.state.doctorTiming[e.state.selectedDoctor],filterType:e.state.filterType,selectedDoctor:e.state.selectedDoctor,showCalendarEvents:e.state.showCalendarEvents}))}}}))),L.a.createElement(s.a,{span:5},L.a.createElement(Z,Object.assign({},this.props,this.state,{key:k()(this.state.selectedDate).toISOString()})))):L.a.createElement(s.a,{span:21},L.a.createElement(ot,{key:"AVAILABILITY",defaultDate:new Date,localizer:st,defaultView:"day",step:10,timeslots:1,truncateEvents:!1,events:this.state.showAppointments?this.state.filteredEvent:[],onEventDrop:this.moveEvent,onEventResize:this.resizeEvent,resizable:!0,selectable:!0,popup:this.onSelectEvent,onSelectSlot:this.onSelectSlot,views:{week:!0,day:!0},style:{height:"calc(100vh - 85px)"},eventPropGetter:this.eventStyleGetter,date:new Date(this.state.selectedDate.format()),onRangeChange:this.onRangeChange,components:{event:function(t){return L.a.createElement(z,Object.assign({},t,e.props))},timeSlotWrapper:function(t){return L.a.createElement(U,Object.assign({},t,{key:t.value.toString(),blockedCalendar:e.state.blockedCalendar,calendarTimings:e.state.timing,doctorTimings:e.state.doctorTiming[e.state.selectedDoctor],filterType:e.state.filterType,selectedDoctor:e.state.selectedDoctor,showCalendarEvents:e.state.showCalendarEvents}))}}}))))))))}}]),e}(T.Component),lt=(e.default=ct,function(t){function e(){return Object(g.a)(this,e),Object(y.a)(this,Object(E.a)(e).apply(this,arguments))}return Object(A.a)(e,t),Object(b.a)(e,[{key:"render",value:function(){var t=this.props.date,a=e.range(t);return L.a.createElement(w.a,Object.assign({},this.props,{range:a,eventOffset:15}))}}]),e}(L.a.Component));lt.range=function(t){for(var e=I.add(t,-1,"day"),a=I.add(e,6,"day"),n=e,s=[];I.lte(n,a,"day");)s.push(n),n=I.add(n,1,"day");return s},lt.navigate=function(t,e){switch(e){case _.b.PREVIOUS:return I.add(t,-3,"day");case _.b.NEXT:return I.add(t,3,"day");default:return t}},lt.title=function(t){return" ".concat(t.toLocaleDateString())}}}]);
//# sourceMappingURL=16.42ecc703.chunk.js.map